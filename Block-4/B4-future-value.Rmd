# Future value

`r under_construction()`

Comparison is an important element of human decision making. Often, comparison amounts to translating each of the options at hand into a scalar or score. Scalars are easy to compare; the skill is taught in elementary school. Scalar comparison is completely objective. Putting aside the possibility of error, everyone will agree on which of two numbers is bigger. Importantly, comparison of scalars is ***transitive***, that is if $a > b$ and $b > c$ then it is impossible that $a \leq c$.

The comparison of scalars can be extended to situations where the options available form a continuum and the score for each option is represented by a function, $f(x)$. As we saw in Chapters `r Chaps$optimization` and \@ref(optimization-and-constraint) selecting the highest scoring option is a matter of finding the argmax.

Many decisions involve options that have two or more attributes that are not directly comparable. Expenditure decisions have this flavor: Is it worth the money to buy a more reliable or prettier or more capable version of a product? The techniques of ***constrained optimization*** (Chapter \@ref(optimization-and-constraint)) provide one useful approach for informing decisions when there are multiple objectives.

Elections are a form of collective decision making. The options---called, of course, "candidates"---have many attributions. Three commonly mentioned are attitudes toward social policy, toward fiscal policy, and toward foreign policy. Perceived honesty and trustworthiness as well as the ability to influence other decision makers and perceived ability to win the election are other attributes that are considered and balanced. Ultimately the decision is made by condensing the diverse attributes into a single number: how many votes the candidate garnered. With this number attached to each of the candidates, it's easy to make the decision, which could be written
$$\mathop{\text{argmax}}_{i} \text{votes}(\text{candidate}_i)\ .$$

This chapter is about often encountered settings where attributes are presented as a function on a domain and it is desired to reduce the function to a single, representative number. To avoid unnecessary abstraction, we'll consider two different types of domain: time and age.

## Present value (time)

People and institutions often have to make decisions about undertakings where the costs and benefits are spread out over tie. For instance, a person acquiring an automobile or home is confronted with a large initial outlay. The outlay can be financed by agreeing to pay amounts in the future, often over a span of many years.

Another example: Students today are acutely aware of climate change and the importance of taking preventive or mitigating actions such as discouraging fossil fuel production, investing in renewable sources of energy and the infrastructure for using them effectively, and exploring active measures such as carbon sequestration. The costs and benefits of such actions are spread out over decades, with the costs coming sooner than the benefits. Policy makers are often and perhaps correctly criticized for overvaluing present-day costs and undervaluing benefits that accrue mainly to successive generations. There are many analogous situations on a smaller scale, such as setting Social Security taxes and benefits or the problem of underfunded pension systems and the liability for pension payments deferred to future taxpayers.]

The conventional mechanism for condensing an extended time stream of benefits and costs is called ***discounting***. Discounting is based on the logic of financing expenditures via borrowing at interest. For example, credit cards are a familiar mechanism for financing purchases by delaying the payment of money until the future. A common occurance is that an expense that is too large to bear is "carried" on a credit card so that it can be paid off as funds become available. This incurs costs due to ***interest*** on the credit-card balance. Typical credit-card interest rates are 18-30% per year.


As notation, consider a time stream of money ${\cal C}(t)$. The big conceptual leap is to understand that the ***present value*** of money, that is, the value in terms of a unit of money that we have right now, is not constant.  Let's denote the present value function ${\cal V}_r(t)$, where $r$ is a parameter. The total present value---generally called the ***net present value***---of the time stream of money is 
$$\int_\text{now}^\text{forever} {\cal C}(t) {\cal V}_r(t)\, dt\ .$$
It's conventional to define ${\cal V}_r(t)$ on the basis of bank interest. We stipulate that the present value of  that ${\cal V}_r(0) = 1$, which is to say that the present value of $1 that we have in hand right now is exactly 1 dollar.

Suppose that a bank offers to lend you money at an interest rate of $r$ per month. To receive from them 1 dollar now entails that you pay the bank $1+r$ dollars at the end of the month. A rational decision maker would undertake this transaction only if there was not a loss in it, that is, if the present value of $1+r$ dollars in a month is less than or equal to the present value of 1 dollar now. Or, more generally, 
$$(1+r)^t \ {\cal V}_r(t) \leq  {\cal V}_r(0) = 1\ .$$ By this logic, $${\cal V}(t) =  \frac{1}{(1+r)^t} = (1+r)^{-t}\ .$$
Thus, the present value function ${\cal V}_r(t)$ is an exponentially decaying function of time. Since we're used to using a parameter $k$ in exponential functions, we'll write the present value function as $${\cal V}_r(t) = e^{-k t} = (1+r)^{-t}\ .$$ The last equality provides a way to determine the numerical value of $k$ from the specified $r$. 

The reason it's preferable to use $k$ instead of $r$ has to do with compounding of interest. Being told $r=2\%$ per month is not quite the entire story. You also have to know how often the interest is compounded. For instance, it's natural (but wrong!) to believe that 2% per month is the same as 24% per year. But it depends on how often the interest is compounded. If it is compounded every month, the present value of one dollar at the end of a year is ${\cal V}_r(t= 1\ \text{year}) = (1+r)^{12}$. For $r = 2\%$ per month, that comes to $1.02^{12} = 1.2682$. In other words, the effective annual rate is 26.82%. If you round off 2% per month to 24% per year, you will be underestimating the amount you owe by about 10%.

In the $e^{kt}$ format, all you need to know is the value of $k$ and its units. The parameter $k$ will match a rate of $r$ per month when $e^{kt} = (1+r)^t$, in other words $k = \ln(1+r)$ per month. Whereas multiplying $r$ by 12 will not convert a monthly rate into an annual rate, things are much simpler with $k$. For instance, for $r=2\%$ per month, $k = \ln(1.02) = 0.0198$ per month. The $k$ corresponding to 12 months is a unit conversion: "per month" into "per year". Of course, 1 per month is the same quantity as 12 per year, so multiply 0.0198 per month by 12 months/year to get $12 \times 0.0198 = 0.2376$ per year. In this way of reckoning, the amount you owe after one year is $\exp(0.2376\ \text{per year} \times 1\ \text{year}) = 1.2682$.

::: {.intheworld data-latex=""}

Suppose you decide to buy a product that costs $\$\cal P$, say $\cal P=$ $10,000 for a used car. Let's say you need the car for your new job, but you don't have the money. So you borrow it. 

Your plan is to pay an amount $A$ each month for 30 months---the next 2 $\tiny\frac{1}{2}$ years. What should that rate be? 

You can put the purchase on your credit card at an interest rate of $r=2\%$ per month. This corresponds to $k = \ln(1+r) = 0.0198$ per month. The net present value of your payments over 30 months at a rate of $A$ per month will be
$$\int_0^{30} A {\cal V}_r(t)\, dt = \int_0^{30} e^{-kt} A = -\frac{A}{k} e^{-kt}\left.{\Large\strut}\right|_{t=0}^{30}\\ =- A \left(\strut \frac{e^{-30k}}{k} - \frac{e^{-0k}}{k} \right) = - A\left(\strut27.88 - 50.50\right) = 22.62 A$$
For $22.62 A = {\cal P}$, your monthly payment on the $10,000 car will be $10,000/22.62 or $442.09.
:::

## Age adjusting

How you do this.  YOU WERE HERE.

## OLD STUFF
The Powerball is a weekly lottery famous for its outsized payoff. For instance, for the week of April 7, 2021, the jackpot payout is officially described as $43,000,000. There is a limited sense in which this might be true, but in a far more meaningful sense it is not. The winner has a choice between a one-time cash payout of $29,300,000 or an annuity of 30 annual payments of $1,433,333. However, the winnings are taxable income and the lottery's administration (a not-for-profit, government benefit organization) withhold applicable federal and state taxes. According to the [usmega site](https://www.usamega.com/powerball/jackpot), in Colorado the cash payment would amount to $17,161,778 while the annuity would be 30 payments of $873,711. `r mark(4300)`

This will sound silly, but we know the value of $17,161,778 paid today: it is $17,161,778. But what is the value of $873,711 paid out over 30 years? The answer depends on the *discount rate*, that is, the present value of future money. When the discount rate is $r$, the current value of money due to be paid in $n$ years is $(1-r)^n$. For instance, at $r = 5\%$, the current value of $1000 to be paid 10 years in the future is $599. The table shows the net present value of the $873,711 paid out yearly over 30 years. `r mark(4305)`

Discount rate | Net Present Value
--------------|------------------:
0    | `r format(sum(1^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
1%   | `r format(sum(.99^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
2%   | `r format(sum(.98^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
4%   | `r format(sum(.96^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
5%   | `r format(sum(.95^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
8%   | `r format(sum(.92^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
10%  | `r format(sum(.90^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`
15%  | `r format(sum(.85^(0:29))*873711, digits=4, scientific=FALSE, big.mark=",")`

The formula behind this table is $$873711 \sum_{k=0}^{29} (1-r)^k$$

What discount rate to use is a judgement call, and will reasonably depend on a person's situation. For example, a 90-year old might reasonably discount future money at $r=20\%$, whereas the discount rate for a person owing money next month to the mafia might be considerably higher.  `r mark(4310)`

As a placeholder, we can look to the auctions of inflation-adjusted US Treasury Inflation Protected Securities (TIPS). As of this writing, a TIPS with a nominal payout of $1000 in 30 years is for sale at $100.70 (as of April 6, 2021), corresponding to a discount rate of 8% per year. With some justification, one might assert that the nominal $43,000,000 Powerball prize is really worth about $10 million. `r mark(4315)`

Let's turn the problem of calculating a net present value into a calculus problem. Rather than summing over the discounted yearly dollar payout, we'll consider a continuous payout rate in dollars per year.  `r mark(4320)`

```{r pb1-1, echo=FALSE, results="markup"}
askMC(
  "In continuous time, a continuously compounding interest rate $r$ is a parameter in a differential equation $$\\dot{P} = r P$$ where $P$ is the amount of money (\"principal\") under investment.  Solve the differential equation at $t=1$ year  with an initial principal of $100  to find the corresponding *effective annual interest rate*. Which of these is the conversion between $r$ in the differential equation and the effective annual interest rate? (Hint: Think carefully about the distinction between the interest rate $r$ and the increase at the end of one year $1+r$)",
  "+$\\exp(r) - 1$+",
  "$\\exp(1+r) -1$",
  "$\\exp(r)$",
  "$\\exp(1+r)$"
)
```

```{r pb1-2, echo=FALSE, results="markup"}
askMC(
  "Using the correct answer from the previous question, find the continuously compounding interest rate $r$ that corresponds to an effective annual discount rate of 8%. Which of these is it?",
  "$r = \\ln(0.08)$",
  "+$r = \\ln(1.08)$+",
  "$r = \\sqrt{0.08}$",
  "$r = \\sqrt{(1 + 0.08)^2} - 1$"
  
)
```


```{r pb1-3, echo=FALSE, results="markup"}
askMC(
  "Which of these integrals corresponds to the discrete sum in the formula for the net present value of the Powerball payout?",
  "+$\\int_0^{29} 873711 (1-r)^t dt$+",
  "$\\int_1^{30} 873711 (1-r)^t dr$",
  "$\\int_0^{30} 873711 (1-r)^t dt$",
  "$\\int_1^{29} 873711 (1-r)^t dr$"
)
```


Here is a sandbox you can use for the calculations needed to answer the following questions.

```{r pb2-1, exercise=TRUE, exercise.cap="Calculation sandbox", exercise.nlines=10, eval = FALSE}




```


```{r answer-to-last-question, echo=FALSE, eval=FALSE}
F <- antiD((1-r)^t ~ t, r=0.077)
10*(F(100000) - F(0))
```


We're going to use an effective annual discount rate of 8% in the following problems.

```{r pb1-4, echo=FALSE, results="markup"}
askMC(
  "Which of the following is the continuously compounded interest rate that corresponds to the effective annual interest rate of 8%?",
  "7.3%",
  "+7.7%+",
  "8.0%", 
  "8.3%",
  random_answer_order = FALSE
)
```

```{r pb1-5, echo=FALSE, results="markup"}
askMC(
  "Using the continously compounded interest rate that's equivalent to an effective annual rate of 8%, calculate the appropriate integral for the net present value of a continuous payout at a rate of $873,711 dollars/year$ for the 30-year annuity term used in Powerball. Which of these is it? (Hint: Construct the appropriate anti-derivative and from that compute the appropriate definite integral.)", 
  "$8,970,000",
  "+$9,840,000+",
  "$10,030,000",
  "$10,460,000",
  random_answer_order = FALSE
)
```

There is a joke that makes sense only to the financially savvy: When the Powerball claims a $1 million payout, they mean $1 per year over a million years. We can do this calculation using numerical evaluation of the definite integral but there is a catastrophic loss of numerical precision for the 1-million year calculation. Instead, do the calculation for a $10/year payout over 100,000 years. `r mark(4325)`

First, answer the following **ungraded** question with utter honesty.

> **Before doing the actual calculation**, form an intuitive answer to the question of what is the net present value of $10/year over 100,000 years. Don't try to be strategic in anticipating the answer, just give your gut feeling. The instructors are curious about what sorts of numbers will come to mind.

```{r pb1-6b, echo=FALSE, results="markup"}
askMC(
  "At the continuously compounded interest rate corresponding to an effective annual rate of 8%, find the net present value of $10 per year over a hundred-thousand years. Which one of these is closest?",
  "+$124.80+",
  "$1248.00$",
  "$12,480.00$",
  "$124,800.00$",
  random_answer_order = TRUE
)
```

Finally, and this has nothing to do with net present value *per se*, try out the calculation of the net present value of $1 per year over a million years. This is worth doing if only to see a compelling example of how far off computer numerics can be when using very large or very small numbers. `r mark(4335)`

A professional will always have at hand some method for checking the reasonableness of an answer in order to detect when something is wrong. For example, here you might look at a sequence of calculations: $100,000 per year over 10 years, $10,000 per year over 100 years, and so on. You would expect the numbers in this sequence to approach some sort of limit as the number of years increases. It does, but as the number of years gets larger that limit goes awry. `r mark(4340)`


