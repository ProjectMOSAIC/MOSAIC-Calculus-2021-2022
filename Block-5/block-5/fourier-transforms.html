<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Fourier transforms | MOSAIC-Calculus.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Fourier transforms | MOSAIC-Calculus.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Fourier transforms | MOSAIC-Calculus.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-inference.html"/>
<link rel="next" href="block-5-projects-and-review.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>






<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="mosaic-calc-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../docs/welcome-to-calculus.html">Welcome to calculus</li>
<li><a href="../block-1/change.html">Block 1: Functions & quantities</a></li>
<li><a href="../block-2/change-relatonships.html">Block 2: Differentiation</a></li>
<li><a href="../block-3/change-accumulation.html">Block 3: Accumulation</a></li>
<li><a href="../block-4/introduction.html">Block 4: Manifestations</a></li>
<hr>
<li><strong><a href="./">Block 5: Linear combinations</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="linear-objects.html"><a href="linear-objects.html"><i class="fa fa-check"></i><b>1</b> Linear objects</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-objects.html"><a href="linear-objects.html#vectors"><i class="fa fa-check"></i><b>1.1</b> Vectors</a></li>
<li class="chapter" data-level="1.2" data-path="linear-objects.html"><a href="linear-objects.html#the-nth-dimension"><i class="fa fa-check"></i><b>1.2</b> The n<sup>th</sup> dimension</a></li>
<li class="chapter" data-level="1.3" data-path="linear-objects.html"><a href="linear-objects.html#geometry-arithmetic"><i class="fa fa-check"></i><b>1.3</b> Geometry &amp; arithmetic</a></li>
<li class="chapter" data-level="1.4" data-path="linear-objects.html"><a href="linear-objects.html#angles"><i class="fa fa-check"></i><b>1.4</b> Angles</a></li>
<li class="chapter" data-level="1.5" data-path="linear-objects.html"><a href="linear-objects.html#orthogonality"><i class="fa fa-check"></i><b>1.5</b> Orthogonality</a></li>
<li class="chapter" data-level="1.6" data-path="linear-objects.html"><a href="linear-objects.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
<li class="chapter" data-level="1.7" data-path="linear-objects.html"><a href="linear-objects.html#outline"><i class="fa fa-check"></i><b>1.7</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html"><i class="fa fa-check"></i><b>2</b> Linear combinations of vectors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html#scaling"><i class="fa fa-check"></i><b>2.1</b> Scaling</a></li>
<li class="chapter" data-level="2.2" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html#sub-spaces"><i class="fa fa-check"></i><b>2.2</b> Sub-spaces</a></li>
<li class="chapter" data-level="2.3" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html#functions-as-vectors"><i class="fa fa-check"></i><b>2.3</b> Functions as vectors</a></li>
<li class="chapter" data-level="2.4" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html#matrices"><i class="fa fa-check"></i><b>2.4</b> Matrices</a></li>
<li class="chapter" data-level="2.5" data-path="linear-combinations-of-vectors.html"><a href="linear-combinations-of-vectors.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="projection-residual.html"><a href="projection-residual.html"><i class="fa fa-check"></i><b>3</b> Projection &amp; residual</a>
<ul>
<li class="chapter" data-level="3.1" data-path="projection-residual.html"><a href="projection-residual.html#projecting-a-vector-onto-another-vector"><i class="fa fa-check"></i><b>3.1</b> Projecting a vector onto another vector</a></li>
<li class="chapter" data-level="3.2" data-path="projection-residual.html"><a href="projection-residual.html#projection-onto-a-set-of-vectors"><i class="fa fa-check"></i><b>3.2</b> Projection onto a set of vectors</a></li>
<li class="chapter" data-level="3.3" data-path="projection-residual.html"><a href="projection-residual.html#exercises-2"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
<li class="chapter" data-level="3.4" data-path="projection-residual.html"><a href="projection-residual.html#moved-from-vectors"><i class="fa fa-check"></i><b>3.4</b> MOVED FROM VECTORS</a></li>
<li class="chapter" data-level="3.5" data-path="projection-residual.html"><a href="projection-residual.html#matrix"><i class="fa fa-check"></i><b>3.5</b> Matrix</a></li>
<li class="chapter" data-level="3.6" data-path="projection-residual.html"><a href="projection-residual.html#scalar-multiplication"><i class="fa fa-check"></i><b>3.6</b> Scalar multiplication</a></li>
<li class="chapter" data-level="3.7" data-path="projection-residual.html"><a href="projection-residual.html#dot-product-and"><i class="fa fa-check"></i><b>3.7</b> Dot product and <code>%*%</code></a></li>
<li class="chapter" data-level="3.8" data-path="projection-residual.html"><a href="projection-residual.html#vector-lengths"><i class="fa fa-check"></i><b>3.8</b> Vector lengths</a></li>
<li class="chapter" data-level="3.9" data-path="projection-residual.html"><a href="projection-residual.html#outline-1"><i class="fa fa-check"></i><b>3.9</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="target-problem.html"><a href="target-problem.html"><i class="fa fa-check"></i><b>4</b> The target problem</a>
<ul>
<li class="chapter" data-level="4.1" data-path="target-problem.html"><a href="target-problem.html#properties-of-the-solution"><i class="fa fa-check"></i><b>4.1</b> Properties of the solution</a></li>
<li class="chapter" data-level="4.2" data-path="target-problem.html"><a href="target-problem.html#the-geometry-of-qr.solve"><i class="fa fa-check"></i><b>4.2</b> The geometry of <code>qr.solve()</code></a></li>
<li class="chapter" data-level="4.3" data-path="target-problem.html"><a href="target-problem.html#finding-the-target-with-qr"><i class="fa fa-check"></i><b>4.3</b> Finding the target with QR</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="least-squares.html"><a href="least-squares.html"><i class="fa fa-check"></i><b>5</b> Least Squares</a>
<ul>
<li class="chapter" data-level="5.1" data-path="least-squares.html"><a href="least-squares.html#the-data"><i class="fa fa-check"></i><b>5.1</b> The data</a></li>
<li class="chapter" data-level="5.2" data-path="least-squares.html"><a href="least-squares.html#the-fitting-problem"><i class="fa fa-check"></i><b>5.2</b> The fitting problem</a></li>
<li class="chapter" data-level="5.3" data-path="least-squares.html"><a href="least-squares.html#the-residual-vector"><i class="fa fa-check"></i><b>5.3</b> The residual vector</a></li>
<li class="chapter" data-level="5.4" data-path="least-squares.html"><a href="least-squares.html#solving-m-x-b-part-ii"><i class="fa fa-check"></i><b>5.4</b> Solving M x ≈ b: Part II</a></li>
<li class="chapter" data-level="5.5" data-path="least-squares.html"><a href="least-squares.html#lm-and-qr.solve"><i class="fa fa-check"></i><b>5.5</b> <code>lm()</code> and <code>qr.solve</code></a></li>
<li class="chapter" data-level="5.6" data-path="least-squares.html"><a href="least-squares.html#r2-residuals-etc."><i class="fa fa-check"></i><b>5.6</b> R<span class="math inline">\(^2\)</span>, Residuals, etc.</a></li>
<li class="chapter" data-level="5.7" data-path="least-squares.html"><a href="least-squares.html#modern-fitting-the-ridge-and-the-lasso-optional"><i class="fa fa-check"></i><b>5.7</b> Modern fitting: The ridge and the lasso (optional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>6</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-inference.html"><a href="statistical-inference.html#categorical-inputs"><i class="fa fa-check"></i><b>6.1</b> Categorical inputs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fourier-transforms.html"><a href="fourier-transforms.html"><i class="fa fa-check"></i><b>7</b> Fourier transforms</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fourier-transforms.html"><a href="fourier-transforms.html#ocean-tides"><i class="fa fa-check"></i><b>7.1</b> Ocean Tides</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="fourier-transforms.html"><a href="fourier-transforms.html#the-functions-continuously"><i class="fa fa-check"></i><b>7.1.1</b> The functions, continuously</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fourier-transforms.html"><a href="fourier-transforms.html#the-sun-and-the-moon"><i class="fa fa-check"></i><b>7.2</b> The Sun <strong>and</strong> the Moon</a></li>
<li class="chapter" data-level="7.3" data-path="fourier-transforms.html"><a href="fourier-transforms.html#tide-prediction"><i class="fa fa-check"></i><b>7.3</b> Tide prediction</a></li>
<li class="chapter" data-level="7.4" data-path="fourier-transforms.html"><a href="fourier-transforms.html#spectroscopy"><i class="fa fa-check"></i><b>7.4</b> Spectroscopy</a></li>
<li class="chapter" data-level="7.5" data-path="fourier-transforms.html"><a href="fourier-transforms.html#exercises-3"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
<li class="chapter" data-level="7.6" data-path="fourier-transforms.html"><a href="fourier-transforms.html#outline-2"><i class="fa fa-check"></i><b>7.6</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html"><i class="fa fa-check"></i><b>8</b> Block 5 Projects and review</a>
<ul>
<li class="chapter" data-level="8.1" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html#internal-combustion-engines"><i class="fa fa-check"></i><b>8.1</b> Internal combustion engines</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html#starting-out"><i class="fa fa-check"></i><b>8.1.1</b> Starting out</a></li>
<li class="chapter" data-level="8.1.2" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html#another-example"><i class="fa fa-check"></i><b>8.1.2</b> Another example</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html#cylinder-shape"><i class="fa fa-check"></i><b>8.2</b> Cylinder shape</a></li>
<li class="chapter" data-level="8.3" data-path="block-5-projects-and-review.html"><a href="block-5-projects-and-review.html#body-fat"><i class="fa fa-check"></i><b>8.3</b> Body fat</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="../block-6/dynamics.html">Block 6: Dynamics</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fourier-transforms" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Fourier transforms</h1>
<p>In high school, you learned about <em>polynomials</em>, functions of the form</p>
<p><span class="math display">\[f(x) \equiv a + b x + c  x^2 + d x^3  \ldots\]</span>
Perhaps, having been introduced to the idea of linear combinations of functions, you can see <span class="math inline">\(f(x)\)</span> as a linear combination of power-law functions: <span class="math inline">\(x^0\)</span> and <span class="math inline">\(x^1\)</span> and <span class="math inline">\(x^2\)</span> and so on. These are sometimes called <em>monomials</em> (where <em>mono</em> means “one” and <em>poly</em> means “many”). The monomials are a <em>basis set</em> of functions, essentially the building blocks of polynomials.</p>
<p>Historically, these have been extremely important in the development of mathematics, and these were fundamental tools available to Newton and the users of calculus in the 18th century. They are still a staple of calculus curricula world wide.</p>
<p>In the early 1800s, there was a radical development. French mathematician Jean-Baptiste Joseph Fourier (1768-1830), studying the propagation of heat in metal bars, introduced a new set of building-block functions, the familiar sine functions.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-1.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-2.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-3.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-4.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-5.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-6.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-7.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-8.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-9.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-10.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-11.png" width="25%" style="display: block; margin: auto;" /><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-12.png" width="25%" style="display: block; margin: auto;" /></p>
<p>In Fourier’s honor, the use of the sine-wave basis set is called a <em>Fourier Transform</em>. The Fourier basis set is fundamental in many areas of science and engineering. Our purpose here is to show you that linear combinations of the sine-wave basis provide a valid way to approximate many types of non-sine functions. We will not focus on applications, since you will see so many of those in your later courses.</p>
<p>In recent decades, there have been remarkable developments in creating new basis sets for applications such as sound and image compression, approximating smooth functions, etc. You may have heard the names of some of them, e.g. JPEG, wavelets, splines.</p>
<p>Our objective in this Daily Digital is merely to de-mystify some of the most important techniques in science so that, when you encounter them later, you will understand better that their purpose is to approximate functions by a linear combination of simple building blocks.</p>
<div id="ocean-tides" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Ocean Tides</h2>
<p>We’re going to start to construct a simple theory of ocean tides. Let’s start with some data, several days’ tides in Providence, Rhode Island in 2010. The tide <code>level</code> is in meters.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="fourier-transforms.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(level <span class="sc">~</span> date_time, <span class="at">data =</span> RI_tide)</span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-61-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Look at the graph and pull out some patterns, either regular or irregular.</p>
<blockquote>
<p>Question: <em>Describe briefly some patterns that you see in the tide data.</em></p>
</blockquote>
<p>Instead of using the <code>date_time</code> variable, we’ll use <code>hour</code>, which is a simple numerical variable giving the time in hours since the start of April 2010 that the <code>level</code> measurement was made. The <code>hour</code> variable works better for making model functions.</p>
<p>The next code box contains the basic commands you will be using. You’ll see similar code boxes throughout this Daily Digital, each with some refinement in the development of the tide theory.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="fourier-transforms.html#cb148-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(</span>
<span id="cb148-2"><a href="fourier-transforms.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(level <span class="sc">~</span> <span class="fu">fourier_M</span>(hour, <span class="dv">1</span>, <span class="at">fperiod =</span> <span class="dv">24</span>), <span class="at">data =</span> RI_tide)</span>
<span id="cb148-3"><a href="fourier-transforms.html#cb148-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-4"><a href="fourier-transforms.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(level <span class="sc">~</span> hour, <span class="at">data =</span> RI_tide) <span class="sc">%&gt;%</span></span>
<span id="cb148-5"><a href="fourier-transforms.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">model</span>(hour) <span class="sc">~</span> hour, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">npts =</span> <span class="dv">500</span>) </span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-62-1.png" width="90%" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Question: <em>The blue curve shows the sinusoid model fitted to the data. Do you think this is a good model? Explain why or why not, giving some detail about the match or mis-match of the data to the model.</em></p>
</blockquote>
<p>Now to explain the code being used. There are two expressions. Lines 1-3 construct a model using linear combinations of sines and cosines. Lines 4 and 5 plot out the data and the model respectively.</p>
<p>Some of the commands in the code box will be familiar to you: <code>makeFun()</code>, <code>gf_point()</code>, <code>slice_plot()</code>.</p>
<p>What will be <em>unfamiliar</em> are the two functions <code>lm()</code> and <code>fourier_M()</code>.</p>
<ul>
<li><code>fourier_M()</code> generates a set of vectors from the Fourier basis.
<ol style="list-style-type: lower-roman">
<li>The first argument is the input values at which to evaluate the basis function.</li>
<li>The second argument is how many sine/cosine pairs from the basis to generate.</li>
<li>The third argument is the <em>fundamental period</em> of the Fourier basis. We set this to 24 hours.</li>
</ol></li>
<li><code>lm()</code> is the workhorse of modeling with linear combinations. It takes as input a tilde expression. The output variable is on the left side of the tilde. On the right side is a list of matrices (separated by <code>+</code>) whose vectors we want to include in the linear combination.</li>
</ul>
<p>Let’s play around a bit with <code>fourier_M()</code>. The next code block shows a simple use of <code>fourier_M()</code>: for <span class="math inline">\(t = 1\)</span> to <span class="math inline">\(24\)</span> (hours), we are generating the first sine/cosine pair in the Fourier basis.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="fourier-transforms.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fourier_M</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">1</span>, <span class="at">fperiod =</span> <span class="dv">24</span>)</span></code></pre></div>
<pre><code>##                [,1]          [,2]
##  [1,]  2.588190e-01  9.659258e-01
##  [2,]  5.000000e-01  8.660254e-01
##  [3,]  7.071068e-01  7.071068e-01
##  [4,]  8.660254e-01  5.000000e-01
##  [5,]  9.659258e-01  2.588190e-01
##  [6,]  1.000000e+00  6.123234e-17
##  [7,]  9.659258e-01 -2.588190e-01
##  [8,]  8.660254e-01 -5.000000e-01
##  [9,]  7.071068e-01 -7.071068e-01
## [10,]  5.000000e-01 -8.660254e-01
## [11,]  2.588190e-01 -9.659258e-01
## [12,]  1.224647e-16 -1.000000e+00
## [13,] -2.588190e-01 -9.659258e-01
## [14,] -5.000000e-01 -8.660254e-01
## [15,] -7.071068e-01 -7.071068e-01
## [16,] -8.660254e-01 -5.000000e-01
## [17,] -9.659258e-01 -2.588190e-01
## [18,] -1.000000e+00 -1.836970e-16
## [19,] -9.659258e-01  2.588190e-01
## [20,] -8.660254e-01  5.000000e-01
## [21,] -7.071068e-01  7.071068e-01
## [22,] -5.000000e-01  8.660254e-01
## [23,] -2.588190e-01  9.659258e-01
## [24,] -2.449294e-16  1.000000e+00</code></pre>
<p><strong>Question I</strong> True or False: In the output from <code>fourier_M(1:24, 1, fperiod = 24)</code>, the first column is the cosine member of the pair and the second is the sine member.</p>
<p>    <span class="Zchoice">True<span class="mcanswer">︎✘ Remember, at input 0, cosine produces an output of 1.</span></span>       <span class="Zchoice">False<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span></p>
<p><strong>Question J</strong> True or False: The period of the sinusoid is the same in both columns of the output of <code>fourier_M(1:24, 1, fperiod=24)</code>.</p>
<p>    <span class="Zchoice">True<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">False<span class="mcanswer">︎✘ The basis functions come in pairs: a sine and a cosine of each period.</span></span></p>
<div id="the-functions-continuously" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> The functions, continuously</h3>
<p>The <code>fourier_M()</code> function is designed to work with the <code>lm()</code> linear-combination model-making function. But for <em>looking</em> at the functions, it’s convenient to use <code>fourier_set()</code>. Instead of generating a set of numerical vectors, <code>fourier_set()</code> creates a set of functions that can be graphed in the usual way. The following code box shows the first Fourier pair. <code>F_funs</code> is a function that takes two arguments: the first is the input value; the second is the index of the function – equivalent to the column number in the output of <span class="math inline">\(fourier_M()\)</span>. So with <code>fourier_set()</code>, we can easily graph the functions corresponding to the various columns of <code>fourier_M()</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="fourier-transforms.html#cb151-1" aria-hidden="true" tabindex="-1"></a>F_funs <span class="ot">&lt;-</span> <span class="fu">fourier_set</span>(<span class="dv">1</span>, <span class="at">left =</span> <span class="dv">0</span>, <span class="at">right =</span> <span class="dv">24</span>)</span>
<span id="cb151-2"><a href="fourier-transforms.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">F_funs</span>(t, <span class="dv">1</span>) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">24</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="fourier-transforms.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">F_funs</span>(t, <span class="dv">2</span>) <span class="sc">~</span> t, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-64-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The functions in the first pair have the <em>fundamental</em> period of the Fourier basis. The next pair have a period <em>half</em> as long, the pair after that have a period one-third as long, and so on. These are called <em>harmonics</em> of the fundamental. In music, the first harmonic is one octave higher than the fundamental, the second is two octaves higher, and so on.</p>
<p>In the code box, change the first argument to <code>fourier_set()</code> in order to generate the fundamental pair, and the pairs for some higher harmonics. For instance, setting the first argument to 5 will generate the fundamental plus 4 harmonics.</p>
<p>Modify the code to generate the fundamental pair plus 3 more pairs. Then plot out the cosine member of all four pairs (i.e. indices 2, 4, 6, and 8). Use different colors for each one so that you can keep track of which is which.</p>
<p><strong>Question K</strong> In the 24 hours of the domain, how many cycles are there of the fundamental (index 2)?</p>
<p>    <span class="Zchoice">1<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">2<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">3<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">4<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">5<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">6<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">7<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">8<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question L</strong> In the 24 hours of the domain, how many cycles are there of the first harmonic (index 4)?</p>
<p>    <span class="Zchoice">1<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">2<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">3<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">4<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">5<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">6<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">7<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">8<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question M</strong> In the 24 hours of the domain, how many cycles are there of the second harmonic (index 6)?</p>
<p>    <span class="Zchoice">1<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">2<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">3<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">4<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">5<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">6<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">7<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">8<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question N</strong> In the 24 hours of the domain, how many cycles are there of the third harmonic (index 8)?</p>
<p>    <span class="Zchoice">1<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">2<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">3<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">4<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">5<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">6<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">7<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">8<span class="mcanswer">︎✘ </span></span></p>
<p>The next code box calculates the linear combination of the sines and cosines in the fundamental and first three harmonics of the 24 hour period.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="fourier-transforms.html#cb152-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(</span>
<span id="cb152-2"><a href="fourier-transforms.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(level <span class="sc">~</span> <span class="fu">fourier_M</span>(hour, <span class="dv">4</span>, <span class="at">fperiod =</span> <span class="fl">24.83</span>), <span class="at">data =</span> RI_tide)</span>
<span id="cb152-3"><a href="fourier-transforms.html#cb152-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb152-4"><a href="fourier-transforms.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(level <span class="sc">~</span> hour, <span class="at">data =</span> RI_tide, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-5"><a href="fourier-transforms.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">model</span>(hour) <span class="sc">~</span> hour, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">npts =</span> <span class="dv">500</span>) </span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-65-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Perhaps you can see in the plot of the period 24-hour model a drift between the model and the actual tide data. There’s a good reason for that. 24 hours describes the period of the rotation of the Earth with respect to the Sun. But it is the Moon that is mostly responsible for tidal oscillations. The length of the “day” with respect to the Moon is a little longer: 24.83 hours.</p>
<p>Change the <code>fperiod</code> argument in <code>fourier_M()</code> to 24.83 hours.</p>
<blockquote>
<p>QUESTION: <em>Describe what in the graph shows that the <code>fperiod = 24.83</code> hour model is superior to the <code>fperiod = 24</code> hour model.</em></p>
</blockquote>
<p>QUESTION: <em>Describe what in the tidal data the <code>fperiod = 24.83</code> hour model doesn’t capture.</em></p>
</div>
</div>
<div id="the-sun-and-the-moon" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> The Sun <strong>and</strong> the Moon</h2>
<p>While the Moon is the primary influence in shaping the tides, the Sun also plays a role. The Sun’s role is particularly evident near hide and low tide.</p>
<p>With the technique of linear combinations, it’s easy enough to add in a solar periodicity to the tides. That’s done in the next code box. You can see that the model incorporates 4 pairs for the Moon period and another 4 pairs for the Sun period.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="fourier-transforms.html#cb153-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(</span>
<span id="cb153-2"><a href="fourier-transforms.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(level <span class="sc">~</span> <span class="fu">fourier_M</span>(hour, <span class="dv">4</span>, <span class="at">fperiod =</span> <span class="fl">24.83</span>) <span class="sc">*</span> <span class="fu">fourier_M</span>(hour, <span class="dv">4</span>, <span class="at">fperiod =</span> <span class="dv">24</span>), <span class="at">data =</span> RI_tide)</span>
<span id="cb153-3"><a href="fourier-transforms.html#cb153-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb153-4"><a href="fourier-transforms.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(level <span class="sc">~</span> hour, <span class="at">data =</span> RI_tide, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb153-5"><a href="fourier-transforms.html#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">model</span>(hour) <span class="sc">~</span> hour, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">npts =</span> <span class="dv">500</span>) </span></code></pre></div>
<pre><code>## Warning in predict.lm(model, newdata = data.frame(hour = hour), ...): prediction
## from a rank-deficient fit may be misleading</code></pre>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-66-1.png" width="90%" style="display: block; margin: auto;" />
Adding in the Sun’s influence to that of the Moon improves the model a bit. But there are still clear deviations between the model and the data.</p>
<p>It’s tempting to look for additional planets as the explanation for shortcomings of the Moon + Sun model. Let’s show now that any such planetary influences are trivial. We’ll do this by incorporating in to the model a new phenomenon. It turns out that the Moon’s and Sun’s influences <em>interact</em>. This is just to say that the Sun can have greater or lesser influence depending on the depth of the tide, which is primarily set by the Moon. The interactions create new functions that look like the <em>product</em> of one sinusoidal with another, for instance, <span class="math inline">\(sin(2\pi 2 t/24.83) \times sin(2\pi 2 t/24)\)</span>, which is the interaction of the first harmonic of the Moon’s period with the first harmonic of the Sun’s period.</p>
<p>Interactions between model components are so important for modeling in general, that <code>lm()</code> has a special, simple notation that means, “and include the interactions.” Simply change the <code>+</code> in the tilde expression for the model with a <code>*</code>. The effect will be to move from having 8 pairs of sines and cosines (four for the Moon and four for the Sun) to having 80 functions which can be combined linearly.</p>
<blockquote>
<p>QUESTION: <em>Change the <code>+</code> in the tilde expression for the model to <code>*</code>. Describe what features of the data that were not accounted for by the previous models are now captured by the model with interactions.</em></p>
</blockquote>
</div>
<div id="tide-prediction" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Tide prediction</h2>
<p>The tide predictions made by the US National Oceanic and Atmospheric Administration are based on the same sort of linear combination of sinusoids presented here. Tides differ by location and are influenced by geography both large (continents) and small (bays). So a custom prediction must be made for each location for which a prediction is desired (harbors, beaches, etc). The overall scheme for doing this involves the linear combination of sinusoids of specific periods. Often, dozens of different periods are included. Using these periods, past tidal records are examined using essentially the same method we’ve done here. The result is the coefficients for the linear combinations. To illustrate, here is the <a href="https://tidesandcurrents.noaa.gov/harcon.html?id=9455920">NOAA table for Anchorage, Alaska</a> which lists 120 different periods.</p>
<p>The work that we did with <code>lm()</code>, figuring out the best linear combination of the sinusoids, is called “harmonic analysis.” Before the 1950s and the advent of electronic computers, the work had to be done by large analog computers involving rollers on rotating disks and might take weeks of effort.</p>
<p>Once the coefficients are known, however, generating a model output for any given time is straightforward. We can do it simply by evaluating the model function. Before electronic computers, this work was done with analog “harmonic synthesizers.” The picture shows the harmonic synthesizer built by the U.S. Coast and Geodetic Survey in 1882. This machine and its successors were used until 1966, when they were replaced by mainframe computers.</p>
<p><img src="www/mach2cs.png" width="50%" style="display: block; margin: auto;" /></p>
<p>The machine sums 19 sinusoids. Seventeen of these are visible in the picture, each is a wheel spinning at a specific frequency. Another wheel is positioned off-center on each major wheel according to the amplitude and phase of the sinusoid.</p>
<p>Accurate prediction of tides is essential to amphibious landings. Well before the D-Day invasion in 1944, British surveillance teams were sent secretly to the Normandy beaches to make careful shallow-water measurements of tide and wave levels. These were then subjected to harmonic analysis (the work we did with <code>lm()</code>) and then harmonic synthesis used to generate the predictions. A general theory held that the best time to attack was at high tide, so the Germans built coastal obstacles that would be just underwater at high tide in order to rip out the bottoms of landing craft. The allies were aware of these defenses and so arranged to land at low tide. This required soldiers to cover a much longer run of beach, but also provided the opportunity to spot and demolish the beach obstacles so that larger craft could be used as the tide rose. The date of the invasion was set for a confluence of low tide at dawn and a late-rising moon.</p>
</div>
<div id="spectroscopy" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Spectroscopy</h2>
<p>The prism as a fourier analyzer.</p>
</div>
<div id="exercises-3" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Exercises</h2>
<ul>
<li>Show that the Legendre polynomials of different degree are orthogonal to one another.</li>
<li>Show that the length of a legendre polynomial is 1.</li>
</ul>
</div>
<div id="outline-2" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Outline</h2>
<ol style="list-style-type: lower-alpha">
<li>Polynomials as transforms: read off the coefficients to represent the function</li>
<li>Functions can be represented as vectors
<ol style="list-style-type: lower-roman">
<li>“Time base”</li>
<li>Evaluate function at time base</li>
</ol></li>
<li>Polynomial transform as target problem
<ol style="list-style-type: lower-roman">
<li>extreme sensitivity to small changes in <span class="math inline">\(\vec{b}\)</span>
<ol style="list-style-type: lower-alpha">
<li>highly collinear: the vectors say only two things:
<ol style="list-style-type: lower-roman">
<li>both arms up.</li>
<li>one arm up, one arm down.</li>
</ol></li>
</ol></li>
<li>extrapolate poorly</li>
<li>But low-order (up to quadratic) is OK.
i. three shapes of function: flat, arms both up, one arm up and one down</li>
</ol></li>
<li>Transform into the frequency domain
<ol style="list-style-type: lower-roman">
<li>orthogonal sines and cosines</li>
<li>sines and cosines are important models of system behavior,
<ol style="list-style-type: lower-roman">
<li>pendula of different lengths</li>
<li>whistling</li>
<li>transmission by waves/modulation</li>
</ol></li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="block-5-projects-and-review.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/B5-Fourier.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/B5-Fourier.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
