# Eigenvalues, eigenvectors {#eigenvalues}

::: {.underconstruction}
8. Eigenvalue/Eigenvector analysis
    a. Objectives/topics
        i. Understand the geometry of the flow (what an eigenvector looks like in terms of the flow, as it emerges from the image of the flow field)
        i. Trajectories as linear combinations of eigenflows
::: 


In the previous chapters, you've seen how linear dynamics, when unstable, lead trajectories off to infinity. Chapter \@ref(modeling-dynamics) looked at some ways that nonlinearity can tame instability, as in the simple models of linear growth.

In this chapter, we return to linear dynamics to develop a *quantitative theory of stability*. Such theory is important in many engineering and design applications. For instance, a building exposed to earthquake risk can be economically designed to be strong specifically against the type of shaking produced by earthquakes. An electronic circuit can be designed to be sensitive to certain kinds of communication signals while still resisting noise or jamming.

::: {.example data-latex=""}
***Cruise control*** is a feature of many modern automobiles. It enables a driver to set a desired speed for the car to follow automatically, thus reducing cognitive load on the driver.
Early models of cruise control introduced in the 1970s (and still common in 2020) had an extremely simple logic. The speedometer constantly monitors the car's speed $v$. The driver sets a desired speed, which we'll call $v_0$. The cruise control actuator---the mechanism that works to maintain the speed at $v_0$ by, let's say, adjusting the throttle to increase or reduce speed as appropriate---is designed to produce a throttle input proportional to the deviation in actual speed $v$ from the set speed $v_0$.
$$\text{throttle_input} = -a (v - v_0)\ .$$
You can see that when $v = v_0$, the throttle input from the system is zero. When $v_0 < v$, as when starting to go downhill, the throttle input will be negative, reducing the speed. 

A simple model is that the throttle input is proportional to $\partial_t\, v$: positive input increases speed, negative input decreases speed. The overall system is then described by a linear, first-order differential equation $$\partial_t\,v = -a(v-v_0)\ .$$ This equation has a fixed point at $v = v_0$ (as desired). To describe more simply the dynamics around the fixed point, we can define a new dynamical state $y=v - v_0$. Differentiating both sides with respect to time gives $\partial_t y = \partial_t v$, so we can re-write the original differential equation as $$\partial_t y = -a y$$ which has a solution $y(t) = A e^{-at}$ as we've seen before. For any positive coefficient $a$, the control system is stable: a deviation from $v_0$ will be followed by exponential decay back to $v_0$. 

A modern cruise control system adds an important feature: the car slows down automatically if it gets too close to the car in front. Let's call the distance to the leading car $x$ and define "too close" to mean closer than distance $x_0$. The control system looks like this:
$$\partial_t v = \left\{\begin{array}{l}- a (v-v_0) \ \text{if}\ x_0 < x\\
-b(x-x_0) \ \text{otherwise}\end{array}\right.$$
For a system to work, the dynamics must be stable. But the signs are not good. For instance, when in car-following mode, the dynamics are $$\partial_t v \equiv \partial_{tt} x = - b(x-x_0)\ .$$
This system will show sinusoidal oscillations around the fixed point $x=x_0$. To see why, define $y=x-x_0$. Re-written in terms of $y$, the differential equation is $\partial_{tt} y = -b y$ which has a solution $y=A \sin\left(\sqrt{b} \ t\right)$.
:::

## Eigenvectors

The form in which we have been writing linear differential equations in two state variables is
$$\partial_t x = a x + b y\\
\partial_t y = c x + d y$$

In Section \@ref(qualitative-stability) we looked at the stability from a qualitative point of view, finding eight generic situations for the two-state variable linear system.

Now we will look at things from a quantitative perspective, at least for saddles, centers, and sources. The key insight comes from looking at the flow field around the fixed point. As an example, we'll look at the system:

$$\partial_t x = x + y\\
\partial_t y = 2 x \ \ \ \ $$
whose flow is shown in Figure \@ref(fig:linear-streamlines). The fixed point 

```{r linear-streamlines, echo=FALSE, fig.cap="Flow for a linear system. The lines going through the fixed point are the directions in which the flow is directly toward the fixed point or away from the fixed point."}
gf_abline(intercept=~ 0, slope=~1, color="magenta", alpha=0.5, size=2) %>%
  gf_abline(intercept=~ 0, slope=~-2, color="brown", alpha=0.5, size=2) %>%
vectorfield_plot(x + y ~ x + y, 2*x ~ x + y, domain(x=-1:1, y=-1:1), npts=10, transform=function(x) x^0.3) %>%
  gf_refine(coord_fixed()) 
  
```
The fixed point in the flow of Figure \@ref(fig:linear-streamlines) is at $(0,0)$. The plot is annotated with two lines. The flow on the $\color{magenta}{\text{magenta}}$ line is directly away from the fixed point, while the flow on the $\color{brown}{\text{brown}}$ line is directly toward the fixed point. 

As you'll see, for any saddle, center, or source, there are always two such directions from the fixed point such that a trajectory starting on a point in that direction will continue in a straight line in that direction toward or away from the fixed point. These directions are called ***eigenvectors***. The word "eigen" comes from the German for "own" or "self." In mathematics, it is usually translated as "proper" or "characteristic. That meaning is appropriate because the eigenvectors characterize the entire flow field. 

The eigenvectors in Figure \@ref(fig:linear-streamlines) are $$\vec{v_1} = \left[\begin{array}{c}1\\1\end{array}\right]\ \ \ \text{and}\ \ \ \vec{v_2} = \left[\begin{array}{c}-\frac{1}{2}\\\ 1\end{array}\right]\ .$$



Here are two trajectories, one starting from $(x=0.1, y=0.1)$ and the other from $(x=-0.5, y=1)$

```{r two-trajectories, fig.cap="Any trajectory starting on an eigenvector will stay on that eigenvector."}
traj1 <- integrateODE(dx ~ x + y, dy ~ 2*x, x=0.1, y=0.1)
traj2 <- integrateODE(dx ~ x + y, dy ~ 2*x, x = -.5, y=1)
traj_plot(y(t) ~ x(t), traj1, color="magenta") %>%
  traj_plot(y(t) ~ x(t), traj2, color="brown") %>%
  vectorfield_plot(x + y ~ x + y, 2*x ~ x + y, 
                   domain(x=-1:1, y=-1:1), 
                   npts=10) %>%
  gf_refine(coord_fixed()) %>%
  gf_lims(x=c(-1,1), y=c(-1,1))
```

The idea that a trajectory starting on an eigenvector stays on an eigenvector has an important mathematical consequence for finding the solutions. For instance, the trajectory starting on $\vec{v_2} = \left[\begin{array}{c}-\frac{1}{2}\\1 \end{array}\right]$ will go only through points that have the relationship $y = -2 x$, since on $a \vec{v_2}$ the $y$ coordinate will always be negative 2 times the $x$ coordinate. This allows us to simplify the differential equations and immediately see the solution.
$$\partial_t x = x + y \ \ \implies\ \ \ \partial_t x = x - 2x = -x \ \ \implies\ \ x(t) = A e^{-1t}\\
\partial_t y = 2 x \ \ \implies\ \ \ \partial_t y = -y\ \ \implies \ \ \ y(t) = B e^{-1t}\ .$$ Since the solution will always be such that $y = -2 x$, we know that $B = -2 A$.

Similarly, for a trajectory starting on the other eigenvector, where $x = y$, the differential equations simplify to
$$\partial_t x = x + y \ \ \implies\ \ \ \partial_t x = x +y = 2x \ \ \implies\ \ x(t) = A e^{2t}\\
\partial_t y = 2 x \ \ \implies\ \ \ \partial_t y = 2y\ \ \implies \ \ \ y(t) = B e^{2t}$$ where $B = A$ so that the initial condition is on the eigenvector.

Solutions from an initial condition on an eigenvector are simple exponentials! 

## Linear combinations

It's awkward having to write things like $B=A$ or $B = -2A$ to make clear that the initial condition is on an eigenvector. 


What about solutions from initial conditions not on an eigenvector. For instance, how about the initial condition $$\left[\begin{array}{c}x_0\\y_0\end{array}\right] = \left[\begin{array}{c}-0.9\\2.1\end{array}\right] = 0.1 \vec{v_1} + 2 \vec{v_2}$$





Even more remarkable is the exponential shape of the solution, which we can see by plotting $y(t)$ vs $t$ on semi-log axes. (See Chapter `r Chaps$magnitudes`)
```{r exp-shape-soln}
traj_plot(y(t) ~ t, traj1, color="magenta") %>%
  traj_plot(y(t) ~ t, traj2, color="brown") %>%
  gf_refine(scale_y_log10(sec.axis = sec_axis( trans=~exp(.), name="y")))

```


Show that starting on an eigenvector stays on an eigenvector. The time series will be either a growing exponential or a decaying exponential, depending on the sign of $\lambda$.

Every $n\times n$ matrix---we are working with $2\times 2$ matrices for simplicity--has associated with it a set of $n$ numbers called *eigenvalues*.  This is a mix of the German word "eigen" meaning "characteristic," and the English work "values." Sometime they are called *characteristic values* just to render them purely in English. But "eigen" has a single, specific meaning in mathematics, so the word "eigenvalue" is more evocative to mathematicians than is "characteristic values."

The letter used to represent eigenvalues is the Greek lambda: $\lambda$. Since our $2\times 2$ matrices have 2 eigenvalues, we often write the pair as $\lambda_1$ and $\lambda_2$ or even as $\lambda_{1,2}$. 

For an [ab10] matrix, the formula for the eigenvalues is

$$\lambda_{1,2} = \frac{1}{2} \left[a \pm \sqrt{a^2 + 4b\strut}\right]$$

Note the use of the $\pm$ in the formula. The same formula gives *both* eigenvalues, one from the $+$ branch of the $\pm$, the other from the $-$ branch. Using the $\pm$ rather than two different formulas---one with $-$ and one with $+$---is merely a convenience to make it explicit what the two formulas would have in common.

Writing $\lambda_{1,2}$ is nothing more than saying $\lambda_1$ *and* $\lambda_2$.

## Exercises

`r insert_calcZ_exercise("XX.XX", "OwCtGH", "Exercises/child-buy-drawer.Rmd")`

`r insert_calcZ_exercise("XX.XX", "Rdc7vE", "Exercises/beech-ride-bowl.Rmd")`

`r insert_calcZ_exercise("XX.XX", "PD3CiZ", "Exercises/panda-teach-door.Rmd")`



EXERCISES: Give numbers for $abcd$ and $x(0)$ and $\partial_t x(0)$. Find the eigenvalues and $A$ and $B$.
