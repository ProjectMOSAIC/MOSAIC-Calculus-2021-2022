<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 42 Finding a solution | MOSAIC-Calculus.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 42 Finding a solution | MOSAIC-Calculus.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 42 Finding a solution | MOSAIC-Calculus.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="differential-equations.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf #1}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{\|{\mathbf #1}\|}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="mosaic-calc-style-copy.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../docs/welcome-to-calculus.html">Welcome to calculus</li>
<li><a href="../block-1/change.html">Block 1: Functions & quantities</a></li>
<li><a href="../block-2/change-relationships.html">Block 2: Differentiation</a></li>
<li><a href="../block-3/change-accumulation.html">Block 3: Accumulation</a></li>
<li><a href="../block-4/block4-intro.html">Block 4: Manifestations</a></li>
<li><a href="../block-5/vectors.html">Block 5: Linear combinations</a></li>
<hr>
<li><strong><a href="../block-6/dynamics.html">Block 6: Dynamics</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="41" data-path="differential-equations.html"><a href="differential-equations.html"><i class="fa fa-check"></i><b>41</b> Differential equations</a>
<ul>
<li class="chapter" data-level="41.1" data-path="differential-equations.html"><a href="differential-equations.html#the-language-for-change"><i class="fa fa-check"></i><b>41.1</b> The language for change</a></li>
<li class="chapter" data-level="41.2" data-path="differential-equations.html"><a href="differential-equations.html#state"><i class="fa fa-check"></i><b>41.2</b> State</a></li>
<li class="chapter" data-level="41.3" data-path="differential-equations.html"><a href="differential-equations.html#dynamics"><i class="fa fa-check"></i><b>41.3</b> Dynamics</a></li>
<li class="chapter" data-level="41.4" data-path="differential-equations.html"><a href="differential-equations.html#state-space-and-flow-field"><i class="fa fa-check"></i><b>41.4</b> State space and flow field</a></li>
<li class="chapter" data-level="41.5" data-path="differential-equations.html"><a href="differential-equations.html#exercises"><i class="fa fa-check"></i><b>41.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="second-order-de.html"><a href="second-order-de.html"><i class="fa fa-check"></i><b>42</b> Finding a solution</a>
<ul>
<li class="chapter" data-level="42.1" data-path="second-order-de.html"><a href="second-order-de.html#the-flow-field"><i class="fa fa-check"></i><b>42.1</b> The flow field</a></li>
<li class="chapter" data-level="42.2" data-path="second-order-de.html"><a href="second-order-de.html#euler-method"><i class="fa fa-check"></i><b>42.2</b> Euler method</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="second-order-de" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 42</span> Finding a solution</h1>
<div style="float:right;">
<a href="https://github.com/ProjectMOSAIC/MOSAIC-Calculus/blob/main/Block-6/B6-solution.Rmd"><img src="www/icons/edit.png" /></a>
</div>
<div class="underconstruction">
<ol style="list-style-type: decimal">
<li>Idea of accumulation</li>
<li>Numerical solution: Euler method and iteration</li>
<li>Analytic solution:
<ol style="list-style-type: lower-roman">
<li>Ansatze and confirming a solution</li>
<li>Some special cases, separable equations</li>
<li>Laplace transforms</li>
</ol></li>
</ol>
</div>
<p>As you saw in the previous chapter, a differential equation relates the derivative of a function to the function itself, for instance <span class="math display">\[\partial_t x(t) = x(t)\,(1-x(t))\ .\]</span> <em>Solving</em> a differential equation means to find a function <span class="math inline">\(x(t)\)</span> that is consistent with the equation. This chapter is about techniques for finding solutions.</p>
<p>It’s tempting—but not usually possible—to apply the symbolic anti-differentiation techniques from Block 3 to the problem. After all <span class="math display">\[\int \partial_t x(t) dt = x(t)\,\]</span> as described in the “fundamental theorem of calculus”. Following this logic, we would translate the equation to <span class="math display">\[x(t) = \int x(t)\, (1-x(t))dt\ .\]</span> But in order to carry out the anti-differentiation, we would need to know <span class="math inline">\(x(t)\)</span> itself, which is the function we are trying to find.</p>
<p>Nonetheless, it’s common to refer to <strong><em>integrating</em></strong> a differential equation, but this should be broadly understood as <strong><em>accumulating</em></strong> the increments <span class="math inline">\(\partial_t x(t)\)</span> starting at some initial condition <span class="math inline">\(x(t_0)\)</span>, even if that accumulation is not carried out by symbolic anti-differentiation.</p>
<p>In this chapter we’ll introduce four different techniques to accumulating a solution to a differential equation or a pair of such equations. First, we’ll look again at the <strong><em>graphical method</em></strong> of “following the flow” in a plot of the flow field. This technique is mainly of use for developing intuition about the dynamics.</p>
<p>Second, we’ll develop a simple Euler method for accumulating a solution. Third, we’ll explore how to take a guess about the solution and, when the guess is good enough, refine that into an actual solution. This is called the <strong><em>method of ansëtze</em></strong>.</p>
<p>Fourth, and briefly, we’ll look at some of the situations where symbolic anti-differentiation can be used. This includes a very brief introduction to <strong><em>transform methods</em></strong>.</p>
<div class="takenote">
<p>A differential equation like <span class="math display">\[\partial_t x(t) = x(t)\,(1-x(t))\]</span> is very busy typographically. One reason is the repeated <span class="math inline">\((t)\)</span> which play no role other than to state explicitly that <span class="math inline">\(x\)</span> is a function of <span class="math inline">\(t\)</span>. A convenient shorthand simply replaces <span class="math inline">\(x(t)\)</span> to make the “is a function of <span class="math inline">\(t\)</span>” <em>implicit</em>. Thus the equation appears as <span class="math display">\[\partial_t x = x (1-x)\ .\]</span> It’s the reader’s responsibility, knowing that he or she is working with a differential equation, to remember that <span class="math inline">\(x\)</span> is a function of <span class="math inline">\(t\)</span>.</p>
<p>An even more concise notation, originated by Isaac Newton, is to replace the <span class="math inline">\(\partial_t\)</span> with a simple <span class="math inline">\(\dot{\ }\)</span>. With this notation the equation looks like
<span class="math display">\[\dot{x} = x (1-x)\ ,\]</span> about as simple as it gets.</p>
<p>This dot notation is even more expressive when working with second-order differential equations involving second derivative. In the dot notation, <span class="math inline">\(\partial_{tt}\)</span> is written <span class="math inline">\(\ddot{\ }\)</span>.</p>
</div>
<div id="the-flow-field" class="section level2" number="2.1">
<h2><span class="header-section-number">42.1</span> The flow field</h2>
<p>With a pair of differential equations, as with the pendulum or the rabbit-fox model, each equation gives one component of the change in state. To draw the flow field, pick one point at a time from the state space, and calculate the right-hand sides of the differential equation from each equation. If the parameters in the model have been assigned numerical values, the result of evaluating the right-hand sides will be two numbers.</p>
<p>A case in point is the rabbit-fox model where the state variables are <span class="math inline">\(r\)</span> and <span class="math inline">\(f\)</span>. The differential equations are <span class="math display">\[\partial_t r = 0.66 r - 1.33 r f\\
\partial_t f = -f + rf\\
\]</span></p>
<p>To draw the flow arrow at, say, <span class="math inline">\(r=2, f=1/4\)</span>, plug those values into the right-hand side: <span class="math display">\[\partial_t r = 1.33 - 0.66 = 0.66\\
\partial_t f = -0.25 + 0.5 = 0.25\ .\]</span>
Since <span class="math inline">\(r\)</span> has units of <em>rabbit density</em>, <span class="math inline">\(\partial_t\)</span> has units <em>rabbit density per day</em> (or some other time unit). Similarly <span class="math inline">\(\partial_t f\)</span> has units of fox density per day.</p>
<p>The coordinate axis of rabbit-fox state space have units of <em>rabbit density</em> and <em>fox density</em>. We can’t therefore plot rabbit density <em>per day</em> and fox density <em>per day</em> in the state space. However, the ratio <span class="math inline">\(\frac{\partial_t f}{\partial_t r}\)</span> has units fox density per rabbit density. These are the units of a <em>slope</em> in the state space.</p>
Centered at coordinate <span class="math inline">\((r=2, f = 1/4)\)</span>, draw an sloping line segment. Given the values <span class="math inline">\(\partial_t f = 0.25\)</span> and <span class="math inline">\(\partial_t f = 0.66\)</span>, the segment should have slope <span class="math inline">\(0.25/0.66 = 0.379\)</span>. Also, place an arrowhead on the segment. You can decide which end of the segment it goes by noting the signs of <span class="math inline">\(\partial_t f\)</span> and <span class="math inline">\(\partial_t r\)</span>. Both are positive in this example, so the arrowhead should point up and to the right. This flow arrow is drawn in Figure <a href="#fig:rf-flow-arrow"><strong>??</strong></a>.
<div class="figure" style="text-align: center">
<img src="MOSAIC-Calculus_files/figure-html/rf_flow-arrow-1.png" alt="The flow arrow for the state value $(r=2, f=1/4)$. " width="50%" />
<p class="caption">
(#fig:rf_flow-arrow)The flow arrow for the state value <span class="math inline">\((r=2, f=1/4)\)</span>.
</p>
</div>
<p>To draw the entire flow field, repeat this process at many other points in the state space.</p>
<p>To trace out the trajectory, select the initial condition for the system. Then follow the flow, taking only a small step in state space. The next step should be in the direction of the flow arrow at the end of the previous step.</p>
<p>The trajectory you draw will be only a sketch, but it can be effective for developing intuition. Figure <a href="second-order-de.html#fig:calcplot3d1">42.1</a> shows a semi-automated version of the go-with-the-flow method. The computer has been used to draw the arrows. When you click in the plot, the computer also undertakes calculation of the trajectory.</p>
<p style="text-align:center">
<iframe frameborder="0" height="480px" src="https://c3d.libretexts.org/CalcPlot3D/dynamicFigure/index.html?type=vectorfield;vectorfield=vf;m=0.66x-1.33xy;n=xy-y;p=0;visible=true;view=undefined;scale=4;nx=9;ny=9;nz=1;mode=0;twod=true;constcol=true;color=rgb(0,0,255);norm=false;desystem=true&amp;type=slider;slider=t;value=0;steps=100;pmin=0;pmax=0.1;repeat=true;bounce=false;waittime=1;careful=false;noanimate=false;name=-1&amp;type=window;hsrmode=3;nomidpts=true;anaglyph=-1;center=0,0,40,1;focus=0,0,0,1;up=0,2,0,1;transparent=false;alpha=140;twoviews=false;unlinkviews=false;axisextension=0.7;xaxislabel=R;yaxislabel=F;zaxislabel=z;edgeson=false;faceson=true;showbox=true;showaxes=true;showticks=true;perspective=false;centerxpercent=0.32425144159290803;centerypercent=0.47897178357443876;rotationsteps=30;autospin=true;xygrid=false;yzgrid=false;xzgrid=false;gridsonbox=true;gridplanes=false;gridcolor=rgb(128,128,128);xmin=0;xmax=2;ymin=0;ymax=1;zmin=-8;zmax=8;xscale=0.5;yscale=0.25;zscale=4;zcmin=-16;zcmax=16;xscalefactor=1;yscalefactor=1;zscalefactor=1;tracemode=0;tracepoint=5.627,-1.622,0,1;keep2d=false;zoom=2.738" width="90%">
</iframe>
</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:calcplot3d1"></span>
<img src="www/tiny-blank.png" alt="The flow field for the rabbit/fox dynamics. Click at an initial state to generate the trajectory from that state." width="1%" />
<p class="caption">
Figure 42.1: The flow field for the rabbit/fox dynamics. Click at an initial state to generate the trajectory from that state.
</p>
</div>
<p>Regretably, from such a sketch of the trajectory, you can’t easily construct <span class="math inline">\(r(t)\)</span> and <span class="math inline">\(f(t)\)</span> for time-series plots. Also, you don’t get a sense of how slow or fast the flow is going. Click at different initial conditions in the flow and you will see different trajectories, each of which is a closed loop. But the shape of the trajectory doesn’t tell you whether it takes a long time or a short time to complete a loop.</p>
<p>The next section will show you how the computer constructed the trajectory and how we can get information on the speed of the flow.</p>
</div>
<div id="euler-method" class="section level2" number="2.2">
<h2><span class="header-section-number">42.2</span> Euler method</h2>
<p>Recall from Block 2 the <strong><em>limit definition of the derivative</em></strong>: <span class="math display">\[\partial_t x(t) = \lim_{dt \rightarrow 0} \frac{x(t + dt) - x(t)}{dt}\ .\]</span> We’re going to use this definition to develop a very general way to solve differential equations: the <strong><em>Euler method</em></strong>.</p>
<p>From the differential equations, we already know <span class="math inline">\(\partial_t x(t)\)</span>, so we don’t have to worry about whether the limit exists; it does. So we’ll disregard the limit except to note that <span class="math inline">\(dt\)</span> must be small. How small? Pick <span class="math inline">\(dt\)</span> to be small enough that the result wouldn’t change in any substantial way if we used an even smaller time increment, say <span class="math inline">\(dt/10\)</span>.</p>
<p>Our starting point for solving each differential equation is to re-write it as a finite difference. To illustrate, we’ll solve the equation <span class="math inline">\(\partial_t x = x (1 - x)\)</span>, which is often called the <strong><em>logistic equation</em></strong>.</p>
<p>Applying the finite difference definition, we get
<span class="math display">\[\frac{f(t + dt)- f(t)}{dt} = x (1-x)\\\text{implying}\\
\ \\
\underbrace{f(t + dt)}_{\text{future state}} = \underbrace{f(t)}_{\text{current state}} +\ \ \  \underbrace{x (1-x) dt}_{\text{step}}\]</span> We call this last equation the <strong><em>Euler formula</em></strong>.</p>
<p>To use this, we start at the initial condition, say <span class="math inline">\(x(t=0) = 0.2\)</span>. This initial condition gives us the first row of a tabular representation of the function <span class="math inline">\(x(t)\)</span>:</p>
<table>
<thead>
<tr class="header">
<th>time</th>
<th>state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Next, pick a value for <span class="math inline">\(dt\)</span> that we will use for all the following steps, each of which will add a new row to the table. For the example, we’ll set <span class="math inline">\(dt = 0.1\)</span>. When we have constructed the whole table we can go back and check whether that was small enough.</p>
<p>To fill in the next row, we apply the Euler formula. Sine <span class="math inline">\(dt = 0.1\)</span>, the next time step will be <span class="math inline">\(0.1\)</span>. Plug in the current state—which is 0.2 right now—to calculate the future state. The step will be <span class="math inline">\(0.2 (1-0.2)\, dt = \color{brown}{0.016}\)</span>. Add this step to the current state to get the future state. The table now looks like this:</p>
<table>
<thead>
<tr class="header">
<th>time</th>
<th>state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td><span class="math inline">\(0.2\)</span></td>
</tr>
<tr class="even">
<td>0.1</td>
<td><span class="math inline">\(0.2 + \color{brown}{0.016} = \color{blue}{0.216}\)</span></td>
</tr>
</tbody>
</table>
<p>The next step will bring us to time <span class="math inline">\(0.2\)</span>. Use the Euler formula, pluggin in the value of the present state, <span class="math inline">\(\color{blue}{0.216}\)</span>, to find the step. Here that will be <span class="math inline">\(0.216 (1-0.216)\, dt = \color{magenta}{0.0169.}\)</span>. Now the table looks like</p>
<table>
<thead>
<tr class="header">
<th>time</th>
<th>state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0</td>
<td><span class="math inline">\(0.2\)</span></td>
</tr>
<tr class="even">
<td>0.1</td>
<td><span class="math inline">\(0.2 + \color{brown}{0.016} = \color{blue}{0.216}\)</span></td>
</tr>
<tr class="odd">
<td>0.2</td>
<td><span class="math inline">\(\color{blue}{0.216} + \color{magenta}{0.0169} = 0.2329\)</span></td>
</tr>
</tbody>
</table>
<p>Add as many rows to the table as you like; the process will be the same.</p>
<p>You will recognize this as an iterative process, as discussed in Chapter 32.</p>
<div class="rmarkdown">
<p>To implement the iteration to solve <span class="math inline">\(\partial_t x = x (1-x)\)</span>, we need to create a function that takes the current state as input and produces the next state as output. Our one-step function can be this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="second-order-de.html#cb2-1" aria-hidden="true" tabindex="-1"></a>next_step <span class="ot">&lt;-</span> <span class="cf">function</span>(t, x, <span class="at">dt=</span><span class="fl">0.1</span>) {</span>
<span id="cb2-2"><a href="second-order-de.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> t <span class="sc">+</span> dt</span>
<span id="cb2-3"><a href="second-order-de.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">+</span> x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">*</span>dt</span>
<span id="cb2-4"><a href="second-order-de.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="second-order-de.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">x=</span>x) <span class="co"># return value</span></span>
<span id="cb2-6"><a href="second-order-de.html#cb2-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Notice that we wrote <code>next_step()</code> with an input slot for <span class="math inline">\(dt\)</span>. This will not be part of the state being iterated, just a parameter that allows us easily to explore different values for <span class="math inline">\(dt\)</span>.</p>
<p>Use <code>Iterate()</code> to carry out the iteration of <code>next_step()</code>. Note that we use the <code>fargs</code> argument to <code>Iterate()</code> to pass our selected value for <code>dt</code> to the function <code>next_step()</code>. We’ll run the iteration for 100 steps. With <span class="math inline">\(dt=0.1\)</span>, those 100 steps will 10 units of time.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="second-order-de.html#cb3-1" aria-hidden="true" tabindex="-1"></a>Soln <span class="ot">&lt;-</span> <span class="fu">Iterate</span>(next_step, <span class="at">x0=</span><span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span><span class="fl">0.2</span>), <span class="at">n=</span><span class="dv">100</span>,</span>
<span id="cb3-2"><a href="second-order-de.html#cb3-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">fargs=</span><span class="fu">list</span>(<span class="at">dt=</span><span class="fl">0.1</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
t
</th>
<th style="text-align:right;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.2000000
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.2160000
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.2329344
</td>
</tr>
<tr>
<td colspan="3" align="center">
… and so on …
</td>
</tr>
<tr>
</tr>
<tr>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
9.9
</td>
<td style="text-align:right;">
0.9998595
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
0.9998736
</td>
</tr>
</tbody>
</table>
<p>We can now plot the time series <span class="math inline">\(x\)</span> vs <span class="math inline">\(t\)</span>:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:logistic-time-series"></span>
<img src="MOSAIC-Calculus_files/figure-html/logistic-time-series-1.png" alt="The time series by the Euler method with $dt=0.01$." width="90%" />
<p class="caption">
Figure 42.2: The time series by the Euler method with <span class="math inline">\(dt=0.01\)</span>.
</p>
</div>
</div>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="differential-equations.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/B6-solution.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/B6-solution.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
