<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Piecewise functions |  </title>
  <meta name="description" content="MOSAIC Calculus Block 1" />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Piecewise functions |  " />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="MOSAIC Calculus Block 1" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Piecewise functions |  " />
  
  <meta name="twitter:description" content="MOSAIC Calculus Block 1" />
  



<meta name="date" content="2021-10-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fun-multiple-inputs.html"/>
<link rel="next" href="modeling-cycle.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>






<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="CalcZ-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><span style="font-size: 150%; color: blue;"><strong><a href="../index.html">MOSAIC Calculus</a></strong></span></li>
<li><em><a>Calculus for the 21st century</a></em></li>
<li><a>Daniel Kaplan</a></li>
<hr>
<li><a href="../index.html"><span style="color: blue;">Welcome to calculus</span></li>
<li><strong><a href="../block-1/change.html">Block 1: Functions & quantities</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="change.html"><a href="change.html"><i class="fa fa-check"></i><b>1</b> Change</a>
<ul>
<li class="chapter" data-level="1.1" data-path="change.html"><a href="change.html#quantity-vs-number"><i class="fa fa-check"></i><b>1.1</b> Quantity vs number</a></li>
<li class="chapter" data-level="1.2" data-path="change.html"><a href="change.html#functions"><i class="fa fa-check"></i><b>1.2</b> Functions</a></li>
<li class="chapter" data-level="1.3" data-path="change.html"><a href="change.html#fundamental-model-of-change"><i class="fa fa-check"></i><b>1.3</b> Fundamental model of change</a></li>
<li class="chapter" data-level="1.4" data-path="change.html"><a href="change.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pattern-book.html"><a href="pattern-book.html"><i class="fa fa-check"></i><b>2</b> Functions for modeling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pattern-book.html"><a href="pattern-book.html#pattern-book-functions"><i class="fa fa-check"></i><b>2.1</b> Pattern-book functions</a></li>
<li class="chapter" data-level="2.2" data-path="pattern-book.html"><a href="pattern-book.html#the-power-law-family"><i class="fa fa-check"></i><b>2.2</b> The power-law family</a></li>
<li class="chapter" data-level="2.3" data-path="pattern-book.html"><a href="pattern-book.html#constructing-functions"><i class="fa fa-check"></i><b>2.3</b> Constructing functions</a></li>
<li class="chapter" data-level="2.4" data-path="pattern-book.html"><a href="pattern-book.html#function-shapes"><i class="fa fa-check"></i><b>2.4</b> Function shapes</a></li>
<li class="chapter" data-level="2.5" data-path="pattern-book.html"><a href="pattern-book.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html"><i class="fa fa-check"></i><b>3</b> Structure of a function</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#inputs-to-output"><i class="fa fa-check"></i><b>3.1</b> Inputs to output</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#bureaucratic"><i class="fa fa-check"></i><b>3.2</b> A bureaucratic analogy</a></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#domain-input-space"><i class="fa fa-check"></i><b>3.3</b> Domain: input space</a></li>
<li class="chapter" data-level="3.4" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#range-output-space"><i class="fa fa-check"></i><b>3.4</b> Range: output space</a></li>
<li class="chapter" data-level="3.5" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#formulas-in-r"><i class="fa fa-check"></i><b>3.5</b> Formulas in R</a></li>
<li class="chapter" data-level="3.6" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#exercises-2"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fun-describing.html"><a href="fun-describing.html"><i class="fa fa-check"></i><b>4</b> Describing functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fun-describing.html"><a href="fun-describing.html#slice-plot-intro"><i class="fa fa-check"></i><b>4.1</b> Graphing a function</a></li>
<li class="chapter" data-level="4.2" data-path="fun-describing.html"><a href="fun-describing.html#tables-of-inputs-and-outputs"><i class="fa fa-check"></i><b>4.2</b> Tables of inputs and outputs</a></li>
<li class="chapter" data-level="4.3" data-path="fun-describing.html"><a href="fun-describing.html#word-descriptions"><i class="fa fa-check"></i><b>4.3</b> Word descriptions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="fun-describing.html"><a href="fun-describing.html#concavity"><i class="fa fa-check"></i><b>4.3.1</b> Concavity</a></li>
<li class="chapter" data-level="4.3.2" data-path="fun-describing.html"><a href="fun-describing.html#continuity-intro"><i class="fa fa-check"></i><b>4.3.2</b> Continuity</a></li>
<li class="chapter" data-level="4.3.3" data-path="fun-describing.html"><a href="fun-describing.html#monotonicity"><i class="fa fa-check"></i><b>4.3.3</b> Monotonicity</a></li>
<li class="chapter" data-level="4.3.4" data-path="fun-describing.html"><a href="fun-describing.html#periodicity"><i class="fa fa-check"></i><b>4.3.4</b> Periodicity</a></li>
<li class="chapter" data-level="4.3.5" data-path="fun-describing.html"><a href="fun-describing.html#asymptotic-behavior"><i class="fa fa-check"></i><b>4.3.5</b> Asymptotic behavior</a></li>
<li class="chapter" data-level="4.3.6" data-path="fun-describing.html"><a href="fun-describing.html#local-extremes"><i class="fa fa-check"></i><b>4.3.6</b> Locally extreme points</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="fun-describing.html"><a href="fun-describing.html#computer-function-names"><i class="fa fa-check"></i><b>4.4</b> Computer function names</a></li>
<li class="chapter" data-level="4.5" data-path="fun-describing.html"><a href="fun-describing.html#mathematical-notation"><i class="fa fa-check"></i><b>4.5</b> Mathematical notation</a></li>
<li class="chapter" data-level="4.6" data-path="fun-describing.html"><a href="fun-describing.html#exercises-3"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fun-notation.html"><a href="fun-notation.html"><i class="fa fa-check"></i><b>5</b> Notation for functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fun-notation.html"><a href="fun-notation.html#a-notation-for-computing"><i class="fa fa-check"></i><b>5.1</b> A notation for computing</a></li>
<li class="chapter" data-level="5.2" data-path="fun-notation.html"><a href="fun-notation.html#words-for-using-functions"><i class="fa fa-check"></i><b>5.2</b> Words for using functions</a></li>
<li class="chapter" data-level="5.3" data-path="fun-notation.html"><a href="fun-notation.html#algorithms"><i class="fa fa-check"></i><b>5.3</b> Formulas and algorithms</a></li>
<li class="chapter" data-level="5.4" data-path="fun-notation.html"><a href="fun-notation.html#algorithms-without-formulas"><i class="fa fa-check"></i><b>5.4</b> Algorithms without formulas</a></li>
<li class="chapter" data-level="5.5" data-path="fun-notation.html"><a href="fun-notation.html#computer-notation"><i class="fa fa-check"></i><b>5.5</b> Computer notation</a></li>
<li class="chapter" data-level="5.6" data-path="fun-notation.html"><a href="fun-notation.html#calcz-naming-conventions"><i class="fa fa-check"></i><b>5.6</b> CalcZ naming conventions</a></li>
<li class="chapter" data-level="5.7" data-path="fun-notation.html"><a href="fun-notation.html#functions-in-r"><i class="fa fa-check"></i><b>5.7</b> Functions in R</a></li>
<li class="chapter" data-level="5.8" data-path="fun-notation.html"><a href="fun-notation.html#foursigns"><i class="fa fa-check"></i><b>5.8</b> <span class="math inline">\(=\)</span>, <span class="math inline">\(\equiv\)</span>, <span class="math inline">\(\rightarrow\)</span>, <code>&lt;-</code></a></li>
<li class="chapter" data-level="5.9" data-path="fun-notation.html"><a href="fun-notation.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html"><i class="fa fa-check"></i><b>6</b> Graphics &amp; function graphs</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#the-graphics-frame"><i class="fa fa-check"></i><b>6.1</b> The graphics frame</a></li>
<li class="chapter" data-level="6.2" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-graphics-the-point-plot"><i class="fa fa-check"></i><b>6.2</b> Data graphics: the point plot</a></li>
<li class="chapter" data-level="6.3" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#function-graphs"><i class="fa fa-check"></i><b>6.3</b> Function graphs</a></li>
<li class="chapter" data-level="6.4" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#graphics-layers"><i class="fa fa-check"></i><b>6.4</b> Graphics layers</a></li>
<li class="chapter" data-level="6.5" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-and-functions"><i class="fa fa-check"></i><b>6.5</b> Data and functions</a></li>
<li class="chapter" data-level="6.6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#inputs-to-output-1"><i class="fa fa-check"></i><b>6.6</b> Inputs to output</a></li>
<li class="chapter" data-level="6.7" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#outputs-to-inputs"><i class="fa fa-check"></i><b>6.7</b> Outputs to inputs</a></li>
<li class="chapter" data-level="6.8" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#surface-plot"><i class="fa fa-check"></i><b>6.8</b> Graphs of functions with two inputs</a></li>
<li class="chapter" data-level="6.9" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#contour-plots"><i class="fa fa-check"></i><b>6.9</b> Contour plots</a></li>
<li class="chapter" data-level="6.10" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#slice-plots"><i class="fa fa-check"></i><b>6.10</b> Slice plots</a></li>
<li class="chapter" data-level="6.11" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#exercises-5"><i class="fa fa-check"></i><b>6.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="params-intro.html"><a href="params-intro.html"><i class="fa fa-check"></i><b>7</b> Parameters for functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="params-intro.html"><a href="params-intro.html#parallel-scales"><i class="fa fa-check"></i><b>7.1</b> Parallel scales</a></li>
<li class="chapter" data-level="7.2" data-path="params-intro.html"><a href="params-intro.html#scaling-the-input"><i class="fa fa-check"></i><b>7.2</b> Scaling the input</a></li>
<li class="chapter" data-level="7.3" data-path="params-intro.html"><a href="params-intro.html#scale-the-output"><i class="fa fa-check"></i><b>7.3</b> Scale the output</a></li>
<li class="chapter" data-level="7.4" data-path="params-intro.html"><a href="params-intro.html#linear-combinations"><i class="fa fa-check"></i><b>7.4</b> Linear combinations</a></li>
<li class="chapter" data-level="7.5" data-path="params-intro.html"><a href="params-intro.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="process-of-modeling.html"><a href="process-of-modeling.html"><i class="fa fa-check"></i><b>8</b> Finding parameters for the basic modeling functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="process-of-modeling.html"><a href="process-of-modeling.html#variations-from-scaling"><i class="fa fa-check"></i><b>8.1</b> Variations from scaling</a></li>
<li class="chapter" data-level="8.2" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-periodic"><i class="fa fa-check"></i><b>8.2</b> Curve fitting a periodic function</a></li>
<li class="chapter" data-level="8.3" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-exponential"><i class="fa fa-check"></i><b>8.3</b> Curve fitting an exponential function</a></li>
<li class="chapter" data-level="8.4" data-path="process-of-modeling.html"><a href="process-of-modeling.html#curve-fitting-a-power-law-function"><i class="fa fa-check"></i><b>8.4</b> Curve fitting a power-law function</a></li>
<li class="chapter" data-level="8.5" data-path="process-of-modeling.html"><a href="process-of-modeling.html#gaussian-and-sigmoid-functions"><i class="fa fa-check"></i><b>8.5</b> Gaussian and sigmoid functions</a></li>
<li class="chapter" data-level="8.6" data-path="process-of-modeling.html"><a href="process-of-modeling.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fun-slopes.html"><a href="fun-slopes.html"><i class="fa fa-check"></i><b>9</b> Slope function</a>
<ul>
<li class="chapter" data-level="9.1" data-path="fun-slopes.html"><a href="fun-slopes.html#change-and-slope"><i class="fa fa-check"></i><b>9.1</b> Change and slope</a></li>
<li class="chapter" data-level="9.2" data-path="fun-slopes.html"><a href="fun-slopes.html#continuous-change"><i class="fa fa-check"></i><b>9.2</b> Continuous change</a></li>
<li class="chapter" data-level="9.3" data-path="fun-slopes.html"><a href="fun-slopes.html#slope"><i class="fa fa-check"></i><b>9.3</b> Slope</a></li>
<li class="chapter" data-level="9.4" data-path="fun-slopes.html"><a href="fun-slopes.html#the-fitted-line"><i class="fa fa-check"></i><b>9.4</b> The fitted line</a></li>
<li class="chapter" data-level="9.5" data-path="fun-slopes.html"><a href="fun-slopes.html#average-rate-of-change"><i class="fa fa-check"></i><b>9.5</b> Average rate of change</a></li>
<li class="chapter" data-level="9.6" data-path="fun-slopes.html"><a href="fun-slopes.html#instantaneous-rate-of-change"><i class="fa fa-check"></i><b>9.6</b> Instantaneous rate of change</a></li>
<li class="chapter" data-level="9.7" data-path="fun-slopes.html"><a href="fun-slopes.html#exercises-8"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html"><i class="fa fa-check"></i><b>10</b> Function inverses and “solving”</a>
<ul>
<li class="chapter" data-level="10.1" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#function-inverses"><i class="fa fa-check"></i><b>10.1</b> Function inverses</a></li>
<li class="chapter" data-level="10.2" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#solving-graphically"><i class="fa fa-check"></i><b>10.2</b> Solving graphically</a></li>
<li class="chapter" data-level="10.3" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#zero-finding"><i class="fa fa-check"></i><b>10.3</b> Zero-finding</a></li>
<li class="chapter" data-level="10.4" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#exercises-9"><i class="fa fa-check"></i><b>10.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fun-assembling.html"><a href="fun-assembling.html"><i class="fa fa-check"></i><b>11</b> Assembling functions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fun-assembling.html"><a href="fun-assembling.html#linear-combination"><i class="fa fa-check"></i><b>11.1</b> Linear combination</a></li>
<li class="chapter" data-level="11.2" data-path="fun-assembling.html"><a href="fun-assembling.html#function-composition"><i class="fa fa-check"></i><b>11.2</b> Function composition</a></li>
<li class="chapter" data-level="11.3" data-path="fun-assembling.html"><a href="fun-assembling.html#modeling-polynomial-1"><i class="fa fa-check"></i><b>11.3</b> The modeling polynomial</a></li>
<li class="chapter" data-level="11.4" data-path="fun-assembling.html"><a href="fun-assembling.html#function-multiplication"><i class="fa fa-check"></i><b>11.4</b> Function multiplication</a></li>
<li class="chapter" data-level="11.5" data-path="fun-assembling.html"><a href="fun-assembling.html#all-together-now"><i class="fa fa-check"></i><b>11.5</b> All together now!</a></li>
<li class="chapter" data-level="11.6" data-path="fun-assembling.html"><a href="fun-assembling.html#exercises-10"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html"><i class="fa fa-check"></i><b>12</b> Functions with multiple inputs</a>
<ul>
<li class="chapter" data-level="12.1" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#fx-times-gt"><i class="fa fa-check"></i><b>12.1</b> f(x) times g(t)</a></li>
<li class="chapter" data-level="12.2" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#two-variable-modeling-polynomial"><i class="fa fa-check"></i><b>12.2</b> Two-variable modeling polynomial</a></li>
<li class="chapter" data-level="12.3" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#exercises-11"><i class="fa fa-check"></i><b>12.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fun-piecewise.html"><a href="fun-piecewise.html"><i class="fa fa-check"></i><b>13</b> Piecewise functions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="fun-piecewise.html"><a href="fun-piecewise.html#splitting-the-domain"><i class="fa fa-check"></i><b>13.1</b> Splitting the domain</a></li>
<li class="chapter" data-level="13.2" data-path="fun-piecewise.html"><a href="fun-piecewise.html#basic-piecewise-functions"><i class="fa fa-check"></i><b>13.2</b> Basic piecewise functions</a></li>
<li class="chapter" data-level="13.3" data-path="fun-piecewise.html"><a href="fun-piecewise.html#exercises-12"><i class="fa fa-check"></i><b>13.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modeling-cycle.html"><a href="modeling-cycle.html"><i class="fa fa-check"></i><b>14</b> Modeling cycle</a>
<ul>
<li class="chapter" data-level="14.1" data-path="modeling-cycle.html"><a href="modeling-cycle.html#example-cooling-water"><i class="fa fa-check"></i><b>14.1</b> Example: Cooling water</a></li>
<li class="chapter" data-level="14.2" data-path="modeling-cycle.html"><a href="modeling-cycle.html#example-the-tides"><i class="fa fa-check"></i><b>14.2</b> Example: The tides</a></li>
<li class="chapter" data-level="14.3" data-path="modeling-cycle.html"><a href="modeling-cycle.html#modeling-project"><i class="fa fa-check"></i><b>14.3</b> Modeling project</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="magnitudes.html"><a href="magnitudes.html"><i class="fa fa-check"></i><b>15</b> Magnitudes</a>
<ul>
<li class="chapter" data-level="15.1" data-path="magnitudes.html"><a href="magnitudes.html#counting-digits"><i class="fa fa-check"></i><b>15.1</b> Counting digits</a></li>
<li class="chapter" data-level="15.2" data-path="magnitudes.html"><a href="magnitudes.html#using-digit-to-understand-magnitude"><i class="fa fa-check"></i><b>15.2</b> Using digit() to understand magnitude</a></li>
<li class="chapter" data-level="15.3" data-path="magnitudes.html"><a href="magnitudes.html#quantity-and-magnitude"><i class="fa fa-check"></i><b>15.3</b> Quantity and magnitude</a></li>
<li class="chapter" data-level="15.4" data-path="magnitudes.html"><a href="magnitudes.html#composing-ln"><i class="fa fa-check"></i><b>15.4</b> Composing <span class="math inline">\(\ln()\)</span></a></li>
<li class="chapter" data-level="15.5" data-path="magnitudes.html"><a href="magnitudes.html#magnitude-graphics"><i class="fa fa-check"></i><b>15.5</b> Magnitude graphics</a></li>
<li class="chapter" data-level="15.6" data-path="magnitudes.html"><a href="magnitudes.html#reading-log-axes"><i class="fa fa-check"></i><b>15.6</b> Reading logarithmic scales</a></li>
<li class="chapter" data-level="15.7" data-path="magnitudes.html"><a href="magnitudes.html#fractional-digits"><i class="fa fa-check"></i><b>15.7</b> Fractional digits (optional)</a></li>
<li class="chapter" data-level="15.8" data-path="magnitudes.html"><a href="magnitudes.html#exercises-13"><i class="fa fa-check"></i><b>15.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dimensions.html"><a href="dimensions.html"><i class="fa fa-check"></i><b>16</b> Dimensions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="dimensions.html"><a href="dimensions.html#mathematics-of-quantity"><i class="fa fa-check"></i><b>16.1</b> Mathematics of quantity</a></li>
<li class="chapter" data-level="16.2" data-path="dimensions.html"><a href="dimensions.html#compound-dimensions"><i class="fa fa-check"></i><b>16.2</b> Compound dimensions</a></li>
<li class="chapter" data-level="16.3" data-path="dimensions.html"><a href="dimensions.html#arithmetic-with-dimensions"><i class="fa fa-check"></i><b>16.3</b> Arithmetic with dimensions</a></li>
<li class="chapter" data-level="16.4" data-path="dimensions.html"><a href="dimensions.html#pendulum-dimensions"><i class="fa fa-check"></i><b>16.4</b> Example: Dimensional analysis</a></li>
<li class="chapter" data-level="16.5" data-path="dimensions.html"><a href="dimensions.html#conversion-flavors-of-1"><i class="fa fa-check"></i><b>16.5</b> Conversion: Flavors of 1</a></li>
<li class="chapter" data-level="16.6" data-path="dimensions.html"><a href="dimensions.html#dimensions-and-linear-combinations"><i class="fa fa-check"></i><b>16.6</b> Dimensions and linear combinations</a></li>
<li class="chapter" data-level="16.7" data-path="dimensions.html"><a href="dimensions.html#exercises-14"><i class="fa fa-check"></i><b>16.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html"><i class="fa fa-check"></i>Projects and review</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-project-1-ebola-in-guinea-part-i"><i class="fa fa-check"></i>Block 1 Project 1: Ebola in Guinea, part I</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#exploring-the-data"><i class="fa fa-check"></i>Exploring the Data</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#data-wrangling"><i class="fa fa-check"></i>Data Wrangling</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#analysis-of-the-outbreak"><i class="fa fa-check"></i>Analysis of the outbreak</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#more-data-smoothing"><i class="fa fa-check"></i>More data smoothing</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#final-thoughts"><i class="fa fa-check"></i>Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-project-2-orbit-dimensions"><i class="fa fa-check"></i>Block 1 Project 2: Orbit dimensions</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#the-theory"><i class="fa fa-check"></i>The theory</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#the-data"><i class="fa fa-check"></i>The data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-review"><i class="fa fa-check"></i>Block 1 Review</a></li>
</ul></li>
<li class="divider"></li>
<hr>
<li><a href="../block-2/change-relationships.html">Block 2: Differentiation</a></li>
<li><a href="../block-3/change-accumulation.html">Block 3: Accumulation</a></li>
<li><a href="../block-4/introduction.html">Block 4: Manifestations</a></li>
<li><a href="../block-5/linear-forms.html">Block 5: Linear combinations</a></li>
<li><a href="../block-6/dynamics.html">Block 6: Dynamics</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"> </a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fun-piecewise" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> Piecewise functions</h1>
<p>Each of our basic modeling functions, with two exceptions, has a domain that is the entire number line <span class="math inline">\(-\infty &lt; x &lt; \infty\)</span>. No matter how big or small is the value of the input, the function has an output. Such functions are particularly nice to work with, since we never have to worry about the input going out of bounds. <span style="float: right; padding-left: 50px;"><a name="1500" href="#1500"><img src="www/icons8-signpost.png" title="Location: 1500" width="12px"/></a><span style="color: red; font-size: 6pt;">1500</red></span></p>
<p>The two exceptions are:</p>
<ol style="list-style-type: decimal">
<li>the logarithm function, which is defined only for <span class="math inline">\(0 &lt; x\)</span>.</li>
<li>some of the power-law functions: <span class="math inline">\(x^p\)</span>.
<ul>
<li>When <span class="math inline">\(p\)</span> is negative, the output of the function is undefined when <span class="math inline">\(x=0\)</span>. You can see why with a simple example: <span class="math inline">\(g(x) \equiv x^{-2}\)</span>. Most students had it drilled into them that “division by zero is illegal,” and <span class="math inline">\(g(0) = \frac{1}{0} \frac{1}{0}\)</span>, a double law breaker.</li>
<li>When <span class="math inline">\(p\)</span> is not an integer, that is <span class="math inline">\(p \neq 1, 2, 3, \cdots\)</span> the domain of the power-law function does not include negative inputs. To see why, consider the function <span class="math inline">\(h(x) \equiv x^{1/3}\)</span>.</li>
</ul></li>
</ol>
<p>It can be tedious to make sure that you are on the right side of the law when dealing with functions whose domain is not the whole number line. The designers of the hardware that does computer arithmetic, after several decades of work, found a clever system to make it easier. It’s a standard part of such hardware that whenever a function is handed an input that is not part of that function’s domain, one of two special “numbers” is returned. To illustrate:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="fun-piecewise.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="fun-piecewise.html#cb68-1" aria-hidden="true" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">0.9999</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="fun-piecewise.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<p><code>NaN</code> stands for “not a number.” Just about any calculation involving <code>NaN</code> will generate <code>NaN</code> as a result, even those involving multiplication by zero or cancellation by subtraction or division.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> For instance:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="fun-piecewise.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">*</span> <span class="cn">NaN</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="fun-piecewise.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NaN</span> <span class="sc">-</span> <span class="cn">NaN</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="fun-piecewise.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NaN</span> <span class="sc">/</span> <span class="cn">NaN</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<p>Division by zero produces <code>Inf</code>, whose name is reminiscent of “infinity.” <code>Inf</code> infiltrates any calculation in which it takes part: <span style="float: right; padding-left: 50px;"><a name="1510" href="#1510"><img src="www/icons8-signpost.png" title="Location: 1510" width="12px"/></a><span style="color: red; font-size: 6pt;">1510</red></span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="fun-piecewise.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">*</span> <span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="fun-piecewise.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="cn">Inf</span>)</span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="fun-piecewise.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="sc">*</span> <span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="fun-piecewise.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">+</span> <span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="fun-piecewise.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">-</span> <span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="fun-piecewise.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="cn">Inf</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="scaffolding">
<p>To see the benefits of the <code>NaN</code> / <code>Inf</code> system let’s plot out the logarithm function over the graphics domain <span class="math inline">\(-5 \leq x \leq 5\)</span>. Of course, part of that graphics domain, <span class="math inline">\(-5 \leq x \leq 0\)</span> is not in the domain of the logarithm function and the computer is entitled to give us a slap on the wrists. The <code>NaN</code> provides some room for politeness.</p>
<p>Open a sandbox and see what happens when you make the plot.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="fun-piecewise.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">log</span>(x) <span class="sc">~</span> x, <span class="fu">domain</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)))</span></code></pre></div>
</div>
<div id="splitting-the-domain" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Splitting the domain</h2>
<p>In a purely mathematical sense, the problem with functions being undefined over an extended part of a domain has been handled with cunning and imagination, but the solution—the invention of complex numbers—is not our concern here. Instead, we’re going to embrace functions that have a domain smaller than the whole number line and see what we can do with them.</p>
<p>To illustrate, let’s use computer notation to create a function whose domain is <span class="math inline">\(x &lt; 1\)</span>. To do this, we need a way to write “if,” as in, “If <span class="math inline">\(x\)</span> is 1 or greater, return <code>NaN</code>.” We’ll use a function in R that let’s us ask a TRUE/FALSE question and, depending on the answer, do one or another calculation. The question-answering R function is <code>ifelse()</code> whose name is remarkably descriptive. The <code>ifelse()</code> function takes three arguments. The first is the question to be asked, the second is the value to return if the answer is “yes,” and the third is the value to return for a “no” answer.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="fun-piecewise.html#cb91-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">1</span>, x, <span class="cn">NaN</span>) <span class="sc">~</span> x)</span>
<span id="cb91-2"><a href="fun-piecewise.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">g</span>(x) <span class="sc">~</span> x, <span class="fu">domain</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-57-1.png" width="90%" style="display: block; margin: auto;" />
What takes getting used to here is the expression <code>x &lt; 1</code> which is a <strong><em>question</em></strong> not a statement of fact. There’s no standard traditional mathematical notation for questions, although some people use a question mark as in <span class="math inline">\(x \stackrel{?}{&lt;} 1\)</span>.</p>
<p>The table shows computer notation for some common sorts of questions. <span style="float: right; padding-left: 50px;"><a name="1520" href="#1520"><img src="www/icons8-signpost.png" title="Location: 1520" width="12px"/></a><span style="color: red; font-size: 6pt;">1520</red></span></p>
<table>
<thead>
<tr class="header">
<th>R notation</th>
<th>English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x &gt; 2</code></td>
<td>“Is <span class="math inline">\(x\)</span> greater than 2?”</td>
</tr>
<tr class="even">
<td><code>y &gt;= 3</code></td>
<td>“Is <span class="math inline">\(y\)</span> greater than or equal to 3?”</td>
</tr>
<tr class="odd">
<td><code>x == 4</code></td>
<td>“Is <span class="math inline">\(x\)</span> exactly 4?”</td>
</tr>
<tr class="even">
<td><code>2 &lt; x &amp; x &lt; 5</code></td>
<td>“Is <span class="math inline">\(x\)</span> between 2 and 5?”<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></td>
</tr>
<tr class="odd">
<td><code>x &lt; 2 | x &gt; 6</code></td>
<td>“Is <span class="math inline">\(x\)</span> either less than 2 or greater than 6?”</td>
</tr>
<tr class="even">
<td><code>abs(x-5) &lt; 2</code></td>
<td>“Is <span class="math inline">\(x\)</span> within two units of 5?”</td>
</tr>
</tbody>
</table>
</div>
<div id="basic-piecewise-functions" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Basic piecewise functions</h2>
<p>Having an ability to split up the domain of a function and provide different formula for each of the pieces allows us to
construct <strong><em>piecewise functions</em></strong>. To illustrate, the function <span class="math inline">\(h(x) \equiv |x|\)</span>. You’ll recognize this as the “absolute value” function. The intuitive algorithm is to “strip the negative sign, if any” from the input. But with the ability to divide the domain into pieces, we gain access to a less mysterious sort of arithmetic operation and can re-write <span class="math display">\[h(x) \equiv \left\{ 
\begin{array}{ll}  x &amp; \text{for}\ 0 \leq x \\ \text{- x} &amp; \text{otherwise}\\\end{array}
\right.\]</span>
Or, in computer notation</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="fun-piecewise.html#cb92-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">0</span>, x, <span class="sc">-</span>x) <span class="sc">~</span> x)</span></code></pre></div>
<p>Note that the absolute value function is built-in to R in the form of the <code>abs()</code> function.</p>
<p>Less familiar is the <strong><em>Heaviside function</em></strong> which has important uses in physics and engineering:</p>
<p><span class="math display">\[\text{Heaviside}(x) \equiv \left\{ 
\begin{array}{cl} 1 &amp; \text{for}\ 0 \leq x \\0 &amp; \text{otherwise}\end{array}
\right.\]</span>
In computer notation, this is</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="fun-piecewise.html#cb93-1" aria-hidden="true" tabindex="-1"></a>Heaviside <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">~</span> x)</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-60-1.png" width="90%" style="display: block; margin: auto;" />
The vertical gap between the two pieces is called a <strong><em>discontinuity</em></strong>. Intuitively, you cannot draw a discontinuous function <strong><em>without lifting the pencil from the paper</em></strong>. The Heaviside function has a discontinuity at <span class="math inline">\(x=0\)</span>.</p>
<p>Similarly, the <strong><em>ramp function</em></strong> (aka “ReLU”) is a kind of one-sided absolute value:
<span class="math display">\[\text{ramp}(x) \equiv \left\{ 
\begin{array}{cl} x &amp; \text{for}\ 0 \leq x\\0 &amp; \text{otherwise}\end{array}
\right.\]</span>
Or, in computer notation:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="fun-piecewise.html#cb94-1" aria-hidden="true" tabindex="-1"></a>ramp <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(<span class="dv">0</span> <span class="sc">&lt;</span> x, x, <span class="dv">0</span>) <span class="sc">~</span> x)</span>
<span id="cb94-2"><a href="fun-piecewise.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">ramp</span>(x) <span class="sc">~</span> x, <span class="fu">domain</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)))</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-61-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>A linear combination of two input-shifted ramp functions gives a piecewise version of the sigmoid.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="fun-piecewise.html#cb95-1" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ramp</span>(x<span class="fl">+0.5</span>) <span class="sc">-</span> <span class="fu">ramp</span>(x<span class="fl">-0.5</span>) <span class="sc">~</span> x)</span>
<span id="cb95-2"><a href="fun-piecewise.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">sig</span>(x) <span class="sc">~</span> x, <span class="fu">domain</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)))</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-62-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="intheworld">
<p>Figure <a href="fun-piecewise.html#fig:gas-use-2">13.1</a> is a graph of monthly natural gas use in the author’s household versus average temperature during the month. (Natural gas is measured in cubic feet, appreviated <em>ccf</em>.) <span style="float: right; padding-left: 50px;"><a name="1530" href="#1530"><img src="www/icons8-signpost.png" title="Location: 1530" width="12px"/></a><span style="color: red; font-size: 6pt;">1530</red></span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gas-use-2"></span>
<img src="MOSAIC_Calculus_files/figure-html/gas-use-2-1.png" alt="The amount of natural gas used for heating the author's home varies with the outside temperature." width="90%" />
<p class="caption">
Figure 13.1: The amount of natural gas used for heating the author’s home varies with the outside temperature.
</p>
</div>
<p>The graph looks somewhat like a hockey stick. A sloping straight-line dependence of ccf on temperature for temperatures below <span class="math inline">\(60^\circ\)</span>F and constant for higher temperatures. The shape originates from the dual uses of natural gas. Gas is used for cooking and domestic hot water, the demand for which is more of less independent of outdoor temperature at about 15 ccf per month. Gas is also used for heating the house, but that’s needed only when the temperature is less than about <span class="math inline">\(60^\circ\)</span>F.</p>
<p>We can accomplish the hockey-stick shape with a linear combination of the ramp() function and a constant. The ramp function represents gas used for heating, the constant is the other uses of gas (which are modeled as not depending on temperature. Overall, the model is <span class="math display">\[\text{gas_ccf}(x) \equiv 4.3\,  \text{ramp}(62-x)  + 15\]</span>
Even simpler is the model for the other uses of natural gas:
<span class="math display">\[\text{other_ccf}(x) \equiv 15\]</span>.</p>
</div>
<p>Our last example concerns a bit of familiar technology: music synthesis. Generating a pure tone electronically is easily done using a sinusoid. Generating a note with rich instrumental timbre can be accomplished by a linear combination of sinusoids. Of course, the note will be localized in time. This could be accomplished by multiplying the sinusoids by a gaussian function envelope. <span style="float: right; padding-left: 50px;"><a name="1540" href="#1540"><img src="www/icons8-signpost.png" title="Location: 1540" width="12px"/></a><span style="color: red; font-size: 6pt;">1540</red></span></p>
<p>It turns out that the gaussian function, <code>dnorm()</code>, does not generate a realistic sound. Instead, a more complicated envelope is used, such as the <a href="https://en.wikipedia.org/wiki/Envelope_(music)">ADSR function</a> shown in Figure <a href="fun-piecewise.html#fig:ADSR">13.2</a>. The function has six (!) parameters: the time the key is pressed, the duration A of the “attack” phase when the sound amplitude is increasing in response to the impulse imposed on the key, a decay of duration D to an output level S that lasts until the key is released, then a decay to zero over duration R. It’s reasonable to think of the D and S phases as a piecewise linear approximation to exponential decay.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ADSR"></span>
<img src="www/adsr.png" alt="The ADSR envelope function used in music synthesis consists of 6 pieces including zero output before the key is pressed and after the pulse ends. [Source](https://en.wikipedia.org/wiki/Envelope_(music))" width="65%" />
<p class="caption">
Figure 13.2: The ADSR envelope function used in music synthesis consists of 6 pieces including zero output before the key is pressed and after the pulse ends. <a href="https://en.wikipedia.org/wiki/Envelope_(music)">Source</a>
</p>
</div>
</div>
<div id="exercises-12" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Exercises</h2>
<details>
<summary>
<strong>Exercise 13.05</strong>: <span><a name="File: Exercises/bigger-two.Rmd" href="#EDKYV"><img src="www/icons8-signpost.png" title="Location: Exercises/bigger-two.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">EDKYV</red></span>
</summary>
<p>The function <code>bigger()</code> is defined piecewise in terms of two extremely simple functions. Each of the two simple functions has a contour plot with contours that are parallel. The piecewise combination of the simple functions has a more complicated contour plot, with each simple function’s parallel contours showing up in half of the domain. We’ll call these “pieces” of the domain.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="fun-piecewise.html#cb96-1" aria-hidden="true" tabindex="-1"></a>bigger <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(y <span class="sc">&gt;</span> x, y, x) <span class="sc">~</span> x <span class="sc">+</span> y)</span>
<span id="cb96-2"><a href="fun-piecewise.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contour_plot</span>(<span class="fu">bigger</span>(x,y) <span class="sc">~</span> x<span class="sc">+</span>y, <span class="fu">domain</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-172-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Which of the following best describes the two pieces of the domain?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">One is above and to the left of the line of identity (that is, <span class="math inline">\(y=x\)</span>) and the other is below and to the right of that line.<span class="mcanswer">Nice! </span></span><br />
</li>
<li><span class="Zchoice">One is <span class="math inline">\(x &gt; 0\)</span> and the other <span class="math inline">\(x \leq 0\)</span><span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice">One is <span class="math inline">\(x &gt; 0\)</span> and the other <span class="math inline">\(y \leq 0\)</span><span class="mcanswer">︎✘ </span></span>
</details></li>
</ol>
<details>
<summary>
<strong>Exercise 13.07</strong>: <span><a name="File: Exercises/goat-walk-window.Rmd" href="#E9e7c6"><img src="www/icons8-signpost.png" title="Location: Exercises/goat-walk-window.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">E9e7c6</red></span>
</summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="fun-piecewise.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Zcalc)</span></code></pre></div>
<p>If you are unlucky and develop a serious ear or throat or other infection, and if the infection is bacterial and not viral, you may be prescribed antibiotics. You probably know how it goes. You go to the pharmacy to pick up a bottle of pills. There might be anywhere between 10 pills and 40. The directions will certainly tell you to make sure to finish the bottle; to take the full course of medication. It may say take a pill twice a day, or three times, or every six hours, perhaps with food.</p>
<p>The details of this regimen are determined largely by the details of whether food inhibits or buffers absorption of the medicine and by the efficiency by which your body metabolizes the medicine and then removes it from your blood via your liver.</p>
<p>Modeling this process—often called the *<strong>pharmacokinetics</strong> of the drug—is an important step in drug development. A simple but effective model of the drug concentration over time is a piecewise function: zero before you take the pill, then an exponential decay from an initial level of one unit after you take the pill.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="fun-piecewise.html#cb98-1" aria-hidden="true" tabindex="-1"></a>pill <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">ifelse</span>(t <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> t)) <span class="sc">~</span> t, <span class="at">k =</span> <span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="fl">1.5</span>)</span></code></pre></div>
<p>The shape of the <code>pill()</code> function is seen in Figure <a href="fun-piecewise.html#fig:pharma1">13.3</a>. Another part of the model is the <strong><em>therapeutic threshold</em></strong>, the minimal concentration for medical effectiveness. Keep in mind that this is a model. In reality, the drug not is absorbed instantaneously as in the model, and the medical effectiveness varies smoothly with concentration rather than being an all-or-nothing affair.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="fun-piecewise.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">pill</span>(t) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t=</span><span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="fun-piecewise.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="sc">~</span> <span class="fl">0.25</span>, <span class="at">color=</span><span class="st">&quot;magenta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="fun-piecewise.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_text</span>(<span class="fl">0.25</span> <span class="sc">~</span> <span class="dv">8</span>, <span class="at">label=</span><span class="st">&quot;Therapeutic threshold&quot;</span>, <span class="at">color=</span><span class="st">&quot;magenta&quot;</span>, </span>
<span id="cb99-4"><a href="fun-piecewise.html#cb99-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">vjust=</span><span class="dv">0</span>, <span class="at">nudge_y=</span><span class="fl">0.02</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="fun-piecewise.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">y=</span><span class="st">&quot;Drug availability&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Time (hrs)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pharma1"></span>
<img src="MOSAIC_Calculus_files/figure-html/pharma1-1.png" alt="A simple illustrative model of drug availability from taking a unit dose at time zero. The therapeutic threshold depends on the drug: 0.25 is shown here." width="90%" />
<p class="caption">
Figure 13.3: A simple illustrative model of drug availability from taking a unit dose at time zero. The therapeutic threshold depends on the drug: 0.25 is shown here.
</p>
</div>
<p>The critical features of the model are the half-life of the drug in the body and the therapeutic threshold, both of which depend on the particular drug in question.</p>
<p><strong>Question A</strong> What is the half life of the drug depicted in the Figure <a href="fun-piecewise.html#fig:pharma1">13.3</a>?</p>
<p>    <span class="Zchoice">60 minutes<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">90 minutes<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">120 minutes<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">180 minutes<span class="mcanswer">︎✘ </span></span></p>
<p>Figure <a href="fun-piecewise.html#fig:pharma1">13.3</a> shows the availability from a single pill. The goal of taking multiple pills, spread out over time, is to keep the drug availability above the therapeutic threshold for an extended time, e.g. 10 days. There are three parameters to the therapy: how often you take a pill, and the dose delivered by a single pill, and the medicine’s half-life.</p>
<p><strong>Question B</strong> Occasionally, the prescription directs you to take a single pill once a day. Suppose the half-life of the medicine is 3 hours. How big would the dose <code>A</code> need to be in order to keep the availability above a threshold of 0.25 for a 24-hour period?</p>
<p>    <span class="Zchoice">2 units<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">16 units<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">64 units<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">1024 units<span class="mcanswer">︎✘ </span></span></p>
<p>Let’s explore a familiar-sounding directive: Take one pill every six hours. We can model this by a linear combination of time-shifted <code>pill()</code> functions. Each pill provides a dose of size <code>A</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="fun-piecewise.html#cb100-1" aria-hidden="true" tabindex="-1"></a>six_hours <span class="ot">&lt;-</span> </span>
<span id="cb100-2"><a href="fun-piecewise.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">makeFun</span>(A<span class="sc">*</span><span class="fu">pill</span>(t, k) <span class="sc">+</span> A<span class="sc">*</span><span class="fu">pill</span>(t<span class="dv">-6</span>, k) <span class="sc">+</span> </span>
<span id="cb100-3"><a href="fun-piecewise.html#cb100-3" aria-hidden="true" tabindex="-1"></a>          A<span class="sc">*</span><span class="fu">pill</span>(t<span class="dv">-12</span>, k) <span class="sc">+</span> A<span class="sc">*</span><span class="fu">pill</span>(t<span class="dv">-18</span>, k) <span class="sc">+</span></span>
<span id="cb100-4"><a href="fun-piecewise.html#cb100-4" aria-hidden="true" tabindex="-1"></a>          A<span class="sc">*</span><span class="fu">pill</span>(t<span class="dv">-24</span>, k) <span class="sc">~</span> t, </span>
<span id="cb100-5"><a href="fun-piecewise.html#cb100-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">k=</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">3</span>, <span class="at">A  =</span> <span class="dv">1</span>)</span>
<span id="cb100-6"><a href="fun-piecewise.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">six_hours</span>(t) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>))</span></code></pre></div>
<p><img src="MOSAIC_Calculus_files/figure-html/unnamed-chunk-175-1.png" width="90%" style="display: block; margin: auto;" />
The graph shows that the drug is above the therapeutic threshold (0.25) for the entire first day.</p>
<blockquote>
<p>From the graph of drug availability versus time, do you think continuing the one-pill-every-6-hours regimen will continue to keep the drug level over the therapeutic threshold for the remainder of the course of treatment? Explain why or why not.</p>
</blockquote>
<p>Let’s switch to an one-pill every 8 hour regimen, the pills being taken at midnight, 8am, and 4pm, …</p>
<blockquote>
<p>How big a dose <code>A</code> will be needed to keep the drug availability above the therapeutic threshold for the entire course of treatment? (Hint: Construct a function analogous to <code>six_hours()</code> and plot out the drug availability over the 24 hours of the first day. Then vary the dose <code>A</code> until you find the minimum dose that keeps the availability over the threshold of 0.25 for the entire day.)</p>
</blockquote>
<blockquote>
<p>Suppose the instructions were to take 2 pills when you start treatment and then an additional pill every 8 hours. How big a dose <code>A</code> would be needed to keep the drug availability above the therapeutic threshold for the entire course of treatment?</p>
</blockquote>
<blockquote>
<p>Which of the three regimens described (6-hour, 8-hour, 8-hour-double-first-dose) involves the smallest <strong>total dose</strong>? (The total dose is the sum of the doses for each pill administration.)</p>
</blockquote>
</details>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>One that does produce a number is <code>NaN^0</code>.<a href="fun-piecewise.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Literally, “Is <span class="math inline">\(x\)</span> both greater than 2 and less than 5?”<a href="fun-piecewise.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fun-multiple-inputs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-cycle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dtkaplan/CalcZ-notes/edit/shared/13-piecewise.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dtkaplan/CalcZ-notes/edit/shared/13-piecewise.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
