<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Finding parameters for the basic modeling functions |  </title>
  <meta name="description" content="MOSAIC Calculus Block 1" />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Finding parameters for the basic modeling functions |  " />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="MOSAIC Calculus Block 1" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Finding parameters for the basic modeling functions |  " />
  
  <meta name="twitter:description" content="MOSAIC Calculus Block 1" />
  



<meta name="date" content="2022-01-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="params-intro.html"/>
<link rel="next" href="fun-slopes.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf #1}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{\|{\mathbf #1}\|}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="mosaic-calc-style-copy.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><span style="font-size: 150%; color: blue;"><strong><a href="../index.html">MOSAIC Calculus</a></strong></span></li>
<li><em><a>Calculus for the 21st century</a></em></li>
<li><a>Daniel Kaplan</a></li>
<hr>
<li><a href="../index.html"><span style="color: blue;">Welcome to calculus</span></li>
<li><strong><a href="../block-1/change.html">Block 1: Functions & quantities</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="change.html"><a href="change.html"><i class="fa fa-check"></i><b>1</b> Change</a>
<ul>
<li class="chapter" data-level="1.1" data-path="change.html"><a href="change.html#quantity-vs-number"><i class="fa fa-check"></i><b>1.1</b> Quantity vs number</a></li>
<li class="chapter" data-level="1.2" data-path="change.html"><a href="change.html#functions"><i class="fa fa-check"></i><b>1.2</b> Functions</a></li>
<li class="chapter" data-level="1.3" data-path="change.html"><a href="change.html#fundamental-model-of-change"><i class="fa fa-check"></i><b>1.3</b> Fundamental model of change</a></li>
<li class="chapter" data-level="1.4" data-path="change.html"><a href="change.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="pattern-book.html"><a href="pattern-book.html"><i class="fa fa-check"></i><b>2</b> Functions for modeling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="pattern-book.html"><a href="pattern-book.html#pattern-book-functions"><i class="fa fa-check"></i><b>2.1</b> Pattern-book functions</a></li>
<li class="chapter" data-level="2.2" data-path="pattern-book.html"><a href="pattern-book.html#the-power-law-family"><i class="fa fa-check"></i><b>2.2</b> The power-law family</a></li>
<li class="chapter" data-level="2.3" data-path="pattern-book.html"><a href="pattern-book.html#constructing-functions"><i class="fa fa-check"></i><b>2.3</b> Constructing functions</a></li>
<li class="chapter" data-level="2.4" data-path="pattern-book.html"><a href="pattern-book.html#function-shapes"><i class="fa fa-check"></i><b>2.4</b> Function shapes</a></li>
<li class="chapter" data-level="2.5" data-path="pattern-book.html"><a href="pattern-book.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html"><i class="fa fa-check"></i><b>3</b> Structure of a function</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#inputs-to-output"><i class="fa fa-check"></i><b>3.1</b> Inputs to output</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#bureaucratic"><i class="fa fa-check"></i><b>3.2</b> A bureaucratic analogy</a></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#domain-input-space"><i class="fa fa-check"></i><b>3.3</b> Domain: input space</a></li>
<li class="chapter" data-level="3.4" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#range-output-space"><i class="fa fa-check"></i><b>3.4</b> Range: output space</a></li>
<li class="chapter" data-level="3.5" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#formulas-in-r"><i class="fa fa-check"></i><b>3.5</b> Formulas in R</a></li>
<li class="chapter" data-level="3.6" data-path="structure-of-a-function.html"><a href="structure-of-a-function.html#exercises-2"><i class="fa fa-check"></i><b>3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fun-describing.html"><a href="fun-describing.html"><i class="fa fa-check"></i><b>4</b> Describing functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fun-describing.html"><a href="fun-describing.html#slice-plot-intro"><i class="fa fa-check"></i><b>4.1</b> Graphing a function</a></li>
<li class="chapter" data-level="4.2" data-path="fun-describing.html"><a href="fun-describing.html#tables-of-inputs-and-outputs"><i class="fa fa-check"></i><b>4.2</b> Tables of inputs and outputs</a></li>
<li class="chapter" data-level="4.3" data-path="fun-describing.html"><a href="fun-describing.html#word-descriptions"><i class="fa fa-check"></i><b>4.3</b> Word descriptions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="fun-describing.html"><a href="fun-describing.html#concavity"><i class="fa fa-check"></i><b>4.3.1</b> Concavity</a></li>
<li class="chapter" data-level="4.3.2" data-path="fun-describing.html"><a href="fun-describing.html#continuity-intro"><i class="fa fa-check"></i><b>4.3.2</b> Continuity</a></li>
<li class="chapter" data-level="4.3.3" data-path="fun-describing.html"><a href="fun-describing.html#monotonicity"><i class="fa fa-check"></i><b>4.3.3</b> Monotonicity</a></li>
<li class="chapter" data-level="4.3.4" data-path="fun-describing.html"><a href="fun-describing.html#periodicity"><i class="fa fa-check"></i><b>4.3.4</b> Periodicity</a></li>
<li class="chapter" data-level="4.3.5" data-path="fun-describing.html"><a href="fun-describing.html#asymptotic-behavior"><i class="fa fa-check"></i><b>4.3.5</b> Asymptotic behavior</a></li>
<li class="chapter" data-level="4.3.6" data-path="fun-describing.html"><a href="fun-describing.html#local-extremes"><i class="fa fa-check"></i><b>4.3.6</b> Locally extreme points</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="fun-describing.html"><a href="fun-describing.html#computer-function-names"><i class="fa fa-check"></i><b>4.4</b> Computer function names</a></li>
<li class="chapter" data-level="4.5" data-path="fun-describing.html"><a href="fun-describing.html#mathematical-notation"><i class="fa fa-check"></i><b>4.5</b> Mathematical notation</a></li>
<li class="chapter" data-level="4.6" data-path="fun-describing.html"><a href="fun-describing.html#exercises-3"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fun-notation.html"><a href="fun-notation.html"><i class="fa fa-check"></i><b>5</b> Notation for functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fun-notation.html"><a href="fun-notation.html#a-notation-for-computing"><i class="fa fa-check"></i><b>5.1</b> A notation for computing</a></li>
<li class="chapter" data-level="5.2" data-path="fun-notation.html"><a href="fun-notation.html#words-for-using-functions"><i class="fa fa-check"></i><b>5.2</b> Words for using functions</a></li>
<li class="chapter" data-level="5.3" data-path="fun-notation.html"><a href="fun-notation.html#algorithms"><i class="fa fa-check"></i><b>5.3</b> Formulas and algorithms</a></li>
<li class="chapter" data-level="5.4" data-path="fun-notation.html"><a href="fun-notation.html#algorithms-without-formulas"><i class="fa fa-check"></i><b>5.4</b> Algorithms without formulas</a></li>
<li class="chapter" data-level="5.5" data-path="fun-notation.html"><a href="fun-notation.html#computer-notation"><i class="fa fa-check"></i><b>5.5</b> Computer notation</a></li>
<li class="chapter" data-level="5.6" data-path="fun-notation.html"><a href="fun-notation.html#calcz-naming-conventions"><i class="fa fa-check"></i><b>5.6</b> CalcZ naming conventions</a></li>
<li class="chapter" data-level="5.7" data-path="fun-notation.html"><a href="fun-notation.html#functions-in-r"><i class="fa fa-check"></i><b>5.7</b> Functions in R</a></li>
<li class="chapter" data-level="5.8" data-path="fun-notation.html"><a href="fun-notation.html#foursigns"><i class="fa fa-check"></i><b>5.8</b> <span class="math inline">\(=\)</span>, <span class="math inline">\(\equiv\)</span>, <span class="math inline">\(\rightarrow\)</span>, <code>&lt;-</code></a></li>
<li class="chapter" data-level="5.9" data-path="fun-notation.html"><a href="fun-notation.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html"><i class="fa fa-check"></i><b>6</b> Graphics &amp; function graphs</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#the-graphics-frame"><i class="fa fa-check"></i><b>6.1</b> The graphics frame</a></li>
<li class="chapter" data-level="6.2" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-graphics-the-point-plot"><i class="fa fa-check"></i><b>6.2</b> Data graphics: the point plot</a></li>
<li class="chapter" data-level="6.3" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#function-graphs"><i class="fa fa-check"></i><b>6.3</b> Function graphs</a></li>
<li class="chapter" data-level="6.4" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#graphics-layers"><i class="fa fa-check"></i><b>6.4</b> Graphics layers</a></li>
<li class="chapter" data-level="6.5" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#data-and-functions"><i class="fa fa-check"></i><b>6.5</b> Data and functions</a></li>
<li class="chapter" data-level="6.6" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#inputs-to-output-1"><i class="fa fa-check"></i><b>6.6</b> Inputs to output</a></li>
<li class="chapter" data-level="6.7" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#outputs-to-inputs"><i class="fa fa-check"></i><b>6.7</b> Outputs to inputs</a></li>
<li class="chapter" data-level="6.8" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#surface-plot"><i class="fa fa-check"></i><b>6.8</b> Graphs of functions with two inputs</a></li>
<li class="chapter" data-level="6.9" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#contour-plots"><i class="fa fa-check"></i><b>6.9</b> Contour plots</a></li>
<li class="chapter" data-level="6.10" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#slice-plots"><i class="fa fa-check"></i><b>6.10</b> Slice plots</a></li>
<li class="chapter" data-level="6.11" data-path="graphs-and-graphics.html"><a href="graphs-and-graphics.html#exercises-5"><i class="fa fa-check"></i><b>6.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="params-intro.html"><a href="params-intro.html"><i class="fa fa-check"></i><b>7</b> Parameters for functions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="params-intro.html"><a href="params-intro.html#parallel-scales"><i class="fa fa-check"></i><b>7.1</b> Parallel scales</a></li>
<li class="chapter" data-level="7.2" data-path="params-intro.html"><a href="params-intro.html#scaling-the-input"><i class="fa fa-check"></i><b>7.2</b> Scaling the input</a></li>
<li class="chapter" data-level="7.3" data-path="params-intro.html"><a href="params-intro.html#scale-the-output"><i class="fa fa-check"></i><b>7.3</b> Scale the output</a></li>
<li class="chapter" data-level="7.4" data-path="params-intro.html"><a href="params-intro.html#linear-combinations"><i class="fa fa-check"></i><b>7.4</b> Linear combinations</a></li>
<li class="chapter" data-level="7.5" data-path="params-intro.html"><a href="params-intro.html#exercises-6"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="process-of-modeling.html"><a href="process-of-modeling.html"><i class="fa fa-check"></i><b>8</b> Finding parameters for the basic modeling functions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="process-of-modeling.html"><a href="process-of-modeling.html#variations-from-scaling"><i class="fa fa-check"></i><b>8.1</b> Variations from scaling</a></li>
<li class="chapter" data-level="8.2" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-periodic"><i class="fa fa-check"></i><b>8.2</b> Curve fitting a periodic function</a></li>
<li class="chapter" data-level="8.3" data-path="process-of-modeling.html"><a href="process-of-modeling.html#fit-exponential"><i class="fa fa-check"></i><b>8.3</b> Curve fitting an exponential function</a></li>
<li class="chapter" data-level="8.4" data-path="process-of-modeling.html"><a href="process-of-modeling.html#curve-fitting-a-power-law-function"><i class="fa fa-check"></i><b>8.4</b> Curve fitting a power-law function</a></li>
<li class="chapter" data-level="8.5" data-path="process-of-modeling.html"><a href="process-of-modeling.html#gaussian-and-sigmoid-functions"><i class="fa fa-check"></i><b>8.5</b> Gaussian and sigmoid functions</a></li>
<li class="chapter" data-level="8.6" data-path="process-of-modeling.html"><a href="process-of-modeling.html#exercises-7"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fun-slopes.html"><a href="fun-slopes.html"><i class="fa fa-check"></i><b>9</b> Slope function</a>
<ul>
<li class="chapter" data-level="9.1" data-path="fun-slopes.html"><a href="fun-slopes.html#change-and-slope"><i class="fa fa-check"></i><b>9.1</b> Change and slope</a></li>
<li class="chapter" data-level="9.2" data-path="fun-slopes.html"><a href="fun-slopes.html#continuous-change"><i class="fa fa-check"></i><b>9.2</b> Continuous change</a></li>
<li class="chapter" data-level="9.3" data-path="fun-slopes.html"><a href="fun-slopes.html#slope"><i class="fa fa-check"></i><b>9.3</b> Slope</a></li>
<li class="chapter" data-level="9.4" data-path="fun-slopes.html"><a href="fun-slopes.html#the-fitted-line"><i class="fa fa-check"></i><b>9.4</b> The fitted line</a></li>
<li class="chapter" data-level="9.5" data-path="fun-slopes.html"><a href="fun-slopes.html#average-rate-of-change"><i class="fa fa-check"></i><b>9.5</b> Average rate of change</a></li>
<li class="chapter" data-level="9.6" data-path="fun-slopes.html"><a href="fun-slopes.html#instantaneous-rate-of-change"><i class="fa fa-check"></i><b>9.6</b> Instantaneous rate of change</a></li>
<li class="chapter" data-level="9.7" data-path="fun-slopes.html"><a href="fun-slopes.html#exercises-8"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html"><i class="fa fa-check"></i><b>10</b> Function inverses and “solving”</a>
<ul>
<li class="chapter" data-level="10.1" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#function-inverses"><i class="fa fa-check"></i><b>10.1</b> Function inverses</a></li>
<li class="chapter" data-level="10.2" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#solving-graphically"><i class="fa fa-check"></i><b>10.2</b> Solving graphically</a></li>
<li class="chapter" data-level="10.3" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#zero-finding"><i class="fa fa-check"></i><b>10.3</b> Zero-finding</a></li>
<li class="chapter" data-level="10.4" data-path="function-inverses-and-solving.html"><a href="function-inverses-and-solving.html#exercises-9"><i class="fa fa-check"></i><b>10.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fun-assembling.html"><a href="fun-assembling.html"><i class="fa fa-check"></i><b>11</b> Assembling functions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fun-assembling.html"><a href="fun-assembling.html#linear-combination"><i class="fa fa-check"></i><b>11.1</b> Linear combination</a></li>
<li class="chapter" data-level="11.2" data-path="fun-assembling.html"><a href="fun-assembling.html#function-composition"><i class="fa fa-check"></i><b>11.2</b> Function composition</a></li>
<li class="chapter" data-level="11.3" data-path="fun-assembling.html"><a href="fun-assembling.html#modeling-polynomial-1"><i class="fa fa-check"></i><b>11.3</b> The modeling polynomial</a></li>
<li class="chapter" data-level="11.4" data-path="fun-assembling.html"><a href="fun-assembling.html#function-multiplication"><i class="fa fa-check"></i><b>11.4</b> Function multiplication</a></li>
<li class="chapter" data-level="11.5" data-path="fun-assembling.html"><a href="fun-assembling.html#all-together-now"><i class="fa fa-check"></i><b>11.5</b> All together now!</a></li>
<li class="chapter" data-level="11.6" data-path="fun-assembling.html"><a href="fun-assembling.html#exercises-10"><i class="fa fa-check"></i><b>11.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html"><i class="fa fa-check"></i><b>12</b> Functions with multiple inputs</a>
<ul>
<li class="chapter" data-level="12.1" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#fx-times-gt"><i class="fa fa-check"></i><b>12.1</b> f(x) times g(t)</a></li>
<li class="chapter" data-level="12.2" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#two-variable-modeling-polynomial"><i class="fa fa-check"></i><b>12.2</b> Two-variable modeling polynomial</a></li>
<li class="chapter" data-level="12.3" data-path="fun-multiple-inputs.html"><a href="fun-multiple-inputs.html#exercises-11"><i class="fa fa-check"></i><b>12.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fun-piecewise.html"><a href="fun-piecewise.html"><i class="fa fa-check"></i><b>13</b> Piecewise functions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="fun-piecewise.html"><a href="fun-piecewise.html#splitting-the-domain"><i class="fa fa-check"></i><b>13.1</b> Splitting the domain</a></li>
<li class="chapter" data-level="13.2" data-path="fun-piecewise.html"><a href="fun-piecewise.html#basic-piecewise-functions"><i class="fa fa-check"></i><b>13.2</b> Basic piecewise functions</a></li>
<li class="chapter" data-level="13.3" data-path="fun-piecewise.html"><a href="fun-piecewise.html#exercises-12"><i class="fa fa-check"></i><b>13.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="modeling-cycle.html"><a href="modeling-cycle.html"><i class="fa fa-check"></i><b>14</b> Modeling cycle</a>
<ul>
<li class="chapter" data-level="14.1" data-path="modeling-cycle.html"><a href="modeling-cycle.html#example-cooling-water"><i class="fa fa-check"></i><b>14.1</b> Example: Cooling water</a></li>
<li class="chapter" data-level="14.2" data-path="modeling-cycle.html"><a href="modeling-cycle.html#example-the-tides"><i class="fa fa-check"></i><b>14.2</b> Example: The tides</a></li>
<li class="chapter" data-level="14.3" data-path="modeling-cycle.html"><a href="modeling-cycle.html#modeling-project"><i class="fa fa-check"></i><b>14.3</b> Modeling project</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="magnitudes.html"><a href="magnitudes.html"><i class="fa fa-check"></i><b>15</b> Magnitudes</a>
<ul>
<li class="chapter" data-level="15.1" data-path="magnitudes.html"><a href="magnitudes.html#counting-digits"><i class="fa fa-check"></i><b>15.1</b> Counting digits</a></li>
<li class="chapter" data-level="15.2" data-path="magnitudes.html"><a href="magnitudes.html#using-digit-to-understand-magnitude"><i class="fa fa-check"></i><b>15.2</b> Using digit() to understand magnitude</a></li>
<li class="chapter" data-level="15.3" data-path="magnitudes.html"><a href="magnitudes.html#quantity-and-magnitude"><i class="fa fa-check"></i><b>15.3</b> Quantity and magnitude</a></li>
<li class="chapter" data-level="15.4" data-path="magnitudes.html"><a href="magnitudes.html#composing-ln"><i class="fa fa-check"></i><b>15.4</b> Composing <span class="math inline">\(\ln()\)</span></a></li>
<li class="chapter" data-level="15.5" data-path="magnitudes.html"><a href="magnitudes.html#magnitude-graphics"><i class="fa fa-check"></i><b>15.5</b> Magnitude graphics</a></li>
<li class="chapter" data-level="15.6" data-path="magnitudes.html"><a href="magnitudes.html#reading-log-axes"><i class="fa fa-check"></i><b>15.6</b> Reading logarithmic scales</a></li>
<li class="chapter" data-level="15.7" data-path="magnitudes.html"><a href="magnitudes.html#fractional-digits"><i class="fa fa-check"></i><b>15.7</b> Fractional digits (optional)</a></li>
<li class="chapter" data-level="15.8" data-path="magnitudes.html"><a href="magnitudes.html#exercises-13"><i class="fa fa-check"></i><b>15.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dimensions.html"><a href="dimensions.html"><i class="fa fa-check"></i><b>16</b> Dimensions</a>
<ul>
<li class="chapter" data-level="16.1" data-path="dimensions.html"><a href="dimensions.html#mathematics-of-quantity"><i class="fa fa-check"></i><b>16.1</b> Mathematics of quantity</a></li>
<li class="chapter" data-level="16.2" data-path="dimensions.html"><a href="dimensions.html#compound-dimensions"><i class="fa fa-check"></i><b>16.2</b> Compound dimensions</a></li>
<li class="chapter" data-level="16.3" data-path="dimensions.html"><a href="dimensions.html#arithmetic-with-dimensions"><i class="fa fa-check"></i><b>16.3</b> Arithmetic with dimensions</a></li>
<li class="chapter" data-level="16.4" data-path="dimensions.html"><a href="dimensions.html#pendulum-dimensions"><i class="fa fa-check"></i><b>16.4</b> Example: Dimensional analysis</a></li>
<li class="chapter" data-level="16.5" data-path="dimensions.html"><a href="dimensions.html#conversion-flavors-of-1"><i class="fa fa-check"></i><b>16.5</b> Conversion: Flavors of 1</a></li>
<li class="chapter" data-level="16.6" data-path="dimensions.html"><a href="dimensions.html#dimensions-and-linear-combinations"><i class="fa fa-check"></i><b>16.6</b> Dimensions and linear combinations</a></li>
<li class="chapter" data-level="16.7" data-path="dimensions.html"><a href="dimensions.html#exercises-14"><i class="fa fa-check"></i><b>16.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html"><i class="fa fa-check"></i>Projects and review</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-project-1-ebola-in-guinea-part-i"><i class="fa fa-check"></i>Block 1 Project 1: Ebola in Guinea, part I</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#exploring-the-data"><i class="fa fa-check"></i>Exploring the Data</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#data-wrangling"><i class="fa fa-check"></i>Data Wrangling</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#analysis-of-the-outbreak"><i class="fa fa-check"></i>Analysis of the outbreak</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#more-data-smoothing"><i class="fa fa-check"></i>More data smoothing</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#final-thoughts"><i class="fa fa-check"></i>Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-project-2-orbit-dimensions"><i class="fa fa-check"></i>Block 1 Project 2: Orbit dimensions</a>
<ul>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#the-theory"><i class="fa fa-check"></i>The theory</a></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#the-data"><i class="fa fa-check"></i>The data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="projects-and-review.html"><a href="projects-and-review.html#block-1-review"><i class="fa fa-check"></i>Block 1 Review</a></li>
</ul></li>
<li class="divider"></li>
<hr>
<li><a href="../block-2/change-relationships.html">Block 2: Differentiation</a></li>
<li><a href="../block-3/change-accumulation.html">Block 3: Accumulation</a></li>
<li><a href="../block-4/block4-intro.html">Block 4: Manifestations</a></li>
<li><a href="../block-5/vectors.html">Block 5: Linear combinations</a></li>
<li><a href="../block-6/dynamics.html">Block 6: Dynamics</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"> </a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="process-of-modeling" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Finding parameters for the basic modeling functions</h1>
<div style="float:right;">
<a href="https://github.com/ProjectMOSAIC/MOSAIC-Calculus/blob/main/Block-1/08-modeling.Rmd"><img src="www/icons/edit.png" /></a>
</div>
<p>Seen very abstractly, a mathematical model is a set of <strong><em>functions</em></strong> that represent the relationships between inputs and outputs.</p>
<p>At the most simple level, building a model can be a short process:</p>
<ol style="list-style-type: decimal">
<li>Develop an understanding of the relationship you want to model. Often, part of this “understanding” is the pattern seen in data.</li>
<li>Choose a function type—e.g. exponential, sinusoidal, sigmoid—that you think would be a good match to the relationship.</li>
<li>Find <strong><em>parameters</em></strong> that scales your function to be able to accept real-world inputs and generate real-world outputs.</li>
</ol>
<p>It’s important to distinguish between two basic types of model:</p>
<ol style="list-style-type: decimal">
<li><strong><em>Empirical models</em></strong> which are rooted in <strong><em>observation</em></strong> and <strong><em>data</em></strong>.</li>
<li><strong><em>Mechanistic models</em></strong> such as those created by applying fundamental laws of physics, chemistry, and such.</li>
</ol>
<p>We are going to put off mechanistic models for a while, for two reasons. First, the “fundamental laws of physics, chemistry, and such” are often expressed with the concepts and methods of calculus. We are heading there, but at this point you don’t yet know the core concepts and methods of calculus. Second, most students don’t make a careful study of the “fundamental laws of physics, chemistry, and such” until <em>after</em> they have studied calculus. So examples of mechanistic models will be a bit hollow at this point.</p>
<p>We’ll start then with empirical modeling: finding functions that are a good summary of data. The process of constructing a model that is a good match for data is called <strong><em>curve fitting</em></strong>, or, more generally, <strong><em>fitting a model</em></strong>.</p>
<div id="variations-from-scaling" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Variations from scaling</h2>
<p>A good place to start building a model is to pick one of the basic modeling functions. This works surprisingly often. To remind you, here are our nine <strong><em>pattern-book</em></strong> functions:</p>
<!-- the official list of pattern-book functions and their names -->
<table>
<thead>
<tr class="header">
<th>Pattern name</th>
<th>Traditional notation</th>
<th>R notation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td><span class="math inline">\(e^x\)</span></td>
<td><code>exp(x)</code></td>
</tr>
<tr class="even">
<td>logarithm (“natural log”)</td>
<td><span class="math inline">\(\ln(x)\)</span></td>
<td><code>log(x)</code></td>
</tr>
<tr class="odd">
<td>sinusoid</td>
<td><span class="math inline">\(\sin(x)\)</span></td>
<td><code>sin(x)</code></td>
</tr>
<tr class="even">
<td>square</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><code>x^2</code></td>
</tr>
<tr class="odd">
<td>proportional</td>
<td><span class="math inline">\(x\)</span></td>
<td><code>x</code></td>
</tr>
<tr class="even">
<td>constant</td>
<td><span class="math inline">\(1\)</span></td>
<td><code>1</code></td>
</tr>
<tr class="odd">
<td>reciprocal</td>
<td><span class="math inline">\(1/x\)</span> or <span class="math inline">\(x^{-1}\)</span></td>
<td><code>1/x</code></td>
</tr>
<tr class="even">
<td>gaussian</td>
<td><span class="math inline">\(\dnorm(x)\)</span></td>
<td><code>dnorm(x)</code></td>
</tr>
<tr class="odd">
<td>sigmoid</td>
<td><span class="math inline">\(\pnorm(x)\)</span></td>
<td><code>pnorm(x)</code></td>
</tr>
</tbody>
</table>
<p>The basic modeling functions are the same, but replace the plain <span class="math inline">\(x\)</span> in the pattern-book function with a straight-line function, for instance <span class="math inline">\(ax + b\)</span> or, equivalently <span class="math inline">\(a(x - x_0)\)</span>. In use, the parameter <span class="math inline">\(a\)</span> is often written with some other letter and, often, the <span class="math inline">\(b\)</span> or <span class="math inline">\(-x_0\)</span> part is not needed.</p>
<p>Here are some of the common forms of the basic modeling functions you will encounter:</p>
<table>
<colgroup>
<col width="16%" />
<col width="45%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Common forms</th>
<th>note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exponential</td>
<td><span class="math inline">\(e^{k t}\)</span> or <span class="math inline">\(e^{-k t}\)</span> or <span class="math inline">\(e^{-t/ \tau}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>Sinusoid</td>
<td><span class="math inline">\(\sin\left(\frac{2 \pi}{P} (t-t_0)\right)\)</span>, <span class="math inline">\(\sin\left(\frac{2 \pi}{P} t\right)\)</span>, or <span class="math inline">\(\sin(\omega t)\)</span></td>
<td><span class="math inline">\(P\)</span> is “period”, <span class="math inline">\(\omega\)</span> is “angular frequency.”</td>
</tr>
<tr class="odd">
<td>Monomials</td>
<td><span class="math inline">\([x-x_0]\)</span> or <span class="math inline">\([x-x_0]^2\)</span>, and so on</td>
<td></td>
</tr>
<tr class="even">
<td>Power-law generally</td>
<td><span class="math inline">\(x^p\)</span> or <span class="math inline">\([x-x_0]^p\)</span></td>
<td><span class="math inline">\(p\)</span> is “power.”</td>
</tr>
<tr class="odd">
<td>Gaussian</td>
<td><span class="math inline">\(\dnorm(x, mean, sd)\)</span></td>
<td>Interpret “mean” as “center.”</td>
</tr>
<tr class="even">
<td>Sigmoid</td>
<td><span class="math inline">\(\dnorm(x, mean, sd)\)</span></td>
<td><span class="math inline">\(sd\)</span> is “standard deviation” or “spread.”</td>
</tr>
</tbody>
</table>
<p>It helps in making the selection to have ready to mind the basic shape of each of these function families. To review, revisit Section <a href="pattern-book.html#function-shapes">2.4</a>.</p>
<p>Remember also that, in general, we scale the inputs and scale the output. This means that in choosing a model family, we don’t have to worry at first about the numbers on the axes. (Of course, those numbers will be critically important later on in the process!) The scaling does, however, allow us to consider some variations on the shapes of the modeling functions. In particular, the <strong><em>input scaling</em></strong> lets us flip the shape right-for-left. And the <strong><em>output scaling</em></strong> lets us flip the shape top-for-bottom.</p>
<ul>
<li><span class="math inline">\(f(t)\)</span>, basic shape</li>
<li><span class="math inline">\(f(-t)\)</span>, flipped right-for-left</li>
<li><span class="math inline">\(-f(t)\)</span>, flipped top-for-bottom</li>
<li><span class="math inline">\(-f(-t)\)</span>, flipped both top-for-bottom and right-for-left</li>
</ul>
<p>For functions such as the sinusoid, flipping is not much use, since the flipped sinusoid curve is still a sinusoid, although with a shifted input. Similarly, a right-for-left flipped gaussian function has the same shape as the original. For the straight-line function, flipping of either sort accomplishes the same thing: changing the sign of the slope.</p>
<p>For the exponential function, the two possible types of flipping—right-for-left and top-for-bottom—produce four different curves, all of which are exponential, shown in Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:four-variations"></span>
<img src="MOSAIC-Calculus_files/figure-html/four-variations-1.png" alt="Four variations of the exponential function." width="50%" /><img src="MOSAIC-Calculus_files/figure-html/four-variations-2.png" alt="Four variations of the exponential function." width="50%" />
<p class="caption">
Figure 8.1: Four variations of the exponential function.
</p>
</div>
</div>
<div id="fit-periodic" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Curve fitting a periodic function</h2>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-1">8.2</a> shows the tide level in <a href="https://www.google.com/maps/place/Providence,+RI/@41.8071,-71.4012,14z/data=!4m5!3m4!1s0x89e444e0437e735d:0x69df7c4d48b3b627!8m2!3d41.8071!4d-71.4012">Providence, Rhode Island</a>, starting at midnight on April 1, 2020 and recorded every minute for four and a half days. (These data were collected by the US National Oceanic and Atmospheric Administration. <a href="https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=20200401%2010:00&amp;end_date=20200405%201:59&amp;station=8454000&amp;product=one_minute_water_level&amp;datum=mllw&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv">Link</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-a-3-1"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-3-1-1.png" alt="About four days of tide-level data from Providence, Rhode Island" width="90%" />
<p class="caption">
Figure 8.2: About four days of tide-level data from Providence, Rhode Island
</p>
</div>
<p>It’s not too hard to see what’s going on. The tide rises and falls about every 12 hours. The difference between high tide and low tide is a little more than one meter. The tide gauge is calibrated so that a typical reading is 1 meter, although we don’t know what that is respect to. (Certainly not sea level, since then the typical reading would be around zero.)</p>
<p>This simple description tells almost everything needed to match a basic modeling function to the tide level. Given the clear pattern in the data, we’ll use a sinusoid, that is, a function of the form <span class="math display">\[\text{tide}(t) \equiv A \sin(2\pi t/P) + B\]</span> The procedure is straightforward:</p>
<p><strong>Step 0</strong>: Determine whether a sinusoid model is appropriate. As you know, sinusoids oscillate up and down repeatedly with a steady <strong><em>period</em></strong>. That certainly seems the case here. But sinusoids are also steady in the <strong><em>peak</em></strong> and <strong><em>trough</em></strong> values for each cycle. That’s only approximately true in the Providence data. Models inevitably involve approximation. We’ll have to keep an eye on whether modeling with sinusoids and their <strong><em>fixed amplitude</em></strong> still lets us extract useful information.</p>
<p><strong>Step 1</strong>: Choose a sensible value to represent the low point repeatedly reached. 0.5 m seems appropriate here, but obviously the exact position of the trough of each cycle varies over the 4.5 day duration of the data. Similarly, the peak is near 1.6 m. Parameter <span class="math inline">\(B\)</span> is the mean of the peak and trough values: <span class="math inline">\(\frac{1.6 + 0.5}{2} = 1.05\)</span> m here. Parameter <span class="math inline">\(A\)</span> is half the difference between the peak and trough values: <span class="math inline">\(\frac{1.6 - 0.5}{2} = 0.55\)</span>. Parameter <span class="math inline">\(B\)</span> is called the <strong><em>baseline</em></strong> of the sinusoid. Parameter <span class="math inline">\(A\)</span> is the <strong><em>amplitude</em></strong>. (Note that by convention, the amplitude is always <em>half</em> the high-to-low range of the sinusoid.)</p>
<p><strong>Step 2</strong>: Estimate the period <span class="math inline">\(P\)</span> of the sinusoid. This can be done with the horizontal axis scale: measure the horizontal duration of a complete cycle. I like to use the time between peaks, but the time between troughs would work just as well. Another good choice is the time between positive sloping crossings of the baseline. (But be careful. The time between <em>successive</em> baseline crossings, one positive sloping and the other negative, give just <em>half</em> the period.)</p>
<p>On the scale of the above plot, it’s hard to read off the time of the first peak. So, zoom in until it becomes more obvious.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-a-3-2"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-3-2-1.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%" /><img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-3-2-2.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%" />
<p class="caption">
Figure 8.3: Zooming in on the start of the data (left) and on the last part of the data (right).
</p>
</div>
<p>The left panel in Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-2">8.3</a> shows about 24 hours at the start of the record. The first peak is at about 6 hours, the second at about 19 hours. That indicates that the period is roughly 19 - 6 = 13 hours.</p>
<p><strong>Step 3</strong> Plot out the model over the data. Replacing the symbols <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(P\)</span> with our estimates, the model is</p>
<p><span class="math display">\[{\color{magenta}{\text{tide}(t)} \equiv \underbrace{1.05}_A + \underbrace{0.55}_B \sin(\ 2\pi t\ /\underbrace{13}_P)}\]</span></p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> shows this model in <span class="math inline">\(\color{magenta}{\text{magenta}}\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-a-3-3"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-3-3-1.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="90%" />
<p class="caption">
Figure 8.4: The sinusoid fails to align with the timing of peaks and troughs.
</p>
</div>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> shows the model aligning beautifully with the data at around time 80 hours, but not so well near the very beginning of the record. Looking carefully, you can see the magenta peak gradually move to the left compared to the data as you look at the peaks of the cycles one at a time moving backward from <span class="math inline">\(t=80\)</span> hours. This is diagnostic of our 13-hour estimate for the period being a little too long.</p>
<p>A good way to refine the estimate is to change the model slightly and re-graph the data and model. Keep doing this until you have found the right alignment. In other words, parameter estimation is often an <strong><em>iterative</em></strong> process of estimate-and-refine. This is one of the aspects of the <strong><em>modeling cycle</em></strong>, where a modeler builds a tentative model, looks for systematic deviations from the data, and refines the model.</p>
<div class="intheworld">
<p>Another sort of deviation of the model from the data seen in Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> concerns the varying heights of the peaks and troughs in the data, which is not captured by the simple sinusoid pattern. Perhaps you can see that at the beginning of the record, the troughs are also <em>wider</em> than the peaks. Later on, as this extra width disappears, the amplitude of the peaks and troughs increases.</p>
<p>You don’t yet have the calculus tools or experience to know how or whether this phenomenon can be modeled. For now, a hint: Earth has two large orbiting bodies, the Sun and the Moon. These have slightly different periods: 24 hours for the Sun and slightly longer for the Moon.</p>
</div>
<p><strong>Step 4</strong> Our model omitted one of the parameters of the sinusoid basic modeling function: the time shift <span class="math inline">\(t_0\)</span>. A more complete model would be:
<span class="math display">\[\text{tide}_\text{shifted}(t) \equiv A \sin(2\pi (t - t_0)/P) + B\]</span>
Whether including this parameter is important depends on our purpose for the model. If the goal is to find the period of the tides, the time shift hardly matters. But if the goal is to predict a future tide level, the time shift is critical.</p>
<p>Estimating <span class="math inline">\(t_0\)</span> can only be done once the period <span class="math inline">\(P\)</span> is known precisely. In practice, as you’ll see in Chapter <a href="modeling-cycle.html#modeling-cycle">14</a>, we use a numerical method called <strong><em>polishing</em></strong> to estimate both <span class="math inline">\(P\)</span> and <span class="math inline">\(t_0\)</span> at the same time.</p>
</div>
<div id="fit-exponential" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Curve fitting an exponential function</h2>
<p>The exponential function is particularly useful when the quantity we want to model shows <strong><em>constant proportional increase</em></strong>. Many quantities in everyday life are this way. For instance, an increase in salary is typically presented in a format like “a 3% increase.” The population growth of a country is often presented as “percent per year.” Inflation in the price of goods is similarly described in percent per year. Interest on money in a bank savings account is also described as percent per year. But if you have the bad fortune to owe money to a loan shark, the proportional increase might be described as “percent per month” or “percent per week.”</p>
<p>When you know the “percent increase per time” of a quantity whose initial value is <span class="math inline">\(A\)</span>, the exponential function is easy to write down: <span class="math display">\[f(t) = A (1+r)^t\]</span>
The number <span class="math inline">\(r\)</span> is often called the <strong><em>interest rate</em></strong> or <strong><em>discount rate</em></strong> and is given in <strong>percent</strong>.</p>
<div class="takenote">
<p>Regrettably, it’s extremely easy and common to forget the rules for addition with percent. If <span class="math inline">\(r = 5\%\)</span>, then <span class="math inline">\((1+r) = 1.05\)</span>, not 6. Always keep in mind that <span class="math inline">\(5\%\)</span> means <span class="math inline">\(\frac{5}{100}\)</span>.</p>
<p>Another source of error stems from the tradition in mathematics of using the number <span class="math inline">\(e=2.718282\)</span> as the “natural” base of the exponential function, whereas in <span class="math inline">\(f(t) = A (1+r)^t\)</span> the base is <span class="math inline">\(1+r\)</span>.</p>
<p>You can translate an exponential <span class="math inline">\(b^t\)</span> in any base <span class="math inline">\(b\)</span> to the “natural” base. This is just a matter of calculating the appropriate parameter <span class="math inline">\(k\)</span> such that <span class="math inline">\(e^k = b\)</span>. Using logarithms, <span class="math display">\[e^k = b\ \ \implies \ \  k=\ln(b)\]</span> For instance, if
<span class="math inline">\(r=5\%\)</span> per year, we’ll have <span class="math inline">\(k = \ln(1+r) = \ln(1.05) = 0.488\)</span> per year.</p>
<p>Almost everybody is happier doing arithmetic with numbers like 2 and 10 rather than <span class="math inline">\(e=2.718282\)</span>. For this reason, you may see formulations of the exponential function as <span class="math inline">\(g(t) \equiv 2^{a t}\)</span> or <span class="math inline">\(h(t) \equiv 10^{c t}\)</span>. Remember that <span class="math inline">\(2^{a t}\)</span> and <span class="math inline">\(e^{at}\)</span>, although both exponential functions, are quantitatively different. If you want to write <span class="math inline">\(2^{at}\)</span> using the “natural” base, it will be <span class="math inline">\(e^{\ln(2) a\, t }\)</span>. Similarly, <span class="math inline">\(10^{ct} = e^{\ln(10) c\, t}\)</span>.</p>
</div>
<p>Exponential functions also describe <strong><em>decrease</em></strong> or <strong><em>decay</em></strong>. Just replace <span class="math inline">\(t\)</span> with <span class="math inline">\(-t\)</span>. That is, a movie of a decreasing quantity is just the movie of an increasing quantity played backwards in time!</p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-intro-1">8.5</a> shows some data collected by Prof. Stan Wagon to support his making a detailed mechanistic model of an everyday phenomenon: <a href="https://www.researchgate.net/profile/Gianluca_Argentini/post/Is_analogy_reasoning_between_heat_transfert_and_electriocity_allows_to_apply_the_electricity_laws_about_resistance_to_thermal_resistances/attachment/59d6573379197b80779ada64/AS%3A533325451403264%401504166104259/download/Stan+WAGON+How+quickly+does+water+cool.pdf">The cooling of a mug of hot beverage to room temperature</a>. The mug started at room temperature, which was measured at 26 degrees C. At time 0 he poured in boiling water from a kettle and measured the temperature of the water over the next few hours.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-intro-1"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-intro-1-1.png" alt="Stan's data" width="90%" />
<p class="caption">
Figure 8.5: Stan’s data
</p>
</div>
<p>Our task is to translate this data into the form of a function that takes time as input and returns temperature as output. Such a model would be useful for, say, filling in the gaps of the data. For instance, we might want to find the temperature of the water immediately after being poured from the kettle into the mug.</p>
<p>Looking at the data, one sees that the temperature decreases along a curve: cooling fast at first and then more slowly. This is the pattern of the flipped right-for-left exponential. (Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>(B)) We can imagine then that an exponential, <span class="math inline">\(A e^{kt} + C\)</span> will be a suitable model form for the cooling water.</p>
<p>What remains is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span>. Here is a general process for curve-fitting an exponential. Later, we’ll apply this process specifically to the water-cooling situation.</p>
<p><strong>General process for curve-fitting an exponential</strong></p>
<p>The goal is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span> in the formula <span class="math inline">\(A e^{kx} + C\)</span>.</p>
<p><strong>Step 0</strong>: Check that the data show an exponential pattern in one of its varieties, namely a smooth increase or decrease and leveling out beyond some value of <span class="math inline">\(x\)</span>. If this isn’t true, reconsider whether you should be using an exponential function in the first place. Using your mind’s eye (or paper, if you like) sketch out an exponential-shaped curve that follows the overall trend of the data. We’ll call this imagined curve <span class="math inline">\(f(x)\)</span>.</p>
<p><strong>Step 1</strong>: Find the <strong><em>baseline</em></strong>. This is the output level at which the function has a horizontal asymptote, that is, at which the function levels off. <span class="math inline">\(C\)</span> is this baseline level.</p>
<p><strong>Step 2</strong>: Find the numerical value of the imagined function <span class="math inline">\(f()\)</span> at input <span class="math inline">\(x = 0\)</span>. We’ll call this value <span class="math inline">\(f(0)\)</span>. Then <span class="math inline">\(A \equiv f(0) - C\)</span>.</p>
<p><strong>Step 3</strong> Estimate parameter <span class="math inline">\(k\)</span> using these steps:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Pick any input value, which we’ll call <span class="math inline">\(x_2\)</span>, such that <span class="math inline">\(f(x_2)\)</span> is far from the baseline.</p></li>
<li><p>Find an input value, which we’ll call <span class="math inline">\(x_1\)</span> such that <span class="math inline">\(f(x_1)\)</span> is halfway<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> between the baseline <span class="math inline">\(C\)</span> and <span class="math inline">\(f(x_2)\)</span>, that is <span class="math display">\[f(x_1) = \frac{f(x_2) + C}{2}\]</span></p></li>
<li><p>Once you have <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, you can immediately find <span class="math inline">\(k\)</span>: <span class="math display">\[k = \frac{\ln(2)}{x_2 - x_1} \approx \frac{0.693}{x_2 - x_1}\]</span></p></li>
<li><p>Using this simple test to double-check your work. If the horizontal asymptote of <span class="math inline">\(f()\)</span> (that is, approach to the baseline) is for <span class="math inline">\(x \rightarrow \infty\)</span>, then <span class="math inline">\(k\)</span> should be <strong>negative</strong>. If the horizontal asymptote is for <span class="math inline">\(x \rightarrow - \infty\)</span>, then <span class="math inline">\(k\)</span> will be positive.</p></li>
</ol>
<p>Notice that the question of “growth or decay” depends only on the sign of the parameter <span class="math inline">\(k\)</span>. You can have an exponentially decaying process that’s increasing. Consider, for instance, the speed of a car as it merges onto a highway from a slow speed on the entrance ramp. The car’s velocity is increasing, but as you approach highway speed the rate of increase gets smaller. That’s exponential <strong>decay</strong>.</p>
<p>The procedure in Step 3 for estimating <span class="math inline">\(k\)</span> stems from a very important property of exponential functions: Exponential functions always double/half at a constant pace. By design, the parameter <span class="math inline">\(k\)</span>
directly determines that pace. Picking an <span class="math inline">\(x_2\)</span> and finding the corresponding <span class="math inline">\(x_1\)</span> gives the length of the input interval, <span class="math inline">\(x_1 - x_2\)</span> over which the distance from the baseline doubles/halves.</p>
<p>What’s remarkable about the doubling/halving time is that, for a genuinely exponential function, it doesn’t matter which point we choose for <span class="math inline">\(x_1\)</span>. In practice working with graphed data, it’s best to choose so that <span class="math inline">\(f(x_1)\)</span> is discernibly far from the baseline.</p>
<p>The <span class="math inline">\(2\)</span> in <span class="math inline">\(\ln(2)\)</span> corresponds to idea of doubling/halving. The logarithm converts <span class="math inline">\(2\)</span> to a scale that will generate 2 when exponentiated.</p>
<p><strong>Step 4</strong> If you can plot the data, do so. Add to that a graphics layer showing the function <span class="math inline">\(A e^{k x} + C\)</span> using the values for <span class="math inline">\(A\)</span>, <span class="math inline">\(C\)</span>, and <span class="math inline">\(k\)</span> that you just found. If you are not satisfied with the way the plotted function approximates the data, tweak the parameters a bit until you are.</p>
<p><strong>Exponential curve fitting applied to the water-cooling data</strong></p>
<p>Let’s illustrate the general process on the water-cooling data, redrawn in Figure <a href="process-of-modeling.html#fig:Fun-4-a-2-1">8.6</a>.</p>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-a-2-1"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-2-1-1.png" alt="The cooling-water data, repeated here for convenience. We've sketched in an exponential-like curve that matches the data pretty well." width="90%" />
<p class="caption">
Figure 8.6: The cooling-water data, repeated here for convenience. We’ve sketched in an exponential-like curve that matches the data pretty well.
</p>
</div>
<p>Step 0: The data indicate a smooth curve. As <span class="math inline">\(t\)</span> gets large, the curve approaches a constant. So an exponential model is reasonable.</p>
<p><strong>Step 1</strong>: The curve looks like it’s leveling out at a temperature of about 25 degrees C for large <span class="math inline">\(t\)</span>. So <span class="math inline">\(C \approx 25^{\circ} \text{C}\)</span>.</p>
<p><strong>Step 2</strong>: Looking at our imagined curve (sketched in blue in Figure <a href="process-of-modeling.html#fig:Fun-4-a-2-1">8.6</a>), it appears to intersect the <span class="math inline">\(t=0\)</span> vertical axis at about <span class="math inline">\(f(0) = 85^\circ\text{C}\)</span>. Thus, <span class="math display">\[A = 85^\circ\text{C} - 25^\circ\text{C} = 60^\circ\text{C}\]</span></p>
<p><strong>Step 3</strong>:</p>
<ol style="list-style-type: lower-alpha">
<li>Now choose a time <span class="math inline">\(t_2\)</span> where <span class="math inline">\(f(t_2)\)</span> is far from the baseline. … It looks like <span class="math inline">\(t_2 = 25\)</span> will do the job, at which point we can read off the graph that the function value is <span class="math inline">\(f(25) \approx 65\)</span>.</li>
<li>Find an input value <span class="math inline">\(t_1\)</span> such that <span class="math inline">\(f(t_1) -C = (f(t_2)-C)/2.\)</span> This tells us that <span class="math inline">\(f(t_1) = 25 + (65-25)/2 = (65+25)/2 = 45\)</span>. Referring to the graph, the time at which the function is about 45 is <span class="math inline">\(t_1 \approx 65\)</span>, that is, <span class="math inline">\(f(t_1) \approx 65\)</span>.</li>
<li>We have <span class="math inline">\(t_1 \approx 65\)</span> and <span class="math inline">\(t_2 = 25\)</span>. From this, we calculate <span class="math inline">\(k\)</span>:
<span class="math display">\[ k = \frac{\ln(2)}{25 - 65} = 0.693/(-40) = -0.0173\]</span></li>
<li>The data show exponential decay, so we expect <span class="math inline">\(k\)</span> to be negative. Happily, it is. If it hadn’t been, we would go back to look for a sign error someplace.</li>
</ol>
<p><strong>Step 4</strong>. Graph the function on top of the data to confirm the fitted function is a good match to the data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-4-a-2-2"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-4-a-2-2-1.png" alt="An exponential function that roughly aligns with the data." width="90%" />
<p class="caption">
Figure 8.7: An exponential function that roughly aligns with the data.
</p>
</div>
<p>Step 5: The flat zone of the data is to the right. So we’ve got exponential decay and <span class="math inline">\(k &lt; 0\)</span>.</p>
</div>
<div id="curve-fitting-a-power-law-function" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Curve fitting a power-law function</h2>
<p>You have been using power-law functions from early in your math and science education. Some examples:</p>
<table>
<thead>
<tr class="header">
<th>Setting</th>
<th>Function formula</th>
<th>exponent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Circumference of a circle</td>
<td><span class="math inline">\(C(r) = 2 \pi r\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>Area of a circle</td>
<td><span class="math inline">\(A(r) = \pi r^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Volume of a sphere</td>
<td><span class="math inline">\(V(r) = \frac{4}{3} \pi r^3\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td>Distance traveled by a falling object</td>
<td><span class="math inline">\(d(t) = \frac{1}{2} g t^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Gas pressure versus volume</td>
<td><span class="math inline">\(P(V) = \frac{n R T}{V}\)</span></td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>… perhaps less familiar …</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Distance traveled by a diffusing gas</td>
<td><span class="math inline">\(X(t) = D \sqrt{ \strut t}\)</span></td>
<td><span class="math inline">\(1/2\)</span></td>
</tr>
<tr class="even">
<td>Animal lifespan (in the wild) versus body mass</td>
<td><span class="math inline">\(L(M) = a M^{0.25}\)</span></td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>Blood flow versus body mass</td>
<td><span class="math inline">\(F(M) = b M^{0.75}\)</span></td>
<td>0.75</td>
</tr>
</tbody>
</table>
<p>One reason why power-law functions are so important in science has to do with the logic of physical quantities such as length, mass, time, area, volume, force, power, and so on. We’ll discuss this at length later in the course and the principles will appear throughout calculus.</p>
<p>As for finding the power law <span class="math inline">\(f(x) \equiv A x^p\)</span> that provides a good match to data, we’ll need some additional tools to be introduced in Chapter <a href="magnitudes.html#magnitudes">15</a>.</p>
</div>
<div id="gaussian-and-sigmoid-functions" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Gaussian and sigmoid functions</h2>
<p>Our last two basic modeling functions express an important idea in modeling: <strong><em>localness</em></strong>. To put this in concrete terms, imagine creating a function to depict the elevation above sea level of a long road as a function of distance in miles, <span class="math inline">\(x\)</span>, from the start of the road. If the road were level at 1200 feet elevation, a sensible model would be <span class="math inline">\(\text{elevation}(x) = 1200 \text{ft}\)</span>. If the road were gently sloping, a better model would be <span class="math inline">\(\text{elevation}(x) = 1200 + 0.01 x\)</span>.</p>
<p>Now let’s add a bump to the road. A bump is a local feature, often only a few feet wide. Or, perhaps the road is crossing a mountain range. That’s also a local feature, but unlike a bump in the road a mountain range extends for many miles.</p>
<p>The basic modeling function suited to represent bumps in the road, or potholes, or mountain ranges is generically called a “hump function.” In this book, we use a specific hump function called the <strong><em>gaussian</em></strong> function (<code>dnorm()</code>).</p>
<p>A gaussian function has two parameters: the location<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> of the peak, which we’ll call the <strong><em>center</em></strong> parameter, and the sideways extent of the gaussian, which is called the <strong><em>standard deviation</em></strong>. Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> shows a few gaussian functions with different parameters.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-3C-1"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-3C-1-1.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%" /><img src="MOSAIC-Calculus_files/figure-html/Fun-3C-1-2.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%" /><img src="MOSAIC-Calculus_files/figure-html/Fun-3C-1-3.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%" />
<p class="caption">
Figure 8.8: Gaussians with various centers and standard deviations (sd).
</p>
</div>
<p>It’s easy to read off the <strong><em>center</em></strong> parameter from a graph of a gaussian. It’s the location of the top of the function graph. (We mentioned before that a mathematical word for “the location of the top” is <strong><em>argmax</em></strong>; the value for the input of the function that produces the maximum output.)</p>
<p>The <strong><em>spread</em></strong> parameter is also pretty straightforward, but you first have to become familiar with an unusual feature of the gaussian function. The output of the gaussian <em>far from the center</em> is practically zero. But it is not exactly zero. You can see from the graphs that the gaussian function has long flanks which approach zero output more or less in the manner of an exponential function. This means that we can’t measure the spread of the gaussian function by the distance between the zeros on either side of the peak. Instead, we need a <strong><em>convention</em></strong> that will allow us to be precise in quantifying what is admittedly a vague concept of width.</p>
<p>Technically, the convention is that the spread is the length of the interval from the argmax to the inflection point. This can be hard to judge from a graph, but a reasonable approximation is that the spread is the “half-width at half-height.” Come down half-way from the peak value of the output. Panel (c) of Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> marks that elevation with a thin, tan, horizontal line. Along that line, measure the width of the gaussian, as marked by the thick tan line in Panel (c). The <strong><em>spread</em></strong> parameter is half the width of the gaussian measured in this way.</p>
<p>If you have a keen eye, you’ll notice that the tan line in Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> is not exactly half-way down from the peak. It’s down 39.35% from the peak. This corresponds exactly to the technical convention.</p>
<p>Another seeming oddity about the gaussian function is the value of the maximum. It would have seemed natural to define this as 1, so-called “unit height.” The way it actually works is different: the maximum height is set so that the <strong><em>area</em></strong> under the gaussian function is 1.</p>
<p>This business with the area will make more sense when you’ve learned some calculus tools, specifically “differentation” and “integration.” For now though …</p>
<p>Consider another road feature, a local <strong><em>change</em></strong> from one elevation to another as you might accomplish with a ramp. The basic modeling function corresponding to a <strong><em>local change</em></strong> from one level to another is the <strong><em>sigmoid</em></strong> function. Figure <a href="process-of-modeling.html#fig:Fun-3C-2">8.9</a> shows three sigmoid functions.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Fun-3C-2"></span>
<img src="MOSAIC-Calculus_files/figure-html/Fun-3C-2-1.png" alt="Sigmoids with various centers and standard deviations" width="90%" /><img src="MOSAIC-Calculus_files/figure-html/Fun-3C-2-2.png" alt="Sigmoids with various centers and standard deviations" width="90%" /><img src="MOSAIC-Calculus_files/figure-html/Fun-3C-2-3.png" alt="Sigmoids with various centers and standard deviations" width="90%" />
<p class="caption">
Figure 8.9: Sigmoids with various centers and standard deviations
</p>
</div>
<p>The name “sigmoid” comes from vague resemblance of the graph to the letter S (which is “sigma” in Greek: <img src="www/variant-sigma.png" />).</p>
<p>The parameters of the sigmoid function are the same as for the gaussian function: <strong><em>center</em></strong> and <strong><em>width</em></strong>. The center is easy to estimate from a graph. It’s the value of the input that produces an output of 0.5, half-way between the max and min of the sigmoid. As with the gaussian function, the <strong><em>width</em></strong> is measured according to a convention. The width is the <strong><em>change in input</em></strong> needed to go from an output of 0.5 to an output of 0.8413. This use of 0.8413 must seem loony at first exposure, but there is a reason. We’ll need more calculus tools before it can make sense.</p>
<p>Gaussian functions and sigmoid functions with the same center and width parameters have a very close relationship. The <strong><em>instantaneous rate of change</em></strong> of the sigmoid function is the corresponding <strong><em>gaussian</em></strong> function. Figures <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> and <a href="process-of-modeling.html#fig:Fun-3C-2">8.9</a> show corresponding gaussian and sigmoid functions. To the very far left, the sigmoid function is effectively flat: a slope near zero. Moving toward the center the sigmoid has a gentle slope: a low number. In the center, the sigmoid is steepest: a higher number. Then the slope of the sigmoid becomes gentle again before gradually falling off to zero. Near zero, then low, then higher, then low again, then falling off to zero: that’s also the description of a gaussian function!</p>
<p>In R, the name of the sigmoid function is <code>pnorm()</code>. The gaussian is <code>dnorm()</code>. The parameters that specify center and spread are named <code>mean</code> and <code>sd</code>. The word “mean” accurately conveys the idea of “center.” It would be nice to be able to say that <code>sd</code> comes from <code>s</code>prea<code>d</code>, but in fact <code>sd</code> is short for <strong><em>standard deviation</em></strong>, a term familiar to students of statistics.</p>
<div class="intheworld">
<p>Figure <a href="process-of-modeling.html#fig:ebola-data">8.10</a> shows the cumulative number of Ebola cases during an outbreak in Sierra Leone from May 1, 2014 to December 16, 2015.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ebola-data"></span>
<img src="MOSAIC-Calculus_files/figure-html/ebola-data-1.png" alt="Cumulative Ebola cases in Sierra Leone" width="90%" />
<p class="caption">
Figure 8.10: Cumulative Ebola cases in Sierra Leone
</p>
</div>
<p>Although the cumulative case data are roughly sigmoidal in shape, there are systematic differences in shape from a true sigmoid. For comparison, Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a> is a graph of genuinely sigmoidal data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:true-sigmoid"></span>
<img src="MOSAIC-Calculus_files/figure-html/true-sigmoid-1.png" alt="A simulated sigmoidal growth process." width="90%" />
<p class="caption">
Figure 8.11: A simulated sigmoidal growth process.
</p>
</div>
<p>The Ebola data have only a rough similarity to the sigmoid shape. Still, fitting a model and then examining closely the deviations of the model from the data can prompt questions that can lead to a better understanding of the data and what’s needed in an appropriate model.</p>
</div>
<p>Here’s a methodology for estimating the parameters <code>mean</code> and <code>sd</code> of a sigmoid graphically.</p>
<ol style="list-style-type: decimal">
<li><p>Sketch in a S-shaped curve that smoothly follows the data. In Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a> this has already been done for you. For the Ebola data, you will have to use your judgment.</p></li>
<li><p>Find the top plateau of the S-curve. This is indicated by the tan line in Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a>. The parameter <code>A</code> is simply the height of the plateau, in this case <span class="math inline">\(y \approx 15\)</span>.</p></li>
<li><p>Come down half way from the plateau. Here, that’s 15/2 or 7.5, indicated by the horizontal blue line segment. Find the inverse of the S-curve from that half-way point onto the horizontal-axis. Here, that gives <span class="math inline">\(t \approx 5\)</span>. The parameter <code>center</code> is that value.</p></li>
<li><p>From the center of the S-shaped curve, follow the curve upward about 2/3 of the way to the plateau. In the diagram, that point is marked with a green line at <span class="math inline">\(t \approx 7\)</span>. The <code>width</code> is the distance along the horizontal axis from the blue centerline to the green line. Here, that’s <span class="math inline">\(7 - 5\)</span> giving 2 as the <code>width</code>.</p></li>
<li><p>You might also want to trace the S-curve <em>downward</em> from the centerline about 2/3 of the way to zero. That’s indicated by the left green line. In the standard sigmoid, the two green lines will be equally spaced around the centerline. Of course the data may not be in the shape of the standard sigmoid, so you might find the two green lines are not equally spaced from the center.</p></li>
</ol>
</div>
<div id="exercises-7" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Exercises</h2>
<details>
<summary>
<strong>Exercise 8.1</strong>: <span><a name="File: Exercises/kid-type-boat.Rmd" href="#0rvpbu"><img src="www/icons8-signpost.png" title="Location: Exercises/kid-type-boat.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">0rvpbu</red></span>
</summary>
<p>These three expressions</p>
<p><span class="math display">\[e^{kt}\ \ \ \ \ 10^{t/d} \  \ \ \ \  2^{t/h}\]</span></p>
<p>produce the same value if <span class="math inline">\(k\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(h\)</span> have corresponding numerical values.</p>
<div class="scaffolding">
<p>The scaffolding has an expression for plotting out <span class="math inline">\(2^{t/h}\)</span> for <span class="math inline">\(-4 \leq t \leq 12\)</span> where <span class="math inline">\(h = 4\)</span>. It also plots out <span class="math inline">\(e^{kt}\)</span> and <span class="math inline">\(10^{t/d}\)</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="process-of-modeling.html#cb42-1" aria-hidden="true" tabindex="-1"></a>fa <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">exp</span>(k<span class="sc">*</span>t)  <span class="sc">~</span> t, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb42-2"><a href="process-of-modeling.html#cb42-2" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">2</span><span class="sc">^</span>(t<span class="sc">/</span>h) <span class="sc">~</span> t, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb42-3"><a href="process-of-modeling.html#cb42-3" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">10</span><span class="sc">^</span>(t<span class="sc">/</span>d) <span class="sc">~</span> t, <span class="at">d =</span> <span class="dv">4</span>)</span>
<span id="cb42-4"><a href="process-of-modeling.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="process-of-modeling.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">fa</span>(t) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">12</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="process-of-modeling.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fb</span>(t) <span class="sc">~</span> t, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="process-of-modeling.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fc</span>(t) <span class="sc">~</span> t, <span class="at">color  =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="process-of-modeling.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span></code></pre></div>
</div>
<p>Your task is to modify the values of <code>d</code> and <code>k</code> such that all three curves lie on top of one another. (Leave <code>h</code> at the value 4.) You can find the appropriate values of <code>d</code> and <code>k</code> to accomplish this by any means you like, say, by using the algebra of exponents or by using trial and error. (Trial and error is a perfectly valid strategy regardless of what your high-school math teachers might have said about “guess and check.” The trick is to make each new guess systematically based on your previous ones and observation of how those previous ones performed.)</p>
<p>After you have found values of <code>k</code> and <code>d</code> that are suited to the task …</p>
<p><strong>Question A</strong> What is the numerical value of your best estimate of <code>k</code>?</p>
<p>    <span class="Zchoice">0.143<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">0.173<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">0.283<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">0.320<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question B</strong> What is the numerical value of your best estimate of <code>d</code>?</p>
    <span class="Zchoice">11.2<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">11.9<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">13.3<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">15.8<span class="mcanswer">︎✘ </span></span>
</details>
<details>
<summary>
<strong>Exercise 8.3</strong>: <span><a name="File: Exercises/flipping-1.Rmd" href="#YLWP1"><img src="www/icons8-signpost.png" title="Location: Exercises/flipping-1.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">YLWP1</red></span>
</summary>
<p><img src="MOSAIC-Calculus_files/figure-html/flipping-1-1-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> One of the curves in plot (A) is a pattern-book function. Which one?</p>
<p>    <span class="Zchoice">black<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span>It’s the exponential function.</span></span>       <span class="Zchoice">blue<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">green<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">tan<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question B</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (A), which one of the curves is <span class="math inline">\(f(-x)\)</span>?</p>
<p>    <span class="Zchoice">black<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">blue<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">green<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">tan<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><img src="MOSAIC-Calculus_files/figure-html/flipping-1-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question C</strong> One of the curves in plot (B) is a pattern-book function. Which one?</p>
<p>    <span class="Zchoice">black<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">blue<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">green<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">tan<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question D</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (B), which one of the curves is <span class="math inline">\(-f(x)\)</span>?</p>
<p>    <span class="Zchoice">black<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">blue<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">green<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">tan<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><img src="MOSAIC-Calculus_files/figure-html/flipping-1-3-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The blue curve in plot (C), as you know, is the sinusoid pattern-book function.</p>
<p><strong>Question E</strong> Which of these functions is the green curve?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice"><span class="math inline">\(\sin(-x)\)</span><span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(-\sin(x)\)</span><span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(-\sin(-x)\)</span><span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice">Both <span class="math inline">\(\sin(-x)\)</span> and <span class="math inline">\(-\sin(-x)\)</span><span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice">Both <span class="math inline">\(\sin(-x)\)</span> and <span class="math inline">\(-\sin(x)\)</span><span class="mcanswer">Excellent! The sine function has so-called “odd” symmetry around <span class="math inline">\(x=0\)</span>.</span></span></li>
</ol>
<p><img src="MOSAIC-Calculus_files/figure-html/flipping-1-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question F</strong> One of the curves in plot (D) is a pattern-book function. Which one?</p>
<p>    <span class="Zchoice">black<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">dodgerblue<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">green<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">tan<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question G</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (D), which one of the curves is <span class="math inline">\(-f(-x)\)</span>?</p>
    <span class="Zchoice">black<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">dodgerblue<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">green<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">tan<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span>
</details>
<details>
<summary>
<strong>Exercise 8.5</strong>: <span><a name="File: Exercises/lamb-talk-gloves.Rmd" href="#YELXG"><img src="www/icons8-signpost.png" title="Location: Exercises/lamb-talk-gloves.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">YELXG</red></span>
</summary>
<p>A person breathes in and out roughly every three seconds. The volume <span class="math inline">\(V\)</span> of air in the person’s lungs varies between a minimum of <span class="math inline">\(2\)</span> liters and a maximum of <span class="math inline">\(4\)</span> liters. Assume time <span class="math inline">\(t\)</span> is measured in seconds.</p>
<p>Remember that a full cycle of the sine wave <span class="math inline">\(\sin(x)\)</span> involves <span class="math inline">\(x\)</span> going from its starting value to that value <strong>plus</strong> <span class="math inline">\(2 \pi\)</span>.</p>
<p><strong>Question A</strong> Which of the following is the most appropriate of these models for <span class="math inline">\(V(t)\)</span>?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice"><span class="math inline">\(V(t) \equiv 2 \sin \left( \frac{\pi}{3} t \right) + 2\)</span><span class="mcanswer">︎✘ This varies between a minimum of 0 and a maximum of 2.</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(V(t) \equiv \sin \left( \frac{2\pi}{3} t \right) + 3\)</span><span class="mcanswer">Right! Good. In this class, we generally write the sine function like <span class="math inline">\(\sin(2 \pi t/P)\)</span> which means that the overall argument to the sine function will go from 0 to <span class="math inline">\(2 \pi\)</span> when <span class="math inline">\(t\)</span> goes from 0 to <span class="math inline">\(P\)</span>.</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(V(t) \equiv 2 \sin \left( \frac{2\pi}{3} t \right)+ 2\)</span><span class="mcanswer">︎✘ This varies between a minimum of 0 and a maximum of 2.</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(V(t) \equiv \sin \left( \frac{\pi}{3} t \right) + 3\)</span><span class="mcanswer">︎✘ Right amplitude and baseline: the minimum will be 2 liters and the maximum 4 liters. But the period is wrong. Going from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=3\)</span> should produce a full cycle of the sine function. But here the argument would go only from 0 to $ 3 = <span class="math inline">\(\pi\)</span>. After 3 seconds, only half a cycle has been completed.</span></span></li>
</ol>
<p>A respiratory cycle can be divided into two parts: inspiration and expiration. Please do an experiment. Using a clock or watch, breath with a total period of 3 seconds/breath, that is, complete one breath every three seconds. Once you have practiced this and can do it without forcing either phase of breathing, make a rough estimate of what fraction of the cycle is inspiration and what fraction is expiration. (The “correct/incorrect” answers here are right for most people. Your natural respiration might be different.)</p>
<p><strong>Question B</strong> Which is true?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">Inspiration lasts longer than expiration<span class="mcanswer">Right! </span></span><br />
</li>
<li><span class="Zchoice">Expiration lasts longer than inspiration<span class="mcanswer">︎✘ Maybe it is for you, but not for most people. Try breathing in while counting 1-2-3 then exhaling while counting 1-2-3-4-5-6. Likely, that’s not a very natural pattern for you.</span></span><br />
</li>
<li><span class="Zchoice">Inspiration and expiration each consume about the same fraction of the complete cycle.<span class="mcanswer">︎✘ People can do this consciously by counting 1-2-3 for inspiration and another 1-2-3 for expiration. This usually feels forced and unnatural.</span></span></li>
</ol>
</details>
<details>
<summary>
<strong>Exercise 8.7</strong>: <span><a name="File: Exercises/spirometer.Rmd" href="#VBWD"><img src="www/icons8-signpost.png" title="Location: Exercises/spirometer.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">VBWD</red></span>
</summary>
<p>The graph below shows a recording from a “spirometer,” an instrument for recording respiration. Like many old instruments, the trace from this spirometer is made by a pen at the end of a swinging arm with paper moving steadily beneath it. The arm is not exactly aligned with the horizontal axis. Nonetheless, you should be able to estimate an appropriate amplitude and period for the trace. (dm<span class="math inline">\(^3\)</span> is cubic-decimeters: a tenth of a meter cubed. This is the same as a liter.)</p>
<p><img src="/Users/kaplan/KaplanFiles/USAFA/MOSAIC-Calculus/Block-1/Exercises/Fun/www/spirometer.jpg" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> What are appropriate estimates for the period and amplitude of the respiration trace?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">About <span class="math inline">\(\pm 1\)</span> liter and 3 seconds.<span class="mcanswer">︎✘ If this were true, over the 120 seconds of the recording you would expect to see 40 cycles of respiration.</span></span><br />
</li>
<li><span class="Zchoice">About <span class="math inline">\(\pm 1\)</span> liter and 5 seconds.<span class="mcanswer">Right! </span></span><br />
</li>
<li><span class="Zchoice">About <span class="math inline">\(\pm 1\)</span> liter and 7.5 seconds.<span class="mcanswer">︎✘ If this were true, you would expect to see about 16 cycles of respiration over 120 seconds of recording.</span></span></li>
</ol>
</details>
<details>
<summary>
<strong>Exercise 8.9</strong>: <span><a name="File: Exercises/chicken-choose-vase.Rmd" href="#vkwl4"><img src="www/icons8-signpost.png" title="Location: Exercises/chicken-choose-vase.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">vkwl4</red></span>
</summary>
<p>The Bargain Basement store wants to sell its goods quickly. Consequently, they reduce each product’s price <span class="math inline">\(P\)</span> by 5% per day.</p>
<p><strong>Question A</strong> If a jacket costs $80 today, how much will it cost in <span class="math inline">\(t\)</span> days?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice"><span class="math inline">\(P = 80 - 5t\)</span><span class="mcanswer">︎✘ Remember, 5 percent is exactly the same as 0.05</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(P = 80 - 4t\)</span><span class="mcanswer">︎✘ Remember, 4 percent is exactly the same as 0.04</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(P = 80 - 0.05t\)</span><span class="mcanswer">︎✘ This would be a decrease in price by 5 cents every day.</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(P = 80 (0.05)^t\)</span><span class="mcanswer">︎✘ Each day’s price would be only 5% that of the previous day’s price.</span></span><br />
</li>
<li><span class="Zchoice"><span class="math inline">\(P = 80 (0.95)^t\)</span><span class="mcanswer">Correct. </span></span></li>
</ol>
<p>You’ll need to open a sandbox for the next question.</p>
<div class="scaffolding">
<p>You’re on your own here! Remember, to raise a number to a power, you can use an expression like <code>0.95^7</code>.</p>
</div>
<p><strong>Question B</strong> You decided that you like the $80 jacket, but you have a budget of only $60. How long should you wait before coming back to the Bargain Basement store.?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">3 days<span class="mcanswer">︎✘ On day 3 the price will be <span class="math inline">\(0.95\times 0.95 \times 0.95 \times 80\)</span>. That’s above your budget.</span></span><br />
</li>
<li><span class="Zchoice">4 days<span class="mcanswer">︎✘ On day 4 the price will be <span class="math inline">\(80 \times 0.95^4\)</span>= $65.16. Too much!</span></span><br />
</li>
<li><span class="Zchoice">5 days<span class="mcanswer">︎✘ On day 5 the price will be <span class="math inline">\(80 \times 0.95^5\)</span>= $61.90. Close, but still higher than your budget.</span></span><br />
</li>
<li><span class="Zchoice">6 days<span class="mcanswer">Nice! </span></span></li>
</ol>
</details>
<details>
<summary>
<strong>Exercise 8.11</strong>: <span><a name="File: Exercises/cow-type-kayak.Rmd" href="#asevss"><img src="www/icons8-signpost.png" title="Location: Exercises/cow-type-kayak.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">asevss</red></span>
</summary>
<p>The Wikipedia entry on “Common Misconceptions” used to contain this item:</p>
<blockquote>
<p><em>Some cooks believe that food items cooked with wine or liquor will be non-alcoholic, because alcohol’s low boiling point causes it to evaporate quickly when heated. However, a study found that some of the alcohol remains: 25% after 1 hour of baking or simmering, and 10% after 2 hours.</em></p>
</blockquote>
<p>The modeler’s go-to function type for events like the evaporation of alcohol is exponential: The amount of alcohol that evaporates would, under constant conditions (e.g. an oven’s heat), be proportional to the amount of alcohol that hasn’t yet evaporated.</p>
<p><strong>Question A</strong> A) Assume that 25% of the alcohol remains after 1 hour? If the process were exponential, how much would remain after 2 hours?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">10%<span class="mcanswer">︎✘ That’s what the study is reported to have found, but that’s not consistent with an exponential process that decays to 25% after one hour</span></span><br />
</li>
<li><span class="Zchoice">25%<span class="mcanswer">︎✘ Exponentials decay to zero eventually, so don’t expect things to stay still after one hour.</span></span><br />
</li>
<li><span class="Zchoice">25% of 25%<span class="mcanswer">Nice! We know that 75% is eliminated over 1 hour, leaving 25%. The continuing exponential process will, over the next hour eliminate 75% of the amount at the start of that hour. So after hour 2 we’ll have 25% of the amount we had at hour 1, which was 25% of the original amount.</span></span><br />
</li>
<li><span class="Zchoice">75%<span class="mcanswer">︎✘ That’s how much was eliminated in the first hour, not how much remains after 2 hours.</span></span><br />
</li>
<li><span class="Zchoice">75% of 75%<span class="mcanswer">︎✘ In an exponential process, at any moment the rate of decay (e.g. 75% per hour) is a constant proportion of the amount that is still there. After one hour, there is 25% of the alcohol remaining. That will decay at a rate of 75% per hour. Over the next hour, we’ll lose 75% of the original 25%, giving us 25% of the original amount.</span></span></li>
</ol>
<p><strong>Question B</strong> B) What is the half-life of an exponential process that decays to 25% after one hour?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">15 minutes<span class="mcanswer">︎✘ This provides time for four halvings in one hour, which would leave <span class="math inline">\(\frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} = 1/16\)</span> of the original not 1/4.</span></span><br />
</li>
<li><span class="Zchoice">30 minutes<span class="mcanswer">Excellent! This gives time for two halvings in one hour, bringing us to 25% as observed.</span></span><br />
</li>
<li><span class="Zchoice">45 minutes<span class="mcanswer">︎✘ Two halvings bring us down to 25%. At this rate, it would take 90 minutes to get down to 25%, not 60 minutes as observed.</span></span><br />
</li>
<li><span class="Zchoice">none of the above<span class="mcanswer">︎✘ </span></span></li>
</ol>
<p>Let’s change pace and think about the “10% after 2 hours” observation. First, recall that the amount left after <span class="math inline">\(n\)</span> halvings is
<span class="math inline">\(\text{amount.left}(n) \equiv \frac{1}{2}^n\)</span>
This is an exponential function with base 1/2.</p>
<p>You’re going to carry out a <strong><em>guess-and-check</em></strong> procedure to find <span class="math inline">\(n\)</span> that gives <span class="math inline">\(\text{amount.left}(n) = 0.10\)</span>.</p>
<p>Open a sandbox and copy over the scaffolding, which includes the definition of the <code>amount.left()</code> function. We started with a guess of <span class="math inline">\(n=0\)</span>, which is wrong. Change the guess until you get the output 10%.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="process-of-modeling.html#cb43-1" aria-hidden="true" tabindex="-1"></a>amount.left <span class="ot">&lt;-</span> <span class="fu">makeFun</span>((<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>n <span class="sc">~</span> n)</span>
<span id="cb43-2"><a href="process-of-modeling.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">amount.left</span>(<span class="dv">0</span>)</span></code></pre></div>
</div>
<p><strong>Question C</strong> C) Use <code>amount.left()</code> as defined in the scaffolding to guess-and-check how many halvings it takes to bring something down to 10% of the original amount.</p>
<p>    <span class="Zchoice">2.58<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">3.32<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">3.62<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">3.94<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">4.12<span class="mcanswer">︎✘ </span></span></p>
<p>Another way to find the input <span class="math inline">\(n\)</span> that generates an output of 10% is to construct the <strong><em>inverse function</em></strong> to <span class="math inline">\(\text{amount.left}()\)</span>.</p>
<p>The computer already provides you with inverse functions for <span class="math inline">\(2^n\)</span> and <span class="math inline">\(e^n\)</span> and <span class="math inline">\(10^n\)</span>. Their names are <code>log2()</code>, <code>log()</code>, and <code>log10()</code> repectively. Using <code>log2()</code>, write a function named <code>log_half()</code> that gives the inverse function to <span class="math inline">\((1/2)^n\)</span>. Remember, the input to the inverse function corresponds to 10%; the output to the <span class="math inline">\(n\)</span>.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="process-of-modeling.html#cb44-1" aria-hidden="true" tabindex="-1"></a>log_half <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="sc">-</span> <span class="fu">log2</span>(...your stuff here ...) <span class="sc">~</span> x)</span></code></pre></div>
</div>
<p><strong>Question D</strong> D) The answer you got in part C) is the <strong>number</strong> of halvings needed to reach 10%. If this number occurs in 2 hours (that is, 120 minutes), what is the half life stated in minutes.</p>
<p>    <span class="Zchoice">30<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">35<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">36<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">38<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">42<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">47<span class="mcanswer">︎✘ </span></span></p>
<p>Suppose you compromise between the half-life needed to reach 25% after one hour and the half-life needed to reach 10% after two hours. Use, say, 33 minutes as the compromise half life. Using the sandbox, calculate how much would be left after 1 hour for this compromise half life, and how much left after 2 hours.</p>
<p><strong>Question E</strong> E) How much is left after 1 hour and after 2 hours when the half life is 33 minutes?</p>
    <span class="Zchoice">28% and 8%<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">31% and 4%<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">30% and 9%<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">27% and 9%<span class="mcanswer">︎✘ </span></span>
</details>
<details>
<summary>
<strong>Exercise 8.13</strong>: <span><a name="File: Exercises/hump-intro.Rmd" href="#IELWV"><img src="www/icons8-signpost.png" title="Location: Exercises/hump-intro.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">IELWV</red></span>
</summary>
<p>The gaussian function is implemented in R with <code>dnorm(x, mean, sd)</code>. The input called <code>mean</code> corresponds to the <em>center</em> of the hump. The input called <code>sd</code> gives the <em>width</em> of the hump.</p>
<div class="scaffolding">
<p>In a sandbox, make a slice plot of <code>dnorm(x, mean=0, sd=1)</code>. By varying the value of <code>width</code>, figure out how you could read that value directly from the graph.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="process-of-modeling.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>) <span class="sc">~</span> x,</span>
<span id="cb45-2"><a href="process-of-modeling.html#cb45-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">domain</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)))</span></code></pre></div>
</div>
<p>In the plot below, one of the double-headed arrows represents the <code>width</code> parameter. The others are misleading.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-119-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Which arrow shows correctly the <code>width</code> parameter of the gaussian function in the graph with arrows?</p>
<p>    <span class="Zchoice">top<span class="mcanswer"><span class="math inline">\(\heartsuit\ \)</span></span></span>       <span class="Zchoice">middle<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">bottom<span class="mcanswer">︎✘ </span></span>       <span class="Zchoice">none of them<span class="mcanswer">︎✘ </span></span></p>
<p><strong>Question B</strong> What is the value of <code>center</code> in the graph with arrows?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">-2<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span><br />
</li>
<li><span class="Zchoice">-1<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span><br />
</li>
<li><span class="Zchoice">-0.5<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span><br />
</li>
<li><span class="Zchoice">0<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span><br />
</li>
<li><span class="Zchoice">0.5<span class="mcanswer">Right! </span></span><br />
</li>
<li><span class="Zchoice">1<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span><br />
</li>
<li><span class="Zchoice">2<span class="mcanswer">︎✘ The <code>center</code> parameter is the argmax of the function.</span></span>
</details></li>
</ol>
<details>
<summary>
<strong>Exercise 8.15</strong>: <span><a name="File: Exercises/sigmoid-intro.Rmd" href="#CKSLE"><img src="www/icons8-signpost.png" title="Location: Exercises/sigmoid-intro.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">CKSLE</red></span>
</summary>
<p>Gaussian functions and sigmoidal functions come in pairs. For every possible sigmoid, there is a corresponding gaussian that gives, for each value of the input, the slope of the sigmoid.</p>
<p>Each of the following graphs shows a sigmoid and a gaussian function. The two might or might not correspond to one another. That is, the output of the gaussian might be the slope of the sigmoid, or the gaussian might correspond to some other sigmoid. Remember, you’re comparing the <em>output</em> of the gaussian to the <em>slope</em> of the sigmoid.</p>
<p>For each graph, say whether the gaussian and the sigmoid correspond to one another. If not, choose one of the reasons why not.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-121-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Graph (A)</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">The gaussian and sigmoid correspond.<span class="mcanswer">Excellent! </span></span><br />
</li>
<li><span class="Zchoice">The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer">︎✘ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the gaussian the highest?</span></span><br />
</li>
<li><span class="Zchoice">The numerical value of the output of the gaussian function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer">︎✘ Did you calculate the numerical value of the slope of the sigmoid?</span></span></li>
</ol>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-122-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question B</strong> Graph (B)</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">The gaussian and sigmoid correspond.<span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice">The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer">Nice! The gaussian peaks at about <span class="math inline">\(x=2\)</span> while the steepest part of the sigmoid is at about <span class="math inline">\(x=4\)</span></span></span><br />
</li>
<li><span class="Zchoice">The numerical value of the output of the gaussian function is much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer">︎✘ Did you calculate the numerical value of the slope of the sigmoid?</span></span></li>
</ol>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-123-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question C</strong> Graph (C)</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">The gaussian and sigmoid correspond.<span class="mcanswer">Nice! </span></span><br />
</li>
<li><span class="Zchoice">The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer">︎✘ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the gaussian the highest?</span></span><br />
</li>
<li><span class="Zchoice">The numerical value of the output of the gaussian function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer">︎✘ Did you calculate the numerical value of the slope of the sigmoid?</span></span></li>
</ol>
<p>In the graph <em>D</em>, there are several gaussian functions shown, only one of which corresponds to the sigmoid.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-124-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question D</strong> Which gaussian corresponds to the sigmoid?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">A<span class="mcanswer">︎✘ The value of the gaussian output is much larger than the slope of the sigmoid.</span></span><br />
</li>
<li><span class="Zchoice">B<span class="mcanswer">Right! Right! The gaussian is centered on the steepest part of the sigmoid and falls to zero where the sigmoid levels out.</span></span><br />
</li>
<li><span class="Zchoice">C<span class="mcanswer">︎✘ The gaussian is too narrow.</span></span><br />
</li>
<li><span class="Zchoice">D<span class="mcanswer">︎✘ The gaussian is too broad and shifted to the left.</span></span>
</details></li>
</ol>
<details>
<summary>
<strong>Exercise 8.17</strong>: <span><a name="File: Exercises/sigmoid-bath.Rmd" href="#bllKR"><img src="www/icons8-signpost.png" title="Location: Exercises/sigmoid-bath.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">bllKR</red></span>
</summary>
<p>Have in mind a gaussian function and a sigmoid function that form a corresponding pair.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-126-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> Which of these stories is consistent with the relationship between a gaussian and its corresponding sigmoid?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">The gaussian is the amount of water in a bathtub while the sigmoid is the time you spend in the bath.<span class="mcanswer">︎✘ </span></span><br />
</li>
<li><span class="Zchoice">The gaussian is the amount of water in the bathtub while the sigmoid is the rate at which water flows from the tap.<span class="mcanswer">︎✘ You turn the tap on and off after a while. That’s not what the sigmoid looks like.</span></span><br />
</li>
<li><span class="Zchoice">The gaussian is the rate at which water flows from the tap and the sigmoid is the amount of water in the bathtub.<span class="mcanswer">Right! </span></span><br />
</li>
<li><span class="Zchoice">The gaussian indicates the amount the drain is open and the sigmoid is the amount of water in the bathtub.<span class="mcanswer">︎✘ Shouldn’t the amount of water go down when the drain is open?</span></span></li>
</ol>
</details>
<details>
<summary>
<strong>Exercise 8.19</strong>: <span><a name="File: Exercises/flipping-2.Rmd" href="#YLWP2"><img src="www/icons8-signpost.png" title="Location: Exercises/flipping-2.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">YLWP2</red></span>
</summary>
<p>Each of the curves in the graph is an exponential function <span class="math inline">\(e^{kt}\)</span>, for various values of <span class="math inline">\(k\)</span>.</p>
<p><img src="MOSAIC-Calculus_files/figure-html/flipping-2-1-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Question A</strong> What is the order from <span class="math inline">\(k\)</span> smallest (most negative) to k largest?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">black, orange, red, green, blue<span class="mcanswer">Good. Exponential functions that grow slowly have <span class="math inline">\(k\)</span> with a small absolute value</span></span><br />
</li>
<li><span class="Zchoice">black, orange, blue, green, red<span class="mcanswer">︎✘ Sorry. Notice the red curve grows the most slowly. This means it has the smallest <span class="math inline">\(|k|\)</span>.</span></span><br />
</li>
<li><span class="Zchoice">red, green, blue, orange, black<span class="mcanswer">︎✘ The orange and black curves have negative <span class="math inline">\(k\)</span>, so they will be smaller than the other curves with positive sign.</span></span>
</details></li>
</ol>
<details>
<summary>
<strong>Exercise 8.21</strong>: <span><a name="File: Exercises/ebola-sigmoid.Rmd" href="#EKCIE"><img src="www/icons8-signpost.png" title="Location: Exercises/ebola-sigmoid.Rmd" width="12px"/></a><span style="color: red; font-size: 9pt;">EKCIE</red></span>
</summary>
<hr />
<p><em>Put aside for the moment that the Ebola data plotted in Figure <a href="process-of-modeling.html#fig:ebola-data">8.10</a> doesn’t look exactly like the standard sigmoid function. Follow the fitting procedure as best you can.</em></p>
<p><strong>Question A</strong> Where is the top plateau?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">About Day 600.<span class="mcanswer">︎✘ Measure the height of the plateau, not where it starts horizontally.</span></span><br />
</li>
<li><span class="Zchoice">About 14,000 cases<span class="mcanswer">Excellent! </span></span><br />
</li>
<li><span class="Zchoice">About 20,000 cases<span class="mcanswer">︎✘ Read the vertical axis markings more carefully.</span></span><br />
</li>
<li><span class="Zchoice">None of the above<span class="mcanswer">︎✘ One of the above answers is pretty good.</span></span></li>
</ol>
<p><strong>Question B</strong> Where is the centerline?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">Near Day 200<span class="mcanswer">Good. </span></span><br />
</li>
<li><span class="Zchoice">Near Day 300<span class="mcanswer">︎✘ That’s the center of the vertical scale, not the day at which the curve reaches half-way to the eventual plateau.</span></span><br />
</li>
<li><span class="Zchoice">At about 7000 cases<span class="mcanswer">︎✘ That’s half-way up to the plateau, but the answer you want is the day at which the curve reaches that point.</span></span></li>
</ol>
<p><strong>Question C</strong> Now to find the <code>width</code> parameter. The curve looks more classically sigmoidal to the left of the centerline than to the right, so follow the curve <em>downward</em> as in Step 4 of the algorithm to find the parameters. What’s a good estimate for <code>width</code>?</p>
<ol style="list-style-type: lower-roman">
<li><span class="Zchoice">About 50 days<span class="mcanswer">Correct. </span></span><br />
</li>
<li><span class="Zchoice">About 100 days<span class="mcanswer">︎✘ Too wide!</span></span><br />
</li>
<li><span class="Zchoice">About 10 days<span class="mcanswer">︎✘ Too small</span></span><br />
</li>
<li><span class="Zchoice">About 2500 cases<span class="mcanswer">︎✘ The width is measured along the horizontal axis, not the vertical</span></span></li>
</ol>
</details>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>The motivation for the equation is that the distance between <span class="math inline">\(f(x_1)\)</span> and <span class="math inline">\(C\)</span> should be half that of the distance between <span class="math inline">\(f(x_2)\)</span> and <span class="math inline">\(C\)</span>. In other words, <span class="math display">\[f(x_1) - C = \frac{f(x_2) - C}{2}\]</span> Simplifying the algebra a little tells you to look for <span class="math inline">\(x_1\)</span> such that <span class="math display">\[f(x_1) = \frac{f(x_2) + C}{2}\]</span><a href="process-of-modeling.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>That is, the input value at which the function value is largest.<a href="process-of-modeling.html#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="params-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fun-slopes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/08-modeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dtkaplan/MOSAIC-Calculus/shared/08-modeling.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
