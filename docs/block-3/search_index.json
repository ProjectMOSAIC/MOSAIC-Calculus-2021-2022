[["change-accumulation.html", "Chapter 27 Change &amp; accumulation 27.1 Accumulation 27.2 Notation for anti-differentiation 27.3 R/mosaic notation 27.4 Dimension and anti-differentiation 27.5 From Calculus Made Easy 27.6 Exercises", " Chapter 27 Change &amp; accumulation Every 10 years, starting in 1790, the US Census Bureau carries out a constitutionally mandated census: a count of the current population. The overall count as a function of year is shown in Figure 27.1. [Source] In the 230 years spanned by the census data, the US population has grown 100-fold, from about 4 million in 1790 to about 330,000,000 in 2020. Figure 27.1: US population since 1790. Left: linear axes. Right: semi-log axes It’s tempting to look for simple patterns in such data. Perhaps the US population has been growing exponentially. A semi-log plot of the same data suggests that the growth is only very roughly exponential. A truly exponential process would present as a curve with a constant derivative, but the derivative of the function in the graph is decreasing over the centuries. Insofar as the slope over the semi-log graph is informative, it amounts to this quantity: \\[\\partial_t \\ln(\\text{pop}(t)) = \\frac{\\partial_t\\, \\text{pop}(t)}{\\text{pop}}\\] This is the per-capita rate of growth, that is, the rate of change in the population divided by the population. Conventionally, this fraction is presented as a percentage: percentage growth in the population per year, as in Figure 27.2. Figure 27.2: Annual per capita growth rate of the US population (percent) The dots in the graph are a direct calculation from the census data. There’s a lot of fluctuation, but an overall trend stands out: the population growth rate has been declining since the mid-to late 1800s. The deviations from the trend are telling and correspond to historical events. There’s a relatively low growth rate seen from 1860 to 1870: that’s the effect of the US Civil War. The Great depression is seen in the very low growth from 1930 to 1940. Baby Boom: look at the growth from 1950-1960. The bump from 1990 to 2000? Not coincidentally, the 1990 Immigration Act substantially increased the yearly rate of immigration. If the trend in the growth rate continues, the US will reach zero net growth about 2070, then continue with negative growth. Of course, negative growth is just decline. A simple prediction from Figure 27.2 is that the argmax of the US population—that is, the year that the growth rate reaches zero—will occur around 2070. How large will the population be when it reaches its maximum? In Block 2, we dealt with situations where we know the function \\(f(t)\\) and want to find the rate of change \\(\\partial_t f(t)\\). Here, we know the rate of change of the population and we need to figure out the population itself, in other words to figure out from a known \\(\\partial_t f(t)\\) what is the unknown function \\(f(t)\\). The process of figuring out \\(f(t) \\longrightarrow \\partial_t f(t)\\) is, of course, called differentiation. The opposite process, \\(\\partial_t f(t) \\longrightarrow f(t)\\) is called anti-differentiation. In this block we’ll explore the methods for calculating anti-derivatives and some of the settings in which anti-derivative problems arrive. The predictions from the accumulate-population-growth model are shown as a \\(\\color{magenta}{\\text{magenta}}\\) line in Figure 27.3. Figure 27.3: Predicted US population based on the historical linear decline in per-capita growth. According to the accumulation model, the population peaks in 2075 at 390 million. We’ll be back down to the present population level in about 100 years. Professional demographers make much more sophisticated models using detailed data from many sources. The demographers at the US Census Bureau predict that the population will reach a maximum of 404 million in 2060, shown by the little blue dot in Figure 27.3. That’s not too different from what we got by analyzing just the raw census numbers. 3135 27.1 Accumulation Imagine a simple setting: water flowing out of a tap into a basin or tank. The amount of water in the basin will be measured in a unit of volume, say liters. Measurement of the flow \\(f(t)\\) of water from the tap into the tank has different units, say liters per second. If volume \\(V(t)\\) is the volume of water in the tank as a function of time, \\(f(t)\\) at any instant is \\(f(t) = \\partial_t V(t)\\). Clearly there is a relationship between the two functions \\(f(t)\\) and \\(V(t)\\). With derivatives, we can give a good description of that relationship: \\[f(t) = \\partial_t V(t)\\] This description will be informative if we have measured the volume of water in the basin as a function of time and want to deduce the rate of flow from the tap. Now suppose we have measured the flow \\(f(t)\\) and want to figure out the volume. The volume at any instant is the past flow accumulated to that instant. As a matter of notation, we write this view of the relationship as \\[V(t) = \\int f(t) dt,\\] which you can read as “volume is the accumulated flow.” Other examples of accumulation and change: velocity is the rate of change of position with respect to time. Likewise, position is the accumulation of velocity over time. force is the rate of energy with respect to position. Likewise energy is the accumulation of force as position changes. deficit is the rate of change of debt with respect to time. Likewise, debt is the accumulation of deficit over time. 27.2 Notation for anti-differentiation For differentiation we are using the notation \\(\\partial_x\\) as in \\(\\partial_x f(x)\\). Remember that the subscript on \\(\\partial\\) names the with-respect-to input. There are three pieces of information this notation: The \\(\\color{magenta}{\\partial}\\) symbol which identifies the operation as partial differentiation. The name of the with-respect-to input \\(\\partial_{\\color{magenta}{x}}\\) written as a subscript to \\(\\partial\\). The function to be differentiated, \\(\\partial_x \\color{magenta}{f(x)}\\). For anti-differentiation, our notation must also specify the three pieces of information. It might be tempting to use the same notation as differentiation but replace the \\(\\partial\\) symbol with something else, perhaps \\(\\eth\\) or \\(\\spadesuit\\) or \\(\\forall\\), giving us something like \\(\\spadesuit_x f(x)\\). Convention has something different in store. The notation for anti-differentiation is \\[\\large \\int f(x) dx\\] 1. The \\(\\color{magenta}{\\int}\\) is the marker for anti-differentiation. 2. The name of the with-respect to variable is contained in the “dx” at the end of the notation: \\(\\int f(x) d\\color{magenta}{x}\\) 3. The function being anti-differentiated is in the middle \\(\\int \\color{magenta}{f(x)} dx\\). For those starting out with anti-differentiation, the conventional notation can be confusing, especially the \\(dx\\) part. It’s easy confuse \\(d\\) for a constant and \\(x\\) for part of the function being anti-differentiated. Think of the \\(\\int\\) and the \\(dx\\) as brackets around the function. You need both brackets for correct notation, the \\(\\int\\) and the \\(dx\\) together telling you what operation to perform. Remember that just as \\(\\partial_x f(x)\\) is a function, so is \\(\\int f(x) dx\\). 27.3 R/mosaic notation Recall that the notation for differentiation in R/mosaic is D(f(x) ~ x). The R/mosaic notation for anti-differentiation is very similar: D(f(x) ~ x) This has the same three pieces of information as \\(\\partial_x f(x)\\) D() signifies differentiation whereas antiD() signifies anti-differentiation. ~ x identifies the with-respect-to variable. f(x) ~ is the function on which the operation is to be performed. Remember that just as D(f(x) ~ x) creates a new function out of f(x) ~ x, so does antiD(f(x) ~ x). 27.4 Dimension and anti-differentiation This entire block will be about anti-differentiation, its properties and its uses. You already know that anti-differentiation (as the name suggests) is the inverse of differentiation. There is one consequence of this that is helpful to keep in mind as we move on to other chapters. This being calculus, the functions that we construct and operate upon have inputs that are quantities and outputs that are also quantities. Every quantity has a dimension, as discussed in Chapter 16. When you are working with any quantity, you should be sure that you know its dimension and its units. The dimension of the input to a function does not by any means have to be the same as the dimension of the output. For instance, we have been using many functions where the input has dimension time and the output is position (dimension L) or velocity (dimension L/T) or acceleration (dimension L/T\\(^2\\)). Imagine working with some function \\(f(y)\\) that’s relevant to some modeling project of interest to you. Returning to the bracket notation that we used in Chapter 16, the dimension of the input quantity will be [\\(y\\)]. The dimension of the output quantity is [\\(f(y)\\)]. (Remember from 16 that [\\(y\\)] means “the dimension of quantity \\(y\\)” and that [\\(f(y)\\)] means “the dimension of the output from \\(f(y)\\).”) The function \\(\\partial_y f(y)\\) has the same input dimension \\([y]\\) but the output will be \\([f(y)] / [y]\\). For example, suppose \\(f(y)\\) is the mass of fuel in a rocket as a function of time \\(y\\). The output of \\(f(y)\\) has dimension M. The input dimension \\([y]\\) is T. The output of the function \\(\\partial_y f(y)\\) has dimension \\([f(y)] / [y]\\), which in this case will be M / T. (Less abstractly, if the fuel mass is given in kg, and time is measured in seconds, then \\(\\partial_y f(y)\\) will have units of kg-per-second.) How about the dimension of the anti-derivative \\(F(y) = \\int f(y) dy\\)? Since \\(F(y)\\) is the anti-derivative of \\(f(y)\\) (with respect to \\(y\\)), we know that \\(\\partial_y F(y) = f(y)\\). Taking the dimension of both sides \\[[\\partial_y F(y)] = \\frac{[F(y)]}{[y]} = \\frac{[F(y)]}{\\text{T}} = [f(y)] = \\text{M}\\] Consequently, \\([F(y)] = \\text{M}\\). To summarize: The dimension of derivative \\(\\partial_y f(y)\\) will be \\([f(y)] / [y]\\). The dimension of the anti-derivative \\(\\int f(y) dy\\) will be \\([f(y)]\\times [y]\\). Or, more concisely: Differentiation is like division, anti-differentiation is like multiplication. Paying attention to the dimensions (and units!) of input and output can be a boon to the calculus student. Often students have some function \\(f(y)\\) and they are wondering which of the several calculus operations they are supposed to do: differentiation, anti-differentiation, finding a maximum, finding an argmax or a zero. Start by figuring out the dimension of the quantity you want. From that, you can often figure out which operation is appropriate. To illustrate, imagine that you have constructed \\(f(y)\\) for your task and you know, say, \\[[f(y)] = \\text{M and} \\ \\ \\ \\ \\ [y] = \\text{T}\\ .\\] Look things up in the following table: Dimension of result Calculus operation M / T differentiate M T anti-differentiate M find max or min T find argmax/argmin or a function zero M T\\(^2\\) anti-differentiate twice in succession M / T\\(^2\\) differentiate twice in succession For example, suppose the output of the accelerometer on your rocket has dimension L / T\\(^2\\). You are trying to figure out from the accelerometer reading what is your altitude. Altitude has dimension L. Look up in the table to see that you want to anti-differentiate acceleration twice in succession. 27.5 From Calculus Made Easy Calculus Made Easy, by Silvanus P. Thompson, is a classic, concise, and elegant textbook from 1910. It takes a common-sense approach, sometimes lampooning the traditional approach to teaching calculus. Some calculus-tricks are quite easy. Some are enormously difficult. The fools who write the textbooks of advanced mathematics—and they are mostly clever fools—seldom take the trouble to show you how easy the easy calculations are. On the contrary, they seem to desire to impress you with their tremendous cleverness by going about it in the most difficult way. — From the preface Thompson’s first chapter starts with the notation of accumulation, which he calls “the preliminary terror.” The preliminary terror … can be abolished once for all by simply stating what is the meaning—in common-sense terms—of the two principal symbols that are used in calculating. These dreadful symbols are: \\(\\Large\\ d\\) which merely means “a little bit of.” Thus \\(dx\\) means a little bit of \\(x\\); or \\(du\\) means a little bit of \\(u\\). Ordinary mathematicians think it more polite to say “an element of,” instead of “a little bit of.” Just as you please. But you will find that these little bits (or elements) may be considered to be indefinitely small. \\(\\ \\ \\large\\int\\) which is merely a long \\(S\\), and may be called (if you like) “the sum of.” Thus \\(\\ \\int dx\\) means the sum of all the little bits of \\(x\\); or \\(\\ \\int dt\\) means the sum of all the little bits of \\(t\\). Ordinary mathematicians call this symbol “the integral of.” Now any fool can see that if \\(x\\) is considered as made up of a lot of little bits, each of which is called \\(dx\\), if you add them all up together you get the sum of all the \\(dx\\)’s, (which is the same thing as the whole of \\(x\\)). The word “integral” simply means “the whole.” If you think of the duration of time for one hour, you may (if you like) think of it as cut up into \\(3600\\) little bits called seconds. The whole of the \\(3600\\) little bits added up together make one hour. When you see an expression that begins with this terrifying symbol, you will henceforth know that it is put there merely to give you instructions that you are now to perform the operation (if you can) of totaling up all the little bits that are indicated by the symbols that follow. The next chapter shows what it means to “total up all the little bits” of a function. 27.6 Exercises Exercise 27.02: bcJnUq Question A What is the name of the with-respect-to input in \\(\\int g(y) dy\\)? yGood.  dy︎✘ The \\(d\\) is just punctuation preceding the input name. x︎✘ There’s no \\(x\\) in the expression. t︎✘ There’s no \\(t\\) in the expression. Question B What is the name of the with-respect-to input in \\(\\int g(t) dy\\) yRight!  dy︎✘ The \\(d\\) is just punctuation preceding the input name. x︎✘ There’s no \\(x\\) in the expression. t︎✘ Even though \\(g(t)\\) is not a function of \\(y\\), the notation says we are to anti-differentiate it with respect to \\(y\\). The result will be \\(y g(t) + C\\). Question C What is the name of the with-respect-to input in \\(\\int g(x, t) dt\\) y︎✘ dt︎✘ The \\(d\\) is just punctuation preceding the input name. x︎✘ \\(g()\\) is a function of both \\(x\\) and \\(t\\), but we are indication that the anti-differentiation is to be done with respect to \\(t\\), not \\(x\\). tCorrect.  Exercise 27.04: Ya2cVq Question A Which of the following functions is \\(\\int \\left[a + bx \\right] dx\\)? (Hint: Differentiate each of them until you find the one that matches \\(a + bx\\).) \\(ax + \\frac{1}{2}b x^2 + C\\)Right!  \\(ax + 2 b x^2 + C\\)︎✘ The derivative of this is \\(a + 4b x\\), not \\(a + bx\\). \\(a + b x^2 + C\\)︎✘ The derivative of this is \\(2 b x\\), not \\(a + bx\\). Question B Which of the following functions is \\(\\int e^{-kx} dt\\)?     \\(-e^{-kx}\\,/\\,k\\)\\(\\heartsuit\\ \\)       \\(- k e^{-k x}\\)︎✘        \\(e^{-kx}\\,/\\,k\\)︎✘ Exercise 27.06: wmyERp Every function has an anti-derivative. But there are many functions, for example \\(\\dnorm()\\) where there is no formula for the anti-derivative. Even so, the R/mosaic antiD() operator will figure out what is the anti-derivative. For each of the following functions, use makeFun() to implement the function as f(). Then use antiD() to construct the anti-derivative of f() and give this the name F(). Finally, use D() to compute the derivative of F(). For instance: f &lt;- makeFun(x*dnorm(x) ~ x) F &lt;- antiD(f(x) ~ x) dF &lt;- D(F(x) ~ x) slice_plot(f(x) ~ x, domain(x=c(0, 10))) %&gt;% slice_plot(dF(x) ~ x, color=&quot;blue&quot;, size=3, alpha = 0.2) Question A For the function \\(f(x) \\equiv \\pnorm(x^2)\\), what is \\(F(5)\\)? (Pick the closest answer.)     4︎✘        4.5\\(\\heartsuit\\ \\)       5︎✘        5.5︎✘        6︎✘        6.5︎✘ Question B For the function \\(f(x) \\equiv \\sin(x) \\ln(x^2)\\), what is \\(F(5)\\)? (Pick the closest answer.)     -4︎✘        -3.5︎✘        -3︎✘        -2.5\\(\\heartsuit\\ \\)       -2︎✘ Question C For the function \\(f(x) \\equiv x^2 \\pnorm(x)\\), what is \\(F(5)\\)? (Pick the closest answer.)     35︎✘        37︎✘        39︎✘        41\\(\\heartsuit\\ \\)       43︎✘ Exercise 27.08: kEAW8g In the population prediction model at the start of the chapter we want to find a function \\(P(y)\\) that gives the population as a function of year \\(y\\). From the data, we plotted out \\(\\ln\\left[P(y)\\right]\\) and found a fairly smooth curve that was upward sloping and concave down. Next, we made a plot of the derivative with respect to year of that upward-sloping, concave-down curve and found the derivative to be well approximated by a straight-line function with a negative slope \\(a - b y\\). In other words, we found \\[\\partial_y \\ln(P(y)) = a - b\\,y\\] We want to figure out \\(P(y)\\) from this relationship. Step 1: Anti-differentiate the functions on both sides of the equation. Anti-differentiation has the effect of cancelling out the \\(\\partial_y\\) from the left side of the equation. Anti-differentiating the right side means calculating \\(\\int \\left[a - b\\, y\\right]\\ dy\\). Task 1: Confirm that \\(\\int \\left[a - b\\,y\\right]dy = a y - \\frac{1}{2} b y^2 + C\\). Step 2: From Step 1 we have translated the relationship between population and year into this form: \\[\\ln(P(y)) = a y - \\frac{1}{2} b y^2 + C\\] Task 2: Exponentiate both sides of the newly framed relationship to get \\[P(y) = \\exp\\left(a y - \\frac{1}{2} b y^2 + C\\right) = e^{ay -b y^2} e^C = A e^{ay -b y^2}\\] where \\(A = e^C\\). Step 3: Let’s declare that \\(y=0\\) means year 2020. Task 3: Find the census estimate of the population in 2020 and use that information to estimate the parameter \\(A\\) in \\(P(y) = A e^{ay-b y^2}\\). Step 4: The per-capita growth rate is \\[G(y) \\equiv \\frac{\\partial_y P(y)}{P(y)} \\approx \\frac{\\partial_y A e^{a y - b y^2}}{A e^{ay - b y^2}} = a - 2 b y\\] The data suggest that the current growth rate is about 1% per year, so \\(G(0) = a = \\approx 0.01\\). We also know that the growth rate will be around zero in 2070 years time. Year 2070 corresponds to \\(y=50\\). Consequently, \\(G(50) = 0.01 - 2\\cdot 50\\cdot b\\approx 0\\). You can easily solve this for \\(b\\). Task 4: You now have numerical estimates for the parameters \\(A\\), \\(a\\), and \\(b\\) in the function \\(P(y)\\). Using these parameters, plot out \\(P(y)\\) for the next 200 years. According to the prediction, what will be the population in year 2220? # Fill in your estimates for A, a, and b. P &lt;- makeFun(A*exp(a*y - b*(y^2)) ~ y, a = ____, b = ____, A = ____) # y = 200 is year 2220. slice_plot(P(y) ~ y, domain(y=c(0,200))) # At y=200, the estimate is 50 M ```&lt;/details&gt; &lt;details&gt; &lt;summary&gt;**Exercise 27.10**: &lt;span&gt;&lt;a name=&quot;File: Exercises/horse-takes-pillow.Rmd&quot; href=&quot;#NYPDR&quot;&gt;&lt;img src=&quot;www/icons8-signpost.png&quot; title=&quot;Location: Exercises/horse-takes-pillow.Rmd&quot; width=&quot;12px&quot;/&gt;&lt;/a&gt;&lt;span style=&quot;color: red; font-size: 9pt;&quot;&gt;NYPDR&lt;/red&gt;&lt;/span&gt;&lt;/summary&gt; &lt;img src=&quot;MOSAIC-Calculus_files/figure-html/unnamed-chunk-26-1.png&quot; width=&quot;90%&quot; style=&quot;display: block; margin: auto;&quot; /&gt; The graph shows a function $f(x)$. Like all functions, it has an anti-derivative. Here are several functions, $F_1(x)$ through $F_4(x)$. One and only one is the anti-derivative of the function shown in the graph. Which one? ```r F1 &lt;- rfun(~ x, seed = 782) F2 &lt;- rfun(~ x, seed = 934) F3 &lt;- rfun(~ x, seed = 297) F4 &lt;- rfun(~ x, seed = 892) NOTE: rfun() is a program that generates functions, a different one for each seed. It’s been used here to generate F1() through F4() for you to use. Once you run those four lines in your sandbox, you can use slice_plot() in the usual way to plot out any of the four functions over the domain \\(-5 \\leq x \\leq 5\\). Question A Confirming graphically that a candidate \\(F_i(x)\\) is indeed the anti-derivative of \\(f(x)\\) is hard because the two functions can have very different shapes. But there is a very simple operation you can apply to \\(F_i(x)\\) to make the comparison trivial. What is this operation? anti-differentiate \\(F_i(x)\\)︎✘ differentiate \\(F_i(x)\\)Excellent! If the result matches the shape of \\(f(x)\\), you’ve confirmed that \\(F_i(x)\\) is the anti-derivative of \\(f(x)\\). compose \\(f(x)\\) with itself︎✘ multiply \\(F_i(x)\\) times $f(x)︎✘ Question B Which one of the functions is an anti-derivative of the function graphed above? (Hint: See the next problem.)     F1()\\(\\heartsuit\\ \\)       F2()︎✘        F3()︎✘        F4()︎✘ "],["totaling-bits.html", "Chapter 28 Totaling the little bits", " Chapter 28 Totaling the little bits Many students wonder how it is possible to reconstruct a function \\(F(x)\\) from its derivative \\(f(x)\\). The point of this short chapter is to help you develop some intuition about anti-differentiation. You already know the notation meaning “\\(F(x)\\) is the anti-derivative of \\(f(x)\\)”: \\[\\large \\int f(x)\\, dx\\ .\\] In drawing a graph of \\(F(x)\\), we will of course want to use coordinate axes where the quantity \\(x\\) is represented on the horizontal axis and the quantity of the output \\(F(x)\\) is on the vertical axis: Figure 28.1: The graphics frame in which we want to draw the graph of \\(F(x)\\). A small region of the domain is labeled \\(dx\\). Within that domain, \\(F(x)\\), whatever it is, will be a sloping segment. The gray segment shows what this might look like. It’s premature to have drawn a segment of \\(F(x)\\) because we haven’t yet undertaken to compute \\(F(x) = \\int f(x)\\, dx\\). At this point in the process, all we know is \\(f(x)\\), not \\(F(x)\\). Still, since we know \\(f(x)\\), we actually do know the slope of the little segment of \\(F(x)\\). We just don’t know where that segment should be located vertically in each of the \\(dx\\) regions that make up the whole domain. We can’t draw \\(f(x)\\) in the ordinary way as a curve wending its way across the domain of the graph. Why not? Because the vertical axis of the graphics frame is in terms of \\(F(x)\\) and has a different dimension than the output of \\(f(x)\\). But we can draw \\(f(x)\\) in terms of the slope of a segment of horizontal extent \\(dx\\), so long as we accept that the vertical position of that segment means nothing: \\(f(x)\\) gives information only about the slope of the segment. The best we can do at this point is to graph \\(f(x)\\) in terms of sloping segments, as in Figure 28.2. Figure 28.2: Graphing \\(f(x)\\) as a series of sloped segments. The slope is the value of \\(f(x)\\). But the vertical position of the segment is not information provided by \\(f(x)\\), so we’ve drawn all of them at the same vertical level. Each of the segments in Figure 28.2 has the same horizontal extent, namely \\(dx\\). When we draw a sloping segment over the tiny bit \\(dx\\) of the domain, the vertical extent of the segment will be the product of the width \\(dx\\) and the slope \\(f(x)\\). That is, the vertical extent will be the product \\(f(x) dx\\). Whenever we know a function \\(f(x)\\) and have chosen a size for \\(dx\\) we can draw a graph of \\(f(x)\\) in the form shown in Figure 28.2. We’re drawing it in this unusual way because we want the graphics frame to be all ready for drawing the graph of \\(F(x)\\) in the normal fashion after we have figured out what \\(F(x)\\) results from accumulating/summing-up all the little \\(f(x) dx\\) segments. When we write \\(\\large\\int\\) in the notation \\[\\large \\int f(x)\\, dx\\] we mean, “sum up all the \\(f(x) dx\\) segments.” Let’s now consider how to “sum up all the segments.” We’ll start in Figure 28.3 with an example where we already know \\(F(x)\\). That way, we can see of our sum of the \\(f(x) dx\\) segments really does reconstruct \\(F(x)\\). Figure 28.3: Top: A function \\(F(x)\\) for demonstration purposes. Bottom: Slicing \\(F(x)\\) into piecewise domains of width \\(dx=2\\) and anchoring the left-most point of each slice vertically at 0. Now imagine that we sliced up \\(F(x)\\) over small sub-domains of \\(x\\), as in Figure 28.3 (bottom). That is, we approximated \\(F()\\) piecewise locally. But we’ve broken the continuity of \\(F(x)\\) by moving each slice up or down so that the left-most point has value 0. Can you reconstruct \\(F(x)\\) from the local segments? Start by reading off the function value from the last point in the left-most segment. That’s been marked in Figure 28.3 with a blue dot. The function value at that dot is 7.072. Now take the second segment. The idea is to move that segment upward until it joins the first segment at the blue dot. You can do that by adding 7.072 to the second segment. The result is shown in Figure 28.4(top). Figure 28.4: Reconstructing the original function \\(F(x)\\) by moving each segment upward to meet its left neighbor. Top: The first two segments are connected. Bottom: The third segment is connected to the first two. Now read off the new value at the end of the second segment, it’s 4.198. Add this amount to the third segment as in Figure 28.4(bottom). Continue this process until you have reconstructed \\(F(x)\\) from the local segments. You may object: “Of course you can reconstruct \\(F(x)\\) from the local segments, but this isn’t the same as reconstructing \\(F(x)\\) from its derivative \\(\\partial_x F(x)\\).” My answer: “That depends on how many segments you use.” When we make the segment width \\(h\\) smaller and smaller, the individual segments become more and more like straight lines. Figure 28.5 shows the segments for smaller and smaller \\(h\\). Figure 28.5: Using small segments gives each segment a simple shape. In Figure 28.4 the segments had width \\(dx=2.0\\) and were discernable curvy. Top of this figure: At width \\(dx=0.25\\) a few of the segments look curved. Middle: This graph zooms in on the subdomain \\(-1 \\leq x \\leq 1\\) in the top panel, where there is a notably curved segment in the top graph. Setting \\(dx=0.1\\) breaks up such curved segment into components better approximated by a straight line. Bottom: Using \\(dx=0.01\\) further improves the approximation of each segment to a straight line. Notice that many of the segments are straight lines. That’s understandable, since any function looks like a straight line over a small enough domain. Each of those straight-line segments is drawn over a domain \\(x_i &lt; x &lt; x_i+dx\\) that has width \\(dx\\). For \\(dx\\) small enough, the segment is well approximated by a straight line with slope \\(\\partial_x F(x_i)\\). Multiplying slope by width \\(dx\\) gives the segment height: \\(\\left[{\\large\\strut}\\partial_x F(x_i)\\right]\\ dx\\). Of course, remember that \\(\\partial_x F(x) = f(x)\\) helps us see that each of the little segments is \\(f(x_i)\\ dx\\). Lets review. The standard notation for anti-differentiation can be interpreted in terms of putting together segments, or, in the words of Prof. Thompson in Calculus Made Easy, “totaling up all the little bits.” (See Section 27.5.) We start with the function that we already know: \\(\\large f(x)\\). Remember that \\(f(x)\\), at each value of \\(x\\) will be the slope of \\(F(x)\\). Why? Because \\(F(x)\\) is the anti-derivative of \\(f(x)\\), so \\(f(x)\\) is the derivative of \\(F(x)\\). Now divide the domain \\(x\\) into many little bits. Each of these sub-domains is \\(\\large dx\\), a little chunk of \\(x\\). On each of the little chunks, draw in \\(f(x)\\). Since \\(f(x)\\) is the slope of \\(F(x)\\), we will draw \\(f(x)\\) for any given chunk as a short line segment of that slope over the chunk, as in Figure 28.2. We’ll write these little bits, each of which is very nearly a straight-line, as \\(\\large\\color{blue}{f(x) dx}\\). Assemble together all the \\(f(x)dx\\) segments from (3) to get \\(F(x)\\). This instruction to assemble is denoted \\[\\Large \\color{blue}\\int\\] Altogether, we have: \\[\\large \\underbrace{\\underbrace{\\Large\\color{magenta}{\\int}}_{\\color{magenta}{\\text{assemble}}} \\underbrace{\\Large \\overbrace{f(x)}^{\\small\\text{slope of F(x)}}\\ \\ \\overbrace{\\strut dx}^{\\small \\text{bits of}\\ x}}_{\\color{blue}{\\text{the slope segments}}}}_{\\text{giving}\\ {\\Large F(x)+C}\\ \\text{altogether.}}\\] Example 28.1 Returning to the example with which we started the chapter, here are the little segments of the slope function shown in Figure 28.2 assembled together to produce the anti-derivative function. Figure 28.6: \\(\\color{blue}{\\int} f(x)dx\\) means to assemble the straight-line pieces \\(f(x) dx\\) in the manner described in the previous section. "],["net-change.html", "Chapter 29 Integration 29.1 Net change 29.2 The “definite” integral 29.3 Initial value of the quantity 29.4 Integrals from bottom to top 29.5 Exercises", " Chapter 29 Integration Anti-derivatives are useful when you know how a quantity is changing but don’t yet know the quantity itself. It’s important, of course, to keep track of which is the “quantity itself” and which is the “rate of increase in that quantity.” This always depends on context and your point of view. It’s convenient, then, to set some fixed examples to make it easy to keep track of which quantity is which. Context Quantity Rate of increase in quantity Money Cash on hand \\({\\mathbf S}(t)\\) Cash flow \\(s(t)\\) Fuel Amount in fuel tank \\({\\mathbf F}(t)\\) Fuel consumption rate, e.g. kg/hour \\(f(t)\\) Motion Momentum \\({\\mathbf M}(t)\\) Force \\(m(t)\\) notation \\({\\mathbf H}(t)\\) \\(\\partial_t {\\mathbf H}(t)\\) notation \\(G(t) = \\int g(t) dt\\) \\(g(t)\\) We’ll also adopt a convention to make it simpler to recognize which quantity is the “quantity itself” and which is the “rate of increase in that quantity.” We will use CAPITAL LETTERS to name functions that are the quantity itself, and lower-case letters for the rate of increase in that quantity. For example, if talking about motion, an important quantity is momentum and how it changes over time. The momentum itself will be \\({\\mathbf M}(t)\\) while the rate of increase of momentum will be \\(m(t)\\).1 The amount of money a business has on hand at time \\(t\\) is \\({\\mathbf S}(t)\\) measured, say, in dollars. The rate of increase of that money is \\(s(t)\\), in, say, dollars per day. Notice that we’re using the phrase “rate of increase” rather than “rate of change.” That’s because we want to keep straight the meaning of the sign of the lower-case function. If \\(m(t)\\) is positive, the momentum is increasing. If \\(m(t)\\) is negative then it’s a “negative rate of increase,” which is, of course, just a “decrease.” For a business, money coming in means that \\(s(t)\\) is positive. Expenditures of money correspond to \\(s(t)\\) being negative. In the fuel example. \\({\\mathbf F}(t)\\) is the amount of fuel in the tank. \\(f(t)\\) is the rate of increase in the amount of fuel in the tank. Of course, engines burn fuel, removing it from the tank. So we would write the rate at which fuel is burned as \\(-f(t)\\): removing fuel is a negative increase in the amount of fuel, an expenditure of fuel. The objective of this chapter is to introduce you to the sorts of calculations, and their notations, that let you figure out how much the CAPITAL LETTER quantity has changed over an interval of \\(t\\) based on what you already know about the value over time of the lower-case function. The first step in any such calculation is to find or construct the lower-case function \\(f(t)\\) or \\(c(t)\\) or \\(m(t)\\) or whatever it might be. This is a modeling phase. In this chapter, we’ll ignore detailed modeling of the situation and just present you with the lower-case function. The second step in any such calculation is to compute the anti-derivative of the lower-case function, giving as a result the CAPITAL LETTER function. You’ve already seen the notation for this, e.g. \\[{\\Large F(t) = \\int f(t) dt}\\ \\ \\ \\ \\ \\text{or}\\ \\ \\ \\ \\ {\\Large G(t) = \\int g(t) dt}\\ \\ \\ \\ \\text{and so on.}\\] In this chapter, we will not spend any time on this step; we will assume that you already have at hand the means to compute the anti-derivative. (Indeed, you already have antiD() available which will do the job for you.) Later chapters will look at the issues around and techniques for doing the computations by other means. The remaining steps in such calculations are to work with the CAPITAL LETTER function to compute such things as the amount of that quantity, or the change in that quantity as it is accumulated over an interval of \\(t\\). Sometimes you’re writing the capital letter functions in bold-face, e.g. \\({\\mathbf F}(t)\\) and other times you aren’t, e.g. \\(F(t)\\). What’s going on? This is a convention we’re adopting for this chapter, which is when we need it the most to introduce the concepts. Bold-face is being used in this chapter to represent the real-world quantity of interest. So \\({\\mathbf F}(t)\\) is the actual amount of fuel in the tank, \\({\\mathbf M}(t)\\) is the actual momentum of the car, and \\({\\mathbf S}(t)\\) is the actual amount of money on hand. The regular-face functions, \\(F(t)\\) and \\(M(t)\\) and \\(S(t)\\) are the functions that we get by applying anti-differentiation to \\(f(t)\\) or \\(m(t)\\) or \\(s(t)\\). Our broad interest is to construct the bold-face function knowing just the derivative of that function, which we’re writing in lower-case. So, \\(f(t) \\equiv \\partial_t {\\mathbf F}(t)\\). Similarly, \\(m(t) \\equiv \\partial_t {\\mathbf M}(t)\\) and \\(s(t) \\equiv \\partial_t {\\mathbf S}(t)\\). If we knew \\({\\mathbf F}(t)\\) or \\({\\mathbf M}(t)\\) or \\({\\mathbf S}(t)\\), that would be the end of the matter, since our interest is in the quantity \\({\\mathbf F}\\) or \\({\\mathbf V}\\) or \\({\\mathbf M}\\). But we are working with a situation where we know \\(f(t)\\) but not \\({\\mathbf F}(t)\\), or we know \\(m(t)\\) but not \\({\\mathbf M}(t)\\), and so on. How could such a situation arise in the real world? Suppose the car’s fuel gauge is broken, depriving us of direct knowledge of \\(\\mathbf F\\), but that we have a dashboard readout of the rate of fuel consumption. Then we would know \\(f(t)\\) but not \\({\\mathbf F}(t)\\). Or suppose you are in charge of day-to-day running of a business, collecting the income each day and paying the daily expenses. Thus, each day you know \\(s(t)\\)—the cash flow. But it’s your boss who has access to the bank account; you merely deposit money as you get it and write checks or Venmo suppliers (or however it is that your business operates day to day). So your boss knows \\({\\mathbf S}(t)\\) but you know only \\(s(t)\\). Since you know about anti-differentiation, you can try to reconstruct the fuel level \\({\\mathbf F}(t)\\) from the known \\(f(t)\\), or to figure out the bank balance \\({\\mathbf S}(t)\\) from your records of \\(s(t)\\). But anti-differentiation, while part of the solution, is only just a part. You can apply anti-differentiation to \\(f(t)\\), but what you get back will be \\(F(t)\\), not \\({\\mathbf F}(t)\\). What’s the difference between the two? It involves a constant value \\(C\\) which, alas, you can never figure out from \\(f(t)\\). All that you can claim, given the \\(F(t)\\) generated by anti-differentiation, is that \\[{\\mathbf F}(t) = F(t) + C .\\] 29.1 Net change Perhaps it goes without saying, but once you have the CAPITAL LETTER function, e.g. \\(F(t)\\), you can evaluate that function at any input that falls into the domain of \\(F(t)\\). If you have a graph of \\(F(t)\\) versus \\(t\\), just position your finger on the horizontal axis at input \\(t_1\\), then trace up to the function graph, then horizontally to the vertical axis where you can read off the value \\(F(t_1)\\). If you have \\(F()\\) in the form of a computer function, just apply \\(F()\\) to the input \\(t_1\\). In this regard, \\(F(t)\\) is like any other function. However, in using and interpreting the \\(F(t)\\) that we constructed by anti-differentiating \\(f(t)\\), we have to keep in mind the limitations of the anti-differentiation process. In particular, any function \\(f(t)\\) does not have a unique anti-derivative function. If we have one anti-derivative, we can always construct another by adding some constant: \\(F(t) + C\\) is also an anti-derivative of \\(f(t)\\). But we have a special purpose in mind when calculating \\(F(t_1)\\). We want to figure out from \\(F(t)\\) how much of the quantity \\(f(t)\\) has accumulated up to time \\(t_1\\). For example, if \\(f(t)\\) is the rate of increase in fuel (that is, the negative of fuel consumption), we want \\(F(t_1)\\) to be the amount of fuel in our tank at time \\(t_1\\). That cannot happen. All we can say is that \\(F(t_1)\\) is the amount of fuel in the tank at \\(t_1\\) give or take some unknown constant C. Instead, the correct use of \\(F(t)\\) is to say how much the quantity has changed over some interval of time, \\(t_0 \\leq t \\leq t_1\\). This “change in the quantity” is called the net change in \\(F()\\). To calculate the net change in \\(F()\\) from \\(t_0\\) to \\(t_1\\) we apply \\(F()\\) to both \\(t_0\\) and \\(t_1\\), then subtract: \\[\\text{Net change in}\\ F(t) \\ \\text{from}\\ t_0 \\ \\text{to}\\ t_1 :\\\\= F(t_1) - F(t_0)\\] Example 29.1 Suppose you have already constructed the rate-of-change function for momentum \\(m()\\) and implemented it as an R function m(). For instance, \\(m(t)\\) might be the amount of force at any instant \\(t\\) of a car, and \\({\\mathbf M}(t)\\) is the accumulated force, better known as momentum. We’ll assume that the input to m() is in seconds, and the output is in kg-meters-per-second-squared, which has the correct dimension for force. You want to find the amount of force accumulated between time \\(t=2\\) and \\(t=5\\) seconds. # You&#39;ve previous constructed m(t) M &lt;- antiD(m(t) ~ t) M(5) - M(2) ## [1] -1.392131 To make use of this quantity, you’ll need to know it’s dimension and units. For this example, where the dimension [\\(m(t)\\)] is M L T\\(^{-2}\\), and [\\(t\\)] = T, the dimension [\\({\\mathbf M}(t)\\)] will be M L T\\(^{-1}\\). In other words, if the output of \\(m(t)\\) is kg-meters-per-second-squared, then the output of \\(V(t)\\) must be kg- meters-per-second. 29.2 The “definite” integral We have described the process of calculating a net change from the lower-case function \\(f(t)\\) in terms of two steps: Construct \\(F(t) = \\int f(t) dt\\). Evaluate \\(F(t)\\) at two inputs, e.g. \\(F(t_2) - F(t_1)\\), giving a net change, which we’ll write as \\({\\cal F}(t_1, t_2) = F(t_2) - F(t_1)\\). As a matter of notation, the process of going from \\(f(t)\\) to the net change is written as one statement. \\[{\\cal F}(t_1, t_2) = F(t_2) - F(t_1) = \\int_{t_1}^{t_2} f(t) dt\\] The punctuation \\[\\int_{t_1}^{t_2} \\_\\_\\_\\_ dt\\] captures in one construction both the anti-differentiation step (\\(\\int\\_\\_dt\\)) and the evaluation of the anti-derivative at the two bound \\(t_2\\) and \\(t_1\\). Several names are used to describe the overall process. It is important to become familiar with these. \\(\\int_a^b f(t) dt\\) is called a definite integral of \\(f(t)\\). \\(a\\) and \\(b\\) are called, respectively, the lower bound of integration and the upper bound of integration, although given the way we draw graphs it might be better to call them the “left” and “right” bounds, rather than lower and upper. The pair \\(a, b\\) is called the bounds of integration. As always, it pays to know what kind of thing is \\({\\cal F}(t_1, t_2)\\). Assuming that \\(t_1\\) and \\(t_2\\) are fixed quantities, say \\(t_1 = 2\\) seconds and \\(t_2 = 5\\) seconds, then \\({\\cal F}(t_1, t_2)\\) is itself a quantity. The dimension of that quantity is [\\(F(t)\\)] which in turn is [\\(f(t)\\)]\\(\\cdot\\)[\\(t\\)]. So if \\(f(t)\\) is fuel consumption in liters per second, then \\(F(t)\\) will have units of liters, and \\({\\cal F}(t_1, t_2)\\) will also have units of liters. Remember also an important distinction: \\(F(t) = \\int f(t) dt\\) is a function whose output is a quantity. \\(F(t_2) - F(t_1) = \\int_{t_1}^{t_2} f(t) dt\\) is a quantity, not a function. Of course, \\(f(t)\\) is a function whose output is a quantity. In general, the two functions \\(F(t)\\) and \\(f(t)\\) produce outputs that are different kinds of quantities. For instance, the output of \\(F(t)\\) is liters of fuel while the output of \\(f(t)\\) is liters per second: fuel consumption. Similarly, the output of \\(S(t)\\) is dollars, while the output of \\(s(t)\\) is dollars per day. The use of the term definite integral suggests that there might be something called an indefinite integral, and indeed there is. “Indefinite integral” is just a synonym for “anti-derivative.” In this book we favor the use of anti-derivative because it’s too easy to leave off the “indefinite” and confuse an indefinite integral with a definite integral. Also, “anti-derivative” makes it completely clear what is the relationship to “derivative.” Since 1700, it’s common for calculus courses to be organized into two divisions: Differential calculus, which is the study of derivatives and their uses. Integral calculus, which is the study of anti-derivatives and their uses. Mathematical notation having been developed for experts rather than for students, very small typographical changes are often used to signal very large changes in meaning. When it comes to anti-differentiation, there are two poles of fixed meaning and then small changes which modify the meaning. The poles are: Anti-derivative: \\(\\int f(t) dt\\), which is a function whose output is a quantity. Definite integral \\(\\int_a^b f(t) dt\\), which is a quantity, plain and simple. But you will also see some intermediate forms: \\(\\int_a^t f(t) dt\\), which is a function with input \\(t\\). \\(\\int_a^x f(t) dt\\), which is the same function as in (a) but with the input name \\(x\\) being used. \\(\\int_t^b f(t) dt\\), which is a function with input \\(t\\). Less commonly, \\(\\int_x^t f(t) dt\\) which is a function with two inputs, \\(x\\) and \\(t\\). The same is true of \\(\\int_x^y f(t) dt\\) and similar variations. 29.3 Initial value of the quantity Recall that we’re interested in a real quantity \\({\\mathbf F}(t)\\), but we only know \\(f(t)\\) and from that can calculate an anti-derivative \\(F(t)\\). The relationship between them is \\[{\\mathbf F}(t) = F(t) + C\\] where \\(C\\) is some fixed quantity that we cannot determine directly from \\(f(t)\\). Still, even if we cannot determine \\(C\\), there’s one way we can use \\(F(t)\\) to make definite statements about \\({\\mathbf F}(t)\\). Consider the net change from \\(t_1\\) to \\(t_2\\) in the real quantity \\({\\mathbf F}\\). This is \\[{\\mathbf F}(t_2) - {\\mathbf F}(t_1) = \\left[F(t_2) + C\\right] - \\left[F(t_1) + C\\right] = F(t_2) - F(t_1)\\] In other words, just knowing \\(F(t)\\), we can make completely accurate statements about net changes in the value of \\({\\mathbf F}(t)\\). Let’s develop our understanding of this unknown constant \\(C\\), which is called the constant of integration. To do so, watch the following movie which attempts to show the process of constructing the integral \\[F(t) = \\int_2^t f(t) dt\\ .\\] Figure 29.1: Constructing the anti-derivative \\(F(t)\\) by reading the slope from \\(f(t)\\) and using that slope to extend the picture of \\(F()\\) Focus first on the top graph. The function we are integrating, \\(f(t)\\), is known before we carry out the integration, so it is shown in the top graph. \\(f(t)\\) is the rate of increase in \\(F(t)\\) (or \\({\\mathbf F}(t)\\) for that matter). From the graph, you can read using the vertical axis the value of \\(f(t)\\) for any input \\(t\\). But since \\(f(t)\\) is a rate of increase, we can also depict \\(f(t)\\) as a slope. That slope is being drawn as a \\(\\color{magenta}{\\text{magenta}}\\) arrow. Notice that when \\(f(t)\\) is positive, the arrow slopes upward and when \\(f(t)\\) is negative, the arrow slopes downward. The steepness of the arrow is the value of \\(f(t)\\), so for inputs where the value of \\(f(t)\\) is far from zero the arrow is steeper than for values of \\(f(t)\\) that are near zero. Now look at both graphs, but concentrate just on the arrows in the two graphs. They are always the same: carbon copies of one another. Finally the bottom graph. We’re starting the integral at \\(t_1=2\\). Since nothing has yet been accumulated, the value \\(F(t_1 = 2) = 0\\). From (1) and (2), you know the arrow shows the slope of \\(F(t)\\). So as \\(F(t&gt;2)\\) is being constructed the arrow guides the way. When the slope arrow is positive, \\(F(t)\\) is growing. When the slope arrow is negative, \\(F(t)\\) is going down. In tallying up the accumulation of \\(f(t)\\), we started at time \\(t=2\\) and with \\(F(t=2) = 0\\). This makes sense, since nothing can be accumulated over the mere instant of time from \\(t=2\\) to \\(t=2\\). On the other hand, it was our choice to start at \\(t=2\\). We might have started at another value of \\(t\\) such as \\(t=0\\) or \\(t=-5\\) or \\(t=-\\infty\\). If so, then the accumulation of \\(f(t)\\) up to \\(t=2\\) would likely have been something other than zero. But what if we knew an actual value for \\({\\mathbf F}(2)\\). This is often the case. For instance, before taking a trip you might have filled up the fuel tank. The accumulation of fuel consumption only tells you how much fuel has been used since the start of the trip. But if you know the starting amount of fuel, by adding that to the accumulation you’ll know instant by instant how much fuel is in the tank. In other words, \\[{\\mathbf F}(t) = {\\mathbf F}(2) + \\int_2^t f(t) dt\\ .\\] This is why, when we write an anti-derivative, we should always include mention of some constant \\(C\\)—the so-called constant of integration—to remind us that there is a difference between the \\(F(t)\\) we get from anti-differentiation and the \\({\\mathbf F}(t)\\) of the function we’re trying to reconstruct. That is, \\[{\\mathbf F}(t) = F(t) + C = \\int f(t) dt + C\\ .\\] We only need to know \\({\\mathbf F}(t)\\) at one point in time, say \\(t=0\\), to be able to figure out the value of \\(C\\): \\[C = {\\mathbf F}(0) - F(0)\\ .\\] Another way to state the relationship between the anti-derivative and \\({\\mathbf F}(t)\\) is by using the anti-derivative to accumulate \\(f(t)\\) from some starting point \\(t_0\\) to time \\(t\\). That is: \\[{\\mathbf F}(t) \\ =\\ {\\mathbf F}(t_0) + \\int_{t_0}^t f(t)\\, dt\\ = \\ {\\mathbf F}(t_0) + \\left({\\large\\strut}F(t) - F(t_0)\\right)\\] A famous legend has Galileo at the top of the Tower of Pisa around 1590. The legend illustrates Galileo’s finding that a light object (e.g. a marble) and a heavy object (e.g. a ball) will fall at the same speed. Galileo published his mathematical findings in 1638 in Discorsi e Dimostrazioni Matematiche, intorno a due nuove scienze. (English: Discourses and Mathematical Demonstrations Relating to Two New Sciences) In 1687, Newton published his world-changingPhilosophiae Naturalis Principia Mathematica. (English: Mathematical Principles of Natural Philosophy) Let’s imagine the ghost of Galileo returned to Pisa in 1690 after reading Newton’s Principia Mathematica. In this new legend, Galileo holds a ball still in his hand, releases it, and figures out the position of the ball as a function of time. Although Newton famously demonstrated that gravitational attraction is a function of the distance between to objects, he also knew that at a fixed distance—the surface of the Earth—gravitational acceleration was constant. So Galileo was vindicated by Newton. But, although gravitational acceleration is constant from top to bottom of the Tower of Pisa, Galileo’s ball was part of a more complex system: a hand holding the ball still until release. Acceleration of the ball versus time is therefore approximately a Heaviside function: \\[\\text{accel}(t) \\equiv \\left\\{\\begin{array}{rl}0 &amp; \\text{for}\\ t \\leq 3\\\\ {-9.8} &amp; \\text{otherwise}\\end{array}\\right.\\] accel &lt;- makeFun(ifelse(t &lt;= 3, 0, -9.8) ~ t) Acceleration is the derivative of velocity. We can construct a function \\(V(t)\\) as the anti-derivative of acceleration, but the real-world velocity function will be \\[{\\mathbf V}(t) = {\\mathbf V}(0) + \\int_0^t \\text{accel}(t) dt\\] V_from_antiD &lt;- antiD(accel(t) ~ t) V &lt;- makeFun(V0 + (V_from_antiD(t) - V_from_antiD(0)) ~ t, V0 = 0) In the computer expression, the parameter V0 stands for \\({\\mathbf V}(0)\\). We’ve set it equal to zero since, at time \\(t=0\\), Galileo was holding the ball still. Velocity is the derivative of position, but the real-world velocity function will be the accumulation of velocity from some starting time to time \\(t\\), plus the position at that starting time: \\[x(t) \\equiv x(0) + \\int_0^t V(t) dt\\] We can calculate \\(\\int V(t) dt\\) easily enough with antiD(), but the function \\(x(t)\\) involves evaluating that anti-derivative at times 0 and \\(t\\): x_from_antiD &lt;- antiD(V(t) ~ t) x &lt;- makeFun(x0 + (x_from_antiD(t) - x_from_antiD(0)) ~ t, x0 = 53) We’ve set the parameter x0 to be 53 meters, the height above the ground of the top balcony on which Galileo was standing for the experiment. Figure 29.2: The acceleration, velocity, and position of the ball as a function of time in Galileo’s Tower of Pisa experiment. The ball is released at time \\(t_0\\). In the (fictional) account of the 1690 experiment, we had Galileo release the ball at time \\(t=0\\). That’s a common device in mathematical derivations, but in a physical sense it’s entirely arbitrary. Galileo might have let go of the ball at any other time, say, \\(t=3\\) or \\(t=14:32:05\\). A remarkable feature of integrals is that it doesn’t matter what we use as the lower bound of integration, so long as we set the initial value to correspond to that bound. For a while you were writing integrals like this: \\(\\int_a^b f(t) dt\\). Then you replaced \\(b\\) with the input name \\(t\\) to get \\(\\int_a^t f(t) dt\\). But then you switched everything up by writing \\(\\int_a^t f(x) dx\\). Is that the same as \\(\\int_a^t f(t) dt\\)? If so, why do you get to replace the \\(t\\) with \\(x\\) in some places but not in others? Recall from Chapter 5 that the names used for inputs to a function definition don’t matter so long as they are used consistently on the left and right sides of \\(\\equiv\\). For instance, all these are the same function: \\(f(x) \\equiv m x + b\\) \\(g(t) \\equiv m t + b\\) \\(h(\\text{wind}) \\equiv m \\text{wind} + b\\) Now think about the integral \\(\\int_a^b f(t) dt\\): \\[\\int_a^b f(t) dt = F(b) - F(a)\\ .\\] On the left-hand side, the input name \\(t\\) is prominant, appearing in two places: \\(f(\\color{magenta}{t}) d\\color{magenta}{t}\\). But \\(t\\) is nowhere on the right-hand side. We could have equally well written this as \\(\\int_a^b f(x) dx\\) or \\(\\int_a^b f(\\text{wind}) d\\text{wind}\\). The name we use for the input to \\(f()\\) doesn’t matter so long as it is consistent with the name used in the \\(d\\_\\_\\) part of the notation. Often, the name placed in the blanks in \\(\\int f(\\_\\_) d\\_\\_\\) is called a dummy variable. Writing \\(\\int_a^t f(t) dt\\) is perfectly reasonable, but many authors dislike the multiple appearance of \\(t\\). So they write something like \\(\\int_a^t f(x) dx\\) instead. 29.4 Integrals from bottom to top The bounds of integration appear in different arrangements. None of these are difficult to derive from the basic forms: The relationship between an integral and its corresponding anti-derivative function: \\[\\int_a^b f(x) dx = F(b) - F(a)\\] This relationship has a fancy-sounding name: the second fundamental theorem of calculus. The accumulation from an initial-value \\[{\\mathbf F}(b)\\ =\\ {\\mathbf F}(a) + \\int_a^b f(x) dx\\ = \\ {\\mathbf F}(a) + F(b) - F(a)\\] For many modeling situations, \\(a\\) and \\(b\\) are fixed quantities, so \\(F(a)\\) and \\(F(b)\\) are also quantities; the output of the anti-derivative function at inputs \\(a\\) and \\(b\\). But either the lower-bound or the upper-bound can be input names, as in \\[\\int_0^t f(x) dx = F(t) - F(0)\\] Note that \\(F(t)\\) is not a quantity but a function of \\(t\\). On occasion, you will see forms like \\(\\int_t^0 f(x)dx\\). You can think of this in either of two ways: The accumulation from a time \\(t\\) less than 0 up until 0. The reverse accumulation from 0 until time \\(t\\). Reverse accumulation can be a tricky concept because it violates everyday intuition. Suppose you were harvesting a row of ripe strawberries. You start at the beginning of the row—position zero. Then you move down the row, picking strawberries and placing them in your basket. When you have reached position \\(B\\) your basket holds the accumulation \\(\\int_0^B s(x)\\, dx\\), where \\(s(x)\\) is the lineal density of strawberries—units: berries per meter of row. But suppose you go the other way, starting with an empty basket at position \\(B\\) and working your way back to position 0. Common sense says your basket will fill to exactly the same amount as in the forward direction, and indeed this is the case. But integrals work differently. The integral \\(\\int_B^0 s(x) dx\\) will be the negative of \\(\\int_0^B s(x) dx\\). You can see this from the relationship between the integral and the anti-derivative: \\[\\int_B^0 s(x) dx \\ = \\ S(0) - S(B) \\ =\\ -\\left[{\\large\\strut}S(B) - S(0)\\right]\\ = \\ -\\int_0^B s(x) dx\\] This is not to say that there is such a thing as a negative strawberry. Rather, it means that harvesting strawberries is similar to an integral in some ways (accumulation) but not in other ways. In farming, harvesting from 0 to \\(B\\) is much the same as harvesting from \\(B\\) to 0, but integrals don’t work this way. Another property of integrals is that the interval between bounds of integration can be broken into pieces. For instance: \\[\\int_a^c f(x) dx \\ = \\ \\int_a^b f(x) dx + \\int_b^c f(x) dx\\] You can confirm this by noting that \\[\\int_a^b f(x) dx + \\int_b^c f(x) dx \\ = \\ \\left[{\\large\\strut}F(b) - F(a)\\right] + \\left[{\\large\\strut}F(c) - F(b)\\right] = F(c) - F(a) \\ = \\ \\int_a^c f(x) dx\\ .\\] Finally, consider this function of \\(t\\): \\[\\partial_t \\int_a^t f(x) dx\\ .\\] First, how do we know it is a function of \\(t\\)? \\(\\int_a^t f(x) dx\\) is a definite integral and has the value \\[\\int_a^t f(x) dx = F(t) - F(a)\\ .\\] Following our convention, \\(a\\) is a parameter and stands for a specific numerical value, so \\(F(a)\\) is the output of \\(F()\\) for a specific input. But according to convention \\(t\\) is the name of an input. So \\(F(t)\\) is a function whose output depends on \\(t\\). Differentiating the function \\(F(t)\\), as with every other function, produces a new function. Second, there is a shortcut for calculating \\(\\partial_t \\int_a^t f(x) dx\\): \\[\\partial_t \\int_a^t f(x) dx\\ =\\ \\partial_t \\left[{\\large\\strut}F(t) - F(a)\\right]\\ .\\] Since \\(F(a)\\) is a quantity and not a function, \\(\\partial_t F(a) = 0\\). That simplies things. Even better, we know that the derivative of \\(F(t)\\) is simply \\(f(t)\\): that’s just the nature of the derivative/anti-derivative relationship between \\(f(t)\\) and \\(F(t)\\). Put together, we have: \\[\\partial_t \\int_a^t f(x) dx\\ =\\ f(t)\\ .\\] This complicated-looking identity has a fancy name: the first fundamental theorem of calculus. Backtracking the stars. In the 1920s, astronomers and cosmologists questioned the idea that the large-scale universe is static and unchanging. This traditional belief was undermined both by theory (e.g. General Relativity) and observations. The most famous of these were collected and published by Edwin Hubble, starting in 1929 and continuing over the next decade as improved techniques and larger telescopes became available. In recent years, with the availability of the space telescope named in honor of Hubble data has expanded in availability and quality. Figure 29.3 shows a version of Hubble’s 1929 graph based on contemporary data. Figure 29.3: The relationship between velocity and distance of stars, using contemporary data in the same format at Edwin Hubble’s 1929 publication. Each dot in Figure 29.3 is an exploding star called a supernova. The graph shows the relationship between the distance of the star from our galaxy and the outward velocity of that star. The velocities are large, \\(3 \\times 10^4 = 30,000\\) km/s is about one-tenth the speed of light. Similarly, the distances are big; 600 Mpc is the same as 2 billion light years or \\(1.8 \\times 10^{22} \\text{km}\\). The slope of the line in Figure 29.3 is \\(\\frac{3.75 \\times 10^4\\, \\text{km/s}}{1.8 \\times 10^{22}\\, \\text{km}} = 2.1 \\times 10^{-18}\\, \\text{s}^{-1}\\). For ease of reading, we’ll call this slope \\(\\alpha\\) and therefore the velocity of a start distance \\(D\\) from Earth is \\[v(D) \\equiv \\alpha D\\ .\\] Earlier in the history of the universe each star was a different distance from Earth. We’ll call this function \\(D(t)\\), distance as a function of time in the universe. The distance travelled by each star from time \\(t\\) (billions of years ago) to the present is \\[\\int_t^\\text{now} v(t) dt = D_\\text{now} - D(t)\\] which can be re-arranged to give \\[D(t) = D_\\text{now} - \\int_t^\\text{now} v(t) dt .\\] Assuming that \\(v(t)\\) for each star has remained constant at \\(\\alpha D_\\text{now}\\), the distance travelled by each star since time \\(t\\) depends on it’s current distance like this: \\[\\int_t^\\text{now} v(t) dt = \\int_t^\\text{now} \\left[ \\alpha D_\\text{now}\\right]\\, dt = \\alpha D_\\text{now}\\left[\\text{now} - t\\right]\\] Thus, the position of each star at time \\(t\\) is \\[D(t) = D_\\text{now} - \\alpha D_\\text{now}\\left[\\text{now} - t\\right] = D(t)\\] or, \\[D(t) = D_\\text{now}\\left({\\large\\strut} 1-\\alpha \\left[\\text{now} - t\\right]\\right)\\] According to this model, there was a common time \\(t_0\\) when when all the stars were at the same place: \\(D(t_0) = 0\\). This happened when \\[\\text{now} - t_0 = \\frac{1}{\\alpha} = \\frac{1}{2.1 \\times 10^{-18}\\, \\text{s}^{-1}} = 4.8 \\times 10^{17} \\text{s}\\ .\\] It seems fair to call such a time, when all the stars where at the same place at the same time, as the origin of the universe. If so, \\(\\text{now} - t_0\\) corresponds to the age of the universe and our estimate of that age is \\(4.8\\times 10^{17}\\text{s}\\). Conventionally, this age is reported in years. To get that, we multiply by the flavor of one that turns seconds into years: \\[\\frac{60\\, \\text{seconds}}{1\\, \\text{minute}} \\cdot \\frac{60\\, \\text{minutes}}{1\\, \\text{hour}} \\cdot \\frac{24\\, \\text{hours}}{1\\, \\text{day}} \\cdot \\frac{365\\, \\text{days}}{1\\, \\text{year}} = 31,500,000 \\frac{\\text{s}}{\\text{year}}\\] The grand (but hypothetical) meeting of the stars therefore occurred \\(4.8 \\times 10^{17} \\text{s} / 3.15 \\times 10^{7} \\text{s/year} = 15,000,000,000\\) years ago. Pretty crowded to have all the mass in the universe in one place at the same time. No wonder they call it the Big Bang! 29.5 Exercises Exercise 29.02: DkoUjX As you know, \\[\\int_a^c f(x) dx = \\int_a^b f(x) dx + \\int_b^c f(x) dx\\\\ \\text{and}\\\\\\int_a^c f(x) dx = - \\int_c^a f(x) dx\\ .\\] Here are some definite integrals for which, without stating anything more about the function, we give you the numerical result.       \\(\\int_{2}^{7} f(x) \\,dx = -8\\) \\(\\int_{-6}^{-2} g(x) \\,dx = 3\\) \\(\\int_{2}^{12} f(x) \\,dx = -14\\) \\(\\int_{0}^{2} g(x) \\,dx = 1\\) \\(\\int_{2}^{7} h(x) \\,dx = 5\\) \\(\\int_{0}^{2} h(x) \\,dx = 6\\) Consider these the facts you have to work with when answering the following questions: Question A \\(\\int_{2}^{7} 3f(x) \\,dx =\\)?     -8︎✘ Did you see the three?       -42︎✘ Check the bounds       -24\\(\\heartsuit\\ \\)       13︎✘ Question B \\(\\int_{7}^{12} f(x) \\,dx =\\)? 6︎✘ Be careful with your signs 22︎✘ Be careful with your signs -6Nice!  -22︎✘ Be careful with your signs Question C \\(\\int_{2}^{7} f(x) + g(x) \\,dx =\\)? -3︎✘ Do you know \\(\\int_{2}^{7} g(x) \\,dx\\)? 8︎✘ Do you know \\(\\int_{2}^{7} g(x) \\,dx\\)? -8︎✘ Do you know \\(\\int_{2}^{7} g(x) \\,dx\\)? insufficient information to answer questionCorrect.  Question D \\(\\int_{2}^{2} r(x) \\,dx =\\)? -3︎✘ Look at the bounds 0Good. Even though you don’t know \\(r(x)\\) this is always true when the bounds are the same -8︎✘ Look at the bounds insufficient information to answer question at t︎✘ Look at the bounds Question E \\(\\int_{-6}^{-2} \\left[\\strut g(x)+3\\right] \\,dx =\\)? 6︎✘ You need to integrate the 3 15Correct.  12︎✘ Don’t forget g(x) 3︎✘ Break it up into two different integrals Question F \\(\\int_{12}^{7} f(x) \\,dx =\\) -6︎✘ Be careful with your signs 22︎✘ Be careful with your signs 6Nice!  -22︎✘ Be careful with your signs Exercise 29.04: LCKEs The equation below shows three items, all of which are equivalent even though they look different. You can see this from the equal signs separating the three items. \\[\\large \\int_{\\color{brown}{a}}^{\\color{brown}{b}} {\\color{blue}{f(x)}}\\, dx = {\\color{magenta}{F(x)}}\\left.{\\LARGE\\strut}\\right|_{\\color{brown}{a}}^{\\color{brown}{b}} = {\\color{magenta}{F}({\\color{brown}{b}})} -{\\color{magenta}{F}({\\color{brown}{a}})}\\] When you reach the point where you can say, “That’s obvious,” and can write down the three items from memory, you will have achieved an important facility with calculus. Question A Since the three items are equivalent, they are all the same kind of “thing.” What kind of thing are they? a quantityExcellent! Another term for this is definite integral. Evaluating an anti-derivative at two values of \\(x\\) and subtracting one from the other gives a number. (Remember, in our notation, \\(a\\) and \\(b\\) stand for numerical constants, unless we specifically say otherwise.) a function of \\(x\\)︎✘ Each of the items include something that is a function of \\(x\\), but the entire item is not itself a function of \\(x\\). an interval︎✘ Each of the items includes an interval, but the entire item is not one. an integration bound︎✘ Each of the items includes an upper and lower bound of integration, but the entire item is not one. an anti-derivative︎✘ There is an anti-derivative involved in each item, but the entire item is not one. a constant of integration︎✘ No constant of integration is needed to express any of the items The equation has been written in color to help you identify elements that are the same in each of the three items. Question B Which of the colors stands for a bound of integration?     black︎✘        blue︎✘        brown\\(\\heartsuit\\ \\)       magenta︎✘ Question C Which of the colors stands for the derivative of a function that appears elsewhere in the equation?     black︎✘        blue\\(\\heartsuit\\ \\)       tan︎✘        magenta︎✘ Question D Which of the colors stands for an anti-derivative of a function that appears elsewhere in the equation?     black︎✘        blue︎✘        tan︎✘        magenta\\(\\heartsuit\\ \\) Exercise 29.06: gDSeX Remember our conventions for notation: Fixed quantities (perhaps with units) Symbols: e.g. \\(a\\), \\(b\\), \\(c\\), \\(x_0\\), \\(t^{\\star}\\) Examples: 3.2, 4.8 meters, 17 feet/sec\\(^2\\) Names of inputs to functions Symbols: e.g. \\(x\\), \\(t\\), \\(y\\), \\(u\\), \\(v\\) Examples: position, time, velocity Functions of an input Symbols: e.g. \\(f(x)\\), \\(g(t)\\), \\(h(x, t)\\) Examples: position as a function of time, density as a function of position Functions evaluated at a specific numerical input Symbols: e.g. \\(f(a)\\), \\(g(t_0)\\), \\(h(x^{\\star}, t^{\\star})\\) Examples: velocity at the finish line, starting position In particular, take care to distinguish between these two kinds of symbolic items: \\(f(x)\\), which means \\(f()\\) as a function of \\(x\\) \\(f(x_0)\\), which means the function \\(f()\\) evaluated at the specific input \\(x_0\\), producing a quantity (e.g., 3.5 meters/sec.) A major source of confusion for students is that \\(a\\) is a constant, even though we are not yet saying specifically which numerical value that constant has. Think of \\(a\\) as meaning “insert constant here.” In terms of derivatives … \\(\\partial_x f(a) = 0\\) \\(\\partial_x f(x)\\) is a function \\(\\partial_u f(x) = 0\\), since \\(u\\) and \\(x\\) are different variables. \\(\\partial_u f(u)\\) is a function, the exact same function as in (ii). With this in mind, turn to our three perspectives on a definite integral \\[\\large \\int_{\\color{brown}{a}}^{\\color{brown}{b}} {\\color{blue}{f(x)}}\\, dx = {\\color{magenta}{F(x)}}\\left.{\\LARGE\\strut}\\right|_{\\color{brown}{a}}^{\\color{brown}{b}} = {\\color{magenta}{F}({\\color{brown}{b}})} -{\\color{magenta}{F}({\\color{brown}{a}})}\\] \\(\\color{brown}{a}\\) and \\(\\color{brown}{b}\\) are numerical constants \\(\\color{blue}{f}(x)\\) and \\(\\color{magenta}{F}(x)\\) are functions of \\(x\\) \\(\\color{magenta}{F}(\\color{brown}{a})\\) is the function \\(\\color{magenta}{F}()\\) evaluated at the specific input \\(\\color{brown}{a}\\), producing a quantity. Likewise \\(\\color{magenta}{F}(\\color{brown}{b})\\). Question A What kind of a thing is \\(F(u)\\), according to our notation convention? (Hint: First figure out what kind of thing is \\(u\\), according to the notation conventions.) a fixed quantity︎✘ Is \\(u\\) a quantity in our notation? a function of \\(x\\)︎✘ Close, but not \\(x\\). a function of \\(u\\)Nice! \\(u\\) is the name of an input, according to our convention. a definite integral︎✘ A definite integral would be something like \\(\\int_a^b f(x) dx\\) or \\(\\left. F(x) \\right|_a^b\\) or \\(F(b) - F(a)\\). Question B What kind of a thing is \\(F(a)\\), according to our notation convention? a quantityNice! We’re evaluating \\(F()\\) at a specific numerical value of the input, namely \\(a\\). a function of \\(x\\)︎✘ A function always has one or more variables as input. \\(a\\) is not a variable but a numerical constant. a function of \\(u\\)︎✘ A function always has one or more variables as input. \\(a\\) is not a variable but a numerical constant. a definite integral︎✘ A definite integral would be something like \\(\\int_a^b f(x) dx\\) or \\(\\left. F(x) \\right|_a^b\\) or \\(F(b) - F(a)\\). Question C What kind of a thing is \\(F(u) - F(a)\\), according to our notation convention? a quantity︎✘ According to our conventions, while \\(F(a)\\) is a quantity, \\(F(u)\\) is not a function of \\(x\\)︎✘ Close, but not \\(x\\). a function of \\(u\\)Correct. Since \\(F(u)\\) is a function of \\(u\\), and \\(F(a)\\) is a constant, \\(F(u) - F(a)\\) is a function of \\(u\\) minus a constant, or, in other words, a function of \\(u\\). a definite integral︎✘ A definite integral would be something like \\(\\int_a^b f(x) dx\\) or \\(\\left. F(x) \\right|_a^b\\) or \\(F(b) - F(a)\\). Question D According to our notation convention, what kind of a thing is \\[\\int_a^u f(x) dx \\text{?}\\], a quantity︎✘ According to our conventions, while \\(F(a)\\) is a quantity, \\(F(u)\\) is not a function of both \\(x\\) and \\(u\\)︎✘ The \\(x\\) is just a placeholder name for the “with respect to” input. a function of \\(x\\)︎✘ Close, but not \\(x\\). a function of \\(u\\)Correct. You can see this by referring to the three perspectives equation. \\[\\int_a^u f(x)dx = F(u) - F(a)\\] which is a function of \\(u\\). a definite integral︎✘ Certainly it looks a lot like a definite integral. But \\(u\\) is a variable, not a constant. Question E According to our notation convention, what kind of a thing is \\[\\int_u^b f(x) dx \\text{?}\\], a number︎✘ a function of both x and u︎✘ a function of \\(x\\)︎✘ Close, but not \\(x\\). a function of \\(u\\)Right! You can see this by referring to the three perspectives equation. \\[\\int_u^b f(x)dx = F(b) - F(u)\\] which is a function of \\(u\\). a definite integral︎✘ Certainly it looks a lot like a definite integral. But \\(u\\) is a variable, not a constant. Question F According to our notation convention, what kind of a thing is \\[\\int_u^x f(x) dx \\text{?}\\], a number︎✘ a function of both x and uCorrect. You can see this by referring to the three perspectives equation. \\[\\int_u^x f(x)dx = F(x) - F(u)\\] which is a function of both \\(x\\) and \\(u\\). a function of \\(x\\)︎✘ a function of \\(u\\)︎✘ a definite integral︎✘ Certainly it looks a lot like a definite integral. But \\(x\\) and \\(u\\) are variables, not constants. Now turn to the entities involved in the so-called “First Fundamental Theorem of Calculus.” (“Fundamental theorem” is a highfalutin way of saying something like, “This isn’t obvious at first glance, and so you should be especially careful to memorize it so that you identify it when you see it.” Another way to state it is, “Every function is the derivative of some anti-derivative.” But you knew that already, since “every function has an anti-derivative.”) Here are the entities involved, which you’ll recognize as a slight modification of an earlier statement: \\[\\partial_u \\int_a^u f(x)dx \\ \\ =\\ \\ \\partial_u \\left. F(x) \\right|_a^u \\ \\ = \\ \\ \\partial_u \\left(F(u) - F(a)\\right) .\\] Let’s look at the right-most expression \\(\\partial_u \\left(F(u) + F(a)\\right)\\) and exploit the the derivative of a sum is the sum of the derivatives. So … \\[\\partial_u \\left(F(u) + F(a)\\right) = \\partial_u F(u) - \\partial_u F(a) = \\partial_u F(u)\\] Question G Which of the following correctly justifies the step \\[\\partial_u F(u) - \\partial_u F(a) = \\partial_u F(u)\\ \\text{?}\\] \\(F(a)\\) is a constantCorrect. And the derivative of a constant is always 0. \\(F()\\) is an anti-derivative.︎✘ \\(F(b)\\) does not appear.︎✘ \\(F(u) = \\int f(x) dx\\)︎✘ Taking the left-most and right-most expressions in the above equation, we have \\[\\partial_u \\int_a^u f(x) dx = \\partial_u F(u)\\] Question H Is there an algebraic simplification of \\(\\partial_u F(u)\\)? No, because it depends on what \\(F(u)\\) is.︎✘ But we know what \\(F(u)\\) is: the anti-derivative of \\(f(u)\\). Yes, because \\(\\partial_u F(u)\\) is simply \\(f(u)\\).Excellent!  No, because we could just as easily have written \\(\\partial_x F(x)\\)︎✘ Yes, because it is the same thing as \\(\\partial_x F(x)\\)︎✘ The equation \\[\\partial_u \\int_a^u f(x) dx \\ \\ = \\ \\ f(u)\\] means that “differentiation undoes integration” or, as we’ve been putting it, “differentiation undoes anti-differentiation.” Exercise 29.08: DKwksA In the 1660s, John Boyle made use of then-new instrumentation to measure gas pressure. He discovered what’s now called Boyle’s Law, which says that, at constant temperature in a closed system, pressure times volume is a constant: \\[PV = const\\] In the 1720s, Daniel Fahrenheit developed the first reliable thermometer consisting of a column of mercury in a glass straw. He developed a temperature scale which divided the range from freezing to boiling into 180 small units, which he called “degrees,” as was traditional in measuring angles. (In 1742, Anders Celsius created another scale with freezing at 0 and 100 small units—still called “degrees”—between freezing and boiling. With the availability of reliable thermometers, scientists started to consider the role of temperature in the relationship between pressure and volume. Their many discoveries were eventually synthesized into a “combined gas law” and then into an “ideal gas law” which famously states: \\[PV = nRT .\\] Here, \\(n\\) is “amount” of gas, quantified as the number of moles of the gas in the container, \\(T\\) is temperature, and \\(R\\) is the “ideal gas constant”: \\[R = 8.314 \\text{J}/(\\text{K}\\ \\text{mol})\\] The “mol” cancels out the dimension of \\(n\\), the \\(K\\) cancels out the dimension of \\(T\\), leaving us with \\(PV\\) having the dimension of energy (Joules). The temperature \\(T\\) is measured in degrees Kelvin, which is just like Celsius but moving the location of 0 from freezing to … well … the hypothetical temperature when \\(PV=0\\), which can be estimated by extrapolating measurements of \\(PV(T)\\) (that is, \\(PV\\) as a function of \\(T\\)) to the \\(T\\) where \\(PV = 0\\). Question A It’s convenient to have specific units in mind for pressure and volume. Since \\(P V\\) gives energy, let’s arrange \\(P\\) and \\(V\\) to have units such that when multiplied the result is Joules. What is the expression of the dimension Joule in terms of the SI system, that is, time in seconds, length in meters, and mass in kg? Hint: use the above paragraph and knowing that the units for energy are consistent for potential, kinetic, or other types of energy. \\(kg m^2 s^{-2}\\)Correct.  \\(kg m / s\\)︎✘ This is the units of momentum. \\(kg^2 m^2 s^3\\)︎✘ \\(m^2 / s^2\\)︎✘ Question B In the SI units system, volume has units of cubic meters: \\(m^3\\). What are the SI units for pressure in terms of kg, m, and s? The units of your answer to this question times the units for pressure should be equivilent to your answer from the previous question. \\(kg m^{-1} s^{-2}\\)Good.  \\(kg m^1 s^{-2}\\)︎✘ This is the units of force \\(kg^2 m^1 s^2\\)︎✘ \\(m s^2 / kg\\)︎✘ For use in calculus, it’s helpful to re-write the Ideal Gas Law in functional form. There are several ways to do this. For instance, if we wanted to measure the number of moles of gas in a container, we could use the function \\(n(P, V, T) = PV/RT\\). Here, we’re going to focus on pressure as a function of the other quantities: \\[P(n, V, T) = nRT/V.\\] Now consider a very simple machine consisting of a cylinder, closed on one end and sealed by a movable piston at the other, as in this picture. Source: R. Castelnuovo - Own work, CC BY-SA 3.0 The machine in the picture is more complicated than the simple machine we want to model. The picture includes two small valves at the top of the cylinder connected each to a pipe. Our machine has no valves and no pipes. The cylinder is charged with gas when it is manufactured. After that, nothing material goes in or out of the closed cylinder/piston system. When you push on the cylinder, the volume available for the gas gets smaller and the pressure increases. When you let the cylinder push on you, the volume available gets bigger and the pressure decreases. The amount of gas, \\(n\\), never changes. For simplicity, we’ll imagine that \\(n=1\\) and that the gas is N\\(_2\\). This means the mass of the gas is 0.028 kg. And, to simplify even more, let’s insist that the temperature of the cylinder and its gaseous content does not change from room temperature: 293\\(^\\circ\\) Kelvin. If you start in a high-volume, low-pressure state and push the piston to move to a low-volume, high-pressure state at the same temperature, you will be putting energy into the machine. The “area” of each little box in the graph, that is, pressure times volume, Question C How much energy (in Joules) corresponds to one small rectangle of area in the graph? 500 J︎✘ pick a gray box, what are its dimensions? 625 JCorrect.  2500 J︎✘ pick a gray box, what are its dimensions? 25,000 J︎✘ This is four gray boxes, not one Question D By counting rectangles in the graph, estimate how much energy needs to be put into the machine when the volume changes from 7.5 m\\(^3\\) to 2.5 m\\(^3\\) at a temperature of 300 K?     1000 J︎✘        3000 J\\(\\heartsuit\\ \\)       5000 J︎✘        10,000 J︎✘ Now that you have compressed the gas in the cylinder, by doing work on it, let’s heat up the machine to 1200K. Question E What will be the pressure of the gas when the volume of the machine is 2.5 m\\(^3\\) at temperature 1200 K? (The units will be kg m$^{-1} \\(s^{-2}\\))     1000︎✘        2000︎✘        3000︎✘        4000\\(\\heartsuit\\ \\) Question F Starting with the machine at 1200K and a volume of 2.5 m\\(^3\\), how much energy will the machine transfer to you when it expands to 7.5 m\\(^3\\)? Estimate this by counting squares in the graph.     about 5000 J︎✘        about 10,000 J\\(\\heartsuit\\ \\)       about 50,000 J︎✘        about 100,000 J︎✘ The net work done by the machine in completing the cycle, shifting from compression at low temperature to expansion at high temperature, is the difference between the energy put out by the machine when expanding and the energy put into the machine to compress the gas. Such a machine is called a “heat engine” since it turns a source of high temperature and a source of low temperature into energy. In a SANDBOX, evaluate the code below. The first line defines a function \\(P(V, T)\\) with default \\(n=1\\) mole of gas. Anti-differentiate \\(P()\\) with respect to \\(V\\) then calculate the energy needed to compress the cylinder at the low temperature, that is \\[\\int_{7.5}^{2.5} P(V, T=300) dV .\\] Call this numerical result compress_energy. Similarly, calculate the energy done by the machine in the high-temperature expansion \\[\\int_{2.5}^{7.5} P(V, T=1200) dV .\\] Call this numerical result expand_energy. You may want to make a graph of your \\(P(V, T)\\) function to check that it is right. Also, check that the integrals are right by comparing them to the rough estimate you made earlier by counting squares. P &lt;- makeFun( n*8.314*T/V ~ V + T, n=1) antiP &lt;- makeFun(n*8.314*T*log(V) ~ V + T, n=1) compress_energy &lt;- ... evaluate antiP appropriately expand_energy &lt;- ... ditto compress_energy # prints out the values expand_energy Exercise 29.10: ikgl The function windspeed(t) records wind speed at the site of a wind-turbine farm over one day, that is, \\(0 \\leq t \\leq 24\\) hours. The function speed2power(s) is the production function for the model of wind turbine used at the farm: the input is speed in miles per hour, the output is in kilowatts. (Both these functions were created for this exercise. They are not about a real turbine at a real wind farm, but are somewhat realistic.) Hint: you can nest a function inside of another function. For instance, if I had a function (‘solarpanelpower’) that calculates the amount of power a solar panel generates and another function (‘sunlight’) that tells me the amount of sunlight at time of the day (‘TOD’). I could evaluate this in one step like the following: ‘solarpanelpower(sunlight(TOD))’. This would give me the amount of power from the solar panel based upon the time of the day. Your task, find the total energy generated over the 24-hour period by the turbine. Reminder: energy \\(E\\) is electric power multiplied by time. Or, more usefully for this problem, the increment energy \\(dE\\) generated at time \\(t\\) is the product of power at time \\(t\\) multiplied by the increment of time \\(dt\\), that is, \\(dE = p(t) dt\\). Consequently, \\[E = \\int_\\text{morning}^\\text{night} p(t) dt\\] where “morning” should really be 00:00 h and night 24:00 h on the day in question. We don’t have an algebraic formula for windspeed(t) even though it is a function. You can use antiD() to find the anti-derivative of the electric power function. The answer you compute should be saved to the name result. The units will be in kWh – kilowatt hours. # ignore these definitions. They are setting up the # functions for you to use tmp &lt;- rfun(~ t, seed=982) tmp2 &lt;- rfun(~ t, seed = 2932) tmp3 &lt;- rfun(~ t, seed = 43) windspeed &lt;- function(t) { abs(tmp((t - 5)*3) + tmp2((t - 10)*2) + tmp3((t - 15)*4)) } speed2power &lt;- function(s) { pmin(ifelse(s &lt; 5, 0, (s-2)^3), 5000) } #Your work starts here slice_plot(windspeed(t) ~ t, domain(t=c(0, 24))) # # Uncomment the next lines as you figure out how to fill in the &quot;...blanks...&quot; # antid_of_power &lt;- antiD( ....power_function_here(t)... ~ t) # result &lt;- antid_of_power(...night...) - antid_of_power(...morning...) # result # this prints out the result Question A Wind turbines of this type have a maximum power rating of 5000 kilowatts. Was this rating exceeded at any point during the day? The maximum instantaneous power was about 3500 kilowatts︎✘ The maximum instantaneous power was about 1100 kilowatts︎✘ That threshold was reached about 9 AMRight!  That threshold was exceeded about 8 AM︎✘ The maximum instantaneous power cannot be determined from the information given.︎✘ Question B At the maximum power rating of 5000 kilowatts, what’s the theoretical maximum amount of energy produced by the turbine over a 24-hour day? 5000 * 24 kilowatt-hoursGood.  5000 / 24 kilowatt-hours︎✘ The units, kilowatt hours, should remind you that power is multiplied by time. 5000 kilowatts︎✘ That’s the power rating. We want to know the amount of energy. Can’t be determined from the information given.︎✘ Question C About what fraction of the theoretical maximum energy did the wind turbine generate over the 24-hour period? About 2.5%︎✘ About 10%Good.  About 25%︎✘ About 50%︎✘ Can’t be determined from the information given.︎✘ Question D A peak time for residential energy consumption is from 7 am to 9 am. The price at which you can sell electrical energy to the grid operator is $0.09 per kilowatt-hour. At that price, how much would the energy produced from 7-9 am be worth? About 20 cents.︎✘ That would be the answer if the turbine generated only 1 kilowatt of power during that period. About $150︎✘ About $350Nice!  About $650︎✘ Question E What’s the average wind speed over the 24-hour period?     About 5 mph\\(\\heartsuit\\ \\)       About 7 mph︎✘        About 9 mph︎✘ Question F Wind speed fluctuates a lot, but imagine that the wind blew steadily at the average wind speed from the previous problem. How much energy would be generated over the 24-hour period? 0 kilowatt hoursRight! That wind wouldn’t be strong enough to turn the turbine. 500 kilowatt hours︎✘ 1000 kilowatt hours︎✘ 10,000 kilowatt hours︎✘ Exercise 29.12: JKLes The (so-called) “First Fundamental Theorem of Calculus” says: \\[\\partial_t \\int_a^t f(x) dx \\ = \\ f(t)\\] Question A Consider this new quantity: \\[\\partial_t \\int_t^a f(x) dx\\] Which of the following is a valid simplification of the quantity?     \\(f(t)\\)︎✘        \\(f(-t)\\)︎✘        \\(-f(t)\\)\\(\\heartsuit\\ \\)       none of the above︎✘ An app. Exercise 29.14: Hd5zsE Your house has solar panels on the roof. In sunshine, these generate power. You use some of that power immediately for cooking, lighting, and such. Any power generated above your needs gets stored in a battery. Any power used above the solar generation gets supplied by the battery. Over the course of a day, your use of power fluctuates (you use the toaster, open the refrigerator, etc). Similarly, the solar generation fluctuates as clouds pass by and the sun rises and sets in the sky. The amount of energy stored in the battery fluctuates over the day as you consume energy in your home and produce it with the solar panels. The unit used for electrical power is a “kilowatt” (kW). An old-fashioned incandescent light bulb consumes about 0.1 kW while lighted, a modern LED bulb generates about the same amount of light using only 0.01 kW. A refrigerator uses about 0.1 kW while a hair-dryer uses about 1 kW when it is running. Batteries store energy. The usual unit for energy is “kilowatt-hour” (kWh). A refrigerator will, over a 24-hour day, use 0.1 * 24 = 2.4 kWh. Power multiplied by time duration gives energy. If the power were constant, the energy could be calculated by a simple multiplication of the power over the duration. Since power fluctuates, we can’t do the calculation with ordinary multiplication. Instead, we have to integrate power over time. For this activity, use the “Solar-panels” App. Add picture/link to app. Question A Why is it called “net production” instead of just “production?” Because your house is connected to the utility electrical network in case you need extra power.︎✘ Because the system designer is something of a poet and wants you to think of the solar cells as a kind of fishing net harvesting photons.︎✘ Because the government will send you surplus hair nets to thank you for reducing CO2 production.︎✘ Because it’s not simply production from the solar panels but production minus consumption (the solar panels require energy to run). If you ignored consumption, you would call it “gross energy produced.”Right!  Question B The bottom graph shows energy accumulated in the battery since midnight. What does it mean that the energy accumulated is negative? The battery level is lower throughout the day than it was at midnight.Excellent!  The battery is discharging over the entire day.︎✘ It’s the top graph, net power production, that tells if if the battery is charging (positive net production) or discharging (negative net production). So this statement is not always accurate The sign is not important.︎✘ The sign is important Question C During the interval from 05:00 to 20:00, how much did the energy stored by the battery change? Highlight that interval in the beeps graph. -2.5 kWh︎✘ Is there more or less energy in the battery between these two points? 1.9 kW︎✘ Energy has units kWh, not kW. 15 hours︎✘ This is the length of the interval, not the energy stored. 1.5 kWhCorrect. You an calculate this by taking the difference between the relative battery level at the end of the interval and at the start of the interval. These values are shown as blue dots on the bottom graph (if you used the cursor to highlight the interval). Question D Suppose the battery was holding 20 kWh at 00:00. How much energy was it holding at 15:00? -2 kWh︎✘ This is the change in the battery energy level, what is the actual value at the level? 18 kWhCorrect.  20 kWh︎✘ 24 kWh︎✘ Question E When you choose a time interval in the beep graph, how come the energy stored (in kWh) is displayed as an area in the top graph? Keep in mind that the vertical scale of the top graph is kW, not kWh. It’s pretty.︎✘ Thanks. But there’s a better reason that’s relevant to calculus. To highlight visually the interval that that was selected.︎✘ There would be other ways to show the interval. To convert kW to kWh, we are effectively multiplying the power (kW) by the time duration. Power is on the vertical axis, time duration is on the horizontal axis. Multiplying the two corresponds to the area under the graph.Correct. In this instance, energy is acting as the anti-derivative of the power function with respect to time Question F How come two different colors are used to display the “area” under the net power curve? The second derivative of the anti-derivative of \\(f(t)\\) is equal to \\(f(t)\\).︎✘ The statement is true, but it’s irrelevant to the question being asked. No reason related to calculus per se. We like to make graphs pretty.︎✘ Because it’s not simply “area.” It’s the product of net power and time duration, and sometimes this quantity is negative. The color indicates whether the quantity is positive or negative at any instant.Good.  Exercise 29.16: Rr2ds Suppose the continuous function \\(f(x)\\) is positive on \\(x \\in [0, 4]\\) and negative on \\(x \\in [4, 8]\\). Let \\[F(x) \\equiv \\int_0^x f(u) du.\\] In addition, suppose \\(\\int_0^8 f(x)dx &lt; 0\\). Mark each statement as True or False. Question A \\(F(x)\\) has to be positive on [0,4] and negative on [4, 8].     True︎✘        False\\(\\heartsuit\\ \\) Question B \\(F(x)\\) must cross the x-axis at least once in the interval [0, 8].     True\\(\\heartsuit\\ \\)       False︎✘ Question C \\(F(0) &lt; F(8)\\).     True︎✘        False\\(\\heartsuit\\ \\) Question D \\(F(x)\\) is concave up on [0, 4] and concave down on [4, 8].     True︎✘        False\\(\\heartsuit\\ \\) Question E \\(F(x)\\) has a local maximum at x = 4.     True\\(\\heartsuit\\ \\)       False︎✘ Question F \\(F(x)\\) has a point of inflection at x=4.     True︎✘        False\\(\\heartsuit\\ \\) Momentum is velocity times mass. Newton’s Second Law of Motion stipulates that force equals the rate of change of momentum.↩︎ "],["integrals-step-by-step.html", "Chapter 30 Integrals step-by-step 30.1 Euler method 30.2 Area 30.3 The Euler Step 30.4 Better numerics (optional) 30.5 Exercises", " Chapter 30 Integrals step-by-step The setting for anti-differentiation (and it’s close cousin, integration) is that we have a function \\(F(t)\\) which we do not yet know, but we do have access to some information about it: its slope as a function of time \\(f(t) \\equiv \\partial_t F(t)\\) and, perhaps, its value \\(F(t_0)\\) at some definite input value. Chapter 28 showed some ways to visualize the construction of an \\(F(t)\\) by accumulating short segments of slope. The idea is that we know \\(f(t)\\) which tells us, at any instant, the slope of \\(F(t)\\). So, in drawing a graph of \\(F(t)\\), we put our pen to paper at some input value \\(t_0\\) and then move forward in \\(t\\), setting the instantaneous slope of our curve according to \\(f(t)\\). In Chapter 29, we dealt with one of the limitations of finding \\(F(t)\\) by anti-differentiation of \\(f(t)\\); the anti-derivative is not unique. This is because to start drawing \\(F(t)\\) we need pick a \\(t_0\\) and an initial value of \\(F(t_0)\\). If we had picked a a different starting point \\(t_1\\) or a different initial value \\(F(t_1)\\), the new curve would be different than the one drawn through \\((t_0, F(t_0))\\), although it would have the same shape, just shifted up or down according to our choice. We summarize this situation algebraically by writing \\[\\int f(t) dt = F(t) + C\\ ,\\] where \\(C\\) is the constant of integration, that is, the vertical shift of the curve. The non-uniqueness of \\(F(t)\\) does not invalidate its usefulness. In particular, the quantity \\(F(b) - F(a)\\), will be the same regardless of which starting point we used to draw \\(F(t)\\). We have two names for \\(F(b) - F(a)\\) The net change in \\(F()\\) from \\(a\\) to \\(b\\). The definite integral of \\(f()\\) from \\(a\\) to \\(b\\), written \\(\\int_a^b f(t) dt\\). These two things, the net change and the definite integral, are really one and the same, a fact we describe by writing \\[\\int_a^b f(t) dt = F(b) - F(a)\\ .\\] In this chapter, we’ll introduce a simple numerical method for calculating from \\(f()\\) the net change/definite integral. This will be a matter of trivial but tedious arithmetic: adding up lots of little bits of \\(f(t)\\). Later, in Chapter 31, we’ll see how to avoid the tedious arithmetic by use of algebraic, symbolic transformations. This symbolic approach has great advantages, and is the dominant method of anti-differentiation found in college-level science textbooks. However, there are many common \\(f(t)\\) for which the symbolic approach is not possible, whereas the numerical method works for any \\(f(t)\\). Even more important, the numerical technique has a simple natural extension to some commonly encountered accumulation problems that look superficially like they can be solved by anti-differentiation but rarely can be in practice. We’ll meet one such problem and solve it numerically, but a broad approach to the topic, called dynamics or differential equations, will have to wait until Block 6. 30.1 Euler method The starting point for this method is the definition of the derivative of \\(F(t)\\). Reaching back to Chapter 8, \\[\\partial_t F(t) \\equiv \\lim_{h\\rightarrow 0} \\frac{F(t+h) - F(t)}{h}\\] To translate this into a numerical method for computing \\(F(t)\\), let’s write things a little differently. First, since the problem setting is that we don’t (yet) know \\(F(t)\\), let’s refer to things we do know. In particular, we know \\(f(t) = \\partial_t F(t)\\). Again, recognizing that we don’t yet know \\(F(t)\\), let’s re-write the expression using something that we do know: \\(F(t_0)\\). Stated more precisely, \\(F(t_0)\\) is something we get to make up to suit our convenience. (A common choice is \\(F(t_0)=0\\).) Let’s replace the symbol \\(h\\) with the symbol \\(dt\\). Both of them mean “a little bit of” and \\(dt\\) makes explicit that we mean “a little bit of \\(t\\).” We’ll substitute the limit \\(\\lim_{h\\rightarrow 0}\\) with an understanding that \\(dt\\) will be something “small.” How small? We’ll deal with that question when we have to tools to answer it. With these changes, we have \\[f(t_0) = \\frac{F(t_0+dt) - F(t_0)}{dt}\\ .\\] The one quantity in this relationship that we do not yet know is \\(F(t_0 + dt)\\). So re-arrange the equation so that we can calculate the unknown in terms of the known. \\[F(t_0 + dt) = F(t_0) + f(t_0)\\, dt\\ .\\] Example 30.1 Let’s consider finding the anti-derivative of \\(\\dnorm()\\), that is, \\(\\int_0^t \\dnorm(x) dx\\). In one sense, you already know the answer, since \\(\\partial_x \\pnorm(x) = \\dnorm(x)\\). In reality, however, we know \\(\\pnorm()\\) only because it has been numerically constructed by integrating \\(\\dnorm()\\). The \\(\\pnorm()\\) function is so important that the numerically constructed answer has been memorized by software. 30.2 Area The quantity \\[\\Large \\color{magenta}{f(t_0)}\\, \\color{orange}{dt}\\] gives rise to a visualization that has been learned by generations of calculus students. The visualization is so compelling and powerful that many students (and teachers, and textbook authors) mistake the visualization for integration and anti-differentiation themselves. We’ll start the visualization with a simple graph of \\(f(t)\\), which is called the integrand in the integral \\(\\int_a^b f(t) dt\\). Figure 30.1 shows the graph of \\(f(t)\\). A specific point \\(t_0\\) has been marked on the horizontal axis. Next to it is another mark at \\(t_0 + dt\\). Of course, the distance between these marks is \\(\\color{orange}{dt}\\). ## Warning in is.na(x): is.na() applied to non-(list or vector) of type ## &#39;expression&#39; Figure 30.1: Illustrating the interpretation of \\(f(t_0) dt\\) as an “area”. Per the usual graphical convention, a position along the vertical axis corresponds to a possible output of \\(f(t)\\). The output for \\(t=t_0\\) is \\(\\color{magenta}{f(t_0)}\\). That same quantity corresponds to the length of the vertical orange segment connecting \\((t_0, 0)\\) to \\((t_0, f(t_0))\\). The \\(\\color{orange}{dt}\\) line segment and the \\(\\color{magenta}{f(t_0)}\\) segment constitute two sides of a rectangle, shown as a shaded zone. The “area” of that rectangle is the product \\(\\color{magenta}{f(t_0)}\\ \\color{orange}{dt}\\). In this sort of visualization, an integral is the accumulation of many of these \\(f(t) dt\\) rectangles. For instance, Figure 30.2 the visualization of the integral \\[\\int_{0}^3 f(t) dt\\ .\\] ## Warning in is.na(x): is.na() applied to non-(list or vector) of type ## &#39;expression&#39; ## Warning in is.na(x): is.na() applied to non-(list or vector) of type ## &#39;expression&#39; ## Warning in is.na(x): is.na() applied to non-(list or vector) of type ## &#39;expression&#39; Figure 30.2: Visualizing the integral \\(\\int_0^3 f(t) dt\\) as the total “area” of several \\(f(t) dt\\) bars. The width of each of the bars is \\(dt\\). The height depends on the value of the function \\(f(t)\\) at the bar. For illustration, two of the bars are marked with vertical and horizontal line segments. As always in calculus, we imagine \\(dt\\) as a “small” quantity. In Figure 30.3 you can see that the function output changes substantially over the sub-domain spanned by a single rectangle. Using smaller and smaller \\(dt\\), as in Figure ?? brings the visualization closer and closer to the actual meaning of an anti-derivative. Figure 30.3: Visualizing the integral \\(\\int_0^3 f(t) dt\\) as the total “area” of several \\(f(t) dt\\) bars. The width of each of the bars is \\(dt\\). The height depends on the value of the function \\(f(t)\\) at the bar. For illustration, two of the bars are marked with vertical and horizontal line segments. Why do you keep putting “area” in quotes? When \\(f(t_i) &lt; 0\\), then \\(f(t_i) dt\\) will be negative. There is no such thing as a negative area, but in constructing an integral the \\(f(t_i)dt\\), being negative, diminishes the accumulated area. Figure 30.4: The \\(\\int_{-2}^3 g(t) dt\\) covers subdomains where \\(g(t) &gt; 0\\) and where \\(g(t) &lt; 0\\). In those latter subdomains, the “area” is negative, and shown in light orange here. Another problem is that area is a physical quantity, with dimension L\\(^2\\). The quantity produced by integration will have physical dimension \\([f(t)][t]\\), the product of the dimension of the with-respect-to quantity and the output of the function. “Area” is an effective metaphor for visualizing integration, but the goal of integration is not to calculate an area but, typically, some other kind of quantity. 30.3 The Euler Step The previous section a visualization of an integral in terms of an area on a graph. As you know, a definite integral \\(\\int_a^b f(t) dt\\) can also be computed by constructing the anti-derivative \\(F(t) \\equiv \\int f(t) dt\\) and evaluating it at the upper and lower bounds of integration: \\(F(b) - F(a)\\). In this section, we’ll look at the numerical process of constructing an anti-derivative function, which uses many of the same concepts as those involved in finding an integral by combining areas of rectangles. A definite integral produces a quantity, not a function. The anti-derivative function constructed by using quantities like \\(f(t) dt\\) will be a series of quantities rather than a formula. In particular, it will have the form of a data table, something like this: \\(t\\) \\(F(t)\\) -2 10.62 -1.5 6.47 -1 3.51 -0.5 2.02 0 2.4 0.5 3.18 1.0 5.14 \\(\\vdots\\) \\(\\vdots\\) To start, we’ll need to create a series of \\(t\\) values. We’ll do this by specifying a starting value for \\(t\\) and then creating successive values by adding a numerical increment \\(dt\\) to the entries one after the other until we reach a terminating value. For instance, in the above table, the starting value for \\(t\\) is \\(-2\\), the numerical increment is \\(dt=0.5\\), and the terminating value is \\(1\\). In previous chapters of this book we have worked with data tables, but always the data table was given to us, we did not have to construct it.2 Now we need to construct the data frame with the \\(t\\) column containing appropriate values. Computer languages provide many ways to accomplish this task. We’ll use a simple R/mosaic function Picket(), which constructs a data table like the one shown above. You provide two arguments: the domain for \\(t\\), that is, the desired upper and lower bounds of integration; the interval size \\(dt\\) (which is called h in the argument list). For instance, to construct the \\(t\\) column of the table shown above, you can use Picket() this way: Pts &lt;- Picket(domain(t = -2:1), h=0.5) Pts ## # A tibble: 6 × 3 ## t preweight weight ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 -2 1 0.5 ## 2 -1.5 1 0.5 ## 3 -1 1 0.5 ## 4 -0.5 1 0.5 ## 5 0 1 0.5 ## 6 0.5 1 0.5 As you can see, the data table produced by Picket() has the \\(t\\) column, as well as a second column named weight. We haven’t explained weight yet, but you can see that it is the same value we specified as h. The name Picket() is motivated by the shape of a picket fence. The pickets are evenly spaced, which keeps things simple but is not a requirement. Note that the picket does not say anything at all about the function \\(f(t)\\) being anti-differentiated. The picket can be applied to any function although precision might require a smaller \\(dt\\) for functions that have a lot going on in a small domain. The next step in using the picket to perform anti-differentiation is to apply the function \\(f()\\) to the pickets. That is, we’ll add a new column, perhaps called vals to the data table. Adding a new column is a common task when dealing with data. We’ll do this with a new function, mutate(), whose specific function is adding new columns (or modifying old ones). Here’s the command to apply \\(f()\\) to t and call the new column vals: # Find the height of the pickets Pts &lt;- Pts %&gt;% mutate(vals = f(t)) With this modification, the data table looks like: ## # A tibble: 6 × 4 ## t preweight weight vals ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 -2 1 0.5 -9.12 ## 2 -1.5 1 0.5 -7.27 ## 3 -1 1 0.5 -4.50 ## 4 -0.5 1 0.5 -1.46 ## 5 0 1 0.5 1.28 ## 6 0.5 1 0.5 3.31 Now that we know the value of the function at each of the pickets, the next step is to multiply the value by the spacing between pickets. That spacing, which we set with the argument h = 0.5 in our original call to Picket() is in the column called weight. We’ll call the result of the multiplication step. Note that the following R command incorporates the previous calculation of vals; we’re looking to build up a single command that will do all the work. # Multiply the height by the picket spacing Pts &lt;- Pts %&gt;% mutate(vals = f(t), step = vals * weight) Pts ## # A tibble: 6 × 5 ## t preweight weight vals step ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 -2 1 0.5 -9.12 -4.56 ## 2 -1.5 1 0.5 -7.27 -3.63 ## 3 -1 1 0.5 -4.50 -2.25 ## 4 -0.5 1 0.5 -1.46 -0.732 ## 5 0 1 0.5 1.28 0.639 ## 6 0.5 1 0.5 3.31 1.66 We used the name step to identify the product of the height and spacing of the pickets to help you think about the overall calculation as accumulating a series of steps. Each step provides a little more information about the anti-derivative that we will now calculate. In terms of the area metaphor for integration, each step is the area of one vertical bar of the sort presented in the previous section. We’ll call these Euler steps, a term that will be especially appropriate when, in Block 6, we use integration to calculate the trajectories of systems—such as a ball in flight—that change in time. The final step in constructing the anti-derivative is to add up the steps. This is simple addition. But we’ll arrange the addition one step at a time. That is, for the second row, the result will be the sum of the first two steps. For the third row, the result will be the sum of the first three steps. And so on. The name for this sort of accumulation of the previous steps is called a cumulative sum. Another name for a cumulative sum is a “running sum”: the sum-so-far as we move down the column of steps. Cumulative sums are computed in R by using cumsum(). Here, we’re calling the result of the cumulative sum F to emphasize that it is the result of anti-differentiating \\(f()\\). But keep in mind that the anti-derivative is not just the F column, but the table with both t and F columns. That is, the table has a column for the input as well as the output. That’s what it takes to be a function. # Doing everything in one command Pts &lt;- Picket(domain(t = -2:1), h=0.5) %&gt;% mutate(vals = f(t), step = vals * weight, F = cumsum(step)) ## # A tibble: 6 × 6 ## t preweight weight vals step F ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 -2 1 0.5 -9.12 -4.56 -4.56 ## 2 -1.5 1 0.5 -7.27 -3.63 -8.19 ## 3 -1 1 0.5 -4.50 -2.25 -10.4 ## 4 -0.5 1 0.5 -1.46 -0.732 -11.2 ## 5 0 1 0.5 1.28 0.639 -10.5 ## 6 0.5 1 0.5 3.31 1.66 -8.88 We can summarize the steps in this Euler approach to numerical integration graphically: ## Scale for &#39;y&#39; is already present. Adding another scale for &#39;y&#39;, which will ## replace the existing scale. Figure 30.5: Steps in a numerical construction of an anti-derivative. (1) Create a set of picket locations over the domain of interest. The locations are spread horizontally by amount dt, so each picket will be dt units wide. (2) evaluate the original function at the picket points to give picket heights. (3) Multiply the picket height by the picket width to create an “area”. (4) Starting at zero for the left-most picket, add in successive picket areas to construct the points on the anti-derivative function (green). Note that the vertical axis in (4) has a different dimension and units than in steps (1)-(3). In (4) the vertical scale is in the units of the anti-derivative function output. Figure 30.6 shows a dynamic version of the process of constructing an anti-derivative by Euler steps. The integrand \\(f(t)\\) is shown in the top panel, the anti-derivative \\(F(t)\\) is shown being built up in the bottom panel. The \\(\\color{magenta}{\\text{magenta}}\\) bar in the top plot is the current Euler step. That step is added to the previously accumulated steps to construct \\(F(t)\\). Figure 30.6: A dynamic view of building \\(F(t)\\) from \\(f(t)\\) by accumulating Euler steps. 30.4 Better numerics (optional) Except as a textbook exercise, you will likely never have to compute a numerical anti-derivative from scratch as we did in the previous section. This is a good thing. To understand why, you have to know one of the important features of modern technical work. That feature is: We never work alone in technical matters. There is always a set of people whose previous work we are building on, even if we never know the names of those people. This is because technology is complicated and it is evidently beyond the reach of any human to master all the salient aspects of each piece of technology being incorporated into the work we consider our own. Of course this is true for computers, since no individual can build a useful computer from first principles. It’s also true for software. One detail in particular is relevant to us here. Computer arithmetic of the sort used in the previous section—particularly addition—is prone to error when adding up lots and lots of small bits. This means that it is not always sensible to choose very small \\(dt\\) in order to get a very accurate approximation to the anti-derivative. Fortunately, there are specialists in numerical mathematics who work on ways to improve the accuracy of calculations for mid-sized \\(dt\\). Their work has been incorporated into the results of antiD() and Integrate() and so the details are, for us, unimportant. But they are only unimportant because they have been taken care of. To illustrate how considerably more accuracy can be gained in calculating an anti-derivative, consider that the rectangular bars drawn in the previous sections are intended to approximate the “area” under the function. With this in mind, we can replace the rectangular bars with more suitable shapes that stay closer to the function over the finite extend of each \\(dt\\) domain. The rectangular bars model the function as piecewise constant. A better job can be done with piecewise linear approximations or piecewise quadratic approximations. Often, such refinements can be implemented merely by changing the weight column in the picket data frame used to start off the process. One widely used method, called Gauss-Legendre quadrature can calculate a large segment of an integral accurately (under conditions that are common in practice) with just five evaluations of the integrand \\(f(t)\\). For the integral \\(\\int_a^b f(t) dt\\) the picket locations and weights have these values: location weight \\(c - 0.90618 w\\) \\(0.236927 \\times w\\) \\(c - 0.53847 w\\) \\(0.478629 \\times w\\) \\(c\\) \\(0.568889 \\times w\\) \\(c + 0.53847 w\\) \\(0.478629 \\times w\\) \\(c + 0.90618 w\\) \\(0.236927 \\times w\\) where \\(c = \\frac{a+b}{2}\\) and \\(w = (b-a)/2\\). The locations and weights may seem like a wizard parody of mathematics, but those precise values are founded in an advanced formulation of polynomials rooted in the theory of linear combinations to which you’ll be introduced in Block 5. Needless to say, you can hardly be expected to have any idea where they come from. That’s why it’s useful to build on the work of experts in specialized areas. It’s particularly helpful when such expertise is incorporated into software that faithfully and reliably implements the methods. The lesson to take to heart: Use professional software systems that have been extensively vetted. 30.5 Exercises Exercise 30.02: ady5Fh The output of a function, being a quantity, has dimension and units. Suppose the dimension of the output of a function \\(v(t)\\) is \\(L/T\\), for instance, meters-per-second. The anti-derivative function \\(V(t) \\equiv \\int v(t) dt\\) will also have dimension and units. Recall that in constructing the anti-derivative using the Euler method, we multiply the values of \\(v(t)\\) times some small increment in the input, \\(h\\). Therefore the dimension of the output of \\(V(t)\\) will be \\([v(t)] [t]\\). So if \\([v(t)] = L/T\\), the dimension \\([V(t)] [t] = L T/T = L\\). Units for such a dimension would be, for instance, meters. This makes sense, since if you accumulate velocity (meters-per-sec) over an interval of time (sec) you end up with the distance travelled (meters). Suppose you know the acceleration \\(a(t)\\) of an object as a function of time. The dimension of acceleration is \\(L/T^2\\). askMC( &quot;What is the dimension of $$\\\\int a(t) dt\\\\ \\\\text{?}$$&quot;, &quot;$L/T^3$&quot;, &quot;$L$&quot;, &quot;$LT$&quot;, &quot;+$L/T$+&quot;, &quot;$LT^2$&quot; ) Question A What is the dimension of \\[\\int a(t) dt\\ \\text{?}\\]     \\(L/T^3\\)︎✘        \\(L\\)︎✘        \\(LT\\)︎✘        \\(L/T\\)\\(\\heartsuit\\ \\)       \\(LT^2\\)︎✘ Suppose you know the power consumed by an appliance \\(p(t)\\) as a function of time. Typically appliances have a cycle and use different amounts of power during different parts of the cycle. (Think of a clothes washer.) askMC( &quot;What will be the dimension of $\\\\int p(t) dt\\\\ \\\\text{?}$&quot;, &quot;+energy+&quot;, &quot;force&quot;, &quot;acceleration&quot;, &quot;length&quot; ) Question B What will be the dimension of \\(\\int p(t) dt\\ \\text{?}\\)     energy\\(\\heartsuit\\ \\)       force︎✘        acceleration︎✘        length︎✘ Exercise 30.04: CCwWGB In this activity, you are going to use the “Graph-antiD” web app which enables you to visualize the anti-derivative function in terms of areas. To use the app, click-drag-and-release to mark part of the domain of the function being displayed. Add a picture of the app and a link to it. To answer these questions correctly, you must set the “Shape of function” box to 864. askMC( &quot;A. From the graph, roughly estimate $$\\\\int_0^3 f(t)dt$$ Choose the closest numerical value from the following. You could use either graph for this caclulation, but $F(t)$ will be simpler algebra.&quot;, -46, -26, &quot;0&quot;=&quot;F(t) has a net change over the interval&quot;, &quot;3&quot;=&quot;there is more stock at F(3) than F(0)&quot;, &quot;19&quot;=&quot;there is more stock at F(3) than F(0)&quot;, &quot;26&quot;=&quot;F(t) at the right end of the interval is lower than at the left end&quot;, right_one = -26, random_answer_order = FALSE ) Question A A. From the graph, roughly estimate \\[\\int_0^3 f(t)dt\\] Choose the closest numerical value from the following. You could use either graph for this caclulation, but \\(F(t)\\) will be simpler algebra. -46︎✘ -26Right!  0︎✘ F(t) has a net change over the interval 3︎✘ there is more stock at F(3) than F(0) 19︎✘ there is more stock at F(3) than F(0) 26︎✘ F(t) at the right end of the interval is lower than at the left end askMC( &quot;B. In order to construct the anti-derivative whose value at time $t=-3$ will be zero, what constant of integration $C$ should you **add** to the $F(t)$ shown.&quot;, &quot;-120&quot;= &quot;Would adding this to F(-3) be equal to 0?&quot;, &quot;-80&quot;= &quot;Would adding this to F(-3) be equal to 0?&quot;, &quot;-50&quot;= &quot;Would adding this to F(-3) be equal to 0?&quot;, &quot;0&quot;= &quot;Would adding this to F(-3) be equal to 0?&quot;, &quot;50&quot; = &quot;Would adding this to F(-3) be equal to 0?&quot;, &quot;80&quot; = &quot;Are you sure you have the sign right?&quot;, &quot;120&quot; = &quot;Would adding this to F(-3) be equal to 0?&quot;, right_one = -80, random_answer_order = FALSE ) Question B B. In order to construct the anti-derivative whose value at time \\(t=-3\\) will be zero, what constant of integration \\(C\\) should you add to the \\(F(t)\\) shown. -120︎✘ Would adding this to F(-3) be equal to 0? -80Correct. Would adding this to F(-3) be equal to 0? -50︎✘ Would adding this to F(-3) be equal to 0? 0︎✘ Would adding this to F(-3) be equal to 0? 50︎✘ Would adding this to F(-3) be equal to 0? 80︎✘ Are you sure you have the sign right? 120︎✘ Would adding this to F(-3) be equal to 0? askMC( &quot;C. Examining the stock at time $t=0$, you observe that there are 40 units. Roughly how much stock will there be at $t=5$?&quot;, &quot;-25&quot; = &quot;Did you shift the curve in the right direction?&quot;, &quot;-15&quot; = &quot;That would be the answer if there had been 0 units of stock at time $t=0$.&quot;,&quot;0&quot;=&quot;Imagine F(t) being shifted by the difference of 40 and F(0)&quot;, &quot;15&quot;=&quot;Imagine F(t) being shifted by the difference of 40 and F(0)&quot;, 25, right_one=25, random_answer_order = FALSE ) Question C C. Examining the stock at time \\(t=0\\), you observe that there are 40 units. Roughly how much stock will there be at \\(t=5\\)? -25︎✘ Did you shift the curve in the right direction? -15︎✘ That would be the answer if there had been 0 units of stock at time \\(t=0\\). 0︎✘ Imagine F(t) being shifted by the difference of 40 and F(0) 15︎✘ Imagine F(t) being shifted by the difference of 40 and F(0) 25Right!  askMC( &quot;D. You start with a stock of 100 units at time $t = -2$. At roughly what time $t$ will the stock be half of this?&quot;, &quot;-1.2&quot;=&quot;$F(t)$-$F(a)$=50, what is the value of a?&quot;, -0.3, &quot;0.5&quot;=&quot;$F(t)$-$F(a)$=50, what is the value of a?&quot;, &quot;1.2&quot;=&quot;$F(t)$-$F(a)$=50, what is the value of a?&quot;, &quot;1.8&quot;=&quot;$F(t)$-$F(a)$=50, what is the value of a?&quot;, &quot;The stock will never fall so low.&quot;, right_one = -0.3, random_answer_order = FALSE ) Question D D. You start with a stock of 100 units at time \\(t = -2\\). At roughly what time \\(t\\) will the stock be half of this? -1.2︎✘ \\(F(t)\\)-\\(F(a)\\)=50, what is the value of a? -0.3Correct.  0.5︎✘ \\(F(t)\\)-\\(F(a)\\)=50, what is the value of a? 1.2︎✘ \\(F(t)\\)-\\(F(a)\\)=50, what is the value of a? 1.8︎✘ \\(F(t)\\)-\\(F(a)\\)=50, what is the value of a? The stock will never fall so low.︎✘ askMC( &quot;E. Your stock finally runs out at time $t=2.5$. When did you have 120 units in stock?&quot;, &quot;+$t=-4$+&quot;, &quot;$t=-3$&quot;=&quot;This uses a similiar approach to the last question.&quot;, &quot;$t=0$&quot;=&quot;This uses a similiar approach to the last question.&quot;, &quot;There was never such a time.&quot; ) Question E E. Your stock finally runs out at time \\(t=2.5\\). When did you have 120 units in stock? \\(t=-4\\)Nice!  \\(t=-3\\)︎✘ This uses a similiar approach to the last question. \\(t=0\\)︎✘ This uses a similiar approach to the last question. There was never such a time.︎✘ askMC( &quot;F. After decreasing for a long time, the stock finally starts to increase from about $t=2.5$ onward. What about $f(t=2.5)$ tells you that $F(t=2.5)$ is increasing?&quot;, &quot;The derivative is at a minimum.&quot;=&quot;Does this mean $F(t)$ must be increasing?&quot;, &quot;The derivative is negative&quot;=&quot;Does this mean $F(t)$ must be increasing?&quot;, &quot;The derivative is near zero.&quot; = &quot;Kind of. For the stock $F(t)$ to increase, what has to be true of the derivative at that instant.&quot;, &quot;+The derivative becomes positive and stays positive.+&quot;, &quot;The derivative is at a maximum.&quot;=&quot;Does this mean $F(t)$ must be increasing?&quot;, random_answer_order = FALSE ) Question F F. After decreasing for a long time, the stock finally starts to increase from about \\(t=2.5\\) onward. What about \\(f(t=2.5)\\) tells you that \\(F(t=2.5)\\) is increasing? The derivative is at a minimum.︎✘ Does this mean \\(F(t)\\) must be increasing? The derivative is negative︎✘ Does this mean \\(F(t)\\) must be increasing? The derivative is near zero.︎✘ Kind of. For the stock \\(F(t)\\) to increase, what has to be true of the derivative at that instant. The derivative becomes positive and stays positive.Correct.  The derivative is at a maximum.︎✘ Does this mean \\(F(t)\\) must be increasing? askMC( &quot;G. Find the argmin $t^\\\\star$ of $f(t)$ and note the sign of $f(t^\\\\star).$ What does this tell you about $F(t^\\\\star)$.&quot;, &quot;$t^\\\\star$ is also the argmin of $F()$.&quot;=&quot;look at the corresponding point on $F(t)$.&quot;, &quot;+$F(t^\\\\star)$ is decreasing at its steepest rate.+&quot;, &quot;$F(t^\\\\star)$ is increasing at it&#39;s slowest rate.&quot;=&quot;look at the corresponding point on $F(t)$.&quot;, &quot;$F(t^\\\\star)$ is increasing at its steepest rate.&quot;=&quot;look at the corresponding point on $F(t)$.&quot;, &quot;$t^\\\\star$ is the argmax of $F()$&quot;=&quot;look at the corresponding point on $F(t)$.&quot; ) Question G G. Find the argmin \\(t^\\star\\) of \\(f(t)\\) and note the sign of \\(f(t^\\star).\\) What does this tell you about \\(F(t^\\star)\\). \\(t^\\star\\) is also the argmin of \\(F()\\).︎✘ look at the corresponding point on \\(F(t)\\). \\(F(t^\\star)\\) is decreasing at its steepest rate.Right!  \\(F(t^\\star)\\) is increasing at it’s slowest rate.︎✘ look at the corresponding point on \\(F(t)\\). \\(F(t^\\star)\\) is increasing at its steepest rate.︎✘ look at the corresponding point on \\(F(t)\\). \\(t^\\star\\) is the argmax of \\(F()\\)︎✘ look at the corresponding point on \\(F(t)\\). askMC( &quot;H. What is the average flow into stock over the period $-5 \\\\leq t \\\\leq 1$. (If the flow is *outward from stock*, that&#39;s the same as a negative inward flow.)&quot;, -30, -20, &quot;0&quot; = &quot;But you can see that the stock is diminishing steadily during $-5 \\\\leq t \\\\leq 1$, so how could the average flow be zero.&quot;, &quot;10&quot;, right_one = -20, random_answer_order = FALSE ) Question H H. What is the average flow into stock over the period \\(-5 \\leq t \\leq 1\\). (If the flow is outward from stock, that’s the same as a negative inward flow.) -30︎✘ -20Excellent!  0︎✘ But you can see that the stock is diminishing steadily during \\(-5 \\leq t \\leq 1\\), so how could the average flow be zero. 10︎✘ askMC( &quot;I. Which of the following is an interval when the average flow is approximately zero?&quot;, &quot;$-1.3 \\\\leq t \\\\leq 1.1$&quot;=&quot;The area appears to be negative.&quot;, &quot;+$0.8 \\\\leq t \\\\leq 5$+&quot;, &quot;$-5 \\\\leq t \\\\leq 0$&quot;=&quot;The area appears to be negative.&quot;, &quot;None of the above&quot;, random_answer_order = FALSE ) Question I I. Which of the following is an interval when the average flow is approximately zero? \\(-1.3 \\leq t \\leq 1.1\\)︎✘ The area appears to be negative. \\(0.8 \\leq t \\leq 5\\)Right!  \\(-5 \\leq t \\leq 0\\)︎✘ The area appears to be negative. None of the above︎✘ askMC( &quot;J. From the graph, estimate $$\\\\int_2^{-4} f(t)dt$$ Choose the closest numerical value from the following.&quot;, &quot;-120&quot; = &quot;Pay attention to the order of the limits of integration.&quot;, -60, 60, 120, &quot;None of these answers are close to being right.&quot;, right_one = 120, random_answer_order = FALSE ) Question J J. From the graph, estimate \\[\\int_2^{-4} f(t)dt\\] Choose the closest numerical value from the following. -120︎✘ Pay attention to the order of the limits of integration. -60︎✘ 60︎✘ 120Good.  None of these answers are close to being right.︎✘ Exercise 30.06: rk5PPK Consider this function, \\(f(t)\\): tmp &lt;- rfun(~ t, seed = 2304) f &lt;- makeFun( tmp( (t-5)) - 15 ~ t) F &lt;- antiD(f(t) ~ t) dt &lt;- 0.1 Slabs &lt;- tibble::tibble( t = seq(0, 10, by = dt), tend = t + dt, y = f(t), ymid = f(t + dt/2), color = ifelse(y &gt; 0, &quot;orange&quot;, &quot;dodgerblue&quot;) ) gf_rect(0 + ymid ~ t + tend, data = Slabs, fill = ~ color, color = NA, alpha = 0.3, inherit=FALSE) %&gt;% gf_path(y ~ t, group=NA, size=1.5) %&gt;% gf_hline(yintercept = 0, color = &quot;orange3&quot;) %&gt;% gf_refine( scale_y_continuous( breaks = c(0, -10, 10, 20), labels=c(&quot;0&quot;, &quot;neg&quot;, &quot;pos&quot;, &quot;&quot;)), scale_x_continuous(breaks=0:10), scale_fill_identity() ) %&gt;% gf_labs(y=&quot;f(t)&quot;, title=&quot;Black curve shows f(t)&quot;) %&gt;% gf_theme(theme(legend.position = &quot;none&quot;)) Assume that the “area” of each small box on the graph is the product of 1 Watt \\(\\times\\) 1 second. askMC( &quot;What is $$\\\\int_1^2 f(t) dt\\\\ \\\\text{?}$$ (Choose the closest answer. The units are in Watt-seconds.)&quot;, -3.2, &quot;-1.4&quot;=&quot;Count the boxes in the interval&quot;, &quot;0&quot;=&quot;Count the boxes in the interval&quot;, &quot;2.5&quot;=&quot;Count the boxes in the interval&quot;, &quot;3.3&quot; = &quot;That&#39;s a pretty good count of boxes, but still not the right answer.&quot;, 6.1, right_one = -3.2, random_answer_order = FALSE ) Question A What is \\[\\int_1^2 f(t) dt\\ \\text{?}\\] (Choose the closest answer. The units are in Watt-seconds.) -3.2Good.  -1.4︎✘ Count the boxes in the interval 0︎✘ Count the boxes in the interval 2.5︎✘ Count the boxes in the interval 3.3︎✘ That’s a pretty good count of boxes, but still not the right answer. 6.1︎✘ \\[\\text{Let}\\ \\ A = \\int_1^3 f(x) dx\\ \\ \\ \\text{and}\\ \\ \\ B = \\int_2^4 f(x) dx\\] askMC( &quot;Which is bigger, A or B?&quot;, &quot;A&quot;, &quot;B&quot;, &quot;They are the same size&quot;, right_one = &quot;B&quot;, random_answer_order = FALSE ) Question B Which is bigger, A or B?     A︎✘        B\\(\\heartsuit\\ \\)       They are the same size︎✘ \\[\\text{Let}\\ \\ A = \\int_3^1 f(t) dt\\ \\ \\ \\text{and}\\ \\ \\ B = \\int_4^2 f(t) dt\\] askMC( &quot;Which is bigger, A or B?&quot;, &quot;A&quot;, &quot;B&quot;, &quot;They are the same size&quot;, right_one = &quot;A&quot;, random_answer_order = FALSE ) Question C Which is bigger, A or B?     A\\(\\heartsuit\\ \\)       B︎✘        They are the same size︎✘ Consider the function \\[g(x) \\equiv \\int_4^x f(t) dt\\] for the next three questions askMC( &quot;Which is bigger, $g(8)$ or $g(9)$?&quot;, &quot;+$g(8)$+&quot;, &quot;$g(9)$&quot;=&quot;the interval from 8 to 9 decreases the total size&quot;, &quot;They are the same size&quot;, &quot;Trick question! There can be no such function $g(x)$ since $f()$ is a function of $t$&quot; = &quot;Try plugging in $x=8$ on the right side of the definition and see if it makes sense.&quot; ) Question D Which is bigger, \\(g(8)\\) or \\(g(9)\\)? \\(g(8)\\)Correct.  \\(g(9)\\)︎✘ the interval from 8 to 9 decreases the total size They are the same size︎✘ Trick question! There can be no such function \\(g(x)\\) since \\(f()\\) is a function of \\(t\\)︎✘ Try plugging in \\(x=8\\) on the right side of the definition and see if it makes sense. askMC( &quot;Is $g(2.5)$ positive or negative?&quot;, &quot;positive&quot; = &quot;The function being integrated, $f(t)$, is positive over the interval $2.5 \\\\leq t \\\\leq 4$. Since the lower limit $t=4$ is larger than the upper limit $t=2.5$, the $\\\\int_4^{2.5} f(t)dt$ is negative.&quot;, &quot;zero&quot;, &quot;+negative+&quot; ) Question E Is \\(g(2.5)\\) positive or negative? positive︎✘ The function being integrated, \\(f(t)\\), is positive over the interval \\(2.5 \\leq t \\leq 4\\). Since the lower limit \\(t=4\\) is larger than the upper limit \\(t=2.5\\), the \\(\\int_4^{2.5} f(t)dt\\) is negative. zero︎✘ negativeRight!  askMC( &quot;At what value of $x$ is $g(x) = 0$?&quot;, &quot;2&quot;=&quot;There is still area under the curve for this interval&quot;, &quot;3&quot;=&quot;There is still area under the curve for this interval&quot;, &quot;4&quot; = &quot;When the two limits of integration are the same, the definite integral is *always* zero.&quot;, &quot;5&quot;=&quot;There is still area under the curve for this interval&quot;, &quot;6&quot;=&quot;There is still area under the curve for this interval&quot;, &quot;7&quot;=&quot;There is still area under the curve for this interval&quot;, &quot;8&quot;=&quot;There is still area under the curve for this interval&quot;, right_one = 4, random_answer_order = FALSE ) Question F At what value of \\(x\\) is \\(g(x) = 0\\)? 2︎✘ There is still area under the curve for this interval 3︎✘ There is still area under the curve for this interval 4Right! When the two limits of integration are the same, the definite integral is always zero. 5︎✘ There is still area under the curve for this interval 6︎✘ There is still area under the curve for this interval 7︎✘ There is still area under the curve for this interval 8︎✘ There is still area under the curve for this interval \\[\\text{Let}\\ \\ h(x) \\equiv \\int_0^x f(t) dt\\] askMC( &quot;At what value of $x$ is $h(x) \\\\approx 0$?&quot;, &quot;1&quot;=&quot;consider when positive and negative areas are equal in magnitude.&quot;, &quot;2&quot;=&quot;consider when positive and negative areas are equal in magnitude.&quot;, &quot;3&quot;=&quot;consider when positive and negative areas are equal in magnitude.&quot;, 4, &quot;5&quot;=&quot;consider when positive and negative areas are equal in magnitude.&quot;, &quot;6&quot;=&quot;consider when positive and negative areas are equal in magnitude.&quot;, right_one = 4, random_answer_order = FALSE ) Question G At what value of \\(x\\) is \\(h(x) \\approx 0\\)? 1︎✘ consider when positive and negative areas are equal in magnitude. 2︎✘ consider when positive and negative areas are equal in magnitude. 3︎✘ consider when positive and negative areas are equal in magnitude. 4Nice!  5︎✘ consider when positive and negative areas are equal in magnitude. 6︎✘ consider when positive and negative areas are equal in magnitude. \\(\\partial_x h(x)\\) is a function. When we write \\(\\partial_x h(3)\\) we mean to evaluate that function for an input value of \\(x=3\\). askMC( &quot;Which is bigger, $\\\\partial_x h(3)$ or $\\\\partial_x h(4)$?&quot;, &quot;$\\\\partial_x h(3)$&quot;=&quot;remember $f(t) is essentially the derivative of $h(x)$ with respect to x.&quot;,&quot;+$\\\\partial_x h(4)$+&quot;, &quot;Can&#39;t tell.&quot; ) Question H Which is bigger, \\(\\partial_x h(3)\\) or \\(\\partial_x h(4)\\)? \\(\\partial_x h(3)\\)︎✘ remember $f(t) is essentially the derivative of \\(h(x)\\) with respect to x. \\(\\partial_x h(4)\\)Nice!  Can’t tell.︎✘ \\[\\text{Let}\\ \\ y(x) \\equiv \\int_4^x f(t) dt\\] Here are four different graphs. slice_plot(F(x) - F(4) ~ x, domain(x=c(0:10))) %&gt;% gf_labs(title = &quot;(A)&quot;) slice_plot(F(4) - F(x) ~ x, domain(x=c(0:10))) %&gt;% gf_labs(title = &quot;(B)&quot;) slice_plot(F(6) - F(x) ~ x, domain(x=c(0:10))) %&gt;% gf_labs(title = &quot;(C)&quot;) slice_plot(abs(F(4) - F(x)) ~ x, domain(x=c(0:10))) %&gt;% gf_labs(title = &quot;(D)&quot;) askMC( &quot;Which of the graphs shows $y(x)$?&quot;, &quot;A&quot;, &quot;B&quot;=&quot;Should it increase or decrease after the point crosses the x-axis?&quot;, &quot;C&quot;=&quot;Should it increase or decrease after the point crosses the x-axis?&quot;, &quot;D&quot;=&quot;When should the graph equal 0?&quot;, right_one = &quot;A&quot;, random_answer_order = FALSE ) Question I Which of the graphs shows \\(y(x)\\)? ANice!  B︎✘ Should it increase or decrease after the point crosses the x-axis? C︎✘ Should it increase or decrease after the point crosses the x-axis? D︎✘ When should the graph equal 0? Exercise 30.08: 9W6VB Using the Euler method find \\(\\int f(t) dt\\) over the interval \\(t_0=0\\) to \\(t_{end}=1\\). The \\(t\\) quantity is in steps of \\(h=0.01\\). \\(t\\) \\(\\partial_t f(t)\\) \\(\\int f(t) dt\\) 0 0.399 0.5 0.01 0.242 0.02 0.054 0.03 | 0.399 | Exercise 30.10: 3IU9R Consider this sequence: 4, 5, 3, 1, 2 Question A What is the sum? 14︎✘ 15Excellent! Yes, we know you can add. We just wanted you to keep in mind what the sum is for the next question, which is just about as easy. 16︎✘ 17︎✘ Question B What is the cumulative sum? The sequence 4, 9, 12, 13, 15Right!  The sequence 2, 3, 6, 11, 15︎✘ That’s backwards! The sequence 0, 4, 9, 13, 15︎✘ The first number in the original sequence is 4, so the cumulative sum will start with that. Question C Which entry in the cumulative sum matches the sum?     The first︎✘        The last\\(\\heartsuit\\ \\)       None of them︎✘        All of them︎✘ Exercise 30.12: ljCxcH The result of applying the Euler method to a function is also another function, but it comes in the form of a vector of numbers all ready to be displayed graphically. So keep in mind the the function produced by Euler will be known only over a specified domain, just as the graph of a function covers only the specified domain. For instance, here is the graph of the natural logarithm function over the domain \\(1 \\leq x \\leq 21\\). slice_plot(log(x) ~ x, domain(x=c(1,21)), npts=11) %&gt;% gf_point() The command in the sandbox is a little different than the usual slice_plot(). We’ve added on two things: An argument npts=11 which says to use 11 discrete values of the input in plotting the graph. A second graphics layer that shows a dot at each input point where slice_plot() evaluated the function. Behind the seemingly smooth curves that slice_plot() produces is really a discrete set of points each of which is the output of the function at some numerical input. In our typical use of slice_plot() we leave out the dots and show only the straight line segments that connect the positions where the dots would be plotted. If the positions are spaced closely enough, your eye will not see the joints between successive straight lines and you will perceive the graph as a smooth curve. Question A For the graph of the log function over the domain \\(1 \\leq x \\leq 21\\) with npts=11 (that is, the initial command shown in the sandbox), what is the horizontal spacing between the discrete \\(x\\) values?     0.5︎✘        1︎✘        2\\(\\heartsuit\\ \\)       4︎✘        5︎✘ Now take away the npts= argument. This will implicitly set npts to a default value, which is what we have been using for most plots in this course. Question B What is the default value of npts in slice_plot()?     25︎✘        50︎✘        100\\(\\heartsuit\\ \\)       200︎✘        500︎✘        1000︎✘ We could use a much larger value for npts, but there is no reason so long as a smaller value produces a graph faithful to the function being graphed. Keeping the domain the same, \\(1 \\leq x \\leq 21\\), plot out a sinusoid with a period of 0.3 using the default npts: \\(g(x) \\equiv \\sin(2\\pi x/0.3)\\). The graph, which shows about 67 cycles of the sinusoid, will not look much like a sinusoid. In particular, although the sine function should reach from -1 to 1 over each cycle, the graph does not. Question C How large should npts be in order for each of the 67 cycles in the graph to come close enough to -1 and 1 that you cannot easily see the discrepancy?     125︎✘        150︎✘        200︎✘        400︎✘        800\\(\\heartsuit\\ \\)       1600︎✘        3200︎✘ Exercise 30.14: rfO0EG Methods such as Euler are tedious, ideal for the computer. So let’s look at some basic R functions for implementing the Euler Method when we know the function to be anti-differentiated \\(f(x)\\), the step size \\(h\\), and the domain \\(a \\leq x \\leq b\\). At the heart of the implementation is a function cumsum(), the “cumulative sum.” This does something very simple. The cumulative sum of the sequence 1, 2, 3, 4 is another sequence: 1, 3, 6, 10. The following code has commands for using cumsum() to approximate the anti-derivative of a function \\(f()\\) over the domain \\(a \\leq x \\leq b\\) f &lt;- makeFun(sin(2*pi*x/0.3) ~ x) # the function to be anti-differentiated. a &lt;- 1 # the lower bound. b &lt;- 2 # the upper bound. h &lt;- 0.01 # the step size x_discrete &lt;- seq(a, b, by = h) # all of the discrete x values based on a, b, and h f_discrete &lt;- f(x_discrete) # all of the values of f(x) when the discrete x values are used as the input F_discrete &lt;- cumsum(h * f_discrete) # the discrete values of the anti-derivative, F(x) gf_point(F_discrete ~ x_discrete) %&gt;% slice_plot(f(x) ~ x, color = &quot;gray&quot;, domain(x=c(a,b))) Here is a function: g &lt;- makeFun(exp(-0.2*(x^2))~x) Using a SANDBOX, find and plot the anti-derivative of \\(g(x)\\) over the domain \\(-6 \\leq x \\leq 6\\). Your task: Describe the shape of \\(G(x)\\). Your description can be one word from earlier in the book, if you choose it carefully. If your graph looks like a straight line, you did not appropriately change the domain above. ECONOMIST PICTURES https://www.economist.com/img/b/600/653/90/sites/default/files/images/print-edition/20210710_EUC776.png knitr::include_graphics(&quot;www/sputnik.png&quot;) https://www.economist.com/img/b/600/653/90/sites/default/files/images/print-edition/20210710_BRC783.png knitr::include_graphics(&quot;www/NHS.png&quot;) https://www.economist.com/img/b/600/653/90/sites/default/files/images/print-edition/20210710_EUC775.png knitr::include_graphics(&quot;www/Turkish-lira.png&quot;) The root of the word “data” is the Latin for “given”.↩︎ "],["accum-symbolic.html", "Chapter 31 Symbolic anti-differentiation 31.1 The cataloged functions 31.2 Differentials 31.3 U-substitution 31.4 Integration by parts 31.5 Integrating polynomials 31.6 Exercises", " Chapter 31 Symbolic anti-differentiation You have already learned how to write down, by sight, the anti-derivative of the many of the pattern-book functions. As a reminder, here is an (almost) complete list of the derivatives and anti-derivatives of the pattern-book functions. \\(\\partial_x f(x)\\) \\(f(x)\\) \\(\\int f(x) dx\\) \\(e^x\\) \\(e^x\\) \\(e^x\\) \\(\\cos(x)\\) \\(\\sin(x)\\) \\(-\\cos(x)\\) \\(p x^{p-1}\\) power-law \\(x^p\\) \\(\\frac{1}{p+1} x^{p+1}\\) \\(\\ \\ \\ \\ 2x\\) \\(\\ \\ \\ \\ x^2\\) \\(\\frac{1}{3} x^3\\) \\(\\ \\ \\ \\ 1\\) \\(\\ \\ \\ \\ x\\) \\(\\frac{1}{2} x^2\\) \\(\\ \\ \\ \\ 0\\) \\(\\ \\ \\ \\ 1\\) \\(x\\) \\(\\ \\ \\ \\ -x^{-2}\\) \\(\\ \\ \\ \\ 1/x\\) \\(\\ln(x)\\) \\(1/x\\) \\(\\ln(x)\\) \\(x \\left(\\strut\\ln(x) - 1\\right)\\) \\(-x \\dnorm(x)\\) \\(\\dnorm(x)\\) \\(\\pnorm()\\) \\(\\dnorm(x)\\) \\(\\pnorm(x)\\) See below. You can see that the derivatives and anti-derivatives of the pattern-book functions can be written in terms of the pattern-book functions. The left column contains the symbolic derivatives of the pattern book functions. The right column contains the symbolic anti-derivatives. We call them “symbolic,” because they are written down with the same kind of symbols that we use for writing the pattern-book functions themselves.3 We’re stretching things a bit by including \\(\\dnorm(x)\\) and \\(\\pnorm(x)\\) among the functions that can be integrated symbolically. As you’ll see later, \\(\\dnorm(x)\\) is special when it comes to integration. Think of the above table as the “basic facts” of differentiation and anti-differentiation. It’s well worth memorizing the table since it shows many of the relationships among the functions that are central to this book. For the sinusoids, we’ve used the traditional name \\(\\cos(x)\\) to refer to \\(\\sin(x + \\pi/2)\\) and \\(-\\cos(x)\\) instead of \\(\\sin(x - \\pi/2)\\) since generations of calculus students have been taught to name “cosine” as the derivative of “sine,” and don’t always remember the relationship that \\(\\cos(x) =\\sin(x + \\pi/2)\\). For differentiation, any function that can be written using combinations of the pattern-book functions by multiplication, composition, and linear combination has a derivative that can be written using the pattern-book functions. So a complete story of symbolic differentiation is told by the above table and the differentiation rules: linear combination: \\(\\partial_x \\left[{\\strut}a\\, f(x) + b\\, g(x)\\right] = a\\, \\partial_x f(x) + b\\, \\partial_x g(x)\\) product: \\(\\partial_x \\left[{\\strut}f(x)\\cdot g(x)\\right] = g(x) \\partial_x f(x) + f(x) \\partial_x g(x)\\) composition: \\(\\partial_x \\left[{\\strut}f(g(x))\\right] = \\left[\\partial_y f(g(x))] \\cdot \\partial_x g(x)\\) This chapter is about the analogous rules for anti-differentiation. The anti-differentiation rule for linear combination is simple: essentially the same as the rule for differentiation. \\[\\int \\left[\\strut a\\, f(x) + b\\, g(x)\\right] = a\\!\\int\\! f(x) dx + b\\!\\int\\! g(x) dx\\] How about the rules for function products and for composition? The surprising answer is that there are no such rules. There is no template analogous to the product and chain rules for derivatives, that can consistently be used for anti-derivatives. What we have instead are techniques of integration, somewhat vague rules that will sometimes guide a successful search for the anti-derivative, but often will lead you astray. Indeed, there are many functions for which a symbolic anti-derivative cannot be constructed from compositions and/or multiplication of pattern-book functions that can be written using pattern-book functions.4 Fortunately, we already know the symbolic anti-derivative form of many functions. We’ll call those the cataloged functions, but this is not a term in general use in mathematics. For functions not in the catalog, it is non-trivial to find out whether the function has a symbolic anti-derivative or not. This is one reason why the techniques of integration do not always provide a result. The following sections provide an overview of techniques of integration. We start with a description of the cataloged functions and direct you to computer-based systems for looking up the catalog. (These are almost always faster and more reliable than trying to do things by hand.) Then we introduce a new interpretation of the notation for anti-differentiation: differentials. This interpretation makes it somewhat easier to understand the major techniques of integration: substitution and integration by parts. We’ll finish by returning to a setting where symbolic integration is easy: polynomials. Remember that, even if we cannot always find a symbolic anti-derivative, that we can always construct a numerical anti-derivative that will be precise enough for almost any genuine purpose. 31.1 The cataloged functions In a traditional science or mathematics education, students encounter (almost exclusively) basic functions from a mid-sized catalog. For instance: \\(\\sqrt{\\strut\\_\\_\\_\\ }\\), \\(\\sin()\\), \\(\\cos()\\), \\(\\tan()\\), square(), cube(), recip(), \\(\\ln()\\), \\(\\exp()\\), negate(), gaussian(), and so on. This catalog also includes some functions that take two arguments but are traditionally written without using parentheses. For instance, \\(a+b\\) doesn’t look like a function but is entirely equivalent to \\(+(a, b)\\). Others in this class are \\(\\times(\\ ,\\ )\\), \\(\\div(\\ , \\ )\\), \\(-(\\ ,\\ )\\), and ^( , ). The professional applied mathematician’s catalog is much larger. You can see an example published by the US National Institute of Standards and Technology as the Digital Library of Mathematical Functions. (Almost all of the 36 chapters in this catalog, important though they be, are highly specialized and not of general interest across fields.) There is a considerable body of theory for these cataloged functions, which often takes the form of relating them to one another. For instance, \\(\\ln(a \\times b) = \\ln(a) + \\ln(b)\\) demonstrates a relationship among \\(\\ln()\\), \\(+\\) and \\(\\times\\). Along the same lines of relating the cataloged functions to one another is \\(\\partial_x \\sin(x) = \\cos(x)\\) and other statements about derivatives such as those listed in Chapter 19. Simply to illustrate what a function catalog looks like, Figure 31.1 shows a page from an 1899 handbook entitled A Short Table of Integrals. Figure 31.1: Entries 124-135 from A Short Table of Integrals (1899) by Benjamin Osgood Pierce. The book includes 938 such entries. The use of cataloged functions is particularly prevalent in textbooks, so the quantitatively sophisticated student will encounter symbolic anti-derivatives of these functions throughout his or her studies. The cataloged functions were assembled with great effort by mathematicians over the decades. The techniques and tricks they used to find symbolic anti-derivatives are not part of the everyday experience of technical workers, although many mathematically minded people find them a good source of recreation. Calculus textbooks that include extensive coverage of the techniques and tricks should be understood as telling a story of the historical construction of catalogs, rather than conveying skills that are widely used today. In a practical sense, when the techniques are needed, it’s more reliable to access them via computer interface such as WolframAlpha, as depicted in Figure 31.2. Figure 31.2: Pierce’s entry 125 as computed by the WolframAlpha system. The systems can do a good job identifying cases where the techniques will not work. In such systems, they provide the anti-derivative as constructed by numerical integration. The R/mosaic antiD() function works in this same way, although its catalog contains only a tiny fraction of the functions found in professional systems. (But then, only a tiny fraction of the professional cataloged function are widely used in applied work.) 31.2 Differentials Breathing some life into the symbol \\(dx\\) will help in understanding the algebra of techniques for anti-differentiating function compositions and products. We’ve thus far presented \\(dx\\) as a bit of notation: punctuation for identifying the with-respect-to input in anti-derivatives. That is, in interpreting a sequence of symbols like \\(\\int f(x,t) dx\\), we’ve parsed the sequence of symbols into three parts: \\[\\underbrace{\\int}_{\\text{integral sign}} \\overbrace{f(x, t)}^{\\text{function to be anti-differentiated}} \\underbrace{dx}_{\\text{&#39;with respect to&#39;}}\\] By analogy, the English sentence \\[\\text{We loaded up on snacks.}\\] consists of five parts: the five words in the sentence. But you can also see “We loaded up on snacks” as having three parts: \\[\\underbrace{\\text{We}}_{\\text{subject}}\\ \\overbrace{\\text{loaded up on}}^{\\text{verb}}\\ \\ \\ \\underbrace{\\text{snacks}}_{\\text{object}}\\] Likewise, the integrate sentence can be seen as consisting of just two parts: \\[\\underbrace{\\int}_{\\text{integral sign}} \\overbrace{f(x, t) dx}^{\\text{differential}}\\] A differential corresponds to the little sloped segments that we add up when calculating a definite integral numerically using the slope function visualization. That is \\[\\underbrace{\\int}_{\\text{Sum}} \\underbrace{\\overbrace{f(x,t)}^\\text{slope of segment}\\ \\ \\overbrace{dx}^\\text{run}}_\\text{rise}\\] A differential is a genuine mathematical object and is used, for example, in analyzing the geometry of curved spaces, as in the Theory of General Relativity. But this is well beyond the scope of this introductory calculus course. 3710 Our use here for differentials will be to express rules for anti-differentiation of function compositions and products. You should be thinking in terms of differentials when you see a sentence like the following: “In \\(\\int \\sin(x) \\cos(x) dx\\), make the substitution \\(u = \\sin(x)\\), implying that \\(du = \\cos(x) dx\\) and getting \\(\\int u du\\), which is simple to integrate.” The table gives some examples of functions and their differentials. “w.r.t” means “with respect to.” Function derivative w.r.t. differential \\(v(x) \\equiv x\\) \\(\\partial_x v(x) = 1\\) x \\(dv = dx\\) \\(u(x) \\equiv x^2\\) \\(\\partial_x u(x) = 2x\\) x \\(du = 2x dx\\) \\(f(x) \\equiv \\sin(x)\\) \\(\\partial_x f(x) = \\cos(x)\\) x \\(df = \\cos(x)dx\\) \\(u(x) \\equiv e^{3 x}\\) \\(\\partial_x u(x) = 3 e^{3 x}\\) x \\(du = 3 e^{3 x} dx\\) \\(g(x) \\equiv t^3\\) \\(\\partial_t v(t) = 3 t^2\\) t \\(dg = 3 t^2 dt\\) As you can see, the differential of a function is simply the derivative of that function followed by the little \\(dx\\) or \\(dt\\) or whatever is appropriate for the “with respect to” variable. Notice that the differential of a function is not written with parentheses: The function \\(u(x)\\) corresponds to the differential \\(du\\). Example 31.1 What is the differential of \\(\\sin(x)\\)? As we’ve seen, \\(\\partial_x \\sin(x) = cos(x)\\). For form the differential of \\(\\sin()\\), take the derivative and suffix it with a \\(dx\\) (since \\(x\\) is the name of the input): \\[\\cos(x)\\ dx\\] 31.3 U-substitution There is little reason to use \\(\\partial_t\\) and \\(\\int \\left[\\right]dt\\) to cancel each other out, but it is the basis of an often successful strategy—u-substitution—for finding anti-derivatives symbolically. Here’s the differentiate/integrate algorithm behind u-substitution. 3725 Pick a function \\(f()\\) and another function \\(g()\\). Typically \\(f()\\) and \\(g()\\) belong to the family of basic modeling functions, e.g. \\(e^x\\), \\(\\sin(t)\\), \\(x^n\\), \\(\\ln(x)\\), and so on. For the purpose of illustration, we’ll use \\(f(x) = \\ln(x)\\) and \\(g(t) = \\cos(t)\\). Compose \\(f()\\) with \\(g()\\) to produce a new function \\(f(g())\\) which, in our case, will be \\(\\ln(\\cos(t))\\). Use the chain rule to find \\(\\partial_t f(g(t))\\). In the example, the derivative of \\(\\ln(x)\\) is \\(1/x\\), the derivative of \\(g(t)\\) is \\(-\\sin(t)\\). By the chain rule, \\[\\partial_t f\\left(\\strut g(t)\\right) = \\partial_t \\underbrace{\\Large\\ln}_{f()}\\left(\\underbrace{\\large\\cos(t)}_{g(t)}\\right) = \\underbrace{\\left[- \\frac{1}{\\cos(t)}\\right]}_{f&#39;(g(t))} \\underbrace{\\left[{\\LARGE\\strut}\\sin(t)\\right]}_{g&#39;(t)} = - \\frac{\\sin(t)}{\\cos(t)} = - \\tan(t)\\] 3730 In a sense, we have just watched a function give birth to another through the straightforward process of differentiation. Having witnessed the birth, we know who is the integration parent of \\(\\tan(t)\\), namely \\(\\int \\tan(t) dt = \\ln\\left(\\cos(t)\\right)\\). For future reference, we might write this down in our diary of integrals: \\[\\int \\tan(t) dt = - \\ln(\\cos(t)) + C\\] Saving this fact in your diary is helpful. The next time you need to find \\(\\int \\tan(x) dx\\), you can look up the answer (\\(-\\ln(\\cos(x)) + C\\)) from your diary. If you use \\(\\int \\tan(x) dx\\) a lot, you will probably come to memorize the answer, just as you have already memorized that \\(\\int \\cos(t) dt = \\sin(t)\\) (a fact that you actually will use a lot in the rest of this course). 3735 Now for the u-substitution game. The trick is to take a problem of the form \\(\\int h(t) dt\\) and extract from \\(h(t)\\) two functions, an \\(f()\\) and a \\(g()\\). You’re going to do this so that \\(h(t) = \\partial_t F(g(t))\\), where \\(\\partial_x F(x) = f(x)\\) Once you’ve done this, you have an answer to the original integration question: \\(\\int h(t) dt = F(g(t)) + C\\). 3740 Example 31.2 Task: Evaluate the definite integral \\(\\int \\frac{\\sin(\\ln(x))}{x} dx\\). You don’t know ahead of time that this is an integral amenable to solution by u-substitution. For all you know, it’s not. So before you start, look at the function to see if it one of those for which you already know the anti-derivative, for example any of the pattern-book functions or their parameterized cousins the basic modeling functions. 3745 If so, you’ve already memorized the answer and you are done. If not … Assume for a moment—without any guarantee that this will work, mind you—that the answer can be built using u-substitution. You will therefore look hard at \\(h()\\) and try to see in it a plausible form that looks like the derivative of some \\(f(g(x))\\). 3750 In the problem at hand, we can readily see something of the form \\(f(g(x))\\) in the \\(\\sin(\\ln(x))\\). This immediately gives you a candidate for \\(g(x)\\), namely \\(g(x)\\equiv \\ln(x)\\) We don’t know \\(f()\\) yet, but if \\(g()\\) is the right guess, and if u-substitution is going to work, we know that \\(f()\\) has to be something that produces \\(\\sin()\\) when you differentiate it. That’s \\(-\\cos()\\). So now we have a guess \\[h_\\text{guess}(x) = -\\cos(\\ln(x)) \\partial_x \\ln(x) = - \\cos(\\ln(x)) \\frac{dx}{x}\\] 3755 If this guess matches the actual \\(h()\\) then you win. The answer to \\(\\int h(x) dx\\) will be \\(f(g(x)) = -\\cos(\\ln(x))\\). If not, see if there is any other plausible guess for \\(g(x)\\) to try. If you can’t find one that works, try integration by parts. 3760 31.4 Integration by parts Integration by parts applies to integrals that are recognizably of the form \\[\\int f(x) g(x) dx\\] Step 1: Split up the integrand into an \\(f(x)\\) and a \\(g(x)\\) multiplied together. That is, split the integrand into parts that are multiplied together. The way we wrote the integrand, this was trivial. Step 2: Pick one of \\(f(x)\\) or \\(g(x)\\). Typically, you pick the one that has a dead-easy anti-derivative. For our general description, let’s suppose this is \\(g(x)\\) which has anti-derivative \\(G(x)\\) (where we know \\(G()\\)). Step 3: Construct a helper function \\(h(x) \\equiv f(x) G(x)\\). This requires no work, since we’ve already identified \\(f(x)\\) and \\(G(x)\\) in step (2). Step 4: Find \\(\\partial_x h(x)\\). It’s always easy to find derivatives, and here we just use the product rule: \\[\\partial_x h(x) = \\partial_x f(x) \\cdot G(x) + f(x)\\cdot\\partial_x G(x)\\] We know from the way we constructed \\(G(x)\\) that \\(\\partial_x G(x) = g(x)\\), so the equation is \\[\\partial_x h(x) = \\partial_x f(x) \\cdot G(x) + f(x)\\cdot g(x)\\] Step 5: Anti-differentiate both sides of the previous equation. From the fundamental theorem of calculus, we know how to do the left side of the equation. \\[\\int \\partial_x h(x) = h(x) \\equiv f(x)g(x)\\] The right side of the equation has two parts: \\[\\int \\left[{\\large\\strut}\\partial_x f(x) \\cdot G(x) + f(x)\\cdot g(x)\\right]dx = \\underbrace{\\int \\partial_x f(x) \\cdot G(x) dx}_\\text{Some NEW integral!}\\ \\ \\ \\ + \\underbrace{\\int f(x) g(x) dx}_\\text{The original integral we sought!}\\] Putting together the left and right sides of the equation, and re-arranging gives us a new expression for the original integral we sought to calculate: \\[\\text{Integration by parts re-arrangement}\\\\\\underbrace{\\int f(x) g(x) dx}_\\text{The original integral we sought.} = \\underbrace{f(x) g(x)}_\\text{We know this!} - \\underbrace{\\int \\partial_x f(x) \\cdot G(x) dx}_\\text{Some NEW integral!}\\] It may seem that we haven’t accomplished much with this re-organization. But we have done something. We took a problem we didn’t otherwise know how to solve (that is \\(\\int f(x) g(x) dx\\)) and broke it down into two parts. One is very simple. The other is an integral. If we’re clever in picking \\(g()\\) and lucky, we’ll be able to figure out the new integral and, thereby, we’ll have computed the original integral. But everything depends on cleverness and luck! Example 31.3 Task: Find \\(\\int x \\cos(x) dx\\). An obvious choice for the two parts is \\(x\\) and \\(\\cos(x)\\). But which one to call \\(g(x)\\). We’ll just guess and say \\(g(x)\\equiv \\cos(x)\\) which implies \\(G(x) = \\sin(x)\\). The helper function is \\(h(x) \\equiv f(x) G(x) = x \\sin(x)\\). Differentiating \\(h(x)\\) can be done by the product rule. \\[\\partial_x h(x) = \\sin(x) + x \\cos(x)\\ .\\] Now anti-differentiate both sides of the above, the left side by the fundamental theorem of algebra and the right side by other means: \\[\\int \\partial_x h(x) = h(x) = x \\sin(x)= \\underbrace{\\int\\sin(x)dx}_{-\\cos(x)} + \\underbrace{\\int x \\cos(x) dx}_\\text{The original integral}\\] Re-arranging gives the answer \\[\\underbrace{\\int x \\cos(x) dx}_\\text{The original integral} = x \\sin(x) + \\cos(x) + C\\] The constant of integration \\(C\\) needs to be included to make the equality true. To confirm the result, you can differentiate the right-hand side; differentiation is always easy. Alternatively, we can check numerically if \\(\\int x \\cos(x) dx - (x\\sin(x)+cos(x))\\) is really a constant. F1 &lt;- antiD(x*cos(x) ~ x) F2 &lt;- makeFun(x*sin(x) + cos(x) ~ x) slice_plot(F1(x) - F2(x) ~ x, domain(x=c(-5,5))) Yes! The graph shows a constant function: \\(C\\). Example 31.4 Task: Find \\(\\int \\ln(x) dx\\). The easy solution is to recognize that the anti-derivative of \\(\\ln(x)\\) is contained in the table at the top of the chapter. But let’s try doing it by parts as an example (and to show you how it got into the table in the first place). It’s hard to see a separate \\(f(x)\\) and \\(g(x)\\) in the integrand \\(\\ln(x)\\). But sometimes you need to be clever. We’ll set \\(f(x) \\equiv \\ln(x)\\) and \\(g(x) \\equiv 1\\). This means that \\(G(x) = x\\). The helper function is therefore \\(h(x) = x\\ln(x)\\) Differentiating the helper function gives (by the product rule): \\(\\partial_x h(x) = \\ln(x) + x \\frac{1}{x} = \\ln(x) + 1\\) Integrating the differentiated helper function, we find \\[\\int \\partial_x h(x) dx = f(x)g(x) = x \\ln(x) = \\underbrace{\\int \\ln(x) dx}_\\text{The original integral} + \\underbrace{\\int 1 dx}_{x}\\] Re-arranging, we have \\[\\underbrace{\\int \\ln(x) dx}_\\text{The original integral} = x \\ln(x) - x\\ \\ =\\ \\ x\\left[\\strut \\ln(x) - 1\\right]\\] Example 31.5 Task: Find \\(\\int \\sin(x) e^x dx\\). This isn’t the integral of a pattern book or basic modeling function, and substitution didn’t work, so we try integration by parts. The obvious choice for the two parts is \\(\\sin(x)\\) and \\(e^x\\). Both are really easy to anti-differentiate. Let’s choose \\(g(x) = \\sin(x)\\), giving \\(G(x) = -\\cos(x)\\). The re-arrangement of the original integral will be \\[\\sin(x) e^x + \\int \\cos(x) e^x dx\\] The new integral that we need to compute doesn’t look any friendlier than the original, but who knows? We’ll do \\(\\int cos(x) e^x dx\\) by parts as well and keep our fingers crossed. That integral turns out to be \\[\\int \\cos(x) e^x dx = \\cos(x) e^x - \\int \\sin(x) e^x dx\\] This may look like we’re going in circles, and maybe we are, but let’s put everything together. \\[\\underbrace{\\int \\sin(x) e^x dx}_\\text{The original problem} = \\underbrace{\\sin(x) e^x + \\cos(x) e^x}_\\text{Easy stuff!}\\ \\ \\ - \\underbrace{\\int \\sin(x) e^x dx}_\\text{Also the original problem}\\] Rearranging gives \\[\\int \\sin(x) e^x dx = \\frac{\\sin(x) e^x + \\cos(x) e^x}{2} = \\frac{e^x}{2}\\left[{\\large\\strut} \\sin(x) + \\cos(x)\\right]\\] And don’t forget the constant of integration. [The presentation of integration by parts in this section was formulated by Prof. Michael Brilleslyper.] If integration by parts doesn’t work … and it doesn’t always work! … there is a variety of possibilities such as asking a math professor (who has a much larger set of functions at hand than you), looking through a table of integrals (which is to say, the collective calculus diary of generations of math professors), using a computer algebra system, or using numerical integration. One of these will work. 3765 If you have difficulty using u-substitution or integration by parts, you will be in the same league as the vast majority of calculus students. Think of your fellow students who master the topic in the way you think of ice dancers. It’s beautiful to watch, but you need a special talent and it hardly solves every problem. People who would fall on their face if strapped to a pair of skates have nonetheless made huge contributions in technical fields, even those that involve ice. Prof. Kaplan once had a heart-to-heart with a 2009 Nobel-prize winner who confessed to always feeling bad and inadequate as a scientist because he had not done well in introductory calculus. It was only when he was nominated for the Nobel that he felt comfortable admitting to his “failure.” Even if you don’t master u-substitution or integration by parts, remember that you can integrate any function using easily accessible resources. 3840 31.5 Integrating polynomials One of the most famous settings for integration comes from the physics of free fall under gravity. Here’s the setting. An object—a ball, let’s imagine—is being held at height \\(x_0\\). At \\(t=0\\) the ball is released. Perhaps the ball is released from a standstill in which case it’s velocity at release is \\(v_0 = v(t=0) =0\\). Or perhaps the ball has been tossed upward so that \\(v_0 &gt; 0\\), or downward so that \\(v_0 &lt; 0\\). Whichever it is, the initial velocity will be labelled \\(v_0\\). On release, the force that held the ball steady is removed and the object moves under the influence of only one factor: gravity. The effect of gravity near the Earth’s surface is easy to describe: it accelerates the object at a constant rate of about 9.8 m/s\\(^2\\). Acceleration is the derivative with respect to time of velocity. Since we know acceleration, to find velocity we find an anti-derivative of acceleration: \\[v(t) = \\int -9.8\\ dt = -9.8\\ t + C\\] The constant of integration \\(C\\) is not just a formality. It has physical meaning. In this case, we see that \\(C=v(0)\\), that is, \\(C = v_0\\). Velocity is the derivative of position: height in this case. So height is an anti-derivative of velocity. \\[x(t) = \\int v(t) dt = \\int \\left[\\strut -9.8\\ t + v_0\\right]dt = - \\frac{9.8}{2} t^2 + v_0\\ t + C\\] Why is \\(C\\) back again? It’s a convention to use \\(C\\) to denote the constant of integration. Those experienced with this convention know, from context, that the value of \\(C\\) in the integration that produced \\(v(t)\\) has nothing to do with the value of \\(C\\) involved in the production of \\(x(t)\\). The situation is a bit like the presentation of prices in US stores: to the price of the item itself, you must always add “plus taxes.” Nobody with experience would assume that “taxes” is always the same number. It depends on the price and type of the item itself.5 You won’t have to deal with the taxes at the time you pick the item from the shelf, but eventually you’ll see them when you check out of the store. Think of \\(+\\ C\\) as meaning, “plus some number that we’ll have to deal with at some point, but not until checkout.” Let’s checkout the function \\(x(t)\\) now. For that, we need to figure out the value of \\(C\\). We can do that by noticing that \\(x(0) = C\\). So in the anti-differentiation producing \\(x()\\), \\(C = x_0\\) giving, altogether the formula for free-fall famous from physics classes \\[x(t) = - \\frac{9.8}{2} t^2 + v_0\\ t + x_0\\] An important thing to notice about \\(x(t)\\): it’s a polynomial in \\(t\\). Polynomials can be birthed by successive anti-differentiations of a constant. At each anti-differentiation, each of the previous terms is promoted by one order. That is, the previous constant becomes the first order term. The previous first-order term becomes the second order term, with the division by 2 familiar from anti-differentiating \\(t\\). A previous second-order term will become the new third-order term, again with the division by 3 familiar from anti-differentiating \\(t^2\\). Stated generally, the anti-derivative of a polynomial is \\[{\\Large\\int} \\left[\\strut \\underbrace{a + b t + ct^2 + \\ldots}_\\text{original polynomial}\\right] dt = \\underbrace{C + a\\,t + \\frac{b}{2} t^2 + \\frac{c}{3} t^3 + \\ldots}_\\text{new polynomial}\\] By use of the symbol \\(C\\), it’s easy to spot how the constant of integration fits in with the new polynomial. But if we were to anti-differentiate the new polynomial, we had better replace \\(C\\) with some more specific symbol to that we don’t confuse the old \\(C\\) with the one that’s going to be produced in the new anti-differentiation. In exercise 26.16, we introduced a Taylor polynomial approximation to the gaussian function. That might have seemed like a mere exercise in high-order differentiation at the time, but there is something more important at work. The gaussian is one of those functions for which the anti-derivative cannot be written exactly in terms of what the mathematicians call “elementary functions.” (See Section 31.1.) Yet integrals of the gaussian are very commonly used in science, especially in statistics where the gaussian is called the normal PDF. The approach we’ve taken in this book is simply to give a name and a computer implementation of the anti-derivative of the gaussian. This is the function we’ve called \\(\\pnorm()\\) with the R computer implementation pnorm(). We never told you the algorithm contained in pnorm(). Nor do we really need to. We all depend on experts and specialists to design and build the computers we use. The same is true of software implementation of functions like pnorm(). And for that matter, for implementations of functions like exp(), log(), sin(), and so on. You don’t have to know about semi-conductors in order to use a computer productively, and you don’t need to know about numerical algorithms in order to use those functions. One feasible algorithm for implementing \\(\\pnorm()\\) is to integrate the Taylor polynomial. It’s very easy integrate polynomials. To ensure accuracy, different Taylor polynomials can be computed for different centers, say \\(x=0\\), \\(x=1\\), \\(x=2\\), and so on. Another feasible algorithm is simply to integrate \\(\\dnorm()\\) numerically using an advanced algorithm such as Gauss-Hermite quadrature. In today’s world, software is the means by which expert knowledge and capability is communicated and applied. Before modern computers were available, the expertise was committed to print in the form of tables. Figure 31.3 shows part of the table from the previously mentioned 1899 A Short Table of Integrals.6 Incredibly, such tables were a standard feature of statistics textbooks up through 2010. Figure 31.3: Before the computer software era, some functions could only be presented using printed tables. This table supports calculations with a gaussian-like function for inputs from 0 to 1. In addition to software being more compact and easier to use than printed tables, the interface to numerical integrals can be presented in the same format as any other mathematical function. That’s enabled us to include \\(\\pnorm()\\) among the pattern book functions. 31.6 Exercises Exercise 31.03: HoQaaq Question A What is the differential of \\(u = x + 5\\)? \\(du = dx\\)Good. Since \\(\\partial_x (x+5) = 1\\). \\(du = (x+5)dx\\)︎✘ You should have used \\(\\partial_x (x+5)\\) instead of \\((x+5)\\) on the right side. \\(du = 5 dx\\)︎✘ Is \\(\\partial_x (x+5) = 5\\)? No! \\(du = x dx\\)︎✘ You should have used \\(\\partial_x (x+5) = 1\\) instead of \\(x\\) on the right side. Question B What is the differential of \\(u = \\sin(2x + 5)\\)? \\(du = 2 \\cos(2x + 5) dx\\)Excellent! Since \\(\\partial_x \\sin(2x + 5) = 2 \\cos(2x + 5)\\). \\(du = (2x+5)dx\\)︎✘ You should have used \\(\\partial_x \\sin(2x+5)\\) instead of \\((2x+5)\\) on the right side. \\(du = 5 dx\\)︎✘ Is \\(\\partial_x \\sin(2x+5) = 5\\)? No! \\(du = 2x dx\\)︎✘ You should have used \\(\\partial_x \\sin(2x+5) = 2 \\cos(2x + 5)\\) instead of \\(2x\\) on the right side. Question C What is the differential of \\(v = e^x\\)? \\(du = e^x dx\\)︎✘ The name of the function here is \\(v()\\), not \\(u\\). So the differential should be written \\(dv\\). \\(dv = e^x dx\\)Correct. Since \\(\\partial_x e^x = 1\\). \\(du = x dx\\)︎✘ The name of the function here is \\(v()\\), not \\(u\\). So the differential should be written \\(dv\\). \\(dv = x dx\\)︎✘ But \\(\\partial e^x = e^x\\), not \\(x\\). Question D What is the differential of \\(f = \\cos(\\ln(t))\\)? \\(df = -\\frac{\\sin(\\ln(t))}{t} dt\\)Excellent! Since the chain rule tells us \\(\\partial_t\\cos(\\ln(t)) = -\\sin(\\ln(t))/x\\). \\(du = -\\frac{\\sin(\\ln(t))}{t} dt\\)︎✘ There’s no \\(u\\) in sight in this problem. It’s \\(f\\). \\(dv = -\\frac{\\sin(\\ln(t))}{t} dt\\)︎✘ There’s no \\(v\\) being used in this problem. It’s \\(f\\) that we’re asking about. \\(df = - rac{\\sin(\\ln(x))}{x} dx\\)︎✘ \\(f\\) is a function of \\(t\\), not \\(x\\). Exercise XX.XX: Y7ecmI Question A In \\(h(x) = 2x/(x^2 + 2)\\) which of the following is a plausible candidate for an interior function \\(g(x)\\)? \\(\\sin(x)\\)︎✘ \\(\\ln(x)\\)︎✘ \\(2x\\)︎✘ In order for this to be an interior function \\(g(x)\\) there has to be some other function embracing it. \\(2x\\) is standing proudly on its own, so it’s not a good choice for \\(g(x)\\) \\(x^2 + 2\\)Right!  Question B Continuing with the integral of \\(h(x) = 2x/(x^2 + 2)\\) and the working guess that \\(g(x) = x^2 + 2\\), do you see any part of \\(h()\\) which is a match to \\(\\partial_x g()\\)?     \\(1/x\\)︎✘ But that’s not anything like \\(\\partial_x g(x)\\).       \\(\\ln(x)\\)︎✘        \\(2x\\)\\(\\heartsuit\\ \\) Question C Taking seriously the progress we made in the previous two questions, we now need to write \\(h(x)\\) as \\(f(x^2 + 2) 2x\\)? What should \\(f()\\) be to make this match \\(h(x)\\)?     \\(f(x) = \\sin(x)\\)︎✘        \\(f(x) = \\ln(x)\\)︎✘        \\(f(x) = 1/x\\)\\(\\heartsuit\\ \\)       \\(x^2 + 2\\)︎✘ Now that you have found both \\(g()\\) and \\(f()\\), you simply need to find a function \\(F(x)\\) such that \\(\\partial_x F(x) = f(x)\\). Since \\(\\partial_x \\ln(x) = 1/x\\), we know that \\(F(x) = \\ln(x)\\). Thus, \\(\\int h(x) dx = F(g(x)) = F(x^2 + 2) = \\ln(x^2 + 2)\\). Exercise XX.XX: LPlcgV Question A \\[\\text{Find a plausible interior g(x) in} \\ x \\exp(x^2 + 3)\\] \\(\\exp(x)\\)︎✘ \\(x\\)︎✘ \\(x^2 + 3\\)Good.  \\(x^2\\)︎✘ The interior function has to be everything embraced by the parentheses of the exterior function \\(f()\\). Question B Using your candidate for \\(g()\\) from the previous question, which of these is a exterior f(x) in \\(x \\exp(x^2 + 3)\\) \\(f(x) = \\exp(x)\\)Correct.  \\(f(x) = x\\)︎✘ \\(f(x) = x \\exp(x)\\)︎✘ If this were so, the resulting \\(h()\\) would have something like \\((x^2 + 3) \\exp(x^2 + 3)\\) in it. \\(f(x) = \\ln(x)\\)︎✘ Confirm that \\(h(x) = f(g(x)) \\partial_x g(x)\\) and you win. The answer will be \\(F(g(x)) + C\\) Exercise XX.XX: A0u94a Question A Which of these candidates for \\(f()\\) and \\(g()\\) will produce \\[f(g(x))\\, \\partial_x g(x) = x^3 \\cos(x^4)\\ ?\\] \\(f(x) = \\cos(x)/4\\) and \\(g(x) = x^4\\)Nice! The 1/4 cancels out the 4 produced by \\(\\partial_x g(x)\\). \\(f(x) = \\cos(x)\\) and \\(g(x) = x^4\\)︎✘ \\(f(x) = x^4\\) and \\(g(x) = \\cos(x)\\)︎✘ But \\(h(x)\\) involves \\(\\cos(x^4)\\) not \\(cos^4(x)\\). Once again, \\(\\int h(x) dx = F(g(x))\\), where \\(\\partial_x F(x) = f(x)\\). Exercise XX.XX: kay2zx Question A What is \\[\\int \\frac{\\sin(x)}{\\cos^5(x)}dx\\ ?\\]     \\(\\ln(cos(x))\\)︎✘        \\(- \\frac{1}{4} \\cos^{-4}(x)\\)\\(\\heartsuit\\ \\)       \\(\\frac{1}{6} \\cos^{-6}(x)\\)︎✘ Exercise XX.XX: nef1lB Question A Use u-substitution to find \\[\\int \\frac{4 e^{4x} + 4}{e^{4x}}dx\\] \\(\\ln(e^{4x} + 4)\\)Excellent!  \\(1/(e^{4x} + 4)\\)︎✘ \\(\\frac{1}{4} e^{4x} + 4\\)︎✘ \\(\\frac{1}{2} 1/(e^{4x} + 4)^2\\)︎✘ Exercise XX.XX: 1qDQZz Go through the steps above to find the anti-derivative of \\(g(x) \\equiv x \\cos(x)\\). Step 1 hint: We know the anti-derivative of \\(\\cos(x)\\) is \\(\\sin(x)\\), so an appropriate helper function is the function \\(x\\, \\sin(x)\\). Now do steps (2) and (3): (2) take the derivative of the helper function and then (3) integrate each term in the result. Question A What is the derivative of the helper function with respect to \\(x\\)? \\(\\partial_x \\text{helper}(x) = \\sin(x) + x \\cos(x)\\)Nice!  \\(\\partial_x \\text{helper}(x) = \\sin(x) + x \\sin(x)\\)︎✘ \\(\\partial_x \\text{helper}(x) = \\sin(x) + \\cos(x)\\)︎✘ \\(\\partial_x \\text{helper}(x) = \\sin(x)\\cos(x)\\)︎✘ Question B What is \\[\\int \\partial_x \\text{helper}(x)\\ ?\\] \\(\\text{helper}(x) + C\\)Excellent! We included the constant of integration \\(C\\) just as a reminder. \\(\\frac{1}{2} \\text{helper}^2(x)\\)︎✘ \\(1 / \\text{helper}(x)\\)︎✘ Whatever it is, it’s just as complicated as the original integral. No obvious way to do it.︎✘ Actually, the answer is simple, even if it doesn’t seem to get us anywhere. Wait for the next problem! Question C What is the integral with respect to \\(x\\) of the first part of the expanded form of the helper function, that is, \\(\\int \\sin(x) dx\\)? \\(-\\cos(x)\\)Nice! This is one of our basic modeling functions. \\(\\cos(x)\\)︎✘ Close. \\(\\cos(x) = \\partial_x \\sin(x)\\), but we want \\(\\int \\sin(x) dx.\\) \\(e^x \\sin(x)\\)︎✘ \\(e^x \\cos(x)\\)︎✘ Question D What is the integral with respect to \\(x\\) of the second part of the expanded form of the helper function, that is, \\(\\int x\\, \\cos(x)\\)? It’s the same as the original problem! I thought you were showing us how to do the problem. If we didn’t know the answer when we started, why should we be able to do it now?︎✘ An understandable frustration. But think! Now you have the original problem written out as part of an equation with two integrals that you do know. It’s the same as the original problem. I’ve got an equation involving the original problem and two bits of algebra/calculus that I know how to do. Thanks!Excellent!  \\(\\sin(x)\\)︎✘ If this were true, then \\(\\partial_x \\sin(x)\\) would give us \\(x\\, \\cos(x)\\). But, as you know, \\(\\partial_x \\sin(x) = \\cos(x)\\), so this answer must be wrong. Solve for the answer to the original function and write the function in R notation here: makeFun( ...your stuff here... ~ x) Exercise XX.XX: YMuG92 Use the same procedure to find the anti-derivative of \\(x\\, \\cos(2x)\\). Since \\[\\cos(2x) = \\frac{1}{2}\\partial_x \\sin(2 x)\\] a reasonable guess for a helper function will be \\(x \\sin(2x)\\). (We have intentionally dropped the \\(1/2\\) to simplify the rest of the procedure. You’ll see that such multiplicative constants don’t matter, since they will be on both sides of the equation showing the derivative of the helper function. You can see this by keeping the \\(1/2\\) in the helper function and watching what happens to it.) As you work through the steps be very careful about the constants and make sure you check your final answer by differentiating. Question A What is \\(\\partial_x x\\, \\sin(x)\\)? \\(\\sin(x) + x\\, \\cos(x)\\)Good.  \\(\\sin(x) + x\\, \\sin(x)\\)︎✘ \\(\\cos(x) + x\\, \\sin(x)\\)︎✘ \\(\\cos(x) + x\\, \\cos(x)\\)︎✘ Question B What is \\(\\int \\partial_x [ x\\, \\sin(x)] dx\\)? \\(x\\, \\sin(x)+C\\)Excellent! Integration undoes differentiation! \\(\\sin(x)+C\\)︎✘ \\(\\cos(x)+C\\)︎✘ \\(x\\, \\cos(x)+C\\)︎✘ Question C What is \\(\\int x\\, \\cos(x) dx\\)? \\(x\\, \\sin(x) + \\cos(x)\\)Excellent!  \\(x\\, \\cos(x) + \\cos(x)\\)︎✘ \\(x\\, \\cos(x) + \\sin(x)\\)︎✘ \\(x\\, \\sin(x) + \\sin(x)\\)︎✘ Exercise XX.XX: LpYZy4 A giant tortoise (with very good eyesight and standing on an unobstructed plane!) spies a head of lettuce on the ground 65 meters away. Being hungry (and knowing the shortest path between two points on the plane!), the tortoise takes off in a straight line for the lettuce. She pretty quickly reaches her top speed, but then starts to tire. If her velocity as a function of time (in meters per minute) is modeled by \\(v(t) = 7 t e^{-0.3t}\\), how long does it take the tortoise to reach her lunch? Answer this question by finding an calculus/algebra formula for the tortoise’s displacement and then use it to approximate how long it takes to get to the lettuce. 3775 We’re going to be looking at \\(\\int v(t) dt = 7 \\int t e^{-0.3 t} dt\\). We’ll call the left side of the equation “displacement(t)”. Use integration by parts to find displacement(t) as a simple formula in \\(t\\). The tortoise will reach the cabbage at time \\(t^\\star\\) such that \\(\\text{displacement}(t^\\star) = 65\\) meters. In a SANDBOX, graph your displacement function to find \\(t^\\star\\). Remember that there will be a constant of integration which can be found by noting that \\(\\text{displacement}(0) = 0\\). (Note that the graphics domain given in the example code isn’t necessarily the best choice for answering the question.) 3780 displacement &lt;- makeFun(7 * WHAT + C ~ t) slice_plot(displacement(t) ~ t, domain(t=c(0,5))) Question A At what time \\(t^\\star\\) does the tortoise reach the cabbage?     5.95 sec︎✘        10.85 sec\\(\\heartsuit\\ \\)       15.75 sec︎✘        Never! (That is, \\(t^\\star\\) is infinite.)︎✘ Exercise 31.07: f6C4Ia Tables of integrals Although any function has an anti-derivative, that anti-derivative cannot always be presented in algebraic notation. This poses no fundamental problem to the construction of the anti-derivative, particularly when a computer is available to handle the book-keeping of numerical integration. 3845 Still, it is convenient to have an algebraic form when it can be found. Many people have devoted considerable effort to constructing extensive collections of functions for which an algebraic form of anti-derivative is known. Think of such collections as a gallery of portraits of people who happen to have red hair. No matter how large the collection, you’ll often have to deal people who are not redheads. And unlike real redheads, it can be hard to know whether a function has an anti-derivative that can be expressed simply in algebraic form. For instance, \\(f(x) \\equiv \\exp(-x^2)\\) does not, even though it is ubiquitous in fields such as statistics. 3850 So, how to organize the gallery of redheads? Let’s take a field trip to the NIST DLMF (The US National Institute of Standards and Technology (NIST) has been a primary publisher for more than 50 years of information about functions encountered in applied mathematics. The work, published originally in book form, is also available via the internet as the NIST Digital Library of Mathematical Functions! 3860 Warning! Many visitors to NIST DLMF encounter dizziness, fatigue, and anxiety. Should you experience such symptoms, close your eyes and remember that DLMF is a reference work and that you will not be examined on its use. Nonetheless, to help you benefit maximally from the field trip, there are a few questions in this Daily Digital for you to answer from DLMF. 3865 You should also note that the techniques in almost universal use to help you navigate through voluminous collections of data (e.g. Twitter, Facebook, Instagram, YouTube) such as ratings, subscribing, “friending,” following, etc. are entirely absent from DLMF. There’s not even a friendly introduction to each chapter saying who the material might be of interest to. 3870 We’re going to focus on Chapter 4, “Elementary Functions,” and indeed just a few sections from that chapter. (A better name for the chapter would be “The Functions Most Often Used.” They are not “elementary” as in “elementary school” but as in the “periodic table of elements.”) 3875 Section 4.10 covers integrals and anti-derivatives of logarithmic, exponential and power-law functions. Section 4.26 is similar, but for trigonometric functions. Navigate to equation 4.10.1. This is one of the anti-derivatives you are expected to know by heart in CalcZ. Notice that the variable name \\(z\\) is used. They could have selected any other name; \\(x\\) and \\(t\\) are popular, \\(y\\) less so, and \\(\\xi\\) even less so. The use of \\(z\\) is a signal to the cognoscenti that the function can be applied to both real and complex numbers. Look at equation 4.10.8. This is another of the functions whose anti-derivative you should know by heart. Perhaps it would have avoided some confusion if 4.10.1 had been written in terms of \\[\\int \\frac{1}{az}dz\\] so that you would know what to do if you had encountered such a function. Some exercises: Question A Which of these is \\(\\int \\frac{1}{az}dz\\)? \\(\\frac{1}{a} \\ln(z)\\)Nice! The level of the DLMF is such that you would be expected to know on your own that \\(\\int \\frac{1}{az} dz = \\frac{1}{a}\\int \\frac{1}{z}dz\\). In other words, the \\(\\frac{1}{a}\\) here is a scalar multiple of the function \\(\\frac{1}{z}\\) and “the integral of a scalar multiple of a function is the scalar multiple of the integral of the function.”. Really. There is no anti-derivative of \\(1/az\\).︎✘ Every function has an anti-derivative. \\(a \\ln(z)\\)︎✘ You lost track of a reciprocal somewhere. askMC( &quot;Use Section 4.10 of DLMF to find $\\\\int \\\\frac{1}{e^{3 t} + 5}dt$&quot;, &quot;+$\\\\frac{1}{15}(3t - \\\\ln(e^{3t} + 5))$+&quot;, &quot;There&#39;s no such function listed in Section 4.10.&quot; = &quot;Although DLFM wrote the function using the variable name $z$, using $t$ instead is perfectly legitimate.&quot;, &quot;$\\\\frac{1}{15}(5 t - \\\\ln(e^{5t} + 3))$&quot; = &quot;Looks like you mixed up the $a$ and $b$.&quot; ) Question B Use Section 4.10 of DLMF to find \\(\\int \\frac{1}{e^{3 t} + 5}dt\\) \\(\\frac{1}{15}(3t - \\ln(e^{3t} + 5))\\)Excellent!  There’s no such function listed in Section 4.10.︎✘ Although DLFM wrote the function using the variable name \\(z\\), using \\(t\\) instead is perfectly legitimate. \\(\\frac{1}{15}(5 t - \\ln(e^{5t} + 3))\\)︎✘ Looks like you mixed up the \\(a\\) and \\(b\\). askMC( &quot;Is $\\\\frac{1}{e^{az} + b}$ different from $e^{-(az + b)}$?&quot;, &quot;+Yes+&quot; = &quot;$e^{-(az + b)}$ is a simple exponential with the linear interior function $-(az + b)$.&quot;, &quot;No&quot; = &quot;They look similar, but $1/(e^{az} + b)$ is not an exponential function and it&#39;s not $1/e^{az} + 1/b$ either.&quot;, &quot;Depends on the value of $b$.&quot; = &quot;A technically correct answer but misleading, since it&#39;s only for $b=0$ that the two functions are equal.&quot; ) Question C Is \\(\\frac{1}{e^{az} + b}\\) different from \\(e^{-(az + b)}\\)? YesGood. \\(e^{-(az + b)}\\) is a simple exponential with the linear interior function \\(-(az + b)\\). No︎✘ They look similar, but \\(1/(e^{az} + b)\\) is not an exponential function and it’s not \\(1/e^{az} + 1/b\\) either. Depends on the value of \\(b\\).︎✘ A technically correct answer but misleading, since it’s only for \\(b=0\\) that the two functions are equal. askMC( &quot;Using section 4.26, find $\\\\int \\\\tan(\\\\theta) d\\\\theta$.&quot;, &quot;+$-\\\\ln\\\\left(\\\\strut\\\\cos(\\\\theta)\\\\right)$+&quot;, &quot;$\\\\tan(\\\\theta)$ doesn&#39;t have an anti-derivative.&quot; = &quot;All functions have an anti-derivative.&quot;, &quot;There&#39;s no $\\\\theta$ in section 4.26&quot; = &quot;The authors didn&#39;t use $\\\\theta$ as the name of the variable, but $\\\\theta$ (\\&quot;theta\\&quot;) is every bit as good a name to use as $x$ or $t$.&quot; ) Question D Using section 4.26, find \\(\\int \\tan(\\theta) d\\theta\\). \\(-\\ln\\left(\\strut\\cos(\\theta)\\right)\\)Correct.  \\(\\tan(\\theta)\\) doesn’t have an anti-derivative.︎✘ All functions have an anti-derivative. There’s no \\(\\theta\\) in section 4.26︎✘ The authors didn’t use \\(\\theta\\) as the name of the variable, but \\(\\theta\\) (“theta”) is every bit as good a name to use as \\(x\\) or \\(t\\). Mathematicians have a list that is a bit longer than our pattern-book functions—they call them elementary functions and include the tangent and other trig functions and their inverses, as well as what are called “hyperbolic functions” and their inverses.↩︎ Again, mathematicians prefer to refer to the “elementary functions” rather than the pattern-book functions. \\(\\dnorm()\\) and \\(\\pnorm()\\) are not elementary functions, and there are several elementary function that we don’t include in the pattern-book list.↩︎ Many jurisdictions tax food and clothing, etc. at a different rate than other items.↩︎ The tabulated function is called the “error function,” amusingly written \\(\\text{Erf}(x)\\). It is essentially the same as the gaussian, the relationship being \\(\\text{Erf}(x) + 1 = 2\\pnorm(x)\\) for \\(0\\leq x &lt; \\infty\\).↩︎ "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
