<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 44 The target problem | MOSAIC-Calculus.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 44 The target problem | MOSAIC-Calculus.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 44 The target problem | MOSAIC-Calculus.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="projection-residual.html"/>
<link rel="next" href="statistical-modeling.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<span class="math inline">
\(\newcommand{\line}{\text{line}}
\newcommand{\hump}{\text{hump}}
\newcommand{\sigmoid}{\text{sigmoid}}
\newcommand{\recip}{\text{recip}}
\newcommand{\diff}[1]{{\cal D}_#1}
\newcommand{\pnorm}{\text{pnorm}}
\newcommand{\dnorm}{\text{dnorm}}
\let\origvec\vec
\let\origmathit\mathit
\let\orighat\hat
\newcommand{\vec}[1]{\overset{{\rule[-1pt]{0mm}{1mm}}\rightharpoonup}{\mathbf #1}}
\newcommand{\mathit}[1]{\underset{\leftharpoondown}{\overset{{\rightharpoonup}}{\large\mathbf #1}}}
\newcommand{\hat}[1]{\widehat{\ \mathbf#1\ }}
\newcommand{\len}[1]{\|{\mathbf #1}\|}
\newcommand{\tvec}[1]{\overset{\uparrow}{\mathbf #1}}
\newcommand{\tmat}[1]{\overset{\leftrightarrows}{\mathbf #1}}
\newcommand{\perpendicularto}[2]{#1\!\perp\!#2}
\newcommand{\modeledby}[2]{#1\!\sim\!#2}
\newcommand{\CC}[1]{\color{#648fff}{#1}}
\newcommand{\CE}[1]{\color{#785ef0}{#1}}
\newcommand{\CA}[1]{\color{#dc267f}{#1}}
\newcommand{\CB}[1]{\color{#fe6100}{#1}}
\newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
</span>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="mosaic-calc-style-copy.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../docs/welcome-to-calculus.html">Welcome to calculus</li>
<li><a href="../block-1/change.html">Block 1: Functions & quantities</a></li>
<li><a href="../block-2/change-relatonships.html">Block 2: Differentiation</a></li>
<li><a href="../block-3/change-accumulation.html">Block 3: Accumulation</a></li>
<li><a href="../block-4/block4-intro.html">Block 4: Manifestations</a></li>
<hr>
<li><strong><a href="./">Block 5: Linear combinations</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="41" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>41</b> Vectors</a>
<ul>
<li class="chapter" data-level="41.1" data-path="vectors.html"><a href="vectors.html#length-direction"><i class="fa fa-check"></i><b>41.1</b> Length &amp; direction</a></li>
<li class="chapter" data-level="41.2" data-path="vectors.html"><a href="vectors.html#the-nth-dimension"><i class="fa fa-check"></i><b>41.2</b> The n<sup>th</sup> dimension</a></li>
<li class="chapter" data-level="41.3" data-path="vectors.html"><a href="vectors.html#geometry-arithmetic"><i class="fa fa-check"></i><b>41.3</b> Geometry &amp; arithmetic</a></li>
<li class="chapter" data-level="41.4" data-path="vectors.html"><a href="vectors.html#vector-length"><i class="fa fa-check"></i><b>41.4</b> Vector lengths</a></li>
<li class="chapter" data-level="41.5" data-path="vectors.html"><a href="vectors.html#angles"><i class="fa fa-check"></i><b>41.5</b> Angles</a></li>
<li class="chapter" data-level="41.6" data-path="vectors.html"><a href="vectors.html#orthogonality"><i class="fa fa-check"></i><b>41.6</b> Orthogonality</a></li>
<li class="chapter" data-level="41.7" data-path="vectors.html"><a href="vectors.html#exercises"><i class="fa fa-check"></i><b>41.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html"><i class="fa fa-check"></i><b>42</b> Linear combinations of vectors</a>
<ul>
<li class="chapter" data-level="42.1" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#scaling-vectors"><i class="fa fa-check"></i><b>42.1</b> Scaling vectors</a></li>
<li class="chapter" data-level="42.2" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#adding-vectors"><i class="fa fa-check"></i><b>42.2</b> Adding vectors</a></li>
<li class="chapter" data-level="42.3" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#linear-combinations"><i class="fa fa-check"></i><b>42.3</b> Linear combinations</a></li>
<li class="chapter" data-level="42.4" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#matrices-and-linear-combinations"><i class="fa fa-check"></i><b>42.4</b> Matrices and linear combinations</a></li>
<li class="chapter" data-level="42.5" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#sub-spaces"><i class="fa fa-check"></i><b>42.5</b> Sub-spaces</a></li>
<li class="chapter" data-level="42.6" data-path="linear-combs-vectors.html"><a href="linear-combs-vectors.html#exercises-1"><i class="fa fa-check"></i><b>42.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="projection-residual.html"><a href="projection-residual.html"><i class="fa fa-check"></i><b>43</b> Projection &amp; residual</a>
<ul>
<li class="chapter" data-level="43.1" data-path="projection-residual.html"><a href="projection-residual.html#projection-terminology"><i class="fa fa-check"></i><b>43.1</b> Projection terminology</a></li>
<li class="chapter" data-level="43.2" data-path="projection-residual.html"><a href="projection-residual.html#projection-onto-a-single-vector"><i class="fa fa-check"></i><b>43.2</b> Projection onto a single vector</a></li>
<li class="chapter" data-level="43.3" data-path="projection-residual.html"><a href="projection-residual.html#projection-onto-a-set-of-vectors"><i class="fa fa-check"></i><b>43.3</b> Projection onto a set of vectors</a></li>
<li class="chapter" data-level="43.4" data-path="projection-residual.html"><a href="projection-residual.html#exercises-2"><i class="fa fa-check"></i><b>43.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="44" data-path="target-problem.html"><a href="target-problem.html"><i class="fa fa-check"></i><b>44</b> The target problem</a>
<ul>
<li class="chapter" data-level="44.1" data-path="target-problem.html"><a href="target-problem.html#linear-equations"><i class="fa fa-check"></i><b>44.1</b> Linear equations</a></li>
<li class="chapter" data-level="44.2" data-path="target-problem.html"><a href="target-problem.html#visualization-in-a-two-dimensional-subspace"><i class="fa fa-check"></i><b>44.2</b> Visualization in a two-dimensional subspace</a></li>
<li class="chapter" data-level="44.3" data-path="target-problem.html"><a href="target-problem.html#properties-of-the-solution"><i class="fa fa-check"></i><b>44.3</b> Properties of the solution</a></li>
<li class="chapter" data-level="44.4" data-path="target-problem.html"><a href="target-problem.html#application-of-the-target-problem"><i class="fa fa-check"></i><b>44.4</b> Application of the target problem</a></li>
<li class="chapter" data-level="44.5" data-path="target-problem.html"><a href="target-problem.html#exercises-3"><i class="fa fa-check"></i><b>44.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="statistical-modeling.html"><a href="statistical-modeling.html"><i class="fa fa-check"></i><b>45</b> Statistical modeling</a>
<ul>
<li class="chapter" data-level="45.1" data-path="statistical-modeling.html"><a href="statistical-modeling.html#r-squared"><i class="fa fa-check"></i><b>45.1</b> R-squared</a></li>
<li class="chapter" data-level="45.2" data-path="statistical-modeling.html"><a href="statistical-modeling.html#interpreting-the-model"><i class="fa fa-check"></i><b>45.2</b> Interpreting the model</a></li>
<li class="chapter" data-level="45.3" data-path="statistical-modeling.html"><a href="statistical-modeling.html#improving-the-model"><i class="fa fa-check"></i><b>45.3</b> Improving the model</a></li>
<li class="chapter" data-level="45.4" data-path="statistical-modeling.html"><a href="statistical-modeling.html#exercises-4"><i class="fa fa-check"></i><b>45.4</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="../block-6/dynamics.html">Block 6: Dynamics</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="target-problem" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 44</span> The target problem</h1>
<div class="underconstruction">
<p>Chapter not yet released</p>
</div>
<div style="float:right;">
<p><a href="https://github.com/ProjectMOSAIC/MOSAIC-Calculus/blob/main/Block-5/B5-target-problem.Rmd"><img src="www/icons/edit.png" /></a></p>
</div>
<blockquote>
<p><em>“In theory there is no difference between theory and practice, while in practice there is.”</em></p>
</blockquote>
<p>In this chapter, we ask you to reconsider a mathematical theory that is universally taught in high-school and to consider augmenting it with newer computational ideas that address the same kind of problems, but which produce useful results even when the mathematical theory insists the “a solution does not exist.”</p>
<p>The time-honored theory is that taught in high-school algebra. There’s nothing wrong with that theory except that it is incomplete. It doesn’t address the needs of present-day practice, particularly in data science, statistics, and machine learning.</p>
<p>Algebra, in its basic sense, is about generalizing arithmetic to handle situations where some quantities are not yet known numerically and so are represented by symbols. The algebra student learns rules for symbolic expressions that allow the expressions to be re-arranged into other forms that would clearly be valid if replaced by numbers. Some examples of these rules:</p>
<p>i. <span class="math inline">\(ax = b\)</span> is equivalent to <span class="math inline">\(x = a/b\)</span>.</p>
<p>ii. <span class="math inline">\(a + x = b\)</span> is equivalent to <span class="math inline">\(x=b-a\)</span>.</p>
<p>iii. <span class="math inline">\(a x^2 + b x + c = 0\)</span> is equivalent to <span class="math inline">\(x = \frac{-b\pm \sqrt{\strut b^2 - 4ac}}{2a}\)</span>.</p>
<p>iv. <span class="math inline">\(\ln(ax) = b\)</span> is equivalent to <span class="math inline">\(x = \frac{1}{a}\ln(b)\)</span>.</p>
<p>A major challenge to the algebra student is to use such rules to re-arrange expressions into a form <span class="math inline">\(x=\)</span> that enables <span class="math inline">\(x\)</span> to be calculated from the numerical values of the other symbols. Unfortunately, students are given little or no insight to the historical origins of algebra techniques and why they are not necessarily appropriate for all tasks.</p>
<p>In English, the word “algebra” is seen as early as 1551. It comes from a book written by the Persian Muhammad ibn Musa al-Khwarizmi (780-850), <em>The Compendious Book on Calculation by Completion and Balancing</em>. The book introduced the use of rules familiar to every algebra student. In the original Arabic, the title includes the word “al-jabr,” meaning “completion” or “rejoining.” According to some sources, the literal meaning of “al-jabr” was resetting and rejoining broken bones. That literal meaning correctly conveys the importance of the subject, but also the pain endured by many algebra students. (Incidentally, the “algorithm” comes from the name of the book’s author: al Khwarizmi. He is a major figure in the history of mathematics.)</p>
<p>This history may not be of immediate interest to every reader, but there is a good point to it. The roots of algebra are ancient and developed in an era very different from our own. Today’s student learns algebra in order to facilitate the study and practice of physics, chemistry, statistics, engineering, and other fields. None of these fields existed when algebra was being conceived. That is, the theory was developed before the recognition of the problems and calculations that arise in modern practice. Thus, “in practice, theory and practice are different.”</p>
<p>This chapter is about re-expressing some basic algebraic theory in order to align it better to today’s practice.</p>
<div id="linear-equations" class="section level2" number="4.1">
<h2><span class="header-section-number">44.1</span> Linear equations</h2>
<p>The focus of interest will be the familiar task</p>
<p><span class="math display">\[\ \ \ \ \ \ \text{given}\ \ a x = b\,,\ \ \text{find}\ \ x\ .\]</span> All algebra students learn that <span class="math inline">\(x = b/a\)</span>, with the proviso that if <span class="math inline">\(a = 0\)</span>, “there is no solution.”</p>
<p>A somewhat more advanced algebra task is to work with “simultaneous linear equations,” for example:
<span class="math display">\[\ \ \ \text{given}\ \ \ \begin{array}{rrrcr}
3 x &amp; + &amp; 2 y &amp; = &amp; 7\\
-1&amp;+&amp;y&amp;=&amp;4\end{array} 
\ \ \ \ \text{find}\ \ x\,\&amp;\,y\ .
\]</span></p>
<p>Solving simultaneous linear equations is hard. It involves more arithmetic than <span class="math inline">\(ax = b\)</span> and requires the student to make good choices how to take linear combinations of the two equations to reduce the problem to two equations, one with <span class="math inline">\(x\)</span> as the only unknown and one with <span class="math inline">\(y\)</span>. Also, the “there is no solution” proviso is not easy to state, so you can’t know at a glance whether there is indeed a solution.</p>
<p>The simultaneous linear equation problem can be more compactly written using matrix and vector notation. <span class="math display">\[\begin{array}{rrrcr}3x &amp; + &amp;2y &amp; = &amp; 7\\-1&amp;+&amp;y&amp;=&amp;4\end{array} \ \ \text{is the same as}\ \ \left[\begin{array}{r}3\\-1\end{array}\right] x + \left[\begin{array}{r}2\\1\end{array}\right] y =
\left[\begin{array}{r}7\\4\end{array}\right] \]</span> You can see the vector form as a linear combination of two vectors. Collecting these two vectors into a matrix <span class="math inline">\(\mathit{A}\)</span>, and similarly writing <span class="math inline">\(x\, \text{and}\, y\)</span> as the scalar components of a vector <span class="math inline">\(\vec{x}\)</span> gives <span class="math display">\[\left[\begin{array}{rr}3&amp;2\\-1&amp;1\end{array}\right]\ \vec{x} = \left[\begin{array}{r}7\\4\end{array}\right]\]</span> Which can be expressed as <span class="math inline">\(\mathit{A} \vec{x} = \vec{b}\)</span>.</p>
<p>A student, recognizing the similarity of <span class="math inline">\(\mathit{A}\vec{x} = \vec{b}\)</span> to <span class="math inline">\(a x = b\)</span> would reasonably suggest the solution <span class="math inline">\(\vec{x} = \vec{b}/ \mathit{A}\)</span>. Such a student might be instructed, “No, you can’t do this.” A better response would be, “Good. Now tell me what you mean by <span class="math inline">\(\vec{b}/\mathit{A}\)</span>?”</p>
<p>Modern practice often calls for solving <span class="math inline">\(\mathit{A}\vec{x} = \vec{b}\)</span> in settings where a traditional algebra teacher might say, as for <span class="math inline">\(0 x = b\)</span> that “there is no solution.”</p>
To illustrate such a setting, recall the problems from Block 1 of finding the linear combination of the functions <span class="math inline">\(f(\mathtt{time})=1\)</span> and <span class="math inline">\(g(\mathtt{time}) = e^{-0.019 \mathtt{time}}\)</span> that best matches the <code>CoolingWater</code> data:
<table>
<thead>
<tr>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
temp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
98.2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94.4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
91.4
</td>
</tr>
<tr>
<td colspan="2" align="center">
… and so on …
</td>
</tr>
<tr>
</tr>
<tr>
<td style="text-align:right;">
220
</td>
<td style="text-align:right;">
25.9
</td>
</tr>
<tr>
<td style="text-align:right;">
221
</td>
<td style="text-align:right;">
25.8
</td>
</tr>
</tbody>
</table>
<p>We seek scalars <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> such that the function <span class="math inline">\(C f(\mathtt{time}) + D g(\mathtt{time})\)</span> gives the best possible match to <code>temp</code>.</p>
<p>We can compactly write the problem of finding the best linear combination into matrix form by evaluating <span class="math inline">\(f()\)</span> and <span class="math inline">\(g()\)</span> at the values listed in the <code>time</code> column:
<span class="math display">\[\underbrace{\left[\begin{array}{rr}1&amp;1.0000\\1&amp;0.9812\\1&amp;0.9627\\\vdots\\1&amp;0.0153\\1&amp;0.0150\end{array}\right]}_{\!\!\!\!\!\!\!\!{\large\mathit{A}} = \left[\strut f(\mathtt{time})\,,\ \ \ g(\mathtt{time})\right]} \underbrace{\left[\begin{array}{r}C\\D\end{array}\right]}_{\large\vec{x}} \ \text{is the best match to}\  \underbrace{\left[\begin{array}{r}\mathtt{98.2}\\\mathtt{94.4}\\\mathtt{91.4}\\\vdots\\\mathtt{25.9}\\\mathtt{25.8}\end{array}\right]}_{\large\vec{b}}\]</span></p>
<p>Regrettably, the classical algebraicists did not propose a rule for “is the best match to.” Replacing “is the best match to” with <span class="math inline">\(=\)</span> is not literally correct since “there is no solution” that makes the equality literally true.</p>
<p>We’ll use the term <strong><em>target problem</em></strong> to name the task of finding <span class="math inline">\(\vec{x}\)</span> such that <span class="math inline">\(\mathit{A} \vec{x}\)</span> is the best possible match to <span class="math inline">\(\vec{b}\)</span>. This term is motivated by the idea that <span class="math inline">\(\vec{b}\)</span> is a target, and we seek to use the resources in <span class="math inline">\(\mathit{A}\)</span> to get as close as possible to the target: choose <span class="math inline">\(\vec{x}\)</span> such that <span class="math inline">\(\mathit{A} \vec{x}\)</span> falls as closely as possible to the target.</p>
<p>To address the practical problem in the notation of algebra theory, people write <span class="math display">\[\mathit{A} \vec{x} = \vec{b} - \vec{r}\]</span> where <span class="math inline">\(\vec{r}\)</span> is a vector specially selected to path up <span class="math inline">\(\mathit{A} \vec{x} = \vec{b}\)</span> so that when the best-matching <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> are found, there will be a literal equality solution to <span class="math inline">\(\mathit{A} \vec{x} = \vec{b} - \vec{r}\)</span>.</p>
<p>At first glance, <span class="math inline">\(\mathit{A} \vec{x} = \vec{b} - \vec{r}\)</span> might seem intractable: How are we to find <span class="math inline">\(\vec{r}\)</span>. The answer is that <span class="math inline">\(\vec{r}\)</span> will be the solution to the projection problem <span class="math inline">\(\vec{b}\sim\mathit{A}\)</span>. When <span class="math inline">\(\vec{r}\)</span> is selected this way, <span class="math inline">\(\vec{r}\)</span> will be the shortest possible vector that can do the matching up. In other words, by choosing <span class="math inline">\(\vec{r} = \vec{b} \sim \mathit{A}\)</span> we are implementing the following definition of “is the best match to”: “the best match is the one with the smallest length <span class="math inline">\(\vec{r}\)</span>.”</p>
<p>It’s remarkable that one can find <span class="math inline">\(\vec{r}\)</span> even without knowing <span class="math inline">\(\vec{x}\)</span>. That’s why we introduced and solved the <strong><em>projection problem</em></strong> before taking on the <strong><em>target problem</em></strong>.</p>
<p>The part of the target problem that we have still to figure out is how, given <span class="math inline">\(\vec{r}\)</span>, to find <span class="math inline">\(\vec{x}\)</span>. But even at this point you can see that <span class="math inline">\(\mathit{A}\vec{x} = \vec{b} - \vec{r}\)</span> must have a solution, since <span class="math inline">\(\vec{b} - \vec{r}\)</span> is exactly the model vector <span class="math inline">\(\hat{b}\)</span> which, as we saw in Chapter <a href="projection-residual.html#projection-residual">43</a>, must lie in <span class="math inline">\(span{\mathit{A}}\)</span>.</p>
</div>
<div id="visualization-in-a-two-dimensional-subspace" class="section level2" number="4.2">
<h2><span class="header-section-number">44.2</span> Visualization in a two-dimensional subspace</h2>
<p>To help you create a mental model of the geometry of the target problem, we’ll solve it graphically for a two dimensional subspace. That is, we’ll solve <span class="math inline">\(\left[\vec{u}, \vec{v}\right] \vec{x} = \vec{b}\)</span>. For simplicity, the vectors <span class="math inline">\(\vec{u}\)</span>, <span class="math inline">\(\vec{v}\)</span> and <span class="math inline">\(\vec{b}\)</span> will have two components. This means that there is no need to project <span class="math inline">\(\vec{b}\)</span> onto the subspace; it’s already there (so long as <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> have different directions. )</p>
<p>You may already have encountered the step (ii) technique in your childhood reading. The problem appears in Robert Louis Stevenson’s famous novel, <a href="https://www.gutenberg.org/cache/epub/120/pg120-images.html#link2H_4_0039"><em>Treasure Island</em></a>. The story is about the discovery of a treasure map indicating the location of buried treasure on the eponymous Island. There is a red X on the map labelled “bulk of treasure here,” but that is hardly sufficient to guide the dig for treasure. After all, every buried treasure needs some secret to protect it. On the back of the map is written a cryptic clue to the precise location:</p>
<blockquote>
<p>Tall tree, Spy-glass shoulder, bearing a point to the N. of N.N.E.<br />
Skeleton Island E.S.E. and by E.<br />
Ten feet.</p>
</blockquote>
<p>Skeleton Island is clearly marked on the map, as is Spy-glass Hill. The plateau marked by the red X “was dotted thickly with pine-trees of varying height. Every here and there, one of a different species rose forty or fifty feet clear above its neighbors.” But which of these was the “tall tree” mentioned in the clue?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:treasure-island"></span>
<img src="www/drawings/treasure-island-annotated.png" alt="The map of *Treasure Island*. The heading 'E.S.E. and by E.' is marked with a solid black line starting at Skeleton Island. The heading 'N. of N.N.E.' is marked by dotted lines, one of which is positioned to point at the shoulder of Spy-glass Hill. Where the bearing from Skeleton Island meets the bearing to Spy-glass Hill will be the Tall tree." width="70%" />
<p class="caption">
Figure 44.1: The map of <em>Treasure Island</em>. The heading ‘E.S.E. and by E.’ is marked with a solid black line starting at Skeleton Island. The heading ‘N. of N.N.E.’ is marked by dotted lines, one of which is positioned to point at the shoulder of Spy-glass Hill. Where the bearing from Skeleton Island meets the bearing to Spy-glass Hill will be the Tall tree.
</p>
</div>
<p>With your new-found background in vectors, you will no doubt recognize that “N. of N.N.E” is the direction of a vector as is “E.S.E. and by E.” Pirate novels seem always to use the length unit of “pace,” which we’ll use here as well. The target is the shoulder of Spy-glass Hill. Or, in vector terms, <span class="math inline">\(\vec{b}\)</span> is the vector with Skeleton Island as the tail and the should of Spy-glass Hill as the tip. The vectors are <span class="math inline">\(\vec{u} = \text{N. of N.N.E.}\)</span> and
<span class="math inline">\(\vec{v} = \text{E.S.E. and by E.}\)</span> We need to <span class="math display">\[\text{solve} \ \ \underbrace{\left[\vec{u}, \vec{v}\right]}_{\Large\strut\mathit{A}} \underbrace{\small\left[\begin{array}{c}C\\D\end{array}\right]}_{\Large\vec{x}} = \vec{b}\ \ \text{for}\ \ {\small\left[\begin{array}{c}C\\D\end{array}\right]}\ .\]</span></p>
<p>Long John Silver, obviously an accomplished mathematician, starts near Skeleton Island, moving on along the vector that keeps Skeleton Island to the compass bearing one point east of east-south-east. While on the march, he keeps a telescope trained on the shoulder of Spy-glass Hill. When that telescope points one point north of north-north-east, they are in the vicinity of a tall tree. That’s the tree matching the clue.</p>
<p>The vectors in <em>Treasure Island</em> were perpendicular to one another, that is, <strong><em>mutually orthogonal</em></strong>. The more general situation is that the vectors in <span class="math inline">\(\mathit{A}\)</span> will be somewhat aligned with one another: not mutually orthogonal. <a href="target-problem.html#fig:telescope">44.2</a> illustrates the situation: <span class="math inline">\(\vec{v}\)</span> is not perpendicular to <span class="math inline">\(\vec{u}\)</span>. The task, still, is to find a linear combination of <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> that will match <span class="math inline">\(\vec{b}\)</span>. The diagram shows the <span class="math inline">\(\vec{u}\)</span> vector and the subspace aligned with <span class="math inline">\(\vec{u}\)</span>, and similarly for <span class="math inline">\(\vec{v}\)</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:telescope"></span>
<img src="www/drawings/u-v-spyglass.png" alt="The telescope method of solving projection onto two vectors." width="90%" />
<p class="caption">
Figure 44.2: The telescope method of solving projection onto two vectors.
</p>
</div>
<p>The algorithm is based in Long John Silver’s technique. Pick either <span class="math inline">\(\vec{u}\)</span> or <span class="math inline">\(\vec{v}\)</span>, it doesn’t matter which. In the diagram, we’ve picked <span class="math inline">\(\vec{v}\)</span>. Align your telescope with that vector. Now march along the other vector, <span class="math inline">\(\vec{u}\)</span>, carefully keeping the telescope on the bearing aligned with <span class="math inline">\(\vec{v}\)</span>. From the diagram, you can see that when you’ve marched to <span class="math inline">\(\frac{1}{2} \vec{u}\)</span>, the telescope does not yet have <span class="math inline">\(\vec{b}\)</span> in view. Similarly, at <span class="math inline">\(1 \vec{u}\)</span>, the target <span class="math inline">\(\vec{b}\)</span> isn’t yet visible. Marching a little further, to about <span class="math inline">\(1.6 \vec{u}\)</span> brings you to the point in the <span class="math inline">\(\vec{u}\)</span>-subspace where the target falls into view. This tells us that the coefficient on <span class="math inline">\(\vec{u}\)</span> will be 1.6.</p>
<p>To find the coefficient on <span class="math inline">\(\vec{v}\)</span>, you’ll need to march along the line of the telescope, taking steps of size <span class="math inline">\(\|\vec{v}\|\)</span>. In the diagram, we’ve marked the march with copies of <span class="math inline">\(\vec{v}\)</span> to make the counting easier. We’ll need to march <em>opposite</em> the direction of <span class="math inline">\(\vec{v}\)</span>, so the coefficient will be negative. Taking 2.8 steps of size <span class="math inline">\(\|\vec{v}\|\)</span> brings us to the target. Thus:</p>
<p><span class="math display">\[\vec{b} = 1.6 \vec{u} - 2.8 \vec{v}\ .\]</span></p>
<p>To handle vectors in spaces where telescopes are not available, we need an arithmetic algorithm. In R, that algorithm is packaged up as <code>qr.solve()</code>. We will pick this up again the next section.</p>
<div class="example">
<p><span id="exm:unlabeled-div-8" class="example"><strong>Example 44.1  </strong></span>In 3-dimensional space, visualization of the solution to the target problem is possible, at least for those who have the talent of rotating three-dimensional objects in their head. For the rest of us, a physical model can help; take three pencils labeled <span class="math inline">\(\vec{u}\)</span>, <span class="math inline">\(\vec{v}\)</span>, and <span class="math inline">\(\vec{b}\)</span> and bury their tails in a small ball of putty. (Chemistry molecular construction kits are a good alternative.)</p>
<p>In case putty, pencils, or a molecular model kit are not available, use the interactive diagram in Figure @ref{fig:b-onto-u-v}. This diagram also includes <span class="math inline">\(\hat{b}\)</span> and <span class="math inline">\(\vec{r}\)</span> with the hope that this will guide you into orienting the diagram appropriately to see where the solution comes from.</p>
<p style="text-align:center">
<iframe frameborder="0" height="480px" src="https://c3d.libretexts.org/CalcPlot3D/dynamicFigure/index.html?type=jaxlabel;position=middle;math=.;textonly=false&amp;type=vector;vector=%3C2,1,0%3E;visible=true;color=rgb(17,109,192);size=2;initialpt=(0,0,0)&amp;type=vector;vector=%3C-1,1,0%3E;visible=true;color=rgb(208,20,240);size=2;initialpt=(0,0,0)&amp;type=vector;vector=%3C1/2,2,2.5%3E;visible=true;color=rgb(106,168,79);size=2;initialpt=(0,0,0)&amp;type=z;z=0;visible=true;umin=-3;umax=3;vmin=-3;vmax=3;grid=30;format=normal;alpha=40;hidemyedges=true;constcol=rgb(255,0,0);view=0;contourcolor=red;fixdomain=true;contourplot=true;showcontourplot=false;firstvalue=-1;stepsize=0.2;numlevels=11;list=;xnum=46;ynum=46;show2d=false;hidesurface=false;hidelabels=true;showprojections=false;surfacecontours=true;projectioncolor=rgba(255,0,0,1);showxygrid=false;showxygridonbox=true;showconstraint=false&amp;type=vector;vector=%3C.5,2,0%3E;visible=true;color=rgb(173,255,0);size=2;initialpt=(0,0,0)&amp;type=vector;vector=%3C0,0,2.5%3E;visible=true;color=rgb(255,0,0);size=2;initialpt=(.5,2,0)&amp;type=text;text=Target%3A%20b;visible=true;point=(1/2,1,1.4);color=rgb(106,168,79);font=Arial;fontsize=14pt;bold=true;italic=false;fontmath=true;align=Lower-right&amp;type=text;text=Residual;visible=true;point=(.5,2,1);color=rgb(255,0,0);font=Arial;fontsize=11pt;bold=false;italic=false;fontmath=true;align=Upper-right&amp;type=text;text=u;visible=true;point=(1,.6,0);color=rgb(17,109,192);font=Arial;fontsize=14pt;bold=true;italic=false;fontmath=true;align=Upper-right&amp;type=text;text=v;visible=true;point=(-.6,.4,.1);color=rgb(208,20,240);font=Arial;fontsize=14pt;bold=true;italic=false;fontmath=true;align=Upper-right&amp;type=spacecurve;spacecurve=curve;x=-t;y=t;z=0;visible=true;width=2;view=0;tmin=-3;tmax=3;tsteps=10;color=rgb(233,185,233);showtrace=false;tval=0;constcol=true;twod=false;arrows=0;showpt=true;trace=false;vel=false;acc=false;osc=false;k=false;repeat=false;bounce=false;dashed=false;tanline=false;dropcurtain=false;showtvector=false;shownvector=false;showbvector=false;showtnbeqs=false;showtnblabels=false;showoscplane=false;showrectplane=false;shownormplane=false;optimizecurve=true;maxjointangle=10&amp;type=spacecurve;spacecurve=curve;x=2t;y=t;z=0;visible=true;width=2;view=0;tmin=-1.6;tmax=1.6;tsteps=10;color=rgb(159,187,213);showtrace=false;tval=0;constcol=true;twod=false;arrows=0;showpt=true;trace=false;vel=false;acc=false;osc=false;k=false;repeat=false;bounce=false;dashed=false;tanline=false;dropcurtain=false;showtvector=false;shownvector=false;showbvector=false;showtnbeqs=false;showtnblabels=false;showoscplane=false;showrectplane=false;shownormplane=false;optimizecurve=true;maxjointangle=10&amp;type=point;point=(1.66666,0.83333,0);visible=true;color=rgb(0,255,255);size=4&amp;type=point;point=(-1.1666,1.1666,0);visible=true;color=rgb(228,125,228);size=4&amp;type=spacecurve;spacecurve=curve;x=-t+1.6666;y=t+0.83333;z=0;visible=true;width=2;view=0;tmin=-2;tmax=2;tsteps=10;color=rgb(233,185,233);showtrace=false;tval=0;constcol=true;twod=false;arrows=0;showpt=true;trace=true;vel=true;acc=true;osc=false;k=false;repeat=false;bounce=false;dashed=false;tanline=false;dropcurtain=false;showtvector=false;shownvector=false;showbvector=false;showtnbeqs=false;showtnblabels=false;showoscplane=false;showrectplane=false;shownormplane=false;optimizecurve=true;maxjointangle=10&amp;type=spacecurve;spacecurve=curve;x=2t-1.1666;y=t+1.1666;z=0;visible=true;width=2;view=0;tmin=-.9;tmax=2;tsteps=200;color=rgb(162,193,222);showtrace=false;tval=0;constcol=true;twod=false;arrows=0;showpt=true;trace=true;vel=true;acc=true;osc=false;k=false;repeat=false;bounce=false;dashed=false;tanline=false;dropcurtain=false;showtvector=false;shownvector=false;showbvector=false;showtnbeqs=false;showtnblabels=false;showoscplane=false;showrectplane=false;shownormplane=false;optimizecurve=true;maxjointangle=10&amp;type=vector;vector=%3C-.6,1.2,0%3E;visible=false;color=rgb(228,125,228);size=2;initialpt=(0,0,0)&amp;type=text;text=v%20perp%20u;visible=false;point=(-.5,1,-.1);color=rgb(208,20,240);font=Times%20New%20Roman;fontsize=14pt;bold=false;italic=false;fontmath=true;align=Upper-right&amp;type=window;hsrmode=0;nomidpts=true;anaglyph=-1;center=0.09657308993109837,1.8128995478040388,9.833822698615093,1;focus=0,0,0,1;up=0.6869713273879257,-0.7158150586575313,0.12521660092011352,1;transparent=false;alpha=140;twoviews=false;unlinkviews=false;axisextension=0.7;xaxislabel=x;yaxislabel=y;zaxislabel=z;edgeson=true;faceson=true;showbox=false;showaxes=false;showticks=true;perspective=false;centerxpercent=0.5;centerypercent=0.5;rotationsteps=30;autospin=true;xygrid=false;yzgrid=false;xzgrid=false;gridsonbox=true;gridplanes=true;gridcolor=rgb(128,128,128);xmin=-2;xmax=2;ymin=-2;ymax=2;zmin=-2;zmax=2;xscale=1;yscale=1;zscale=1;zcmin=-4;zcmax=4;xscalefactor=1;yscalefactor=1;zscalefactor=1;tracemode=0;keep2d=false;zoom=0.78" width="90%">
</iframe>
</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:b-onto-u-v"></span>
<img src="www/tiny-blank.png" alt="Showing the relative orientation of the three vectors $\vec{u}$, $\vec{v}$ and $\vec{b}$. Drag the image to rotate it." width="1%" />
<p class="caption">
Figure 44.3: Showing the relative orientation of the three vectors <span class="math inline">\(\vec{u}\)</span>, <span class="math inline">\(\vec{v}\)</span> and <span class="math inline">\(\vec{b}\)</span>. Drag the image to rotate it.
</p>
</div>
<p><span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> are fixed in length. However, their lengths will appear to change as you rotate the space. This might be called the “gun-barrel” effect; a tube looks very short when you look down it’s longitudinal axis, but looks longer when you look at it from the side. Rotate the space until <strong>both</strong> <span class="math inline">\(\vec{u}\)</span> and <span class="math inline">\(\vec{v}\)</span> reach their maximum apparent length. The viewpoint that accomplishes this is looking downward perpendicularly onto the <span class="math inline">\(\left[\vec{u},\vec{v}\right]\)</span>-plane. In this orientation, you will be looking down the barrel of the <span class="math inline">\(\vec{r}\)</span> gun. Vector <span class="math inline">\(\vec{b}\)</span> is not in that plane, as you can confirm by rotating the plot a bit out of the <span class="math inline">\(\left[\vec{u},\vec{v}\right]\)</span>-plane. Returning to the perspective looking down perpendicularly on the place, you can see how <span class="math inline">\(\vec{b}\)</span> corresponds to <span class="math inline">\(\hat{b}\)</span>, the point in the plane where the projection of <span class="math inline">\(\vec{b}\)</span> will fall.</p>
<p>To find the scalar multiplier on <span class="math inline">\(\vec{v}\)</span>, rotate the space until the vector <span class="math inline">\(\vec{u}\)</span> is pointing straight toward you. You’ll see only the arrowhead of <span class="math inline">\(\vec{u}\)</span>. Vectors <span class="math inline">\(\vec{v}\)</span> and <span class="math inline">\(\hat{b}\)</span> will appear parallel to each other, but that’s because you are looking at the plane edge on. In this orientation, <span class="math inline">\(\hat{b}\)</span> will appear just a little longer than <span class="math inline">\(\vec{v}\)</span>, perhaps 1.2 times longer. So 1.2 is the scalar multiplier on <span class="math inline">\(\vec{v}\)</span>.</p>
<p>To figure out the scalar multiplier on <span class="math inline">\(\vec{u}\)</span>, follow the same procedure as in the previous paragraph, but looking down the barrel of <span class="math inline">\(\vec{v}\)</span>. From this perspective, <span class="math inline">\(\vec{u}\)</span> appears longer than <span class="math inline">\(\hat{b}\)</span>; the scalar multiplier on <span class="math inline">\(\vec{u}\)</span> will be about 0.9. In terms of <span class="math inline">\(\mathit{A} \vec{x} = \hat{b}\)</span>, the solution is
<span class="math display">\[\vec{x} = \left[\begin{array}{r}0.9\\1.2\end{array}\right]\ .\]</span></p>
</div>
</div>
<div id="properties-of-the-solution" class="section level2" number="4.3">
<h2><span class="header-section-number">44.3</span> Properties of the solution</h2>
<p>As you might expect, there is a known solution to the target problem. We’ll start by using a computer implementation of this solution to demonstrate some simple properties of the solution. As an example, we’ll use three vectors <span class="math inline">\(\vec{u}\)</span>, <span class="math inline">\(\vec{v}\)</span>, and <span class="math inline">\(\vec{w}\)</span> in a 5-dimensional space as the “screen” to be projected onto, and another vector <span class="math inline">\(\vec{b}\)</span> as the object being projected.</p>
<p>The matrix <span class="math inline">\(\mathit{A}\)</span> is:
<span class="math display">\[{\mathbf A} \equiv \left[\strut \begin{array}{ccc}|&amp;|&amp;|\\\vec{u} &amp; \vec{v} &amp; \vec{w}\\|&amp;|&amp;|\end{array}\right]\]</span></p>
<p>For the sake of example, we’ll make up some vectors. In your own explorations, you can change them to anything you like.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="target-problem.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the three vectors</span></span>
<span id="cb90-2"><a href="target-problem.html#cb90-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb90-3"><a href="target-problem.html#cb90-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">1</span>, <span class="dv">5</span>,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">7</span>)</span>
<span id="cb90-4"><a href="target-problem.html#cb90-4" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">4</span>)</span>
<span id="cb90-5"><a href="target-problem.html#cb90-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">cbind</span>(u, v, w)</span>
<span id="cb90-6"><a href="target-problem.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the target</span></span>
<span id="cb90-7"><a href="target-problem.html#cb90-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">8</span>, <span class="dv">2</span>,<span class="sc">-</span><span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>The operator <code>%onto%</code> model vector and from that we can calculate the residual vector.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="target-problem.html#cb91-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> b <span class="sc">%onto%</span> A </span>
<span id="cb91-2"><a href="target-problem.html#cb91-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> b <span class="sc">-</span> s</span></code></pre></div>
<p>Those two simple commands constitute a complete solution to the <strong><em>projection problem</em></strong>, where see seek to model vector and the residual vector.</p>
<p>In the <strong><em>target problem</em></strong> we want more: How to express <span class="math inline">\(\hat{b}\)</span> as a linear combination of the columns in <span class="math inline">\(\mathit{A}\)</span>. At the risk of being repetitive, this means finding <span class="math inline">\(\color{magenta}{\vec{x}}\)</span> in <span class="math display">\[\mathit{A}\ \color{magenta}{\large\vec{x}} = \vec{b}\]</span> where <span class="math inline">\(\mathit{A}\)</span> and <span class="math inline">\(\vec{b}\)</span> are given.</p>
<p>The function <code>qr.solve()</code> finds <span class="math inline">\(\vec{x}\)</span>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="target-problem.html#cb92-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">qr.solve</span>(A, b)</span></code></pre></div>
<pre><code>##            [,1]
## [1,] 0.03835171
## [2,] 0.33478133
## [3,] 0.48849968</code></pre>
<p>How can we confirm that this really is the solution to the target problem for this set of vectors? Easy! Just multiply <span class="math inline">\(\mathit{A}\)</span> by the <span class="math inline">\(\vec{x}\)</span> that we found. The result should be the target vector <span class="math inline">\(\hat{b}\)</span>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="target-problem.html#cb94-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> x</span></code></pre></div>
<pre><code>##            [,1]
## [1,]  2.0303906
## [2,] -0.6151849
## [3,]  0.6526021
## [4,]  4.0230526
## [5,]  4.3358197</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="target-problem.html#cb96-1" aria-hidden="true" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>##            [,1]
## [1,]  2.0303906
## [2,] -0.6151849
## [3,]  0.6526021
## [4,]  4.0230526
## [5,]  4.3358197</code></pre>
<div class="takenote">
<p>You should add <code>qr.solve()</code> to your computational toolbox of R functions.</p>
</div>
</div>
<div id="application-of-the-target-problem" class="section level2" number="4.4">
<h2><span class="header-section-number">44.4</span> Application of the target problem</h2>
<p>In Section @ref{linear-equations} we translated into vector/matrix form the problem, originally stated in Block 1, of finding the best linear combination of <span class="math inline">\(f(\mathtt{time}) \equiv 1\)</span> and <span class="math inline">\(g(\mathtt{time}) \equiv e^{-0.019 \mathtt{time}}\)</span>. Let’s solve that problem now.</p>
<p>::: {.rmosaic data-latex=""}
Earlier we introduced <code>rbind()</code> for the purpose of making column vectors, as in</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="target-problem.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    3
## [2,]    7
## [3,]   -1</code></pre>
<p>Now we are going to work with <strong><em>columns of data</em></strong> stored in the <code>CoolingWater</code> data frame. A good way to extract a column from a data frame is using the <code>with()</code> function. For instance,</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="target-problem.html#cb100-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">with</span>(CoolingWater, temp)</span>
<span id="cb100-2"><a href="target-problem.html#cb100-2" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">with</span>(CoolingWater, time)</span>
<span id="cb100-3"><a href="target-problem.html#cb100-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.019</span> <span class="sc">*</span> time))</span>
<span id="cb100-4"><a href="target-problem.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(A)</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]    1 1.0000000
## [2,]    1 0.9811794
## [3,]    1 0.9627129
## [4,]    1 0.9445941
## [5,]    1 0.9268162
## [6,]    1 0.9093729</code></pre>
<p>Notice that <code>cbind()</code> automatically translated <code>1</code> into the vector of all ones.</p>
<p>We’re all set up to solve the target problem:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="target-problem.html#cb102-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">qr.solve</span>(A, b)</span></code></pre></div>
<pre><code>## [1] 25.92024 61.26398</code></pre>
<p>How good an answer is the <code>x</code> calculated by <code>qr.solve()</code>? Judge for yourself!</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="target-problem.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(temp <span class="sc">~</span> time, <span class="at">data =</span> CoolingWater, <span class="at">size=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="target-problem.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fl">25.92</span> <span class="sc">+</span> <span class="fl">61.26</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.019</span><span class="sc">*</span>time) <span class="sc">~</span> time,</span>
<span id="cb104-3"><a href="target-problem.html#cb104-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-60-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>You may recall from Block 1 the explanation for the poor match between the model and the data for early times: that the water cooled quickly when poured into the cool mug, but the mug-with-water cooled much slower into the room air.</p>
<p>Let’s augment the model by adding another vector with a much faster exponential cooling, say, <span class="math inline">\(e^{-0.06 \mathtt{time}}\)</span>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="target-problem.html#cb105-1" aria-hidden="true" tabindex="-1"></a>newA <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.06</span><span class="sc">*</span>time))</span>
<span id="cb105-2"><a href="target-problem.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qr.solve</span>(newA, b)</span></code></pre></div>
<pre><code>## [1] 26.82297 53.27832 12.67486</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="target-problem.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(temp <span class="sc">~</span> time, <span class="at">data =</span> CoolingWater, <span class="at">size=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="target-problem.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fl">26.82</span> <span class="sc">+</span> <span class="fl">53.28</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.019</span><span class="sc">*</span>time) <span class="sc">+</span></span>
<span id="cb107-3"><a href="target-problem.html#cb107-3" aria-hidden="true" tabindex="-1"></a>               <span class="fl">12.67</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.06</span><span class="sc">*</span>time) <span class="sc">~</span> time,</span>
<span id="cb107-4"><a href="target-problem.html#cb107-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="MOSAIC-Calculus_files/figure-html/unnamed-chunk-62-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="exercises-3" class="section level2" number="4.5">
<h2><span class="header-section-number">44.5</span> Exercises</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="projection-residual.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "B5-target-problem.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "B5-target-problem.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"edit": {
"link": "https://github.com/ProjectMOSAIC/MOSAIC-Calculus/blob/main/Block-5/%s",
"text": "Edit me!"
},
"sharing": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
