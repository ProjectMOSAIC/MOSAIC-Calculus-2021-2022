<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 14 Modeling cycle | CalcZ Student Notes</title>
<meta name="author" content="Daniel Kaplan">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.8/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}\)
    </span>

    <!-- see https://www.homepages.ucl.ac.uk/~ucahmto/elearning/2019/09/14/bookdown.html-->
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">CalcZ Student Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Functions for modeling</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="" href="process-of-modeling.html"><span class="header-section-number">8</span> Process of modeling</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">9</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">10</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">11</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">12</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">13</span> Piecewise functions</a></li>
<li><a class="active" href="modeling-cycle.html"><span class="header-section-number">14</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">15</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">16</span> Dimensions</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="Not%20available">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modeling-cycle" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Modeling cycle<a class="anchor" aria-label="anchor" href="#modeling-cycle"><i class="fas fa-link"></i></a>
</h1>
<p>Effective modelers treat models with skepticism. They look for ways in which models failure to capture salient features of the real world. They have an eye out for deviations between what their models show and what they believe they know about the system being modeled. They consider ways in which the models might not serve the purpose for which they were developed. <span style="float: right; padding-left: 50px;"><a name="1560" href="#1560"><img src="www/icons8-signpost.png" title="Location: 1560" width="12px"></a><span style="color: red; font-size: 6pt;">1560</span></span></p>
<p>When modelers spot a failure or deviation or lack of proper utility, they might discard the model but more often they make a series of small adjustments, tuning up the model until is successfully serves the purposes for which it is intended.</p>
<p>Thus, modeling is a cyclic process of creating a model, assessing the model, and revising the model. The process comes to a sort of preliminary end when the model serves its purposes. But even then, models are often revised to check whether the results are sensitive to some factor that was not included or to check whether some component that was deemed essential really is so.</p>
<div id="example-cooling-water" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Example: Cooling water<a class="anchor" aria-label="anchor" href="#example-cooling-water"><i class="fas fa-link"></i></a>
</h2>
<p>Looking back on the exponential fitted to the cooling water data in Section <a href="process-of-modeling.html#fit-exponential">8.2</a>, it looks like our original estimate of the half-life is a bit too small; the data doesn’t seem to decay at the rate implied by <span class="math inline">\(k = -0.0277\)</span>. Perhaps we should try a somewhat slower decay, say <span class="math inline">\(k = -0.2\)</span> and see if that improves things.</p>
<div class="scaffolding">
<p>In the cooling water example, we’re using only a subset of the data collected by Prof. Wagon. The next commands re-create that subset so that you can work with it. They also plot the data and an exponential model. <span style="float: right; padding-left: 50px;"><a name="1565" href="#1565"><img src="www/icons8-signpost.png" title="Location: 1565" width="12px"></a><span style="color: red; font-size: 6pt;">1565</span></span></p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># reconstruct the sample</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>
<span class="va">Stans_data</span> <span class="op">&lt;-</span> <span class="va">CoolingWater</span> <span class="op">%&gt;%</span> <span class="fu">sample_n</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="co"># Plot the sample and overlay a model</span>
<span class="fu">gf_point</span><span class="op">(</span><span class="va">temp</span> <span class="op">~</span> <span class="va">time</span>, data<span class="op">=</span><span class="va">Stans_data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_lims</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fl">25</span> <span class="op">+</span> <span class="fl">83.3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.0277</span><span class="op">*</span><span class="va">time</span><span class="op">)</span> <span class="op">~</span> <span class="va">time</span>, color<span class="op">=</span><span class="st">"dodgerblue"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-73-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>See if <span class="math inline">\(k=-0.02\)</span> provides a better fit to the model. (You can add another <code>slice_plot()</code> to be able to compare the original and <span class="math inline">\(k=-0.02\)</span> models.)</p>
</div>
<p>Later in CalcZ, we’ll study <strong><em>optimization</em></strong>. There are optimization techniques for directing the computer to refine the parameters to best match the data. Just to illustrate, here’s what we get:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">refined_params</span> <span class="op">&lt;-</span>
  <span class="fu">fitModel</span><span class="op">(</span><span class="va">temp</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">k</span><span class="op">*</span><span class="va">time</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Stans_data</span>,
           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">25</span>, B <span class="op">=</span> <span class="fl">83.3</span>, k <span class="op">=</span> <span class="op">-</span><span class="fl">0.0277</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">refined_params</span><span class="op">)</span></code></pre></div>
<pre><code>##           A           B           k 
## 25.92628463 60.69255269 -0.01892572</code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_f</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="va">refined_params</span><span class="op">)</span>
<span class="fu">gf_point</span><span class="op">(</span><span class="va">temp</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">Stans_data</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fu">new_f</span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">~</span> <span class="va">time</span>, color<span class="op">=</span><span class="st">"dodgerblue"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-3"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-3-1.png" alt="Polishing the fit using the rough model as a starting point." width="90%"><p class="caption">
Figure 14.1: Polishing the fit using the rough model as a starting point.
</p>
</div>
<p>The refined parameters give a much better fit to the data than our original rough estimates by eye.</p>
<p>We had two rounds of the <strong><em>modeling cycle</em></strong>. First, choice of an A/B expontential model and a rough estimate of the parameters A, B, and <span class="math inline">\(k\)</span>. Second, refinement of those parameters using the computer.</p>
<p>Looking at the results of the second round, the experienced modeler can see some disturbing discrepancies. First, the estimated baseline appears to be too high. Related, the initial decay of the model function doesn’t seem to be fast enough and the decay of the model function for large <span class="math inline">\(t\)</span> appears to be too slow. Prof. Stan Wagon noticed this. He used additional data to fill in the gaps for small <span class="math inline">\(t\)</span> and refined his model further by changing the basis functions in the linear combination. He hypothesized that there are at least two different cooling processes. First, the newly poured water raises the temperature of the mug itself. Since the water and mug are in direct contact, this is a fast process. Then, the complete water/mug unit comes slowly into equilibrium with the room temperature. <span style="float: right; padding-left: 50px;"><a name="1567" href="#1567"><img src="www/icons8-signpost.png" title="Location: 1567" width="12px"></a><span style="color: red; font-size: 6pt;">1567</span></span></p>
<p>The newly refined model was a even better match to the data. But nothing’s perfect and Prof. Wagon saw an opportunity for additional refinement based on the idea that there is a third physical mechanism of cooling: evaporation from the surface of the hot water. Prof. Wagon’s additional circuits of the modeling cycle were appropriate to his purpose, which was to develop a detailed understanding of the process of cooling. For other purposes, such as demonstrating the appropriateness of an exponential process or interpolating between the data points, earlier cycles might have sufficed.</p>
<p>Here’s a graph of the model Prof. Wagon constructed to match the data.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-4"></span>
<img src="www/Wagon-water-fit.png" alt="A model that combines three exponentials provides an excellent fit." width="70%"><p class="caption">
Figure 14.2: A model that combines three exponentials provides an excellent fit.
</p>
</div>
<p>This is an excellent match to the data. But … matching the data isn’t always the only goal of modeling. Prof. Wagon wanted to make sure the model was physically plausible. And looking at the refined parameters, which include two exponential processes with parameters <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span>, he saw something wrong:</p>
<blockquote>
<p><em>But what can we make of <span class="math inline">\(k_1\)</span>, whose [positive value] violates the laws of thermodynamics by suggesting that the water gets hotter by virtue of its presence in the cool air? The most likely problem is that our simple model (the proportionality assumption) is not adequate near the boiling point. There are many complicated factors that affect heat transportation, such as air movement, boundary layer dissipation, and diffusion, and our use of a single linear relationship appears to be inadequate. In the next section [of our paper] we suggest some further experiments, but we also hope that our experiments might inspire readers to come up with a better mathematical model.</em></p>
</blockquote>
<p>The modeling cycle can go round and round!</p>
</div>
<div id="example-the-tides" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Example: The tides<a class="anchor" aria-label="anchor" href="#example-the-tides"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Step 4</strong>: Evaluate and refine. The green model would make poor predictions. The model says “high tide” when the data say otherwise. What’s missing is the <strong><em>phase</em></strong> of the sinusoid. A model that incorporates the phase is <span style="float: right; padding-left: 50px;"><a name="1040" href="#1040"><img src="www/icons8-signpost.png" title="Location: 1040" width="12px"></a><span style="color: red; font-size: 6pt;">1040</span></span></p>
<p><span class="math display">\[{\color{blue}{\mbox{tide}(t)} \equiv 1.05 + 0.55 \sin(2\pi (t - t_0)/11)}\]</span></p>
<p>The new parameter, <span class="math inline">\(t_0\)</span>, should be set to be the time of a positive-going crossing of the baseline. There’s such a crossing at about time = 17. Happily, changing the phase does not itself necessitate re-estimating the other parameters: baseline, amplitude, period. This model, incorporating the phase, has been graphed in <span class="math inline">\(\color{blue}\mbox{blue}\)</span>.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-4"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-4-1.png" alt="Shifting the **phase** of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong." width="50%"><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-4-2.png" alt="Shifting the **phase** of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong." width="50%"><p class="caption">
Figure 14.3: Shifting the <strong>phase</strong> of the sinusoid gives the flexibility needed to align the peaks and troughs of the model with the data. Performing this alignment for one peak makes it clear that the period is wrong.
</p>
</div>
<p>For some modeling purposes, such as prediction of future tides, the phase information is impossible. For others, say, description of the amplitude of the tides, not. But getting the phase roughly right can help point out other problems. For instance, having the blue sinusoid for comparison makes it clear that the estimated period of 11 hours is too short. Maybe 13 hours would be better. Better still, since at <span class="math inline">\(t=t_0 = 17\)</span> the model is a close match to the data, let’s use that as the estimate of the start of a cycle. But then, let’s move much further along in the data to find another baseline crossing. To judge from the right panel, there is a baseline crossing at <span class="math inline">\(t=103\)</span>. The difference between these two times is <span class="math inline">\(103 - 17 = 86\)</span> hours. Of course, the period is not 86 hours. Looking back at the whole set of data we can see 7 complete cycles between <span class="math inline">\(t=17\)</span> and <span class="math inline">\(t=103\)</span>. So our new estimate of the period is <span class="math inline">\(86/7 = 12.3\)</span> hours.</p>
<p>With this refinement the model is
<span class="math display">\[{\color{green}{\mbox{tide}(t)} \equiv 1.05 + 0.55 \sin(2\pi (t - 17)/12.3)}\]</span></p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-5"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-5-1.png" alt="With the phase about right, a better estimate can be made of the period: 12.3 hours." width="90%"><p class="caption">
Figure 14.4: With the phase about right, a better estimate can be made of the period: 12.3 hours.
</p>
</div>
<p>That’s a pretty good match to the data! We might call it quits at that. First, let’s polish up the parameter estimates, letting the computer do the tedious work of trying little tweaks to see if it can improve the fit.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tide_mod</span> <span class="op">&lt;-</span>
  <span class="fu">fitModel</span><span class="op">(</span><span class="va">level</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="va">hour</span><span class="op">-</span><span class="va">hzero</span><span class="op">)</span><span class="op">/</span><span class="va">P</span><span class="op">)</span>,
  data <span class="op">=</span> <span class="va">RI_tide</span>,
  start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1.05</span>, B<span class="op">=</span><span class="fl">0.55</span>, hzero<span class="op">=</span><span class="fl">17</span>, P<span class="op">=</span><span class="fl">12.3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">tide_mod</span><span class="op">)</span></code></pre></div>
<pre><code>##          A          B      hzero          P 
##  1.0220540  0.4998367 15.3899905 12.5593556</code></pre>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-6"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-6-1.png" alt="Polishing the parameters of the sinusoid" width="90%"><p class="caption">
Figure 14.5: Polishing the parameters of the sinusoid
</p>
</div>
<p>This last model seems capable of making reasonable predictions, so if we collected up-to-date data we might be able to fit a new model to predict the tide level pretty accurately a few days ahead of time. Also, the excellent alignment of the model peaks with the data tell us that the cyclic tide has a period that constant, at least so far as well can tell. <span style="float: right; padding-left: 50px;"><a name="1576" href="#1576"><img src="www/icons8-signpost.png" title="Location: 1576" width="12px"></a><span style="color: red; font-size: 6pt;">1576</span></span></p>
<p>With the period estimate <span class="math inline">\(P=12.56\)</span> hours, we can go looking for other phenomena that might account for the tides. The period of the day-night cycle is, of course 24 hours. So the tides in Providence come in and out twice a day. But not exactly. Something else must be going on.</p>
<p>Isaac Newton was the first to propose that the tides were caused by the gravitational attraction of the Moon. A complete cycle of the Moon—moon rise to moon rise—takes about 50 minutes longer than a full day: the Earth revolves once every 24 hours, but in that time the Moon has moved a bit further on in its orbit of the Earth. So the Moon’s period, seen from a fixed place on Earth is about 24.8 hours. Half of this, 12.4 hours, is awfully close to our estimate of the tidal period: 12.56 hours. The difference in periods, 8 minutes a day, might be hard to observe over only 4 days. Maybe with more data we’d get a better match between the tides and the moon.</p>
<p>This is the modeling cycle at work: Propose a model form (A/B model with sinusoid), adjust parameters to match what we know (the Providence tide record), compare the model to the data, observe discrepancies, propose a refined model. You can stop the model when it is giving you what you need. The period 12.56 hour model seems good enough to make a prediction of the tide level a few days ahead, and is certainly better than the “two tides a day” model. But our model is not yet able to implicate precisely the Moon’s orbit in in tidal oscillations.</p>
<p>Discrepancies between a model and data play two roles: they help us decide if the model is fit for the purpose we have in mind and they can point the way to improved models. That the tidal data deviates from the steady amplitude of our model can be a clue for where to look next. It’s not always obvious where this will lead.</p>
<p>Historically, careful analysis of tides led to a highly detailed, highly accurate model: a linear combination of sinusoids with diurnal periods 12.42, 12.00, 12.66, and 11.97 hours as well components with period 23.93, 25.82, 24.07, 26.87, and 24.00 hours. A tide-prediction model is constructed by finding the coefficients of the linear combination; these differ from locale to locale. <span style="float: right; padding-left: 50px;"><a name="1577" href="#1577"><img src="www/icons8-signpost.png" title="Location: 1577" width="12px"></a><span style="color: red; font-size: 6pt;">1577</span></span></p>
<hr>
<details><summary><strong>Exercise 8.43</strong>: <span><a name="File:%20Exercises/Fun/sunset-in-LA.Rmd" href="#GSEww"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/sunset-in-LA.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">GSEww</span>
</span></summary><p>The data frame <code>SunsetLA</code> records the number of minutes after 4 pm until the sun sets in Los Angeles, CA over a 4-year interval from January 2010 (month 1) through December 2013 (month 48).</p>
<!-- (All times are already adjusted for daylight savings time. The book doesn't tell us whether the value for each month is an average over all days or for a particular day of the month.) -->
<p>Open a sandbox and make a plot of sunset time versus month.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_point</span><span class="op">(</span><span class="va">Minutes</span> <span class="op">~</span> <span class="va">Month</span>, data <span class="op">=</span> <span class="va">SunsetLA</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-174-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>We’re using both <code>gf_point()</code> and <code>gf_line()</code>. With data that oscillates up and down, connecting the data points with lines makes it easier to see the pattern.</p>
</div>
<p><strong>Question A</strong> What is the range of the number of minutes until sunset over the whole 4-year period?</p>
<ol style="list-style-type: lower-roman">
<li>40 to 190 minutes<span class="mcanswer"> Right-oh! </span><br>
</li>
<li>120 minutes<span class="mcanswer"> ︎✘ A range is an interval spanned by <em>two</em> numbers. </span><br>
</li>
<li>40 to 180 minutes<span class="mcanswer"> ︎✘ The largest values are half a tick mark up from 180. Tick marks are spaced by 20 minutes. </span><br>
</li>
<li>0 to 48 months<span class="mcanswer"> ︎✘ That’s the <em>domain</em>. The <em>range</em> is along the vertical axis. </span>
</li>
</ol>
<p><strong>Question B</strong> The data fall nicely on a sine-shaped curve. What is the period of that sine?</p>
<p>    6 months<span class="mcanswer"> ︎✘ Look at the number of months from one peak to another. </span>       11 months<span class="mcanswer"> ︎✘ Look more carefully. And remember that the change in length of day is an <em>annual</em> phenomenon. </span>       12 months<span class="mcanswer"> Good. </span>       12 minutes<span class="mcanswer"> ︎✘ Period refers to an interval on the <em>domain</em> of the function, not the range. </span></p>
<p>The function <span class="math display">\[\mbox{sunset}(\mbox{Month}) \equiv A  \sin(2 \pi\, \mbox{Month} / 12) + C\]</span> is a <em>linear combination</em> of two functions:</p>
<ol style="list-style-type: decimal">
<li>The constant function <code>one(Month)</code>
</li>
<li>The sine function <code><a href="https://rdrr.io/r/base/Trig.html">sin(2*pi*Month/12)</a></code>
</li>
</ol>
<p>The two functions are scaled by <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span>, respectively.</p>
<p>You can estimate <span class="math inline">\(C\)</span> by the mid-point of the range (in minutes) of the data. You can estimate <span class="math inline">\(A\)</span> as half the length of the range (that is, half the max minus the min.)</p>
<p>Make rough but reasonable numeric estimates for <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span> from the data. Then, in the sandbox, define the <code>sunset()</code> function using the numerical estimates in the linear combination. Plot your function as a layer on top of the data. (Pipe the <code>gf_point()</code> layer to <code>slice_plot()</code>.)</p>
<div class="scaffolding">
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="modeling-cycle.html#cb105-1" aria-hidden="true" tabindex="-1"></a>sunset <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(A <span class="sc">+</span> C<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>), </span>
<span id="cb105-2"><a href="modeling-cycle.html#cb105-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">A =</span> __your estimate__, </span>
<span id="cb105-3"><a href="modeling-cycle.html#cb105-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">C =</span> __your estimate__,</span>
<span id="cb105-4"><a href="modeling-cycle.html#cb105-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">offset=</span><span class="dv">0</span>)</span>
<span id="cb105-5"><a href="modeling-cycle.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Minutes <span class="sc">~</span> Month, <span class="at">data =</span> SunsetLA) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="modeling-cycle.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_line</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="modeling-cycle.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">sunset</span>(Month) <span class="sc">~</span> Month)</span></code></pre></div>
<p>The domain for <code>slice_plot()</code> is inherited to that implied by the <code>SunsetLA</code> data. Notice that the input name in <code>slice_plot()</code> corresponds to that established in <code>gf_point()</code>.</p>
</div>
<p><strong>Question C</strong> Your <code>sunset()</code> function should be a pretty good match to the data except for one thing. What is that thing?</p>
<ol style="list-style-type: lower-roman">
<li>The <code>sunset()</code> function has a completely different range than the data.<span class="mcanswer"> ︎✘ This won’t be the case if you have estimated <span class="math inline">\(C\)</span> and <span class="math inline">\(A\)</span> correctly. </span><br>
</li>
<li>The period of the <code>sunset()</code> function doesn’t match the data.<span class="mcanswer"> ︎✘ Did you use <code><a href="https://rdrr.io/r/base/Trig.html">sin(2*pi*Month/12)</a></code>? If so, the period should be right. </span><br>
</li>
<li>There is a horizontal time shift between <code>sunset()</code> and the data.<span class="mcanswer"> Right! </span>
</li>
</ol>
<p>We’re going to fix the problem with <code>sunset()</code> by defining a <em>time offset</em> to use as a reference. For a sine function, a suitable time offset is the value along the horizontal axis when the phenomenon being modeled crosses <span class="math inline">\(C\)</span> with a positive slope. There are 4 such points along the horizontal axis readily identifiable in the data. (They may not be at an integer value of <code>Month</code>.)</p>
<p><strong>Question D</strong> Which of these is a suitable value for the time offset?</p>
<p>    0 months<span class="mcanswer"> ︎✘ That’s not a time when the data suggest that <span class="math inline">\(C\)</span> is being crossed. </span>       19 months<span class="mcanswer"> ︎✘ That’s a maximum, not a crossing of <span class="math inline">\(C\)</span>. </span>       21.5 months<span class="mcanswer"> ︎✘ That’s a crossing of <span class="math inline">\(C\)</span>, but not one with a positive slope. </span>       15.5 months<span class="mcanswer"> Correct. This is a good rough value. Since the period is 12 months, you could equally well have said the offset is 3.5 months. </span></p>
<p>In the original scaffolding, the value of <code>offset</code> was zero. Change that to match your answer to the previous question.</p>
<p>Plot out the modified <code>sunset()</code> function and confirm that it is a much better match to the data than the original (that is, the one without the time offset). You can “tune” your function by tweaking the numerical values of the <span class="math inline">\(A\)</span>, <span class="math inline">\(C\)</span>, and <span class="math inline">\(offset\)</span> parameters until you get a solid match.</p>
<p>Alternatively, you can use <code>fitModel()</code> to do the tuning for you. Plug in your estimates (a.k.a. “guesses”) for the parameters in place of the <code>___</code> in the following. Then run the code. You’ll see your estimate of the function compared to the result of having the computer refine your estimate. Chances are, the computer does a better job of stringing the function through the data.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="modeling-cycle.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="do">## rough estimates from graph</span></span>
<span id="cb106-2"><a href="modeling-cycle.html#cb106-2" aria-hidden="true" tabindex="-1"></a>rough_A <span class="ot">&lt;-</span> __estimated_A__</span>
<span id="cb106-3"><a href="modeling-cycle.html#cb106-3" aria-hidden="true" tabindex="-1"></a>rough_C <span class="ot">&lt;-</span> __estimated_C__</span>
<span id="cb106-4"><a href="modeling-cycle.html#cb106-4" aria-hidden="true" tabindex="-1"></a>rough_offset <span class="ot">&lt;-</span> __estimated_offset___</span>
<span id="cb106-5"><a href="modeling-cycle.html#cb106-5" aria-hidden="true" tabindex="-1"></a>guessed_fun <span class="ot">&lt;-</span></span>
<span id="cb106-6"><a href="modeling-cycle.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">makeFun</span>(A<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span> C <span class="sc">~</span> Month,</span>
<span id="cb106-7"><a href="modeling-cycle.html#cb106-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">A  =</span> rough_A, <span class="at">C =</span> rough_D,</span>
<span id="cb106-8"><a href="modeling-cycle.html#cb106-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">offset =</span> rough_offset)</span>
<span id="cb106-9"><a href="modeling-cycle.html#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="modeling-cycle.html#cb106-10" aria-hidden="true" tabindex="-1"></a>tuned_fun <span class="ot">&lt;-</span></span>
<span id="cb106-11"><a href="modeling-cycle.html#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitModel</span>(Minutes <span class="sc">~</span> A<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(Month <span class="sc">-</span> offset)<span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span> C,</span>
<span id="cb106-12"><a href="modeling-cycle.html#cb106-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">data  =</span> SunsetLA,</span>
<span id="cb106-13"><a href="modeling-cycle.html#cb106-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> rough_A,</span>
<span id="cb106-14"><a href="modeling-cycle.html#cb106-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">C =</span> rough_C,</span>
<span id="cb106-15"><a href="modeling-cycle.html#cb106-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">offset =</span> rough_offset) )</span>
<span id="cb106-16"><a href="modeling-cycle.html#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="modeling-cycle.html#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Minutes <span class="sc">~</span> Month, <span class="at">data =</span> SunsetLA) <span class="sc">%&gt;%</span></span>
<span id="cb106-18"><a href="modeling-cycle.html#cb106-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_line</span>(<span class="at">color  =</span> <span class="st">"dodgerblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-19"><a href="modeling-cycle.html#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">tuned_fun</span>(Month) <span class="sc">~</span> Month) <span class="sc">%&gt;%</span></span>
<span id="cb106-20"><a href="modeling-cycle.html#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">guessed_fun</span>(Month) <span class="sc">~</span> Month,  <span class="at">color =</span> <span class="st">"orange3"</span>)</span></code></pre></div>
</div>
<p>Perhaps you were expecting the tuned sine function to match the data exactly. It does not. One reason for this is that the Earth’s orbit around the Sun is not exactly circular. The sine function is only a <em>model</em> of the phenomenon, good for some purposes and not for others. For a more complete explanation, see <a href="https://en.wikipedia.org/wiki/Sunrise_equation">this article on Wikipedia</a>.</p>
(<em>Thomas Swalm</em> contributed to this exercise.)
</details>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="fun-piecewise.html"><span class="header-section-number">13</span> Piecewise functions</a></div>
<div class="next"><a href="magnitudes.html"><span class="header-section-number">15</span> Magnitudes</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modeling-cycle"><span class="header-section-number">14</span> Modeling cycle</a></li>
<li><a class="nav-link" href="#example-cooling-water"><span class="header-section-number">14.1</span> Example: Cooling water</a></li>
<li><a class="nav-link" href="#example-the-tides"><span class="header-section-number">14.2</span> Example: The tides</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="Not%20available/blob/master/Fun-modeling-cycle.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="Not%20available/edit/master/Fun-modeling-cycle.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>CalcZ Student Notes</strong>" was written by Daniel Kaplan. It was last built on 2021-08-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
