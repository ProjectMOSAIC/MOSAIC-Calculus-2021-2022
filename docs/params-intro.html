<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Parameters for functions | CalcZ Student Notes</title>
<meta name="author" content="Daniel Kaplan">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.8/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}\)
    </span>

    <!-- see https://www.homepages.ucl.ac.uk/~ucahmto/elearning/2019/09/14/bookdown.html-->
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">CalcZ Student Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="outline-of-block-1.html">Outline of Block 1</a></li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Functions for modeling</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="active" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">8</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">9</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">10</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">11</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">12</span> Piecewise functions</a></li>
<li><a class="" href="modeling-cycle.html"><span class="header-section-number">13</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">14</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">15</span> Dimensions</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/dtkaplan/CalcZ-notes">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="params-intro" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Parameters for functions<a class="anchor" aria-label="anchor" href="#params-intro"><i class="fas fa-link"></i></a>
</h1>
<p>The pattern-book functions provide the modeler with a collection of shapes. They are not yet fully suited to represent real-world phenomena. To illustrate, consider Figure <a href="params-intro.html#fig:covid-exp">7.1</a> which shows the number of officially confirmed cases in March 2020. <span style="float: right; padding-left: 50px;"><a name="800" href="#800"><img src="www/icons8-signpost.png" title="Location: 800" width="12px"></a><span style="color: red; font-size: 6pt;">800</span></span></p>
<p>The outbreak was widely described as “exponential,” so alongside the data Figure <a href="params-intro.html#fig:covid-exp">7.1</a> shows the function <span class="math inline">\(e^x\)</span>.</p>
<div class="figure" style="text-align: center">
<span id="fig:covid-exp"></span>
<img src="CalcZ-notes_files/figure-html/covid-exp-1.png" alt="Cumulative confirmed COVID-19 cases during the month of March, 2020. The red curve is $e^x$" width="90%"><p class="caption">
Figure 7.1: Cumulative confirmed COVID-19 cases during the month of March, 2020. The red curve is <span class="math inline">\(e^x\)</span>
</p>
</div>
<p>There’s an obvious mismatch between the data and the function <span class="math inline">\(e^x\)</span>. Does this mean the COVID pattern is not exponential?</p>
<p>A hint comes from the formula <span class="math inline">\(e^x\)</span>. What is <span class="math inline">\(x\)</span>? Plotted as it is in the graph, <span class="math inline">\(x\)</span> is the calender day in March. But why shouldn’t <span class="math inline">\(x\)</span> be the given in hours or minutes or weeks?</p>
<p>If we want the input to <span class="math inline">\(\exp()\)</span> to be in hours, we can multiply <span class="math inline">\(x\)</span> by 24. If the input is to be in weeks, the multiplier should be <span class="math inline">\(\frac{1}{7} = 0.1429\)</span>. In both cases, the function will be <span class="math inline">\(e^{kx}\)</span>, where <span class="math inline">\(k\)</span> would be 24 for hours or 0.1429 for weeks. Exploring a bit, we found that <span class="math inline">\(0.3 \leq k &lt; 0.5\)</span> will produce functions graphs that match the data much better than pattern-book <span class="math inline">\(e^x\)</span>. <span style="float: right; padding-left: 50px;"><a name="810" href="#810"><img src="www/icons8-signpost.png" title="Location: 810" width="12px"></a><span style="color: red; font-size: 6pt;">810</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:covid-exp2"></span>
<img src="CalcZ-notes_files/figure-html/covid-exp2-1.png" alt="COVID-19 data compared to the exponential functions $e^{kt}$. A variety of possible numerical values for $k$ is shown." width="90%"><p class="caption">
Figure 7.2: COVID-19 data compared to the exponential functions <span class="math inline">\(e^{kt}\)</span>. A variety of possible numerical values for <span class="math inline">\(k\)</span> is shown.
</p>
</div>
<p>The multiplier <span class="math inline">\(k\)</span> in <span class="math inline">\(e^{kx}\)</span> is called a <strong><em>parameter</em></strong> of the function: a number that we can use to set the <strong><em>scale</em></strong> of the input. To use the exponential function to model COVID, we’ve had to stretch out the red curve in Figure <a href="params-intro.html#fig:covid-exp2">7.2</a> by tailoring pattern-book <span class="math inline">\(x\)</span> as <span class="math inline">\(k x\)</span>. Perhaps it’s a matter of personal choice which size of <span class="math inline">\(k\)</span> will be best suited to model the data.</p>
<p>My personal choice is <span class="math inline">\(k=0.30\)</span>. My reasoning? The orange curve parallels the COVID data. The flaw with <span class="math inline">\(k=0.30\)</span> is that the curve lags several the data by several days. But we can fix this by pulling the <span class="math inline">\(k=0.30\)</span> curve to the left. Mathematically this can be accomplished by subtracting a few days from <span class="math inline">\(x\)</span> before multiplying by <span class="math inline">\(k\)</span>, that is, using the function <span class="math display">\[f(x) \equiv e^{k(x-s)}\]</span> where <span class="math inline">\(s\)</span> stands for the shift.</p>
<p>Figure <a href="params-intro.html#fig:covid-exp3">7.3</a> shows the orange curve after pulling it 10 days to the left. It’s now a pretty good match to the data.</p>
<div class="figure" style="text-align: center">
<span id="fig:covid-exp3"></span>
<img src="CalcZ-notes_files/figure-html/covid-exp3-1.png" alt="COVID-19 data compared to the exponential functions $e^{k(t-s)}$." width="90%"><p class="caption">
Figure 7.3: COVID-19 data compared to the exponential functions <span class="math inline">\(e^{k(t-s)}\)</span>.
</p>
</div>
<p>Note that once we’ve aligned the orange curve horizontally, it seems to curve too much. The green curve does much better. It has a much gentler curve, <span class="math inline">\(k=0.19\)</span> and is pulled about a little more than a month to the left. <span style="float: right; padding-left: 50px;"><a name="820" href="#820"><img src="www/icons8-signpost.png" title="Location: 820" width="12px"></a><span style="color: red; font-size: 6pt;">820</span></span></p>
<p>By parameterizing the exponential function as <span class="math inline">\(e^{k(x-s)}\)</span> and finding suitable values for <span class="math inline">\(k\)</span> and <span class="math inline">\(s\)</span>, we get a good match to the March data. But models can sometimes tell us more. For the green curve in Figure <a href="params-intro.html#fig:covid-exp3">7.3</a> the value of <span class="math inline">\(s\)</span> is -32 days. 32 days before March 1 is in late January. And even though we didn’t have any January or February data to base the green curve on, late January 2020 is regarded as the very beginning of the outbreak.</p>
<div id="parallel-scales" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Parallel scales<a class="anchor" aria-label="anchor" href="#parallel-scales"><i class="fas fa-link"></i></a>
</h2>
<p>The graphical format we have been using to display functions of one variable places the input on the horizontal axis and the output on the vertical axis. This is not the only way to draw a function. Consider these everyday objects: a thermometer and a ruler.</p>
<p><img src="www/thermometer.png">     <img src="www/ruler.jpeg"></p>
<p>Each object presents a read-out of what’s being measured—temperature or length—on two different scales. At the same time, the objects provide a way to convert one scale to another.</p>
<p>A function gives the output for any given input. We represent the input value as a position on a number line—which we call an “axis”—and the output as a position on another output line, almost always drawn perpendicular to one another. But the two number lines can just as well be parallel to one another. To evaluate the function, find the input value on the input scale and read off the corresponding output. The <strong><em>inverse function</em></strong> can be evaluated just as easily: switch the roles of the input and output scales. <span style="float: right; padding-left: 50px;"><a name="830" href="#830"><img src="www/icons8-signpost.png" title="Location: 830" width="12px"></a><span style="color: red; font-size: 6pt;">830</span></span></p>
<p>Taking the traditional unit scale as the input and the metric scale as the output, the two functions implemented on the objects are:
<span class="math display">\[\underbrace{C(F) = \frac{5}{9}(F-32)}_\mbox{Fahrenheit to Celcius}\ \ \ \text{and}\ \ \ \ \underbrace{\text{cm(inches)} = 2.54 \times (\text{inches}-0}_\mbox{inches to cm})\]</span>
These are very simple, straight-line functions, but they play an important role in modeling.</p>
<p>Each conversion function can be written in the form <span class="math inline">\(\line(x) \equiv m (x - x_0)\)</span>. Of course, if you multiply the <span class="math inline">\(m\)</span> through both terms in parentheses, you get <span class="math inline">\(\line(x) = m x - m x_0\)</span> which can be written even more simply as <span class="math inline">\(mx + b\)</span> by setting <span class="math inline">\(b\equiv m x_0\)</span>. So the conversion function is simply the straight-line function.</p>
<p><span class="math inline">\(m\)</span> and <span class="math inline">\(x_0\)</span> are the <strong><em>parameters</em></strong> of the straight-line function. In terms of the graph of a straight-line function, they are the slope and x-intercept respectively.</p>
<p>Often, functions can be parameterized in other ways. For instance, you likely learned the parameterization <span class="math inline">\(m x + b\)</span>, in which <span class="math inline">\(m\)</span> is (still) the slope of the graph but <span class="math inline">\(b\)</span> is now the y-intercept.</p>
<div class="takenote">
<p>We can call <span class="math inline">\(m(x - x_0)\)</span> the “x-intercept parameterization” and <span class="math inline">\(m x + b\)</span> the "y-intercept parameterization. They are equivalent and equally good ways of parameterizing the straight line. There are still other ways of parameterizing, each style reflecting its own format for specifying the two points that make up a line.</p>
</div>
</div>
<div id="scaling-the-input" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Scaling the input<a class="anchor" aria-label="anchor" href="#scaling-the-input"><i class="fas fa-link"></i></a>
</h2>
<p>To turn a pattern-book function into a <strong><em>basic modeling function</em></strong> all we do is use <span class="math inline">\(\line()\)</span> to convert the input <em>before</em> applying the pattern-book function. <span style="float: right; padding-left: 50px;"><a name="840" href="#840"><img src="www/icons8-signpost.png" title="Location: 840" width="12px"></a><span style="color: red; font-size: 6pt;">840</span></span></p>
<p>To illustrate the link between basic modeling functions and their pattern-book progenitors, Figure <a href="params-intro.html#fig:covid-scale">7.4</a> shows the model we fit to the COVID-19 data:</p>
<div class="figure" style="text-align: center">
<span id="fig:covid-scale"></span>
<img src="CalcZ-notes_files/figure-html/covid-scale-1.png" alt="A graph of the pattern-book exponential with an additional scale displayed (red) to match it to the COVID-19 data" width="90%"><p class="caption">
Figure 7.4: A graph of the pattern-book exponential with an additional scale displayed (red) to match it to the COVID-19 data
</p>
</div>
<p>The function being drawn is simply <span class="math inline">\(e^x\)</span>: a function from the pattern book. The black horizontal scale shows <span class="math inline">\(x\)</span>. To match the function to the data, that is, to show the basic modeling function, we simply add a new scale that translates <span class="math inline">\(x\)</span> to “day in March.” That’s the red scale. So, on March 22, there were about 25,000 COVID cases to date.</p>
<p>The pattern-book function does not give a good model of the COVID case numbers. But if we scale the input before applying the pattern-book function, we are effectively laying a new axis, stretched and shifted from the original, that let’s us read off the number of cases.</p>
<p>Input scaling empowers the pattern-book functions to model a huge variety of phenomena. There’s just one exponential function and it always looks exactly the same. But there is a huge variety of ways to scale the input. With input scaling, the pattern-book function puts on clothes and becomes one of our basic modeling functions.
<span class="math display">\[\underbrace{e^x}_\mbox{pattern-book function}\ \ \ \underbrace{e^{k(x-x_0)}}_\mbox{basic modeling function}\]</span>
The straight-line function <span class="math inline">\(\line()\)</span> is being written here as <span class="math inline">\(k(x-x_0)\)</span> rather than <span class="math inline">\(m(x-x_0)\)</span>. It’s traditional to to write some of the basic modeling functions
You may have noticed that the above uses <span class="math inline">\(k\)</span> instead of <span class="math inline">\(m\)</span> as the multiplier in the straight-line function in the exponent. Of course, you can use whatever name you wish for a parameter. The idiom of mathematical notation has several conventions. Knowing these will help you read mathematics more fluently. <span style="float: right; padding-left: 50px;"><a name="850" href="#850"><img src="www/icons8-signpost.png" title="Location: 850" width="12px"></a><span style="color: red; font-size: 6pt;">850</span></span></p>
<p>The table shows a few of them. Often, there are multiple parameterizations.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="23%">
<col width="26%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Written form</th>
<th>Parameter 1</th>
<th>Parameter 2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential</td>
<td><span class="math inline">\(e^{kt}\)</span></td>
<td>
<span class="math inline">\(k\)</span> “exponential constant”<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>
</td>
<td>Not used</td>
</tr>
<tr class="even">
<td>Exponential</td>
<td><span class="math inline">\(e^{t/\tau}\)</span></td>
<td>
<span class="math inline">\(\tau\)</span> “time constant”<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>
</td>
<td>Not used</td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td><span class="math inline">\(2^{t/\tau_2}\)</span></td>
<td>
<span class="math inline">\(\tau_2\)</span> “doubling time”<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="math inline"&gt;\(-\tau_2\)&lt;/span&gt; is sometimes called the “half life.”&lt;/p&gt;'><sup>10</sup></a>
</td>
<td>Not used</td>
</tr>
<tr class="even">
<td>Power-law</td>
<td><span class="math inline">\([x - x_0]^p\)</span></td>
<td>
<span class="math inline">\(x_0\)</span> “center”</td>
<td>Not used</td>
</tr>
<tr class="odd">
<td>Sinusoid</td>
<td><span class="math inline">\(\sin\left(\frac{2 \pi}{P} (t-t_0)\right)\)</span></td>
<td>
<span class="math inline">\(P\)</span> “period”</td>
<td>
<span class="math inline">\(t_0\)</span> “time shift”</td>
</tr>
<tr class="even">
<td>Sinusoid</td>
<td><span class="math inline">\(\sin(\omega t + \phi)\)</span></td>
<td>
<span class="math inline">\(\omega\)</span> “angular frequency”</td>
<td>
<span class="math inline">\(\phi\)</span> “phase shift”</td>
</tr>
<tr class="odd">
<td>Sinusoid</td>
<td><span class="math inline">\(\sin(2 \pi \omega t + \phi)\)</span></td>
<td>
<span class="math inline">\(\omega\)</span> “frequency”</td>
<td>
<span class="math inline">\(\phi\)</span> “phase shift”</td>
</tr>
<tr class="even">
<td>Hump</td>
<td>dnorm(x, mn, sd)</td>
<td>mn “mean”</td>
<td>sd “standard deviation”</td>
</tr>
<tr class="odd">
<td>Sigmoid</td>
<td>pnorm(x, mn, sd)</td>
<td>mn “mean”</td>
<td>sd “standard deviation”</td>
</tr>
<tr class="even">
<td>Straight-line</td>
<td><span class="math inline">\(mx + b\)</span></td>
<td>
<span class="math inline">\(m\)</span> “slope”</td>
<td>
<span class="math inline">\(b\)</span> “y-intercept”</td>
</tr>
<tr class="odd">
<td>Straight-line</td>
<td><span class="math inline">\(m (x-x_0)\)</span></td>
<td>
<span class="math inline">\(m\)</span> “slope”</td>
<td>
<span class="math inline">\(x_0\)</span> “center”</td>
</tr>
</tbody>
</table></div>
</div>
<div id="scale-the-output" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Scale the output<a class="anchor" aria-label="anchor" href="#scale-the-output"><i class="fas fa-link"></i></a>
</h2>
<p>Just as the natural input usually needs to be scaled before it reaches the pattern-book function, so the output from the pattern-book function may need to be scaled before it presents a result suited for interpreting in the real world.</p>
<div class="figure" style="text-align: center">
<span id="fig:scaling-nature"></span>
<img src="www/scaling-nature.png" alt="Natural **quantities** must be scaled to pure numbers before being suited to the pattern-book functions. The output is a pure number which is scaled to the natural **quantity** of interest." width="100%"><p class="caption">
Figure 7.5: Natural <strong>quantities</strong> must be scaled to pure numbers before being suited to the pattern-book functions. The output is a pure number which is scaled to the natural <strong>quantity</strong> of interest.
</p>
</div>
<p>The overall result of input and output scaling is a smartly dressed modeling function ready to engage the real world. <span style="float: right; padding-left: 50px;"><a name="860" href="#860"><img src="www/icons8-signpost.png" title="Location: 860" width="12px"></a><span style="color: red; font-size: 6pt;">860</span></span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Name</th>
<th>Naked form</th>
<th>Dressed for action</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td><span class="math inline">\(e^x\)</span></td>
<td><span class="math inline">\(A e^{kx} + C\)</span></td>
</tr>
<tr class="even">
<td>sinusoid</td>
<td><span class="math inline">\(\sin(x)\)</span></td>
<td><span class="math inline">\(A \sin(\frac{2 \pi}{P} x) + C\)</span></td>
</tr>
<tr class="odd">
<td>proportional</td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(a x + b\)</span></td>
</tr>
</tbody>
</table></div>
<div class="takenote">
<p>The parameter <span class="math inline">\(C\)</span> is often called the <strong><em>baseline</em></strong> or the <strong><em>offset</em></strong>. Statisticians call it the “intercept,” because it plays the same role as <span class="math inline">\(b\)</span> in the straight-line function.</p>
<p>When working with sinusoids, parameter <span class="math inline">\(A\)</span> is called the <strong><em>amplitude</em></strong>.</p>
<p>Of course, you’re already familiar with <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>: the slope and intercept of a straight line.</p>
<div class="figure" style="text-align: center">
<span id="fig:show-sin-params"></span>
<img src="CalcZ-notes_files/figure-html/show-sin-params-1.png" alt="Baseline (blue), amplitude (red), and period (green) for the sinusoid." width="90%"><p class="caption">
Figure 7.6: Baseline (blue), amplitude (red), and period (green) for the sinusoid.
</p>
</div>
<div class="figure" style="text-align: center">
<span id="fig:show-exp-baseline"></span>
<img src="CalcZ-notes_files/figure-html/show-exp-baseline-1.png" alt="The baseline for the exponential is the horizontal asymptote. There is no vertical asymptote." width="90%"><p class="caption">
Figure 7.7: The baseline for the exponential is the horizontal asymptote. There is no vertical asymptote.
</p>
</div>
</div>
<hr>
<details><summary><strong>Exercise 7.11</strong>: <span><a name="File:%20Exercises/Fun/fiducial-point.Rmd" href="#MWLCS"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/fiducial-point.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">MWLCS</span>
</span></summary><p>Recall that each <strong><em>basic modeling functions</em></strong> are constructed from the corresponding pattern-book functions by scaling the input.</p>
<p><span class="math display">\[\text{pattern-book function}\ \ \underset{x\rightarrow a(x-x_0)}{\overset{\text{input scaling}}{\Large\Longrightarrow}} \ \ \text{basic modeling function}\]</span></p>
<p>Recognizing the axis crossings (y is blue, x is red) and asymptotes (orange) for the pattern-book functions can help you figure out the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(x_0\)</span> in the input scaling <span class="math inline">\(a(x-x_0)\)</span> for the basic modeling functions. Here’s a reference:</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-1.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-2.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-3.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-4.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-5.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-6.png" width="50%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-104-7.png" width="50%" style="display: block; margin: auto;"></p>
<p>Each of the following plots shows a basic modeling function whose input scaling has the form <span class="math inline">\(x - x_0\)</span>. Your job is to figure out from the graph what is the numerical value of <span class="math inline">\(x_0\)</span>. (Hint: For simplicity, <span class="math inline">\(x_0\)</span> in the questions will always be an integer.)</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-105-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> In plot (A), what is <span class="math inline">\(x_0\)</span>?</p>
<p>    -2<span class="mcanswer"> ︎✘ </span>       -1<span class="mcanswer"> ︎✘ </span>       0<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ✔︎ Right. Look for the input that generates the peak output value. </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-106-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question B</strong> In plot (B), what is <span class="math inline">\(x_0\)</span>?</p>
<p>    -2<span class="mcanswer"> ︎✘ </span>       -1<span class="mcanswer"> ✔︎ Good. Look for an input that generates a positive going zero crossing. </span>       0<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ︎✘ </span></p>
<pre><code>## Warning in log(x - 1): NaNs produced</code></pre>
<pre><code>## Warning: Removed 214 row(s) containing missing values (geom_path).</code></pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-107-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question C</strong> In plot (C), what is <span class="math inline">\(x_0\)</span>?</p>
<p>    -2<span class="mcanswer"> ︎✘ </span>       -1<span class="mcanswer"> ✔︎ Right. The location of the vertical asymtote is the clue. </span>       0<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ︎✘ </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-108-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question D</strong> In plot (D), what is <span class="math inline">\(x_0\)</span>?</p>
<p>    -2<span class="mcanswer"> ︎✘ </span>       -1<span class="mcanswer"> ︎✘ </span>       0<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ✔︎ The input where the output is half way between the two horizontal asymptotes </span>       2<span class="mcanswer"> ︎✘ </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-109-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question E</strong> In plot (E), what is <span class="math inline">\(x_0\)</span>?</p>
<p>    -2<span class="mcanswer"> ✔︎ Right. The location of the vertical asymtote is the clue. </span>       -1<span class="mcanswer"> ︎✘ </span>       0<span class="mcanswer"> ︎✘ </span>       1<span class="mcanswer"> ︎✘ </span>       2<span class="mcanswer"> ︎✘ </span></p>
</details><hr>
<details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Fun/pig-make-table.Rmd" href="#VcUetN"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/pig-make-table.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">VcUetN</span>
</span></summary><p>DRAFT</p>
Similar to MWLCS but with input scaling of the form <span class="math inline">\(ax\)</span>.
</details><hr>
<details><summary><strong>Exercise XX.XX</strong>: <span><a name="File:%20Exercises/Fun/falcon-bite-coat.Rmd" href="#kUmsBG"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/falcon-bite-coat.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">kUmsBG</span>
</span></summary><p>DRAFT</p>
Similar to MWLCS and VcUetN but with input scaling of the form <span class="math inline">\(a(x-x_0)\)</span>. Keep it simple.
</details><hr>
<details><summary><strong>Exercise 7.17</strong>: <span><a name="File:%20Exercises/Fun/scale-input-1.Rmd" href="#uKCIE"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/scale-input-1.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">uKCIE</span>
</span></summary><p>Each of the graphs shows two horizontal scales and one of the basic modeling functions. Which horizontal scale (black or red) corresponds to the pattern-book function?</p>
<p><img src="CalcZ-notes_files/figure-html/unnamed-chunk-111-1.png" width="90%" style="display: block; margin: auto;"><strong>Question A</strong> For graph (A), which scale corresponds to the pattern-book function?</p>
<p>    black<span class="mcanswer"> ✔︎ </span>       orange3<span class="mcanswer"> ︎✘ </span>       neither<span class="mcanswer"> ︎✘ </span>       both<span class="mcanswer"> ︎✘ It can’t be both. There’s only one pattern-book function. When you scale the input, it becomes a “basic modeling function.” </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-112-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question B</strong> For graph (B), which scale corresponds to the pattern-book function?</p>
<p>    black<span class="mcanswer"> ︎✘ </span>       red<span class="mcanswer"> ✔︎ Right. The pattern-book function has an output of 1/2 when the output is zero. That’s what the red scale shows. </span>       neither<span class="mcanswer"> ︎✘ </span>       both<span class="mcanswer"> ︎✘ It can’t be both. There’s only one pattern-book function. When you scale the input, it becomes a “basic modeling function.” </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-113-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question C</strong> For graph (C), which scale corresponds to the pattern-book function?</p>
    black<span class="mcanswer"> ︎✘ </span>       red<span class="mcanswer"> ✔︎ The pattern-book sinusoid has a positive-going zero crossing at <span class="math inline">\(x=0\)</span>. That’s the red scale. </span>       neither<span class="mcanswer"> ︎✘ </span>       both<span class="mcanswer"> ︎✘ It can’t be both. There’s only one pattern-book function. When you scale the input, it becomes a “basic modeling function.” </span>
</details><hr>
<details><summary><strong>Exercise 7.1</strong>: <span><a name="File:%20Exercises/Fun/scale-input-2.Rmd" href="#BLECL"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/scale-input-2.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">BLECL</span>
</span></summary><p>Find the straight-line function that will give the value on the red scale for each point on the black scale.</p>
<img src="CalcZ-notes_files/figure-html/unnamed-chunk-115-1.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-115-2.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-115-3.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-115-4.png" width="90%" style="display: block; margin: auto;"></details>
</div>
<div id="linear-combinations" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Linear combinations<a class="anchor" aria-label="anchor" href="#linear-combinations"><i class="fas fa-link"></i></a>
</h2>
<p>We’ve discussed <strong><em>shifting the baseline</em></strong> of the exponential and sinusoid functions by adding a constant to the basic modeling function, like this:</p>
<p><span class="math display">\[f(t) \equiv A e^{kt} + C\\
\ \\
g(t) \equiv A \sin(\frac{2\pi}{P} t) + C\]</span></p>
<p>We’ve called this output scaling. It’s an example of a much more general and powerful way of contructing modeling functions called <strong><em>linear combinations</em></strong>.</p>
<p>In a linear combination, you start with one or more basic functions. For discussion, let’s call these <span class="math inline">\(f_1(t)\)</span>, <span class="math inline">\(f_2(t)\)</span>, <span class="math inline">\(f_3(t)\)</span> and so on. In making a linear combination, multiply each of the basic functions by some quantity and add the results together:</p>
<p><span class="math display">\[\text{linear combination of}\ f_1(t)\ \text{and}\ f_2(t): \ \ A_1 f_1(t) + A_2 f_2(t)\]</span>
The quantities <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span> are called <strong><em>scalars</em></strong> because they <strong>scale</strong> the functions. (In Chapter <a href="#vectors"><strong>??</strong></a> you will see that we make a distinction between a <strong>scalar</strong>, which is a single quantity, and a <strong>vector</strong>, which is a set of scalars.)</p>
<p>It’s common to take linear combinations of functions with different inputs, for example
<span class="math display">\[h(x, y, t) \equiv 4 e^{-kt} + 7 y + 2\pnorm(x-3) - 19\]</span></p>
<p>In fields like statistics and economics and other social sciences, as well as clinical medical research, a great number of modeling techniques involve such combinations of functions of various inputs.</p>
<p>In engineering and physics, an important class of functions involves a linear combination of many sinusoids of different periods, e.g. </p>
<p><span class="math display">\[\text{signal}(t) \equiv A_1 \sin\left(\frac{2 \pi}{P_1}t\right) + 
A_2 \sin\left(\frac{2 \pi}{P_2}t\right) + 
A_3 \sin\left(\frac{2 \pi}{P_3}t\right) + \cdots\]</span></p>
<p>Linear combination of functions provides a powerful and flexible general-purpose modeling technique in part because many physical systems seem to work this way and in part because the methods for finding the scalars—<span class="math inline">\(A_1\)</span>, <span class="math inline">\(A_2\)</span>, and so on—have an extremely strong theory and fast computer implementations that automatically solve the problem once the modeler has selected the functions she wants to combine. In Block 4, we use the name <strong><em>target problem</em></strong> to refer the problem of finding scalars to match as well as possible a linear combination to data.</p>
<p>An expression like <span class="math inline">\(A e^{kx} + C\)</span> combines the exponential (obviously!) and a second function that isn’t immediately obvious: the constant function <span class="math inline">\(\text{constant}(x) \equiv 1\)</span>. It might be overkill to re-write the expression as <span class="math inline">\(A e^{kx} + C\, \text{constant}(x)\)</span> but get in the habit of seeing the constant function as a constant presence in linear combinations!</p>
<p>Polynomials are an important example of linear combinations. Something like <span class="math inline">\(p(x) \equiv a + b t + c t^2\)</span> is a linear combination of the constant function, the proportionality function, and the square function.</p>
<details><summary><strong>Exercise 7.21</strong>: <span><a name="File:%20Exercises/Fun/bumpy-road-1.Rmd" href="#AVNOW"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/bumpy-road-1.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">AVNOW</span>
</span></summary><div class="inline-figure"><img src="CalcZ-notes_files/figure-html/b-road-1-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The graph shows a function that is a linear combination of three x-shifted gaussian functions
<span class="math display">\[a_1 \dnorm(x-3.5) + a_2 \dnorm(x-0.5) + a_3 \dnorm(x-(-4))\]</span></p>
<p><strong>Question A</strong> Estimate the scalars <span class="math inline">\(a_1, a_2\)</span>, and <span class="math inline">\(a_3\)</span> for the function drawn in Plot (A). (Be sure to get the order right!)</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(a_1 = 0.3, a_2 = 0.15, a_3=0.2\)</span><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(a_1 = 0.15, a_2 = 0.2, a_3=0.3\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(a_1 = 0.2, a_2 = 0.3, a_3=0.15\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(a_1 = 0.15, a_2 = 0.3, a_3=0.2\)</span><span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/b-road-1-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Plot (B) shows a function that is a linear combination of four x-shifted sigmoid functions. Each the multiplicative scalars is either 1 or <span class="math inline">\(-1\)</span>. Recall that a handy fiducial point for the sigmoid function is the input at which the output is 1/2.</p>
<p><strong>Question B</strong> Where are the fiducial points for the four sigmoids?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(-8, -2, 3, 7\)</span><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(-6, -4, 0, 6\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-9, -8, 1, 5\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-2, 2, 4, 6\)</span><span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p><strong>Question C</strong> What are the scalar multipliers on each sigmoid, in order from the leftmost to rightmost?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(1, -1, 1, -1\)</span><span class="mcanswer"> ✔︎ </span><br>
</li>
<li>
<span class="math inline">\(1, -1, -1, 1\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-1, 1, 1, -1\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-1, 1, -1, 1\)</span><span class="mcanswer"> ︎✘ </span>
</li>
</ol></details><details><summary><strong>Exercise 7.23</strong>: <span><a name="File:%20Exercises/Fun/two-gaussians.Rmd" href="#FISHU"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/two-gaussians.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">FISHU</span>
</span></summary><p>According to data from the US National Health and Nutrition Evaluation Survey, the average height of adult females is 157 cm vs 167 for adult males. The standard deviations are 17 cm and 22 cm respectively. A good model for the person-to-person variation for females is <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(height, mean = 157, sd = 17)</a></code> and similarly for males.</p>
<p>To see the overall distribution of adult height, regardless of sex, make a linear combination of the distribution for females and for males, giving each a scalar of one-half (since the population is roughly 50-50 female/male).</p>
<p>Open a <a href="https://maa-statprep.shinyapps.io/CalcZ-Sandbox/">SANDBOX</a> and construct the linear combination function for the overall distribution. Use the scaffolding to plot out the distributions for the individual sexes and the overall distribution.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">female</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">height</span>, mean <span class="op">=</span> <span class="fl">157</span>, sd<span class="op">=</span><span class="fl">17</span><span class="op">)</span> <span class="op">~</span> <span class="va">height</span><span class="op">)</span>
<span class="va">male</span>   <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">height</span>, mean <span class="op">=</span> <span class="fl">167</span>, sd<span class="op">=</span><span class="fl">22</span><span class="op">)</span> <span class="op">~</span> <span class="va">height</span><span class="op">)</span>
<span class="va">overall</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fu">female</span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">male</span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span> <span class="op">~</span> <span class="va">height</span><span class="op">)</span>
<span class="co">#overall &lt;- makeFun( __your_linear_combination_here__)</span>

<span class="fu">slice_plot</span><span class="op">(</span><span class="fu">female</span><span class="op">(</span><span class="va">height</span><span class="op">)</span> <span class="op">~</span> <span class="va">height</span>, <span class="fu">domain</span><span class="op">(</span>height<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">220</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"orange3"</span>,
           label_x<span class="op">=</span><span class="fl">.5</span>, label_text<span class="op">=</span><span class="st">"F"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fu">male</span><span class="op">(</span><span class="va">height</span><span class="op">)</span> <span class="op">~</span> <span class="va">height</span>, color<span class="op">=</span><span class="st">"dodgerblue"</span>, label_text<span class="op">=</span><span class="st">"M"</span>, label_x<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fu">overall</span><span class="op">(</span><span class="va">height</span><span class="op">)</span> <span class="op">~</span> <span class="va">height</span>, color<span class="op">=</span><span class="st">"black"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>Some people erroneously think that since the mean height of men is larger than women by 10cm, you can readily distinguish between the sexes based on height. However, notice that the overall distribution (plotted in black) does not show a dip between the sexes: there is no clear separation based on height.</p>
<p>As a though experiment, let’s increase the separation in mean height from the actual value of <span class="math inline">\(167-157=10\)</span> cm to something larger. You can increase the separation by 5 cm, for example, by making the men’s mean height <code>167+5</code>.</p>
<p><strong>Question A</strong> What’s the <em>smallest</em> increase in separation (in cm) that produces a barely visible dip between the sexes in the overall height distribution?</p>
<p>    5<span class="mcanswer"> ︎✘ </span>       10<span class="mcanswer"> ︎✘ </span>       15<span class="mcanswer"> ︎✘ </span>       20<span class="mcanswer"> ︎✘ </span>       25<span class="mcanswer"> ︎✘ </span>       30<span class="mcanswer"> ✔︎ </span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="params-intro.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_density</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES<span class="sc">::</span>NHANES <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Age <span class="sc">&gt;</span> <span class="dv">18</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="params-intro.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">title=</span><span class="st">"Distribution of height, US Adults"</span>, <span class="at">x=</span><span class="st">"Height (cm)"</span>)</span>
<span id="cb43-3"><a href="params-intro.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">df_stats</span>(Height <span class="sc">~</span> Gender, <span class="at">data =</span> NHANES<span class="sc">::</span>NHANES, mean, sd)</span>
<span id="cb43-4"><a href="params-intro.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">&lt;/details&gt;</span></span>
<span id="cb43-5"><a href="params-intro.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="params-intro.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;details&gt;</span></span>
<span id="cb43-7"><a href="params-intro.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;summary&gt;**Exercise 7.25**: &lt;span&gt;&lt;a name="File: Exercises/Fun/two-sines.Rmd" href="#FKLEU"&gt;&lt;img src="www/icons8-signpost.png" title="Location: Exercises/Fun/two-sines.Rmd" width="12px"/&gt;&lt;/a&gt;&lt;span style="color: red; font-size: 9pt;"&gt;FKLEU&lt;/red&gt;&lt;/span&gt;&lt;/summary&gt;</span></span>
<span id="cb43-8"><a href="params-intro.html#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="params-intro.html#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="params-intro.html#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="params-intro.html#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="params-intro.html#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="params-intro.html#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="params-intro.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="at">The graph shows a linear combination of two sinusoids, one of period 0.6 and the other of period 2. There is also a baseline shift. That is, the graph shows the function:</span></span>
<span id="cb43-15"><a href="params-intro.html#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="params-intro.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="at">$$a_1 \sin\left(</span><span class="sc">\f</span><span class="at">rac{2\pi}{2}t</span><span class="sc">\r</span><span class="at">ight) + a_2 \sin\left(</span><span class="sc">\f</span><span class="at">rac{2\pi}{0.6} (t-.3)</span><span class="sc">\r</span><span class="at">ight) + a_3$$</span></span>
<span id="cb43-17"><a href="params-intro.html#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="params-intro.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;img src="CalcZ-notes_files/figure-html/two-sines-1-1.png" width="90%" style="display: block; margin: auto;" /&gt;</span></span>
<span id="cb43-19"><a href="params-intro.html#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="params-intro.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="at">**Question A**  What is $a_3$? </span></span>
<span id="cb43-21"><a href="params-intro.html#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="params-intro.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="at">    -4&lt;span class='mcanswer'&gt; ✔︎  &lt;/span&gt;       -2&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       0&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       2&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       4&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;</span></span>
<span id="cb43-23"><a href="params-intro.html#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="params-intro.html#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="at">**Question B**  What is $a_1$? </span></span>
<span id="cb43-25"><a href="params-intro.html#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="params-intro.html#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="at">    0&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       1&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       2&lt;span class='mcanswer'&gt; ✔︎  &lt;/span&gt;       3.5&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;</span></span>
<span id="cb43-27"><a href="params-intro.html#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="params-intro.html#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="at">**Question C**  What is $a_1$? </span></span>
<span id="cb43-29"><a href="params-intro.html#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="params-intro.html#cb43-30" aria-hidden="true" tabindex="-1"></a><span class="at">    0&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       1&lt;span class='mcanswer'&gt; ✔︎  &lt;/span&gt;       2&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;       3.5&lt;span class='mcanswer'&gt; ︎✘  &lt;/span&gt;&lt;/details&gt;</span></span>
<span id="cb43-31"><a href="params-intro.html#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="params-intro.html#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="params-intro.html#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!--chapter:end:Fun-parameterization.Rmd--&gt;</span></span>
<span id="cb43-34"><a href="params-intro.html#cb43-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-35"><a href="params-intro.html#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="params-intro.html#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="at"># Process of modeling {#process-of-modeling}</span></span>
<span id="cb43-37"><a href="params-intro.html#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="params-intro.html#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="at">Seen very abstractly, a mathematical model, as we are using the term, is a set of ***functions*** that represent the relationships between inputs and outputs.  &lt;span style="float: right; padding-left: 50px;"&gt;&lt;a name="900" href="#900"&gt;&lt;img src="www/icons8-signpost.png" title="Location: 900" width="12px"/&gt;&lt;/a&gt;&lt;span style="color: red; font-size: 6pt;"&gt;900&lt;/red&gt;&lt;/span&gt;</span></span>
<span id="cb43-39"><a href="params-intro.html#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="params-intro.html#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="at">At the most simple level, building a model can be a short process:</span></span>
<span id="cb43-41"><a href="params-intro.html#cb43-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-42"><a href="params-intro.html#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="at">1. Develop an understanding of the relationship you want to model. Often, part of this "understanding" is the pattern seen in data.</span></span>
<span id="cb43-43"><a href="params-intro.html#cb43-43" aria-hidden="true" tabindex="-1"></a><span class="at">2. Choose a function type---e.g. exponential, sinusoidal, sigmoid---that you think would be a good match to the relationship.</span></span>
<span id="cb43-44"><a href="params-intro.html#cb43-44" aria-hidden="true" tabindex="-1"></a><span class="at">3. Find parameters that scales your function to be able to accept real-world inputs and generate real-world outputs.</span></span>
<span id="cb43-45"><a href="params-intro.html#cb43-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-46"><a href="params-intro.html#cb43-46" aria-hidden="true" tabindex="-1"></a><span class="at">It's important to distinguish between two basic types of model:</span></span>
<span id="cb43-47"><a href="params-intro.html#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="params-intro.html#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="at">1. ***Empirical models*** which are rooted in ***observation*** and ***data***.</span></span>
<span id="cb43-49"><a href="params-intro.html#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="at">2. ***Mechanistic models*** such as those created by applying fundamental laws of physics, chemistry, and such.</span></span>
<span id="cb43-50"><a href="params-intro.html#cb43-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-51"><a href="params-intro.html#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="at">We are going to put off mechanistic models for a while, for two reasons. First, the "fundamental laws of physics, chemistry, and such" are often expressed with the concepts and methods of calculus. We are heading there, but at this point you don't yet know the core concepts and methods of calculus. Second, most students don't make a careful study of the "fundamental laws of physics, chemistry, and such" until *after* they have studied calculus. So examples of mechanistic models will be a bit hollow at this point.</span></span>
<span id="cb43-52"><a href="params-intro.html#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="params-intro.html#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="at">We'll start then with empirical modeling: finding functions that are a good summary of data. The process of constructing a model that is a good match for data is called ***curve fitting***, or, more generally, ***fitting a model***.</span></span>
<span id="cb43-54"><a href="params-intro.html#cb43-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-55"><a href="params-intro.html#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="at">## Variations from scaling</span></span>
<span id="cb43-56"><a href="params-intro.html#cb43-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-57"><a href="params-intro.html#cb43-57" aria-hidden="true" tabindex="-1"></a><span class="at">A good place to start building a model is to pick one of the basic modeling functions. This works surprisingly often. To remind you, here are our nine ***pattern-book*** functions:   &lt;span style="float: right; padding-left: 50px;"&gt;&lt;a name="910" href="#910"&gt;&lt;img src="www/icons8-signpost.png" title="Location: 910" width="12px"/&gt;&lt;/a&gt;&lt;span style="color: red; font-size: 6pt;"&gt;910&lt;/red&gt;&lt;/span&gt;</span></span>
<span id="cb43-58"><a href="params-intro.html#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="params-intro.html#cb43-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-60"><a href="params-intro.html#cb43-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-61"><a href="params-intro.html#cb43-61" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;!-- the official list of pattern-book functions and their names --&gt;</span></span>
<span id="cb43-62"><a href="params-intro.html#cb43-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-63"><a href="params-intro.html#cb43-63" aria-hidden="true" tabindex="-1"></a><span class="at">Pattern name | Traditional notation       |  R notation</span></span>
<span id="cb43-64"><a href="params-intro.html#cb43-64" aria-hidden="true" tabindex="-1"></a><span class="at">------------|---------------------|--------------</span></span>
<span id="cb43-65"><a href="params-intro.html#cb43-65" aria-hidden="true" tabindex="-1"></a><span class="at">exponential | $e^x$               | </span><span class="st">`</span><span class="fu">exp</span>(x)<span class="st">`</span></span>
<span id="cb43-66"><a href="params-intro.html#cb43-66" aria-hidden="true" tabindex="-1"></a><span class="at">logarithm ("natural log")  | $\ln(x)$            | </span><span class="st">`</span><span class="fu">log</span>(x)<span class="st">`</span></span>
<span id="cb43-67"><a href="params-intro.html#cb43-67" aria-hidden="true" tabindex="-1"></a><span class="at">sinusoid    | $\sin(x)$           | </span><span class="st">`</span><span class="fu">sin</span>(x)<span class="st">`</span></span>
<span id="cb43-68"><a href="params-intro.html#cb43-68" aria-hidden="true" tabindex="-1"></a><span class="at">square      | $x^2$               | </span><span class="st">`</span>x<span class="sc">^</span><span class="dv">2</span><span class="st">`</span></span>
<span id="cb43-69"><a href="params-intro.html#cb43-69" aria-hidden="true" tabindex="-1"></a><span class="at">proportional| $x$                 | </span><span class="st">`</span>x<span class="st">`</span></span>
<span id="cb43-70"><a href="params-intro.html#cb43-70" aria-hidden="true" tabindex="-1"></a><span class="at">constant    | $1$                 | </span><span class="st">`</span><span class="dv">1</span><span class="st">`</span></span>
<span id="cb43-71"><a href="params-intro.html#cb43-71" aria-hidden="true" tabindex="-1"></a><span class="at">reciprocal  | $1/x$ or $x^{-1}$   | </span><span class="st">`</span><span class="dv">1</span><span class="sc">/</span>x<span class="st">`</span></span>
<span id="cb43-72"><a href="params-intro.html#cb43-72" aria-hidden="true" tabindex="-1"></a><span class="at">gaussian        | $\dnorm(x)$         | </span><span class="st">`</span><span class="fu">dnorm</span>(x)<span class="st">`</span></span>
<span id="cb43-73"><a href="params-intro.html#cb43-73" aria-hidden="true" tabindex="-1"></a><span class="at">sigmoid     | $\pnorm(x)$         | </span><span class="st">`</span><span class="fu">pnorm</span>(x)<span class="st">`</span></span>
<span id="cb43-74"><a href="params-intro.html#cb43-74" aria-hidden="true" tabindex="-1"></a><span class="at">     </span></span>
<span id="cb43-75"><a href="params-intro.html#cb43-75" aria-hidden="true" tabindex="-1"></a><span class="at">The basic modeling functions are the same, but replace the plain $x$ in the pattern-book function with a straight-line function, for instance $ax + b$ or, equivalently $a(x - x_0)$.  In use, the parameter $a$ is often written with some other letter and, often, the $b$ or $-x_0$ part is not needed. </span></span>
<span id="cb43-76"><a href="params-intro.html#cb43-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-77"><a href="params-intro.html#cb43-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-78"><a href="params-intro.html#cb43-78" aria-hidden="true" tabindex="-1"></a><span class="at">Here are some of the common forms of the basic modeling functions you will encounter:</span></span>
<span id="cb43-79"><a href="params-intro.html#cb43-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-80"><a href="params-intro.html#cb43-80" aria-hidden="true" tabindex="-1"></a><span class="at">Name | Common forms | note</span></span>
<span id="cb43-81"><a href="params-intro.html#cb43-81" aria-hidden="true" tabindex="-1"></a><span class="at">-----|--------------|------------</span></span>
<span id="cb43-82"><a href="params-intro.html#cb43-82" aria-hidden="true" tabindex="-1"></a><span class="at">Exponential | $e^{k t}$ or  $e^{-k t}$ or $e^{-t/ </span><span class="sc">\t</span><span class="at">au}$</span></span>
<span id="cb43-83"><a href="params-intro.html#cb43-83" aria-hidden="true" tabindex="-1"></a><span class="at">Sinusoid | $\sin\left(</span><span class="sc">\f</span><span class="at">rac{2 \pi}{P} (t-t_0)</span><span class="sc">\r</span><span class="at">ight)$, $\sin\left(</span><span class="sc">\f</span><span class="at">rac{2 \pi}{P} t</span><span class="sc">\r</span><span class="at">ight)$, or $\sin(\omega t)$ | $P$ is "period", $\omega$ is "angular frequency."</span></span>
<span id="cb43-84"><a href="params-intro.html#cb43-84" aria-hidden="true" tabindex="-1"></a><span class="at">Monomials | $[x-x_0]$ or $[x-x_0]^2$, and so on</span></span>
<span id="cb43-85"><a href="params-intro.html#cb43-85" aria-hidden="true" tabindex="-1"></a><span class="at">Power-law generally | $x^p$ or $[x-x_0]^p$ | $p$ is "power."</span></span>
<span id="cb43-86"><a href="params-intro.html#cb43-86" aria-hidden="true" tabindex="-1"></a><span class="at">Gaussian | $\dnorm(x, mean, sd)$ | Interpret "mean" as "center."</span></span>
<span id="cb43-87"><a href="params-intro.html#cb43-87" aria-hidden="true" tabindex="-1"></a><span class="at">Sigmoid | $\dnorm(x, mean, sd)$ | $sd$ is "standard deviation" or "spread."</span></span>
<span id="cb43-88"><a href="params-intro.html#cb43-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-89"><a href="params-intro.html#cb43-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-90"><a href="params-intro.html#cb43-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-91"><a href="params-intro.html#cb43-91" aria-hidden="true" tabindex="-1"></a><span class="at">It helps in making the selection to have ready to mind the basic shape of each of these function families. To review, revisit Section \@ref(function-shapes).</span></span>
<span id="cb43-92"><a href="params-intro.html#cb43-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-93"><a href="params-intro.html#cb43-93" aria-hidden="true" tabindex="-1"></a><span class="at">Remember also that, in general, we scale the inputs and scale the output. This means that in choose a model family, we don't have to worry at first about the numbers on the axes. (Of course, those numbers will be critically important later on in the process!) The scaling does, however, allow us to consider some variations on the shapes of the modeling functions. In particular, the ***input scaling*** lets us flip the shape right-for-left. And the ***output scaling*** lets us flip the shape top-for-bottom.</span></span>
<span id="cb43-94"><a href="params-intro.html#cb43-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-95"><a href="params-intro.html#cb43-95" aria-hidden="true" tabindex="-1"></a><span class="at">- $f(t)$, basic shape</span></span>
<span id="cb43-96"><a href="params-intro.html#cb43-96" aria-hidden="true" tabindex="-1"></a><span class="at">- $f(-t)$, flipped right-for-left</span></span>
<span id="cb43-97"><a href="params-intro.html#cb43-97" aria-hidden="true" tabindex="-1"></a><span class="at">- $-f(t)$, flipped top-for-bottom</span></span>
<span id="cb43-98"><a href="params-intro.html#cb43-98" aria-hidden="true" tabindex="-1"></a><span class="at">- $-f(-t)$, flipped both top-for-bottom and right-for-left</span></span>
<span id="cb43-99"><a href="params-intro.html#cb43-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-100"><a href="params-intro.html#cb43-100" aria-hidden="true" tabindex="-1"></a><span class="at">For functions such as the sinusoid, flipping is not much use, since the flipped sinusoid curve is still a sinusoid, although with a shifted input. Similarly, a right-for-left flipped gaussian function has the same shape as the original. For the straight-line function, flipping of either sort accomplishes the same thing: changing the sign of the slope. </span></span>
<span id="cb43-101"><a href="params-intro.html#cb43-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-102"><a href="params-intro.html#cb43-102" aria-hidden="true" tabindex="-1"></a><span class="at">For the exponential function, the two possible types of flipping---right-for-left and top-for-bottom---produce four different curves, all of which are exponential, shown in Figure \@ref(fig:four-variations).</span></span>
<span id="cb43-103"><a href="params-intro.html#cb43-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-104"><a href="params-intro.html#cb43-104" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;div class="figure" style="text-align: center"&gt;</span></span>
<span id="cb43-105"><a href="params-intro.html#cb43-105" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;img src="CalcZ-notes_files/figure-html/four-variations-1.png" alt="Four variations of the exponential functions." width="50%" /&gt;&lt;img src="CalcZ-notes_files/figure-html/four-variations-2.png" alt="Four variations of the exponential functions." width="50%" /&gt;&lt;img src="CalcZ-notes_files/figure-html/four-variations-3.png" alt="Four variations of the exponential functions." width="50%" /&gt;&lt;img src="CalcZ-notes_files/figure-html/four-variations-4.png" alt="Four variations of the exponential functions." width="50%" /&gt;</span></span>
<span id="cb43-106"><a href="params-intro.html#cb43-106" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;p class="caption"&gt;(\#fig:four-variations)Four variations of the exponential functions.&lt;/p&gt;</span></span>
<span id="cb43-107"><a href="params-intro.html#cb43-107" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;/div&gt;</span></span>
<span id="cb43-108"><a href="params-intro.html#cb43-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-109"><a href="params-intro.html#cb43-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-110"><a href="params-intro.html#cb43-110" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;details&gt;</span></span>
<span id="cb43-111"><a href="params-intro.html#cb43-111" aria-hidden="true" tabindex="-1"></a><span class="at">&lt;summary&gt;**Exercise 8.3**: &lt;span&gt;&lt;a name="File: Exercises/DD-141Z-04/exponential-bases.Rmd" href="#ds4e7"&gt;&lt;img src="www/icons8-signpost.png" title="Location: Exercises/DD-141Z-04/exponential-bases.Rmd" width="12px"/&gt;&lt;/a&gt;&lt;span style="color: red; font-size: 9pt;"&gt;ds4e7&lt;/red&gt;&lt;/span&gt;&lt;/summary&gt;</span></span>
<span id="cb43-112"><a href="params-intro.html#cb43-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-113"><a href="params-intro.html#cb43-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-114"><a href="params-intro.html#cb43-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-115"><a href="params-intro.html#cb43-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-116"><a href="params-intro.html#cb43-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-117"><a href="params-intro.html#cb43-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-118"><a href="params-intro.html#cb43-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-119"><a href="params-intro.html#cb43-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-120"><a href="params-intro.html#cb43-120" aria-hidden="true" tabindex="-1"></a><span class="at">These three expressions </span></span>
<span id="cb43-121"><a href="params-intro.html#cb43-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-122"><a href="params-intro.html#cb43-122" aria-hidden="true" tabindex="-1"></a><span class="at">$$e^{kt}\ \ \ \ \ 10^{t/d} \  \ \ \ \  2^{t/h}$$</span></span>
<span id="cb43-123"><a href="params-intro.html#cb43-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-124"><a href="params-intro.html#cb43-124" aria-hidden="true" tabindex="-1"></a><span class="at">produce the same value if $k$, $d$ and $h$ have corresponding numerical values.</span></span>
<span id="cb43-125"><a href="params-intro.html#cb43-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-126"><a href="params-intro.html#cb43-126" aria-hidden="true" tabindex="-1"></a><span class="at">::: {.scaffolding}</span></span>
<span id="cb43-127"><a href="params-intro.html#cb43-127" aria-hidden="true" tabindex="-1"></a><span class="at">The scaffolding has an expression for plotting out  $2^{t/h}$ for $-4 \leq t \leq 12$ where $h = 4$. It also plots out $e^{kt}$ and $10^{t/d}$</span></span>
<span id="cb43-128"><a href="params-intro.html#cb43-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-129"><a href="params-intro.html#cb43-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-130"><a href="params-intro.html#cb43-130" aria-hidden="true" tabindex="-1"></a><span class="st">```</span>r</span>
<span id="cb43-131"><a href="params-intro.html#cb43-131" aria-hidden="true" tabindex="-1"></a>fa <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">2</span><span class="sc">^</span>(t<span class="sc">/</span>h) <span class="sc">~</span> t, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb43-132"><a href="params-intro.html#cb43-132" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="dv">10</span><span class="sc">^</span>(t<span class="sc">/</span>d) <span class="sc">~</span> t, <span class="at">d =</span> <span class="dv">10</span>)</span>
<span id="cb43-133"><a href="params-intro.html#cb43-133" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(<span class="fu">exp</span>(k<span class="sc">*</span>t)  <span class="sc">~</span> t, <span class="at">k =</span> <span class="fl">0.1</span>)</span>
<span id="cb43-134"><a href="params-intro.html#cb43-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-135"><a href="params-intro.html#cb43-135" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_plot</span>(<span class="fu">fa</span>(t) <span class="sc">~</span> t, <span class="fu">domain</span>(<span class="at">t =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">12</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb43-136"><a href="params-intro.html#cb43-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fb</span>(t) <span class="sc">~</span> t, <span class="at">color=</span><span class="st">"dodgerblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-137"><a href="params-intro.html#cb43-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">fc</span>(t) <span class="sc">~</span> t, <span class="at">color  =</span> <span class="st">"orange3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-138"><a href="params-intro.html#cb43-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span></code></pre></div>
<p>:::</p>
<p>Your task is to modify the values of <code>d</code> and <code>k</code> such that all three curves lie on top of one another. (Leave <code>h</code> at the value 4.) You can find the appropriate values of <code>d</code> and <code>k</code> to accomplish this by any means you like, say, by using the algebra of exponents or by using trial and error. (Trial and error is a perfectly valid strategy regardless of what your high-school math teachers might have said about “guess and check.” The trick is to make each new guess systematically based on your previous ones and observation of how those previous ones performed.)</p>
<p>After you have found values of <code>k</code> and <code>d</code> that are suited to the task …</p>
<p><strong>Essay question tmp-1</strong>: Enter the numerical value of your best estimate of <code>k</code>.</p>
<strong>Essay question tmp-2</strong>: Enter the numerical value of your beat estimate of <code>d</code>.
</details>
</div>
<div id="fit-exponential" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Curve fitting an exponential function<a class="anchor" aria-label="anchor" href="#fit-exponential"><i class="fas fa-link"></i></a>
</h2>
<p>The exponential function is particularly useful when the quantity we want to model shows <strong><em>constant proportional increase</em></strong>. Many quantities in everyday life are this way. For instance, an increase in salary is typically presented in a format like “a 3% increase.” The population growth of a country is often presented as “percent per year.” Inflation in the price of goods is similarly described in percent per year. Interest on money in a bank savings account is also described as percent per year. But if you have the bad fortune to owe money to a loan shark, the proportional increase might be described as “percent per month” or “percent per week.” <span style="float: right; padding-left: 50px;"><a name="920" href="#920"><img src="www/icons8-signpost.png" title="Location: 920" width="12px"></a><span style="color: red; font-size: 6pt;">920</span></span></p>
<p>When you know the “percent increase per time” of a quantity whose initial value is <span class="math inline">\(A\)</span>, the exponential function is easy to write down: <span class="math display">\[f(t) = A (1+r)^t\]</span>
The number <span class="math inline">\(r\)</span> is often called the <strong><em>interest rate</em></strong> or <strong><em>discount rate</em></strong> and is given in <strong>percent</strong>.</p>
<div class="takenote">
<p>Regrettably, it’s extremely easy amd common to forget the rules for addition with percent. If <span class="math inline">\(r = 5\%\)</span>, then <span class="math inline">\((1+r) = 1.05\)</span>, not 6. Always keep in mind that <span class="math inline">\(5\%\)</span> means <span class="math inline">\(\frac{5}{100}\)</span>.</p>
<p>Another source of error stems from the tradition in mathematics of using the number <span class="math inline">\(e=2.718282\)</span> as the “natural” base of the exponential function, whereas in <span class="math inline">\(f(t) = A (1+r)^t\)</span> the base is <span class="math inline">\(1+r\)</span>.</p>
<p>You can translate an exponential <span class="math inline">\(b^t\)</span> in any base <span class="math inline">\(b\)</span> to the “natural” base. This is just a matter of calculating the appropriate parameter <span class="math inline">\(k\)</span> such that <span class="math inline">\(e^k = b\)</span>. Using logarithms, <span class="math display">\[e^k = b\ \ \implies \ \  k=\ln(b)\]</span> For instance, if
<span class="math inline">\(r=5\%\)</span> per year, we’ll have <span class="math inline">\(k = \ln(1+r) = \ln(1.05) = 0.488\)</span> per year.</p>
<p>Almost everybody is happier doing arithmetic with numbers like 2 and 10 rather than <span class="math inline">\(e=2.718282\)</span>. For this reason, you may see formulations of the exponential function as <span class="math inline">\(g(t) \equiv 2^{a t}\)</span> or <span class="math inline">\(h(t) \equiv 10^{c t}\)</span>. Remember that <span class="math inline">\(2^{a t}\)</span> and <span class="math inline">\(e^{at}\)</span>, although both exponential functions, are quantitatively different. If you want to write <span class="math inline">\(2^{at}\)</span> using the “natural” base, it will be <span class="math inline">\(e^{\ln(2) a\, t }\)</span>. Similarly, <span class="math inline">\(10^{ct} = e^{\ln(10) c\, t}\)</span>.</p>
</div>
<p>Exponential functions also describe <strong><em>decrease</em></strong> or <strong><em>decay</em></strong>. Just replace <span class="math inline">\(t\)</span> with <span class="math inline">\(-t\)</span>. That is, a movie of a decreasing quantity is just the movie of an increasing quantity played backwards in time! <span style="float: right; padding-left: 50px;"><a name="930" href="#930"><img src="www/icons8-signpost.png" title="Location: 930" width="12px"></a><span style="color: red; font-size: 6pt;">930</span></span></p>
<p>Figure <a href="params-intro.html#fig:Fun-4-intro-1">7.8</a> shows some data collected by Prof. Stan Wagon to support his making a detailed mechanistic model of an everyday phenomenon: <a href="https://www.researchgate.net/profile/Gianluca_Argentini/post/Is_analogy_reasoning_between_heat_transfert_and_electriocity_allows_to_apply_the_electricity_laws_about_resistance_to_thermal_resistances/attachment/59d6573379197b80779ada64/AS%3A533325451403264%401504166104259/download/Stan+WAGON+How+quickly+does+water+cool.pdf">The cooling of a mug of hot beverage to room temperature</a>. The mug started at room temperature, which was measured at 26 degrees C. At time 0 he poured in boiling water from a kettle and measured the temperature of the water over the next few hours.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-intro-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-intro-1-1.png" alt="Stan's data" width="90%"><p class="caption">
Figure 7.8: Stan’s data
</p>
</div>
<p>Our task is to translate this data into the form of a function that takes time as input and returns temperature as output. Such a model would be useful for, say, filling in the gaps of the data. For instance, we might want to find the temperature of the water immediately after being poured from the kettle into the mug.</p>
<p>Looking at the data, one sees that the temperature decreases along a curve: cooling fast at first and then more slowly. This is the pattern of the flipped right-for-left exponential. (Figure <a href="#fig:four-variations"><strong>??</strong></a>(B)) We can imagine then that an exponential, <span class="math inline">\(A e^{kt} + C\)</span> will be a suitable model form for the cooling water.</p>
<p>What remains is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span>. Here is a general process for curve-fitting an exponential. Later, we’ll apply this process specifically to the water-cooling situation.</p>
<p><strong>General process for curve-fitting an exponential</strong></p>
<p><strong>Step 0</strong>: Check that the data show an exponential pattern in one of its variations, namely a smooth increase or decrease and leveling out beyond some value of <span class="math inline">\(t\)</span>. If this isn’t true, reconsider whether you should be using an exponential function in the first place.</p>
<p><strong>Step 1</strong> Do the data show exponential growth or exponential decay? If it’s exponential growth, then the flat region in Step 0 will be to the left and <span class="math inline">\(k\)</span> will be positive. If exponential decay, the flat region will be to the right and <span class="math inline">\(k\)</span> will be negative.</p>
<p>Notice that the question of “growth or decay” depends only on the sign of the parameter <span class="math inline">\(k\)</span>. You can have an exponentially decaying process that’s increasing. Consider, for instance, the speed of a car as it merges onto a highway from a slow speed on the entrance ramp. The car’s velocity is increasing, but as you approach highway speed the rate of increase gets smaller. That’s exponential decay.</p>
<p><strong>Step 2</strong> Where is the baseline? We’re going to put aside <span class="math inline">\(k\)</span> for the moment and find the value of the output that is being approached asymptotically, that is, the height of the level zone of the data. This height is the coefficient <span class="math inline">\(A\)</span> in the linear combination.</p>
<p><strong>Step 3</strong> Once you know the baseline, you’re set to find a numerical value for the parameter <span class="math inline">\(k\)</span>.</p>
<ol style="list-style-type: lower-roman">
<li>Pick a point in the data far from the baseline. Call the input <span class="math inline">\(t_1\)</span>.</li>
<li>Scan forward or backward in time to find a point in the data that’s vertically half way from the original point toward the baseline. Call the input at that point <span class="math inline">\(t_{1/2}\)</span>. The difference between these, <span class="math inline">\(t_1 - t_{1/2}\)</span> is called the <strong><em>half-life</em></strong> or <strong><em>halving-time</em></strong> if it’s negative and the <strong><em>doubling time</em></strong> if it’s positive.</li>
<li>The parameter <span class="math inline">\(k\)</span> is <span class="math inline">\(0.693 / (t_1 - t_{1/2})\)</span>. Double check the sign of <span class="math inline">\(k\)</span> to make sure it’s consistent with what you saw in Step 1. (Incidently, <span class="math inline">\(0.693 = \ln(2)\)</span>. The 2 is the same as the 2 in doubling or halving.)</li>
</ol>
<p><strong>Step 4</strong> Now that you have numerical values for the baseline <span class="math inline">\(A\)</span> and the parameter <span class="math inline">\(k\)</span>, calculating the value of <span class="math inline">\(B\)</span> is straightforward.<br>
i. Pick a <span class="math inline">\(t_0\)</span> that’s reasonably well represented in your data. Find the vertical coordinate represented by the data near that <span class="math inline">\(t_0\)</span>. Call that <span class="math inline">\({\cal D}\)</span>.
ii. Solve with respect to <span class="math inline">\(B\)</span> the equation <span class="math inline">\(A + B e^{k t_0} = {\cal D}\)</span>. Things are particularly easy if you can use <span class="math inline">\(t_0 = 0\)</span>. Then you just straight off calculate <span class="math inline">\(B = {\cal D} - A\)</span>.</p>
<p><strong>Step 5</strong> Plot the function <span class="math inline">\(A + B e^{k t}\)</span> using the values for <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(t\)</span> that you just found. If you are not satisfied, tweak the parameters a bit until you are.</p>
<p><strong>Exponential curve fitting applied to the water-cooling data</strong></p>
<p>Let’s illustrate the general process on the water-cooling data, redrawn in Figure <a href="params-intro.html#fig:Fun-4-a-2-1">7.9</a>. <span style="float: right; padding-left: 50px;"><a name="950" href="#950"><img src="www/icons8-signpost.png" title="Location: 950" width="12px"></a><span style="color: red; font-size: 6pt;">950</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-1-1.png" alt="The cooling-water data, repeated here for convenience." width="90%"><p class="caption">
Figure 7.9: The cooling-water data, repeated here for convenience.
</p>
</div>
<p>Step 0: The data indicate a smooth curve. As <span class="math inline">\(t\)</span> gets large, the curve approaches a constant. So an exponential model is reasonable.</p>
<p>Step 1: The flat zone of the data is to the right. So we’ve got exponential decay and <span class="math inline">\(k &lt; 0\)</span>.</p>
<p>Step 2: The curve looks like it’s leveling out at a temperature of about 25 degrees C for large <span class="math inline">\(t\)</span>. So <span class="math inline">\(A \approx 25^{\circ} \text{C}\)</span>.</p>
<p>Step 3:</p>
<ol style="list-style-type: lower-roman">
<li>The point furthest from the baseline is located at <span class="math inline">\(t_1 = 15 \text{sec}\)</span> with a value <span class="math inline">\({\cal D} \approx 80^\circ\text{C}\)</span>.</li>
<li>This if <span class="math inline">\(55^\circ\text{C}\)</span> from the baseline. We want to find the value of <span class="math inline">\(t_1\)</span> where the temperature will be half way from 80 to the baseline. That’s a temperature of about <span class="math inline">\(80 - 55/2 = 53.5\)</span>. Scanning over to the right, the function that I can imagine going through the data crossed <span class="math inline">\(53^\circ\)</span> at about <span class="math inline">\(t_{1/2} = 40\)</span>. Thus, the half-life is estimated at 25s.</li>
<li>The parameter <span class="math inline">\(k\)</span> is therefore $k<span class="math inline">\(0.693 / \mbox{half-life}) = - 0.63 / 25 = -0.0277\)</span>. Since we identified in Step 1 that exponential decay is involved, we expect <span class="math inline">\(k\)</span> to be negative. It is.</li>
</ol>
<p>Step 4.</p>
<ol style="list-style-type: lower-roman">
<li>We know <span class="math inline">\(A \approx 25\)</span> and <span class="math inline">\(k \approx -0.0277\)</span>. We also now that for <span class="math inline">\(t=15\)</span> the function output is about <span class="math inline">\({\cal D} = 80^\circ\)</span>.</li>
<li>This means <span class="math inline">\(25^\circ + B e^{- 0.0277 \times 15} \approx 80^\circ = 25 + 0.66 B\)</span>. Solving for <span class="math inline">\(B\)</span> gives <span class="math inline">\(B = (80 - 25)/0.66 = 83.3\)</span>
</li>
</ol>
<p>Step 5. Graph the function over the data.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-2-1.png" alt="An exponential function that roughly aligns with the data." width="90%"><p class="caption">
Figure 7.10: An exponential function that roughly aligns with the data.
</p>
</div>
<details><summary><strong>Exercise 8.7</strong>: <span><a name="File:%20Exercises/Fun/chicken-choose-vase.Rmd" href="#vkwl4"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/chicken-choose-vase.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">vkwl4</span>
</span></summary><p>The Bargain Basement store wants to sell its goods quickly. Consequently, they reduce each product’s price <span class="math inline">\(P\)</span> by 5% per day.</p>
<p><strong>Question A</strong> If a jacket costs $80 today, how much will it cost in <span class="math inline">\(t\)</span> days?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(P = 80 - 5t\)</span><span class="mcanswer"> ︎✘ Remember, 5 percent is exactly the same as 0.05 </span><br>
</li>
<li>
<span class="math inline">\(P = 80 - 4t\)</span><span class="mcanswer"> ︎✘ Remember, 4 percent is exactly the same as 0.04 </span><br>
</li>
<li>
<span class="math inline">\(P = 80 - 0.05t\)</span><span class="mcanswer"> ︎✘ This would be a decrease in price by 5 cents every day. </span><br>
</li>
<li>
<span class="math inline">\(P = 80 (0.05)^t\)</span><span class="mcanswer"> ︎✘ Each day’s price would be only 5% that of the previous day’s price. </span><br>
</li>
<li>
<span class="math inline">\(P = 80 (0.95)^t\)</span><span class="mcanswer"> ✔︎ </span>
</li>
</ol>
<p>You’ll need to open a sandbox for the next question.</p>
<div class="scaffolding">
<p>You’re on your own here! Remember, to raise a number to a power, you can use an expression like `0.95^7$.</p>
</div>
<p><strong>Question B</strong> You decided that you like the $80 jacket, but you have a budget of only $60. How long should you wait before coming back to the Bargain Basement store.?</p>
<p>    3 days<span class="mcanswer"> ︎✘ On day 3 the price will be <span class="math inline">\(0.95 imes 0.95 imes 0.95 imes 80\)</span>. That’s above your budget. </span>       4 days<span class="mcanswer"> ︎✘ On day 4 the price will be <span class="math inline">\(80 \times 0.95^4\)</span>= $65.16. Too much! </span>       5 days<span class="mcanswer"> ︎✘ On day 5 the price will be <span class="math inline">\(80 \times 0.95^5\)</span>= $61.90. Close, but still higher than your budget. </span>       6 days<span class="mcanswer"> ✔︎ </span></p>
</details><details><summary><strong>Exercise 8.11</strong>: <span><a name="File:%20Exercises/Fun/cow-type-kayak.Rmd" href="#asevss"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/cow-type-kayak.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">asevss</span>
</span></summary><p>The Wikipedia entry on “Common Misconceptions” used to contain this item:</p>
<blockquote>
<p><em>Some cooks believe that food items cooked with wine or liquor will be non-alcoholic, because alcohol’s low boiling point causes it to evaporate quickly when heated. However, a study found that some of the alcohol remains: 25% after 1 hour of baking or simmering, and 10% after 2 hours.</em></p>
</blockquote>
<p>The modeler’s go-to function type for events like the evaporation of alcohol is exponential: The amount of alcohol that evaporates would, under constant conditions (e.g. an oven’s heat), be proportional to the amount of alcohol that hasn’t yet evaporated.</p>
<p><strong>Question A</strong> A) Assume that 25% of the alcohol remains after 1 hour? If the process were exponential, how much would remain after 2 hours?</p>
<p>    10%<span class="mcanswer"> ︎✘ That’s what the study is reported to have found, but that’s not consistent with an exponential process that decays to 25% after one hour </span>       25%<span class="mcanswer"> ︎✘ Exponentials decay to zero eventually, so don’t expect things to stay still after one hour. </span>       25% of 25%<span class="mcanswer"> ✔︎ We know that 75% is eliminated over 1 hour, leaving 25%. The continuing exponential process will, over the next hour eliminate 75% of the amount at the start of that hour. So after hour 2 we’ll have 25% of the amount we had at hour 1, which was 25% of the original amount. </span>       75%<span class="mcanswer"> ︎✘ That’s how much was eliminated in the first hour, not how much remains after 2 hours. </span>       75% of 75%<span class="mcanswer"> ︎✘ In an exponential process, at any moment the rate of decay (e.g. 75% per hour) is a constant proportion of the amount that is still there. After one hour, there is 25% of the alcohol remaining. That will decay at a rate of 75% per hour. Over the next hour, we’ll lose 75% of the original 25%, giving us 25% of the original amount. </span></p>
<p><strong>Question B</strong> B) What is the half-life of an exponential process that decays to 25% after one hour?</p>
<ol style="list-style-type: lower-roman">
<li>15 minutes<span class="mcanswer"> ︎✘ This provides time for four halvings in one hour, which would leave <span class="math inline">\(\frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} \times \frac{1}{2} = 1/16\)</span> of the original not 1/4. </span><br>
</li>
<li>30 minutes<span class="mcanswer"> ✔︎ This gives time for two halvings in one hour, bringing us to 25% as observed. </span><br>
</li>
<li>45 minutes<span class="mcanswer"> ︎✘ Two halvings bring us down to 25%. At this rate, it would take 90 minutes to get down to 25%, not 60 minutes as observed. </span><br>
</li>
<li>none of the above<span class="mcanswer"> ︎✘ </span>
</li>
</ol>
<p>Let’s change pace and think about the “10% after 2 hours” observation. First, recall that the amount left after <span class="math inline">\(n\)</span> halvings is
<span class="math inline">\(\mbox{amount_left}(n) \equiv \frac{1}{2}^n\)</span>
This is an exponential function with base 1/2.</p>
<p>You’re going to carry out a <strong><em>guess-and-check</em></strong> procedure to find a zero of the function <span class="math inline">\(\text{amount_left}(n) - 0.10\)</span> that is, you’ll find what <span class="math inline">\(n\)</span> will generate the stated output value (e.g. 10%).
Open a sandbox and copy over the scaffolding, which include the definition of the <code>amount_left()</code> function. and a “guess” for the input. Change the guess until you get the output 10%.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">amount_left</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="va">n</span> <span class="op">~</span> <span class="va">n</span><span class="op">)</span>
<span class="fu">amount_left</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<p><strong>Question C</strong> C) Use <code>amount_left()</code> to figure out how many halvings it takes to bring something down to 10% of the original amount.</p>
<p>    2.58<span class="mcanswer"> ︎✘ </span>       3.32<span class="mcanswer"> ✔︎ </span>       3.62<span class="mcanswer"> ︎✘ </span>       3.94<span class="mcanswer"> ︎✘ </span>       4.12<span class="mcanswer"> ︎✘ </span></p>
<p>Another way to find the input <span class="math inline">\(n\)</span> that generates an output of 10% is to construct the <strong><em>inverse function</em></strong> to <span class="math inline">\(\text{amount_left}()\)</span>.</p>
<p>The computer already provides you with inverse functions for <span class="math inline">\(2^n\)</span> and <span class="math inline">\(e^n\)</span> and <span class="math inline">\(10^n\)</span>. Their names are <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, and <code><a href="https://rdrr.io/r/base/Log.html">log10()</a></code> repectively. Using <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, write a function named <code>log_half()</code> that gives the inverse function to <span class="math inline">\((1/2)^n\)</span>. Remember, the input to the inverse function corresponds to 10%; the output to the <span class="math inline">\(n\)</span>.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="params-intro.html#cb46-1" aria-hidden="true" tabindex="-1"></a>log_half <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="fu">log2</span>(...your stuff here ...) <span class="sc">~</span> x)</span></code></pre></div>
</div>
<p><strong>Question D</strong> The answer you got in part C) is the <strong>number</strong> of halvings needed to reach 10%. If this number occurs in 2 hours (that is, 120 minutes), what is the half life stated in minutes.</p>
<p>    30<span class="mcanswer"> ︎✘ </span>       35<span class="mcanswer"> ︎✘ </span>       36<span class="mcanswer"> ✔︎ </span>       38<span class="mcanswer"> ︎✘ </span>       42<span class="mcanswer"> ︎✘ </span>       47<span class="mcanswer"> ︎✘ </span></p>
<p>Suppose you compromise between the half-life needed to reach 25% after one hour and the half-life needed to reach 10% after two hours. Use, say, 33 minutes as the compromise half life. Using the sandbox below, calculate how much would be left after 1 hour for this compromise half life, and how much left after 2 hours.</p>
<p><strong>Question E</strong> How much is left after 1 hour and after 2 hours when the half life is 33 minutes?</p>
<ol style="list-style-type: lower-roman">
<li>28% and 8%<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>31% and 4%<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>30% and 9%<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>27% and 9%<span class="mcanswer"> ︎✘ </span>
</li>
</ol></details><details><summary><strong>Exercise 8.15</strong>: <span><a name="File:%20Exercises/Fun/maple-hit-saucer.Rmd" href="#j3xe"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/maple-hit-saucer.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">j3xe</span>
</span></summary><p>You have likely heard the phrase “exponential growth” used to describe the COVID-19 pandemic. Let’s explore this idea using actual data.</p>
<p>The <a href="https://covid19datahub.io/">COVID-19 Data Hub</a> is a collaborative effort of universities, government agencies, and NGOs to provide up-to-date information about the pandemic. We’re going to use the data about the US at the whole-country level. (There’s also data at state and county levels.)</p>
<p>Perhaps the simplest display is to show the number of cumulative cases (the <code>confirmed</code> variable) and deaths as a function of time. You can see the documentation for the dataset at the <a href="https://covid19datahub.io/">COVID-19 Data Hub</a></p>
<p>Open a sandbox and make the plot.</p>
<div class="scaffolding">
<p>We’re going to plot confirmed cases in blue and deaths in red.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_point</span><span class="op">(</span><span class="va">confirmed</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="va">Covid_US</span>, color <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_point</span><span class="op">(</span><span class="va">deaths</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="st">"orange3"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-123-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<p><strong>Question A</strong> As of mid July, about how many confirmed cases were there? (Note that the labeled tick marks refer to the beginning of the month, so the point labeled <code>Feb</code> is February 1.)</p>
<ol style="list-style-type: lower-roman">
<li>about 300,000<span class="mcanswer"> ︎✘ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br>
</li>
<li>about 350,000<span class="mcanswer"> ︎✘ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br>
</li>
<li>about 400,000<span class="mcanswer"> ︎✘ The number 1e6 means 1,000,000, that is, six zeros following the one. </span><br>
</li>
<li>about 3,000,000<span class="mcanswer"> ︎✘ Mid July is the tick mark <em>after</em> the one labelled <code>Jul</code>. </span><br>
</li>
<li>about 3,500,000<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>about 4,000,000<span class="mcanswer"> ︎✘ Mid July is the tick mark <em>after</em> the one labelled <code>Jul</code>. </span>
</li>
</ol>
<p>We’re going to do something to make the graph more informative. (At least, more informative if you understand about logarithms and exponentials!)</p>
<p>Here’s the same graphic as above, but taking the <em>logarithm</em> of the number of cases (that is, <code>confirmed</code>) and of the number of deaths. Since we’re taking the logarithm of only the y-variable, this is called a “semi-log” plot.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_point</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">confirmed</span><span class="op">)</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="va">Covid_US</span>, color <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_point</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="st">"orange3"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-124-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<p>Up through the beginning of March in the US, it is thought that most US cases were in people travelling into the US from hot spots such as China and Italy and the US, as opposed to contagion between people within the US. (Such contagion is called “community spread.”) So let’s focus on the data from the start of March onward.</p>
<p>Exponential growth appears as a straight-line pattern on a semi-log plot. Obviously, the overall pattern of the curves is not a straight line. The explanation for this is that the exponential growth rate changes over time, perhaps due to public health measures (like business closing, masks, etc.)</p>
<p>The first (official) US death from Covid-19 was recorded was recorded on Feb. 29, 2020. Five more deaths occurred two days later, bringing the cumulative number to 6.</p>
<p><strong>Question B</strong> The red data points for Feb 29/March 1 show up at zero on the vertical scale. The red data point for March 2 is at around 2 on the vertical scale. Is this consistent with the facts stated above?</p>
<ol style="list-style-type: lower-roman">
<li>No. The data contradict the facts.<span class="mcanswer"> ︎✘ Think about what it means to be 0 on the vertical scale. </span><br>
</li>
<li>Yes. The vertical scale is in log units, so 0 corresponds to 1 death, since <span class="math inline">\(\ln 1 = 0\)</span>.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>No. The vertical scale doesn’t mean anything.<span class="mcanswer"> ︎✘ You can see from the plotting command what the quantity on the vertical axis is: <code><a href="https://rdrr.io/r/base/Log.html">log(confirmed)</a></code> for the blue dots and <code><a href="https://rdrr.io/r/base/Log.html">log(deaths)</a></code> for the red. </span>
</li>
</ol>
<p>One of the purposes of making a semi-log plot is to enable you to compare very large numbers with very small numbers on the same graph. For instance, in the semi-log plot, you can easily see when the first death occurred, a fact that is invisible in the plot of the raw counts (the first plot in this exercise).</p>
<p>Another feature of semi-log plots is that they preserve proportionality. Look at the plot of raw counts and note that the curve for the number of deaths is much shallower than the curve for the number of (confirmed) cases. Yet on the semi-log plot, the two curves are practically parallel.</p>
<p>On a semi-log plot, the arithmetic difference between the two curves tells you what the proportion is between those curves. The parallel curves mean that the proportion is practically constant.
Calculate what the proportion between deaths and cases was in the month of May. Here’s a mathematical hint: <span class="math inline">\(\ln \frac{a}{b} == \ln a - \ln b\)</span>. We are interested in <span class="math inline">\(\frac{a}{b}\)</span>.</p>
<p><strong>Question C</strong> What is the proportion of deaths to cases during the month of May?</p>
<ol style="list-style-type: lower-roman">
<li>about 0.2%<span class="mcanswer"> ︎✘ Remember, it’s the natural logarithm that’s being plotted, so the inverse function is <code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code>. </span><br>
</li>
<li>about 1%<span class="mcanswer"> ︎✘ This would correspond to a (vertical) difference between the curves of about 4.6 log units. Is it really that big? </span><br>
</li>
<li>about 2%<span class="mcanswer"> ︎✘ This would correspond to a (vertical) difference between the curves of about 4 log units. Is it really that big? </span><br>
</li>
<li>about 6%<span class="mcanswer"> ✔︎ Good. You calculated <code><a href="https://rdrr.io/r/base/Log.html">exp(log(deaths) - log(cases))</a></code> which gives an answer around 0.06, or 6%. </span><br>
</li>
<li>about 25%<span class="mcanswer"> ︎✘ I’m not really sure what could lead you to this answer. You’re making a mistake that I didn’t anticipate. </span><br>
</li>
<li>more than 50%<span class="mcanswer"> ︎✘ It’s true that in May log(deaths) is about 12, and log(cases) is about 14, and 12/14 is indeed greater than 50%. But, on a log scale, the proportion relates to the difference between logs, not the ratio. </span>
</li>
</ol>
<p>In many applications, people use semi-log plots to see whether a pattern is exponential or to compare very small and very large numbers. Often, people find it easier if the vertical scale is written in the original units rather than the log units. To accomplish both, the vertical scale can be ruled with raw units spaced logarithmically, like this:</p>
<div class="scaffolding">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_point</span><span class="op">(</span><span class="va">confirmed</span> <span class="op">~</span> <span class="va">date</span>, data <span class="op">=</span> <span class="va">Covid_US</span>, color <span class="op">=</span> <span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_point</span><span class="op">(</span><span class="va">deaths</span> <span class="op">~</span> <span class="va">date</span>, color <span class="op">=</span> <span class="st">"orange3"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_refine</span><span class="op">(</span><span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-125-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<p>The <strong>labels</strong> on the vertical axis show the raw numbers, while the <strong>position</strong> shows the logarithm of those numbers.</p>
<p>The next question has to do with the meaning of the interval between grid lines on the vertical axis. Note that on the <em>horizontal</em> axis, the spacing between adjacent grid lines is half a month.</p>
<p><strong>Question D</strong> What is the numerical spacing (in terms of raw counts) between adjacent grid lines on the vertical axis?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(10^1\)</span><span class="mcanswer"> ︎✘ If this were true, moving up from the lowest label (<code>1e+01</code>, that is, 10) the next grid line would be at 20, then 30, then 40. </span><br>
</li>
<li>
<span class="math inline">\(10^2\)</span><span class="mcanswer"> ︎✘ If this were true, moving up from the lowest label (<code>1e+01</code>) the next grid line would be at 110, then 210, then 310. </span><br>
</li>
<li>A factor of 10.<span class="mcanswer"> ✔︎ Right. Every time you move up by one grid line, the raw number increases ten-fold, so 10, 100, 1000, 10,000, and so on. The phrase <code>a factor of 10</code> means to multiply by 10, not to add 10. </span><br>
</li>
<li>A factor of 100.<span class="mcanswer"> ︎✘ You’re thinking along the right lines, but this is the difference between every second grid line, not adjacent grid lines. </span>
</li>
</ol></details>
</div>
<div id="fit-periodic" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Curve fitting a periodic function<a class="anchor" aria-label="anchor" href="#fit-periodic"><i class="fas fa-link"></i></a>
</h2>
<p>Figure <a href="params-intro.html#fig:Fun-4-a-3-1">7.11</a> shows the tide level in <a href="https://www.google.com/maps/place/Providence,+RI/@41.8071,-71.4012,14z/data=!4m5!3m4!1s0x89e444e0437e735d:0x69df7c4d48b3b627!8m2!3d41.8071!4d-71.4012">Providence, Rhode Island</a>, starting at midnight on April 1, 2020 and recorded every minute for four and a half days. (These data were collected by the US National Oceanic and Atmospheric Administration. <a href="https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=20200401%2010:00&amp;end_date=20200405%201:59&amp;station=8454000&amp;product=one_minute_water_level&amp;datum=mllw&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv">Link</a>) <span style="float: right; padding-left: 50px;"><a name="960" href="#960"><img src="www/icons8-signpost.png" title="Location: 960" width="12px"></a><span style="color: red; font-size: 6pt;">960</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-1-1.png" alt="About four days of tide-level data from Providence, Rhode Island" width="90%"><p class="caption">
Figure 7.11: About four days of tide-level data from Providence, Rhode Island
</p>
</div>
<p>It’s not too hard to see what’s going on. The tide rises and falls about every 12 hours. The difference between high tide and low tide is a little more than one meter. The tide gauge is calibrated so that a typical reading is 1 meter, although we don’t know what that is respect to. (Certainly not sea level, since then the typical reading would be around zero.)</p>
<p>This simple description tells almost everything needed to construct an A/B model of the tide level using a sinusoid, that is, a function of the form <span class="math display">\[A \sin(2\pi t/P) + B\]</span> The procedure is straightforward:</p>
<p><strong>Step 0</strong>: Determine whether a sinusoid model is appropriate. As you know, sinusoids oscillate up and down repeatedly with a steady <strong><em>period</em></strong>. That certainly seems the case here. But sinusoids are also steady in the <strong><em>peak</em></strong> and <strong><em>trough</em></strong> values for each cycle. That’s only approximately true in the Providence data. Models inevitably involve approximation. We’ll have to keep an eye on whether the <strong><em>fixed amplitude</em></strong> feature of sinusoids</p>
<p><strong>Step 1</strong>: Choose a sensible value to represent the low point repeatedly reached. 0.5 m seems appropriate here, but obviously the exact position of the trough of each cycle varies over the 4.5 day duration of the data. Similarly, the peak is near 1.6 m. Parameter <span class="math inline">\(B\)</span> is the mean of the peak and trough values: <span class="math inline">\(\frac{1.6 + 0.5}{2} = 1.05\)</span> m here. Parameter <span class="math inline">\(A\)</span> is half the difference between the peak and trough values: <span class="math inline">\(\frac{1.6 - 0.5}{2} = 0.55\)</span>. Parameter <span class="math inline">\(B\)</span> is called the <strong><em>baseline</em></strong> of the sinusoid. Paramter <span class="math inline">\(A\)</span> is the <strong><em>amplitude</em></strong>. (Note that by convention, the amplitude is always <em>half</em> the high-to-low range of the sinusoid.)</p>
<p><strong>Step 2</strong>: Estimate the period <span class="math inline">\(P\)</span> of the sinusoid. This can be done with a ruler: the horizontal duration of a complete cycle. I like to use the time between peaks, but the time between troughs would work just as well. Another good choice is the time between positive sloping crossings of the baseline. (But be careful. The time between <em>successive</em> baseline crossings, one positive sloping and the other negative, give just <em>half</em> the period.)</p>
<p>On the scale of the above plot, it’s hard to read off the time of the first peak. So, zoom in until it becomes more obvious.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-1.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%"><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-2.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%"><p class="caption">
Figure 7.12: Zooming in on the start of the data (left) and on the last part of the data (right).
</p>
</div>
<p>The left panel in Figure <a href="params-intro.html#fig:Fun-4-a-3-2">7.12</a> shows about 24 hours at the start of the record. The first peak is at about 7 hours, the second at about 18 hours. That indicates that the period is 18 - 7 = 11 hours.</p>
<p><strong>Step 3</strong> Plot out the model over the data. Replacing the symbols <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(P\)</span> with our estimates, the model is</p>
<p><span class="math display">\[\require{color}
{\color{green}\mbox{tide}(t) \equiv 1.05 + 0.55 \sin(2\pi t/11)}\]</span></p>
<p>Figure <a href="params-intro.html#fig:Fun-4-a-3-3">7.13</a> shows this model in <span class="math inline">\(\color{green}\mbox{green}\)</span>.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-3"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-3-1.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="50%"><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-3-2.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="50%"><p class="caption">
Figure 7.13: The sinusoid fails to align with the timing of peaks and troughs.
</p>
</div>
<details><summary><strong>Exercise 8.19</strong>: <span><a name="File:%20Exercises/Fun/lamb-talk-gloves.Rmd" href="#YELXG"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/lamb-talk-gloves.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YELXG</span>
</span></summary><p>A person breathes in and out every three seconds. The volume <span class="math inline">\(V\)</span> of air in the person’s lungs varies between a minimum of <span class="math inline">\(2\)</span> liters and a maximum of <span class="math inline">\(4\)</span> liters. Assume time <span class="math inline">\(t\)</span> is measured in seconds.</p>
<p>Remember that a full cycle of the sine wave <span class="math inline">\(\sin(x)\)</span> involves <span class="math inline">\(x\)</span> going from its starting value to that value <strong>plus</strong> <span class="math inline">\(2 \pi\)</span>.</p>
<p><strong>Question A</strong> Which of the following is the most appropriate of these models for <span class="math inline">\(V(t)\)</span>?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(V(t) \equiv 2 + 2 \sin \left( \frac{\pi}{3} t \right)\)</span><span class="mcanswer"> ︎✘ This varies between a minimum of 0 and a maximum of 2. </span><br>
</li>
<li>
<span class="math inline">\(V(t) \equiv 3 + \sin \left( \frac{2\pi}{3} t \right)\)</span><span class="mcanswer"> ✔︎ Good. In this class, we generally write the sine function like <span class="math inline">\(\sin(2 \pi t/P)\)</span> which means that the overall argument to the sine function will go from 0 to <span class="math inline">\(2 \pi\)</span> when <span class="math inline">\(t\)</span> goes from 0 to <span class="math inline">\(P\)</span>. </span><br>
</li>
<li>
<span class="math inline">\(V(t) \equiv 2 + 2 \sin \left( \frac{2\pi}{3} t \right)\)</span><span class="mcanswer"> ︎✘ This varies between a minimum of 0 and a maximum of 2. </span><br>
</li>
<li>
<span class="math inline">\(V(t) \equiv 3 + \sin \left( \frac{\pi}{3} t \right)\)</span><span class="mcanswer"> ︎✘ Right amplitude and baseline: the minimum will be 2 liters and the maximum 4 liters. But the period is wrong. Going from <span class="math inline">\(t=0\)</span> to <span class="math inline">\(t=3\)</span> should produce a full cycle of the sine function. But here the argument would go only from 0 to $ 3 = <span class="math inline">\(\pi\)</span>. After 3 seconds, only half a cycle has been completed. </span>
</li>
</ol>
<p><strong>Question B</strong> Given a respiratory period of 3 seconds/breath, what is the respiratory <strong>frequency</strong> in units of breaths/minute?</p>
<ol style="list-style-type: lower-roman">
<li>20 breaths/minute<span class="mcanswer"> ✔︎ Right. Each breath takes 1/20th of a minute, which is 3 seconds, the period specified in the question. </span><br>
</li>
<li>3 breaths/minute<span class="mcanswer"> ︎✘ If this were true, each breath would take 20 seconds to complete. </span><br>
</li>
<li>1/3 breath per minute<span class="mcanswer"> ︎✘ With breaths completed every three seconds, 1/3 of a breath is completed each second. But the problem asked for breaths per minute. </span><br>
</li>
<li>20 seconds per breath<span class="mcanswer"> ︎✘ The <em>period</em> is in the units of seconds per breath, but the <em>frequency</em> will have units of breaths per second. Frequency is the reciprocal of period (and vice versa). </span>
</li>
</ol>
<p>A respiratory cycle can be divided into two parts: inspiration and expiration. Please do an experiment. Using a clock or watch, breath with a total period of 3 seconds/breath, that is, complete one breath every three seconds. Once you have practiced this and can do it without forcing either phase of breathing, make a rough estimate of what fraction of the cycle is inspiration and what fraction is expiration. (The “correct/incorrect” answers here are right for most people. Your natural respiration might be different.)</p>
<p><strong>Question C</strong> Which is true?</p>
<ol style="list-style-type: lower-roman">
<li>Inspiration lasts longer than expiration<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>Expiration lasts longer than inspiration<span class="mcanswer"> ︎✘ Maybe it is for you, but not for most people. Try breathing in while counting 1-2-3 then exhaling while counting 1-2-3-4-5-6. Likely, that’s not a very natural pattern for you. </span><br>
</li>
<li>Inspiration and expiration each consume about the same fraction of the complete cycle.<span class="mcanswer"> ︎✘ People can do this consciously by counting 1-2-3 for inspiration and another 1-2-3 for expiration. This usually feels forced and unnatural. </span>
</li>
</ol></details><details><summary><strong>Exercise 8.23</strong>: <span><a name="File:%20Exercises/Fun/spirometer.Rmd" href="#VBWD"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/spirometer.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">VBWD</span>
</span></summary><p>The graph below shows a recording from a “spirometer,” an instrument for recording respiration. Like many old instruments, the trace from this spirometer is made by a pen at the end of a swinging arm with paper moving steadily beneath it. The arm is not exactly aligned with the horizontal axis. Nonetheless, you should be able to estimate an appropriate amplitude and period for the trace. (dm<span class="math inline">\(^3\)</span> is cubic-decimeters: a tenth of a meter cubed. This is the same as a liter.)</p>
<div class="inline-figure"><img src="Exercises/Fun/www/spirometer.jpg" width="75%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> What are appropriate estimates for the period and amplitude of the respiration trace?</p>
<ol style="list-style-type: lower-roman">
<li>About <span class="math inline">\(\pm 1\)</span> liter and 3 seconds.<span class="mcanswer"> ︎✘ If this were true, over the 120 seconds of the recording you would expect to see 40 cycles of respiration. </span><br>
</li>
<li>About <span class="math inline">\(\pm 1\)</span> liter and 5 seconds.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>About <span class="math inline">\(\pm 1\)</span> liter and 7.5 seconds.<span class="mcanswer"> ︎✘ If this were true, you would expect to see about 16 cycles of respiration over 120 seconds of recording. </span>
</li>
</ol></details>
</div>
<div id="curve-fitting-a-power-law-function" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Curve fitting a power-law function<a class="anchor" aria-label="anchor" href="#curve-fitting-a-power-law-function"><i class="fas fa-link"></i></a>
</h2>
<p>You have been using power-law functions from early in your math and science education. Some examples: <span style="float: right; padding-left: 50px;"><a name="970" href="#970"><img src="www/icons8-signpost.png" title="Location: 970" width="12px"></a><span style="color: red; font-size: 6pt;">970</span></span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Setting</th>
<th>Function formula</th>
<th>exponent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Circumference of a circle</td>
<td><span class="math inline">\(C(r) = 2 \pi r\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>Area of a circle</td>
<td><span class="math inline">\(A(r) = \pi r^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Volume of a sphere</td>
<td><span class="math inline">\(V(r) = \frac{4}{3} \pi r^3\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td>Distance traveled by a falling object</td>
<td><span class="math inline">\(d(t) = \frac{1}{2} g t^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Gas pressure versus volume</td>
<td><span class="math inline">\(P(V) = \frac{n R T}{V}\)</span></td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>… perhaps less familiar …</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Distance traveled by a diffusing gas</td>
<td><span class="math inline">\(X(t) = D \sqrt{ \strut t}\)</span></td>
<td><span class="math inline">\(1/2\)</span></td>
</tr>
<tr class="even">
<td>Animal lifespan (in the wild) versus body mass</td>
<td>$L(M) = a M^{0.25}</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>Blood flow versus body mass</td>
<td><span class="math inline">\(F(M) = b M^{0.75}\)</span></td>
<td>0.75</td>
</tr>
</tbody>
</table></div>
<p>The reason why power-law functions have their important role in science have to do with the logic of physical quantities such as length, mass, time, area, volume, force, power, and so on. We’ll discuss this at length later in the course and the principles will appear throughout calculus.</p>
<p>As for finding the power law <span class="math inline">\(f(x) \equiv A x^p\)</span> that provides a good match to data, we’ll need some additional tools to be introduced in Chapter <a href="magnitudes.html#magnitudes">14</a>.</p>
</div>
<div id="gaussian-and-sigmoid-functions" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Gaussian and sigmoid functions<a class="anchor" aria-label="anchor" href="#gaussian-and-sigmoid-functions"><i class="fas fa-link"></i></a>
</h2>
<p>Our last two basic modeling functions express an important idea in modeling: <strong><em>localness</em></strong>. To put this in concrete terms, imagine creating a function to depict the elevation above sea level of a long road as a function of distance in miles, <span class="math inline">\(x\)</span>, from the start of the road. If the road were level at 1200 feet elevation, a sensible model would be <span class="math inline">\(\mbox{elevation}(x) = 1200 \text{ft}\)</span>. If the road were gently sloping, a better model would be <span class="math inline">\(\mbox{elevation}(x) = 1200 + 3 x\)</span>. <span style="float: right; padding-left: 50px;"><a name="980" href="#980"><img src="www/icons8-signpost.png" title="Location: 980" width="12px"></a><span style="color: red; font-size: 6pt;">980</span></span></p>
<p>Now let’s add a bump to the road. A bump is a local feature, often only a few feet wide. Or, perhaps the road is crossing a mountain range. That’s also a local feature, but unlike a bump in the road a mountain range extends for many miles.</p>
<p>The basic modeling function suited to represent bumps in the road, or potholes, or mountain ranges is generically called a “hump function.” In this book, we use a specific hump function called the <strong><em>gaussian</em></strong> function (<code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>).</p>
<p>A gaussian function has two parameters: the location<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;That is, the input value at which the function value is largest.&lt;/p&gt;"><sup>11</sup></a> of the peak, which we’ll call the <strong><em>center</em></strong> parameter, and the sideways extent of the gaussian, which we’ll call the <strong><em>spread</em></strong>. Figure <a href="#fig:Fun-3C-1"><strong>??</strong></a> shows a few gaussian functions with different parameters.</p>
<p><img src="CalcZ-notes_files/figure-html/Fun-3C-1-1.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/Fun-3C-1-2.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/Fun-3C-1-3.png" width="90%" style="display: block; margin: auto;"></p>
<p>It’s easy to read off the <strong><em>center</em></strong> parameter from a graph of a gaussian. It’s the location of the top of the function graph. (We mentioned before that a mathematical word for “the location of the top” is <strong><em>argmax</em></strong>; the value for the input of the function that produces the maximum output.)</p>
<p>The <strong><em>spread</em></strong> parameter is also pretty straightforward, but you first have to become familiar with an unusual feature of the gaussian function. The output of the gaussian <em>far from the center</em> is practically zero. But it is not exactly zero. You can see from the graphs that the gaussian function has long flanks which approach zero output more or less in the manner of an exponential function. This means that we can’t measure the spread of the gaussian function by the distance between the zeros on either side of the peak. Instead, we need a <strong><em>convention</em></strong> that will allow us to be precise in quantifying what is admittedly a vague concept of width.</p>
<p>A simple convention is that the spread is the “half-width at half-height.” Come down half-way from the peak value of the output. Panel (c) of Figure <a href="#fig:Fun-3C-1"><strong>??</strong></a> marks that elevation with a thin, red, horizontal line. Along that line, measure the width of the gaussian, as marked by the thick red line in Panel (c). The <strong><em>spread</em></strong> parameter is half the width of the gaussian measured in this way. <span style="float: right; padding-left: 50px;"><a name="990" href="#990"><img src="www/icons8-signpost.png" title="Location: 990" width="12px"></a><span style="color: red; font-size: 6pt;">990</span></span></p>
<p>If you have a keen eye, you’ll notice that the red line is not exactly half-way down from the peak. It’s down 39.35% from the peak. The official definition of width of a gaussian is not actually half-width at half-height. Instead, it is the length of the interval from the argmax to the inflection point.</p>
<p>Another seeming oddity about the gaussian function is the value of the maximum. It would have seemed natural to define this as 1, so-called “unit height.” The way it actually works is different: the maximum height is set so that the <strong><em>area</em></strong> under the gaussian function is 1.</p>
<p>This business with the area will make more sense when you’ve learned some calculus tools, specifically “differentation” and “integration.” For now though …</p>
<p>Consider another road feature, a local <strong><em>change</em></strong> from one elevation to another as you might accomplish with a ramp. The basic modeling function corresponding to a <strong><em>local change</em></strong> from one level to another is the <strong><em>sigmoid</em></strong> function. Figure <a href="#fig:Fun-3C-2"><strong>??</strong></a> shows three sigmoid functions.</p>
<p><img src="CalcZ-notes_files/figure-html/Fun-3C-2-1.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/Fun-3C-2-2.png" width="90%" style="display: block; margin: auto;"><img src="CalcZ-notes_files/figure-html/Fun-3C-2-3.png" width="90%" style="display: block; margin: auto;">
The name “sigmoid” comes from vague resemblance of the graph to the letter S (which is “sigma” in Greek: ς).</p>
<p>The parameters of the sigmoid function are the same as for the gaussian function: <strong><em>center</em></strong> and <strong><em>width</em></strong>. The center is easy to estimate from a graph. It’s the value of the input that produces an output of 0.5, half-way between the max and min of the sigmoid. As with the gaussian function, the <strong><em>width</em></strong> is measured according to a convention. The width is the <strong><em>change in input</em></strong> needed to go from an output of 0.5 to an output of 0.8413. This use of 0.8413 must seem loony at first exposure, but there is a reason. We’ll need more calculus tools before it can make sense.</p>
<p>Gaussian functions and sigmoid functions with the same center and width parameters have a very close relationship. The <strong><em>instantaneous rate of change</em></strong> of the sigmoid function is the corresponding <strong><em>gaussian</em></strong> function. Figures <a href="#fig:Fun-3C-1"><strong>??</strong></a> and <a href="#fig:Fun-3C-2"><strong>??</strong></a> show corresponding gaussian and sigmoid functions. To the very far left, the sigmoid function is effectively flat: a slope near zero. Moving toward the center the sigmoid has a gentle slope: a low number. In the center, the sigmoid is steepest: a higher number. Then the slope of the sigmoid becomes gentle again before gradually falling off to zero. Near zero, then low, then higher, then low again, then falling off to zero: that’s also the description of a gaussian function!</p>
<p>In R, the name of the sigmoid function is <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. The gaussian is <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>. The parameters that specify center and spread are named <code>mean</code> and <code>sd</code>. The word “mean” accurately conveys the idea of “center.” It would be nice to be able to say that <code>sd</code> comes from <code>s</code>prea<code>d</code>, but in fact <code>sd</code> is short for <strong><em>standard deviation</em></strong>, a old-fashioned term familiar to students of statistics. <span style="float: right; padding-left: 50px;"><a name="1000" href="#1000"><img src="www/icons8-signpost.png" title="Location: 1000" width="12px"></a><span style="color: red; font-size: 6pt;">1000</span></span></p>
<div class="why">
<p>“Standard deviation” is off-putting to many people and it really should be replaced with something less weird, perhaps <strong><em>typical spread</em></strong>. The “standard” can be interpreted as “widely used convention.” What about “deviation?” The gaussian function first appeared two-hundred years ago as part of a theory of measurement error. In the context of “error,” “deviation” might have made sense. But the theory of measurement error long ago became a more general theory of <strong><em>variation</em></strong>. Errors are just one source of variation.</p>
</div>
<details><summary><strong>Exercise 8.25</strong>: <span><a name="File:%20Exercises/Fun/hump-intro.Rmd" href="#IELWV"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/hump-intro.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">IELWV</span>
</span></summary><p>The hump function that we mainly use in CalcZ is implemented in R with <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(x, mean, sd)</a></code>. The input called <code>mean</code> corresponds to the <em>center</em> of the hump. The input called <code>sd</code> gives the <em>width</em> of the hump.</p>
<div class="scaffolding">
<p>In a sandbox, make a slice plot of <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(x, mean=0, sd=1)</a></code>. By varying the value of <code>width</code>, figure out how you could read that value directly from the graph.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slice_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>,
           <span class="fu">domain</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<p>In the plot below, one of the double-headed arrows represents the <code>width</code> parameter. The others are misleading.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-130-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> Which arrow shows correctly the <code>width</code> parameter of the hump function in the graph with arrows?</p>
<p>    top<span class="mcanswer"> ✔︎ </span>       middle<span class="mcanswer"> ︎✘ </span>       bottom<span class="mcanswer"> ︎✘ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question B</strong> What is the value of <code>center</code> in the graph with arrows?</p>
    -2<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>       -1<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>       -0.5<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>       0<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>       0.5<span class="mcanswer"> ✔︎ </span>       1<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>       2<span class="mcanswer"> ︎✘ The <code>center</code> parameter is the argmax of the function. </span>
</details><details><summary><strong>Exercise 8.29</strong>: <span><a name="File:%20Exercises/Fun/sigmoid-intro.Rmd" href="#CKSLE"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/sigmoid-intro.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">CKSLE</span>
</span></summary><p>Gaussian functions and sigmoidal functions come in pairs. For every possible sigmoid, there is a corresponding gaussian that gives, for each value of the input, the slope of the sigmoid.</p>
<p>Each of the following graphs shows a sigmoid and a gaussian function. The two might or might not correspond to one another. That is, the output of the gaussian might be the slope of the sigmoid, or the gaussian might correspond to some other sigmoid. Remember, you’re comparing the <em>output</em> of the gaussian to the <em>slope</em> of the sigmoid.</p>
<p>For each graph, say whether the gaussian and the sigmoid correspond to one another. If not, choose one of the reasons why not.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-132-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> Graph (A)</p>
<ol style="list-style-type: lower-roman">
<li>The gaussian and sigmoid correspond.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ︎✘ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the gaussian the highest? </span><br>
</li>
<li>The numerical value of the output of the gaussian function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ︎✘ Did you calculate the numerical value of the slope of the sigmoid? </span>
</li>
</ol>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-133-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question B</strong> Graph (B)</p>
<ol style="list-style-type: lower-roman">
<li>The gaussian and sigmoid correspond.<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ✔︎ The gaussian peaks at about <span class="math inline">\(x=2\)</span> while the steepest part of the sigmoid is at about <span class="math inline">\(x=4\)</span> </span><br>
</li>
<li>The numerical value of the output of the gaussian function is much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ︎✘ Did you calculate the numerical value of the slope of the sigmoid? </span>
</li>
</ol>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-134-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question C</strong> Graph (C)</p>
<ol style="list-style-type: lower-roman">
<li>The gaussian and sigmoid correspond.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>The peak of the gaussian does not occur at the same value of <span class="math inline">\(x\)</span> at which the sigmoid is steepest.<span class="mcanswer"> ︎✘ For what <span class="math inline">\(x\)</span> is the sigmoid the steepest? For what <span class="math inline">\(x\)</span> is the gaussian the highest? </span><br>
</li>
<li>The numerical value of the output of the gaussian function is, for all <span class="math inline">\(x\)</span>, much larger than the numerical value of the <em>slope</em> of the sigmoid.<span class="mcanswer"> ︎✘ Did you calculate the numerical value of the slope of the sigmoid? </span>
</li>
</ol>
<p>In the graph <em>D</em>, there are several gaussian functions shown, only one of which corresponds to the sigmoid.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-135-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question D</strong> Which gaussian corresponds to the sigmoid?</p>
    A<span class="mcanswer"> ︎✘ The value of the gaussian output is much larger than the slope of the sigmoid. </span>       B<span class="mcanswer"> ✔︎ Right! The gaussian is centered on the steepest part of the sigmoid and falls to zero where the sigmoid levels out. </span>       C<span class="mcanswer"> ︎✘ The gaussian is too narrow. </span>       D<span class="mcanswer"> ︎✘ The gaussian is too broad and shifted to the left. </span>
</details><details><summary><strong>Exercise 8.33</strong>: <span><a name="File:%20Exercises/Fun/sigmoid-bath.Rmd" href="#bllKR"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/sigmoid-bath.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">bllKR</span>
</span></summary><p>Have in mind a gaussian function and a sigmoid function that form a corresponding pair.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-137-1.png" width="50%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> Which of these stories is consistent with the relationship between a gaussian and its corresponding sigmoid?</p>
<ol style="list-style-type: lower-roman">
<li>The gaussian is the amount of water in a bathtub while the sigmoid is the time you spend in the bath.<span class="mcanswer"> ︎✘ </span><br>
</li>
<li>The gaussian is the amount of water in the bathtub while the sigmoid is the rate at which water flows from the tap.<span class="mcanswer"> ︎✘ You turn the tap on and off after a while. That’s not what the sigmoid looks like. </span><br>
</li>
<li>The gaussian is the rate at which water flows from the tap and the sigmoid is the amount of water in the bathtub.<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>The gaussian indicates the amount the drain is open and the sigmoid is the amount of water in the bathtub.<span class="mcanswer"> ︎✘ Shouldn’t the amount of water go down when the drain is open? </span>
</li>
</ol></details><details><summary><strong>Exercise 8.37</strong>: <span><a name="File:%20Exercises/Fun/ebola-sigmoid.Rmd" href="#EKCIE"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/ebola-sigmoid.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">EKCIE</span>
</span></summary><p>A data frame named <code>EbolaSierraLeone</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;From the &lt;code&gt;{MMAC}&lt;/code&gt; R package&lt;/p&gt;"><sup>12</sup></a> records the cumulative number of Ebola cases in Sierra Leone from May 1, 2014 to December 16, 2015.</p>
<p>Let’s find how well a sigmoidal function models the data.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gf_point</span><span class="op">(</span><span class="va">Cases</span> <span class="op">~</span> <span class="va">Day</span>, data <span class="op">=</span> <span class="fu">MMAC</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MMAC/man/EbolaSierraLeone.html">EbolaSierraLeone</a></span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-139-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>It’s straightforward to estimate the values of the parameters from data that have a sigmoidal form. To walk you through the process, the next plot shows simulated data from a genuine sigmoid function.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-140-1.png" width="90%" style="display: block; margin: auto;"></div>
<ol style="list-style-type: decimal">
<li><p>Sketch in a S-shaped curve that smoothly follows the data.</p></li>
<li><p>Find the top plateau of the S-curve. This is indicated by the red line in the graph above. The parameter <code>A</code> is simply the height of the plateau, in this case <span class="math inline">\(y \approx 15\)</span>.</p></li>
<li><p>Come down half way from the plateau. Here, that’s 15/2 or 7.5, indicated by the horizontal blue line segment. Find the inverse of the S-curve from that half-way point onto the horizontal-axis. Here, that gives <span class="math inline">\(t \approx 5\)</span>. The parameter <code>center</code> is that value.</p></li>
<li><p>From the center of the S-shaped curve, follow the curve upward about 2/3 of the way to the plateau. In the diagram, that point is marked with a green line at <span class="math inline">\(t \approx 7\)</span>. The <code>width</code> is the distance along the horizontal axis from the blue centerline to the green line. Here, that’s <span class="math inline">\(7 - 5\)</span> giving 2 as the <code>width</code>.</p></li>
<li><p>You might also want to trace the S-curve <em>downward</em> from the centerline about 2/3 of the way to zero. That’s indicated by the left green line. In the standard sigmoid, the two green lines will be equally spaced around the centerline. Of course the data may not be in the shape of the standard sigmoid, so you might find the two green lines are not equally spaced from the center.</p></li>
</ol>
<hr>
<p><em>Put aside for the moment that the Ebola data doesn’t look exactly like the standard sigmoid function. Follow the above procedure, nevertheless.</em></p>
<p><strong>Question A</strong> Where is the top plateau?</p>
<ol style="list-style-type: lower-roman">
<li>About Day 600.<span class="mcanswer"> ︎✘ Measure the height of the plateau, not where it starts horizontally. </span><br>
</li>
<li>About 14,000 cases<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>About 20,000 cases<span class="mcanswer"> ︎✘ Read the vertical axis markings more carefully. </span><br>
</li>
<li>None of the above<span class="mcanswer"> ︎✘ One of the above answers is pretty good. </span>
</li>
</ol>
<p><strong>Question B</strong> Where is the centerline?</p>
<ol style="list-style-type: lower-roman">
<li>Near Day 200<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>Near Day 300<span class="mcanswer"> ︎✘ That’s the center of the vertical scale, not the day at which the curve reaches half-way to the eventual plateau. </span><br>
</li>
<li>At about 7000 cases<span class="mcanswer"> ︎✘ That’s half-way up to the plateau, but the answer you want is the day at which the curve reaches that point. </span>
</li>
</ol>
<p><strong>Question C</strong> Now to find the <code>width</code> parameter. The curve looks more classically sigmoidal to the left of the centerline than to the right, so follow the curve <em>downward</em> as in Step 4 of the algorithm to find the parameters. What’s a good estimate for <code>width</code>?</p>
<ol style="list-style-type: lower-roman">
<li>About 50 days<span class="mcanswer"> ✔︎ </span><br>
</li>
<li>About 100 days<span class="mcanswer"> ︎✘ Too wide! </span><br>
</li>
<li>About 10 days<span class="mcanswer"> ︎✘ Too small </span><br>
</li>
<li>About 2500 cases<span class="mcanswer"> ︎✘ The width is measured along the horizontal axis, not the vertical </span>
</li>
</ol>
<p>Open a sandbox and use the following commands to plot the Ebola data along with the sigmoid that you matched to the data by eye. The commands also generate and plot a more “refined” estimate found with <code>fitModel()</code> starting with your by-eye parameters. (Note: You’ll need to fill in the blanks at the start of the scaffolding with your by-eye parameters before running the code.)</p>
<div class="scaffolding">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="params-intro.html#cb53-1" aria-hidden="true" tabindex="-1"></a>A_estimate <span class="ot">&lt;-</span>  _____</span>
<span id="cb53-2"><a href="params-intro.html#cb53-2" aria-hidden="true" tabindex="-1"></a>center_estimate <span class="ot">&lt;-</span> _____</span>
<span id="cb53-3"><a href="params-intro.html#cb53-3" aria-hidden="true" tabindex="-1"></a>width_estimate <span class="ot">&lt;-</span> ______</span>
<span id="cb53-4"><a href="params-intro.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="params-intro.html#cb53-5" aria-hidden="true" tabindex="-1"></a>guessed_fun <span class="ot">&lt;-</span> <span class="fu">makeFun</span>(A<span class="sc">*</span> <span class="fu">pnorm</span>(Day, center, width) <span class="sc">~</span> Day,</span>
<span id="cb53-6"><a href="params-intro.html#cb53-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">A =</span> A_estimate,</span>
<span id="cb53-7"><a href="params-intro.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">center =</span> center_estimate,</span>
<span id="cb53-8"><a href="params-intro.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">width =</span> width_estimate)</span>
<span id="cb53-9"><a href="params-intro.html#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="params-intro.html#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="params-intro.html#cb53-11" aria-hidden="true" tabindex="-1"></a>refined_fun <span class="ot">&lt;-</span> <span class="fu">fitModel</span>(Cases <span class="sc">~</span> A <span class="sc">*</span> <span class="fu">pnorm</span>(Day, center, width),</span>
<span id="cb53-12"><a href="params-intro.html#cb53-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> EbolaSierraLeone,</span>
<span id="cb53-13"><a href="params-intro.html#cb53-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A=</span>A_estimate, </span>
<span id="cb53-14"><a href="params-intro.html#cb53-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">center=</span>center_estimate,</span>
<span id="cb53-15"><a href="params-intro.html#cb53-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">width=</span>width_estimate))</span>
<span id="cb53-16"><a href="params-intro.html#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="params-intro.html#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(Cases  <span class="sc">~</span> Day, <span class="at">data =</span> MMAC<span class="sc">::</span>EbolaSierraLeone)  <span class="sc">%&gt;%</span></span>
<span id="cb53-18"><a href="params-intro.html#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">guessed_fun</span>(Day) <span class="sc">~</span> Day, <span class="at">color=</span><span class="st">"orange3"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="params-intro.html#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_plot</span>(<span class="fu">refined_fun</span>(Day) <span class="sc">~</span> Day, <span class="at">color=</span><span class="st">"dodgerblue"</span>)</span></code></pre></div>
</div>
<p>I can’t predict what you see in your graph, since it depends on what starting estimates you used for <code>A</code>, <code>center</code> and <code>width</code>.</p>
<p><strong>Essay question tmp-3</strong>: Write down the estimates you made by eye for <code>A</code>, <code>center</code> and <code>width</code>. Then explain in words any major systematic deviations of the ‘refined’ model from the data.</p>
<p>This idea of fitting a sigmoidal curve <em>globally</em> to data that are only roughly sigmoidal might be forgiven since it’s just a textbook exercise. But if this were a real-world problem, there are three rookie mistakes in the approach, despite its technical sophistication.</p>
<ol style="list-style-type: decimal">
<li>A model is built for a purpose. There’s no statement in the exercise about what the purpose is.</li>
<li>The data themselves are a good enough representation of the historical pattern. There’s no need to adorn them with a fitted curve.</li>
<li>The mathematical processes that would justify the expectation that a sigmoid curve could be useful are based on the idea that the underlying mechanism for the phenomenon is unchanging. For an epidemic, that mechanism is contagion. By saying the “mechanism is unchanging,” we mean that person-to-person transmission of the Ebola virus happens in the same way at the beginning of the epidemic as it does in the middle and in the end. But strong public health interventions were introduced to control the epidemic. That’s a change in mechanism.</li>
</ol></details><hr>
<details><summary><strong>Exercise 8.36</strong>: <span><a name="File:%20Exercises/Fun/flipping-1.Rmd" href="#YLWP1"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/flipping-1.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YLWP1</span>
</span></summary><div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> One of the curves in plot (A) is a pattern-book function. Which one?</p>
<p>    black<span class="mcanswer"> ✔︎ </span>       dodgerblue<span class="mcanswer"> ︎✘ </span>       green<span class="mcanswer"> ︎✘ </span>       orange3<span class="mcanswer"> ︎✘ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question B</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (A), which one of the curves is <span class="math inline">\(f(-x)\)</span>?</p>
<p>    black<span class="mcanswer"> ︎✘ </span>       dodgerblue<span class="mcanswer"> ︎✘ </span>       green<span class="mcanswer"> ︎✘ </span>       red<span class="mcanswer"> ✔︎ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question C</strong> One of the curves in plot (B) is a pattern-book function. Which one?</p>
<p>    black<span class="mcanswer"> ︎✘ </span>       dodgerblue<span class="mcanswer"> ︎✘ </span>       green<span class="mcanswer"> ︎✘ </span>       red<span class="mcanswer"> ✔︎ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question D</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (B), which one of the curves is <span class="math inline">\(-f(x)\)</span>?</p>
<p>    black<span class="mcanswer"> ︎✘ </span>       blue<span class="mcanswer"> ✔︎ </span>       green<span class="mcanswer"> ︎✘ </span>       orange3<span class="mcanswer"> ︎✘ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-3-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The blue curve in plot (C), as you know, is the sinusoid pattern-book function.</p>
<p><strong>Question E</strong> Which of these functions is the green curve?</p>
<ol style="list-style-type: lower-roman">
<li>
<span class="math inline">\(\sin(-x)\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-\sin(x)\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>
<span class="math inline">\(-\sin(-x)\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>Both <span class="math inline">\(\sin(-x)\)</span> and <span class="math inline">\(-\sin(-x)\)</span><span class="mcanswer"> ︎✘ </span><br>
</li>
<li>Both <span class="math inline">\(\sin(-x)\)</span> and <span class="math inline">\(-\sin(x)\)</span><span class="mcanswer"> ✔︎ The sine function has so-called “odd” symmetry around <span class="math inline">\(x=0\)</span>. </span>
</li>
</ol>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-4-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question F</strong> One of the curves in plot (D) is a pattern-book function. Which one?</p>
<p>    black<span class="mcanswer"> ︎✘ </span>       dodgerblue<span class="mcanswer"> ︎✘ </span>       green<span class="mcanswer"> ✔︎ </span>       orange3<span class="mcanswer"> ︎✘ </span>       none of them<span class="mcanswer"> ︎✘ </span></p>
<p><strong>Question G</strong> Taking <span class="math inline">\(f()\)</span> to be the pattern-book function in plot (D), which one of the curves is <span class="math inline">\(-f(-x)\)</span>?</p>
    black<span class="mcanswer"> ✔︎ </span>       dodgerblue<span class="mcanswer"> ︎✘ </span>       green<span class="mcanswer"> ︎✘ </span>       orange3<span class="mcanswer"> ︎✘ </span>       none of them<span class="mcanswer"> ︎✘ </span>
</details><hr>
<details><summary><strong>Exercise 8.39</strong>: <span><a name="File:%20Exercises/Fun/flipping-2.Rmd" href="#YLWP2"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/flipping-2.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YLWP2</span>
</span></summary><p>Each of the curves in the graph is an exponential function <span class="math inline">\(e^{kt}\)</span>, for various values of <span class="math inline">\(k\)</span>.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-2-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question A</strong> What is the order from <span class="math inline">\(k\)</span> smallest (most negative) to k largest?</p>
<ol style="list-style-type: lower-roman">
<li>orange, black, red, green, blue<span class="mcanswer"> ✔︎ Exponential functions that grow slowly have <span class="math inline">\(k\)</span> with a small absolute value </span><br>
</li>
<li>black, orange, blue, green, red<span class="mcanswer"> ︎✘ Sorry. Notice the red curve grows the most slowly. This means it has the smallest <span class="math inline">\(|k|\)</span>. </span><br>
</li>
<li>red, green, blue, orange, black<span class="mcanswer"> ︎✘ The orange and black curves have negative <span class="math inline">\(k\)</span>, so they will be smaller than the other curves with positive sign. </span>
</li>
</ol></details>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></div>
<div class="next"><a href="fun-slopes.html"><span class="header-section-number">8</span> Slope function</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#params-intro"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="nav-link" href="#parallel-scales"><span class="header-section-number">7.1</span> Parallel scales</a></li>
<li><a class="nav-link" href="#scaling-the-input"><span class="header-section-number">7.2</span> Scaling the input</a></li>
<li><a class="nav-link" href="#scale-the-output"><span class="header-section-number">7.3</span> Scale the output</a></li>
<li><a class="nav-link" href="#linear-combinations"><span class="header-section-number">7.4</span> Linear combinations</a></li>
<li><a class="nav-link" href="#fit-exponential"><span class="header-section-number">7.5</span> Curve fitting an exponential function</a></li>
<li><a class="nav-link" href="#fit-periodic"><span class="header-section-number">7.6</span> Curve fitting a periodic function</a></li>
<li><a class="nav-link" href="#curve-fitting-a-power-law-function"><span class="header-section-number">7.7</span> Curve fitting a power-law function</a></li>
<li><a class="nav-link" href="#gaussian-and-sigmoid-functions"><span class="header-section-number">7.8</span> Gaussian and sigmoid functions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/dtkaplan/CalcZ-notes/blob/master/Fun-modeling.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/dtkaplan/CalcZ-notes/edit/master/Fun-modeling.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>CalcZ Student Notes</strong>" was written by Daniel Kaplan. It was last built on 2021-08-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
