<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 26 Polynomials | MOSAIC Calculus</title>
<meta name="author" content="Daniel Kaplan">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');

      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}
    \newcommand{\CC}[1]{\color{#648fff}{#1}}
    \newcommand{\CE}[1]{\color{#785ef0}{#1}}
    \newcommand{\CA}[1]{\color{#dc267f}{#1}}
    \newcommand{\CB}[1]{\color{#fe6100}{#1}}
    \newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
    </span>

    <!-- see https://www.homepages.ucl.ac.uk/~ucahmto/elearning/2019/09/14/bookdown.html-->
    \require{cancel}

    \newcommand{\bigstrut}{{\rule[-.3\baselineskip]{0pt}{1.5\baselineskip}}
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MOSAIC Calculus</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Functions for modeling</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="" href="process-of-modeling.html"><span class="header-section-number">8</span> Finding parameters for the basic modeling functions</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">9</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">10</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">11</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">12</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">13</span> Piecewise functions</a></li>
<li><a class="" href="modeling-cycle.html"><span class="header-section-number">14</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">15</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">16</span> Dimensions</a></li>
<li class="book-part">Block 2: Differentiation</li>
<li><a class="" href="change-relationships.html"><span class="header-section-number">17</span> Change relationships</a></li>
<li><a class="" href="evanescent-h.html"><span class="header-section-number">18</span> Evanescent h</a></li>
<li><a class="" href="computing-derivs.html"><span class="header-section-number">19</span> Computing derivatives</a></li>
<li><a class="" href="concavity-curvature.html"><span class="header-section-number">20</span> Concavity and curvature</a></li>
<li><a class="" href="cont-and-smooth.html"><span class="header-section-number">21</span> Continuity and smoothness</a></li>
<li><a class="" href="prod-comp-rules.html"><span class="header-section-number">22</span> Derivs of assembled functions</a></li>
<li><a class="" href="optim-and-shape.html"><span class="header-section-number">23</span> Optimization</a></li>
<li><a class="" href="partial-change.html"><span class="header-section-number">24</span> Partial change</a></li>
<li><a class="" href="local-approximations.html"><span class="header-section-number">25</span> Local approximations</a></li>
<li><a class="active" href="polynomials.html"><span class="header-section-number">26</span> Polynomials</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="Not%20available">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="polynomials" class="section level1" number="26">
<h1>
<span class="header-section-number">26</span> Polynomials<a class="anchor" aria-label="anchor" href="#polynomials"><i class="fas fa-link"></i></a>
</h1>
<p>A big part of the high-school algebra curriculum is about polynomials.
In some ways, this is appropriate since polynomials played an outsized
part in the historical development of mathematical theory. Indeed, the
so-called “Fundamental theorem of algebra” is about
polynomials.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The fundamental theorem says that an order-n
polynomial has n roots (including multiplicities).&lt;/p&gt;"><sup>31</sup></a></p>
<p>For modelers, polynomials are a mixed bag. They are very widely used in modeling. Sometimes this is entirely appropriate, for instance the low-order polynomials that are the subject of Chapter <a href="local-approximations.html#local-approximations">25</a>. The problems come when high-order
polynomials are selected for modeling purposes. Building a reliable model with high-order polynomials requires a deep knowledge of mathematics, and introduces serious potential pitfalls. Modern professional modelers learn the alternatives to high-order polynomials, but newcomers often draw on their experience in high-school and give unwarranted credence to polynomials. This chapter attempts to guide you to the ways you are likely to see polynomials in your future work and to help you avoid them when better alternatives are available.</p>
<div id="polynomial-basics" class="section level2" number="26.1">
<h2>
<span class="header-section-number">26.1</span> Basics of polynomials with one input<a class="anchor" aria-label="anchor" href="#polynomial-basics"><i class="fas fa-link"></i></a>
</h2>
<p>A polynomial is a <strong><em>linear combination</em></strong> of a particular class of functions: power-law functions with non-negative, integer exponents: 1, 2, 3, …. The individual functions are called <strong><em>monomials</em></strong>, a word use that echoes the construction of chemical polymers out of monomers; for instance, the material <em>polyester</em> is constructed by chaining together a basic chemical unit called an <a href="https://en.wikipedia.org/wiki/Ester"><em>ester</em></a><em>.</em></p>
<p>In one variable, say <span class="math inline">\(x\)</span>, the monomials are
<span class="math inline">\(x^1, x^2, x^3\)</span>, and so on. (There’s also <span class="math inline">\(x^0\)</span>, but that’s better thought of as the constant function.) An <strong><em>n-th order</em></strong> polynomial has monomials up to exponent <span class="math inline">\(n\)</span>. For example, the form of a third-order polynomial is
<span class="math display">\[a_0 + a_1 x^1 + a_2 x^2 + a_3 x^3\]</span></p>
<p>The <strong><em>domain</em></strong> of polynomials, like the power-law functions they are assembled from, is the entire number line: <span class="math inline">\(-\infty &lt; x &lt; \infty\)</span>. But for the purposes of understanding the shape of high-order polynomials, it’s helpful to divide the domain into three parts: a <strong><em>wriggly domain</em></strong> at the center and two <strong><em>tail domains</em></strong> to the right and left of the center.</p>
<div class="figure" style="text-align: center">
<span id="fig:wriggly-polynomial"></span>
<img src="CalcZ-notes_files/figure-html/wriggly-polynomial-1.png" alt="A $n$th-order polynomial can have up to $n-1$ critical points that it wriggles among. A 7-th order polynomial is shown here in which there are six local maxima or minima alternatingly." width="90%"><p class="caption">
Figure 26.1: A <span class="math inline">\(n\)</span>th-order polynomial can have up to <span class="math inline">\(n-1\)</span> critical points that it wriggles among. A 7-th order polynomial is shown here in which there are six local maxima or minima alternatingly.
</p>
</div>
<p>Figure <a href="polynomials.html#fig:wriggly-polynomial">26.1</a> shows a 7-th order polynomial—that is, the highest-order term is <span class="math inline">\(x^7\)</span>. In one of the tail domains the function value heads off to <span class="math inline">\(\infty\)</span>, in the other to <span class="math inline">\(-\infty\)</span>. This is a necessary feature of all odd-order polynomials: 1, 3, 5, 7, …</p>
<p>In contrast, for even-order polynomials (2, 4, 6, …) the function value in the two tail domains go in the same direction, either both to <span class="math inline">\(\infty\)</span> (Hands up!) or both to <span class="math inline">\(-\infty\)</span>.</p>
<p>In the wriggly domain in Figure <a href="polynomials.html#fig:wriggly-polynomial">26.1</a>, there are six argmins or argmaxes.</p>
<p><strong>An <span class="math inline">\(n\)</span>th-order polynomial can have up to <span class="math inline">\(n-1\)</span> extrema.</strong></p>
<p>Note that the local polynomial approximations in Chapter <a href="local-approximations.html#local-approximations">25</a> are at most 2-nd order and so there is at most 1 wriggle: a unique argmax. If the approximation does not include the quadratic terms (<span class="math inline">\(x^2\)</span> or <span class="math inline">\(y^2\)</span>) then there is no argmax for the function.</p>
</div>
<div id="multiple-inputs" class="section level2" number="26.2">
<h2>
<span class="header-section-number">26.2</span> Multiple inputs?<a class="anchor" aria-label="anchor" href="#multiple-inputs"><i class="fas fa-link"></i></a>
</h2>
<p>High-order polynomials are rarely used with multiple inputs. One reason is the proliferation of coefficients. For instance, here is the third-order polynomial in two inputs, <span class="math inline">\(x\)</span>, and <span class="math inline">\(y\)</span>.
<span class="math display">\[\underbrace{b_0 + b_x x + b_y y}_\text{first-order terms} + \underbrace{b_{xy} x y + b_{xx} x^2 + b_{yy} y^2}_\text{second-order terms} + \underbrace{b_{xxy} x^2 y + b_{xyy} x y^2 + b_{xxx} x^3 + b_{yyy} y^3}_\text{third-order terms}\]</span></p>
<p>This has 10 coefficients. With so many coefficients it’s hard to ascribe meaning to any of them individually. And, insofar as some feature of the function does carry meaning in terms of the modeling situation, that meaning is spread out and hard to quantify.</p>
</div>
<div id="high-order-approximations" class="section level2" number="26.3">
<h2>
<span class="header-section-number">26.3</span> High-order approximations<a class="anchor" aria-label="anchor" href="#high-order-approximations"><i class="fas fa-link"></i></a>
</h2>
<p>The potential attraction of high-order polynomials is that, with their wriggly interior, they can take on a large number of appearances. This chameleon-like behavior has historically made them the tool of choice for understanding the behavior of approximations. That theory has motivated the use of polynomials for modeling patterns in data, but, paradoxically, has shown that high-order polynomials should <strong>not</strong> be the tool of choice for modeling data.&amp;[The mathematical background needed for those better tools won’t be available to us until Block 5, when we explore linear algebra.]</p>
<p>Polynomial functions lend themselves well to calculations, since the output from a polynomial function can be calculated using just the basic arithmetic functions: addition, subtraction, multiplication, and division. To illustrate, consider this polynomial: <span class="math display">\[g(x) \equiv x - \frac{1}{6} x^3\]</span>
Since the highest-order term is <span class="math inline">\(x^3\)</span> this is a third-order polynomial. (As you’ll see, we picked these particular coefficients, 0, 1, 0, -1/6, for a reason.) With such simple coefficients the polynomial is easy to handle by mental arithmetic. For instance, for <span class="math inline">\(g(x=1)\)</span> is <span class="math inline">\(5/6\)</span>. Similarly, <span class="math inline">\(g(x=1/2) = 23/48\)</span> and <span class="math inline">\(g(x=2) = 2/3\)</span>. A person of today’s generation would use an electronic calculator for more complicated inputs, but the mathematicians of Newton’s time were accomplished human calculators. It would have been well within their capabilities to calculate, using paper and pencil<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Unfortunately for these human calculators, pencils weren’t invented until 1795. Prior to the introduction of this advanced, graphite-based computing technology, mathematicians had to use quill and ink.&lt;/p&gt;"><sup>32</sup></a>, <span class="math inline">\(g(\pi/4) = 0.7046527\)</span>.</p>
<p>Our example polynomial, <span class="math inline">\(g(x) \equiv x - \frac{1}{6}x^3\)</span>, graphed in color in Figure <a href="polynomials.html#fig:small-sine">26.2</a>, doesn’t look like any of our pattern book functions. But, for a small interval around <span class="math inline">\(x=0\)</span>, it has a great similarity to the sinusoid.</p>
<div class="figure" style="text-align: center">
<span id="fig:small-sine"></span>
<img src="CalcZ-notes_files/figure-html/small-sine-1.png" alt="The polynomial $g(x) \equiv x -x^3 / 6$ is remarkably similar to $\sin(x)$ near $x=0$." width="90%"><p class="caption">
Figure 26.2: The polynomial <span class="math inline">\(g(x) \equiv x -x^3 / 6\)</span> is remarkably similar to <span class="math inline">\(\sin(x)\)</span> near <span class="math inline">\(x=0\)</span>.
</p>
</div>
<p>It’s clear from the graph that the approximation is excellent near <span class="math inline">\(x=0\)</span> and gets worse as <span class="math inline">\(x\)</span> gets larger. The approximation is poor for <span class="math inline">\(x \approx \pm 2\)</span>. We know enough about polynomials to say that the approximation will not get better for larger <span class="math inline">\(x\)</span>; the sine function has a range of <span class="math inline">\(-1\)</span> to <span class="math inline">\(1\)</span>, while the left and right tails of the polynomial are heading off to <span class="math inline">\(\infty\)</span> and <span class="math inline">\(-\infty\)</span> respectively.</p>
<p>One way to measure the quality of the approximation is the <strong><em>error</em></strong> <span class="math inline">\({\cal E}(x)\)</span> which gives, as a function of <span class="math inline">\(x\)</span>, the difference between the actual sinusoid and the approximation: <span class="math display">\[{\cal E}(x) \equiv |\strut\sin(x) - g(x)|\]</span> The absolute value used the error reflects our interest in how <strong><em>far</em></strong> the approximation is from the actual function and not so much in whether the approximation is below or above the actual function. Figure <a href="#fig:sin-error"><strong>??</strong></a> shows <span class="math inline">\({\cal E}(x)\)</span> as a function of <span class="math inline">\(x\)</span>. Since the error is the same on both sides of <span class="math inline">\(x=0\)</span>, only the positive <span class="math inline">\(x\)</span> domain is shown.</p>
<div class="figure" style="text-align: center">
<span id="fig:sin-error-1"></span>
<img src="CalcZ-notes_files/figure-html/sin-error-1.png" alt="The error ${\cal E}(x)$ of $x - x^3/6$ as an approximation to $\sin(x)$. Left panel: linear scale. Right panel: log-log scale." width="90%"><p class="caption">
Figure 26.3: The error <span class="math inline">\({\cal E}(x)\)</span> of <span class="math inline">\(x - x^3/6\)</span> as an approximation to <span class="math inline">\(\sin(x)\)</span>. Left panel: linear scale. Right panel: log-log scale.
</p>
</div>
<div class="figure" style="text-align: center">
<span id="fig:sin-error-2"></span>
<img src="CalcZ-notes_files/figure-html/sin-error-2.png" alt="The error ${\cal E}(x)$ of $x - x^3/6$ as an approximation to $\sin(x)$. Left panel: linear scale. Right panel: log-log scale." width="90%"><p class="caption">
Figure 26.4: The error <span class="math inline">\({\cal E}(x)\)</span> of <span class="math inline">\(x - x^3/6\)</span> as an approximation to <span class="math inline">\(\sin(x)\)</span>. Left panel: linear scale. Right panel: log-log scale.
</p>
</div>
<p>Figure <a href="#fig:sin-error"><strong>??</strong></a> shows that for <span class="math inline">\(x &lt; 0.3\)</span>, the error in the polynomial approximation to <span class="math inline">\(\sin(x)\)</span> is in the 5th decimal place. For instance, <span class="math inline">\(\sin(0.3) = 0.2955202\)</span> while <span class="math inline">\(g(0.3) = 0.2955000\)</span>.</p>
<p>That the graph of <span class="math inline">\({\cal E}(x)\)</span> is a straight-line on log-log scales diagnoses <span class="math inline">\({\cal E}(x)\)</span> as a power law. That is: <span class="math inline">\({\cal E}(x) = A x^p\)</span>. As always for power-law functions, we can estimate the exponent <span class="math inline">\(p\)</span> from the slope of the graph. It’s easy to see that the slope is positive, so <span class="math inline">\(p\)</span> must also be positive.</p>
<p>The inevitable consequence of <span class="math inline">\({\cal E}(x)\)</span> being a power-law function with positive <span class="math inline">\(p\)</span> is that <span class="math inline">\(\lim_{x\rightarrow 0} {\cal E}(x) = 0\)</span>. That is, the polynomial approximation <span class="math inline">\(x - \frac{1}{6}x^3\)</span> is <em>exact</em> as <span class="math inline">\(x \rightarrow 0\)</span>.</p>
<p>Throughout this book, we’ve been using straight-line approximations to functions around an input <span class="math inline">\(x_0\)</span>.
<span class="math display">\[g(x) = f(x_0) + \partial_x f(x_0) [x-x_0]\]</span>
One way to look at <span class="math inline">\(g(x)\)</span> is as a straight-line function. Another way is as a first-order polynomial. This raises the question of what a second-order polynomial approximation should be. Rather than the polynomial matching just the slope of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x_0\)</span>, we can arrange things so that the second-order polynomial will also match the curvature of the <span class="math inline">\(f()\)</span>. Since the curvature involves only the first and second derivatives of a function, the polynomial constructed to match both the first and the second derivative will necessarily match the slope and curvature of <span class="math inline">\(f()\)</span>. This can be accomplished by setting the polynomial coefficients appropriately.</p>
<p>Start with a general, second-order polynomial centered around <span class="math inline">\(x_0\)</span>:
<span class="math display">\[g(x) \equiv a_0 + a_1 [x-x_0] + a_2 [x - x_0)]^2\]</span>
The first- and second-derivatives, evaluated at <span class="math inline">\(x=x_0\)</span> are:
<span class="math display">\[\partial_x g(x)\left.{\Large\strut}\right|_{x=x_0} = a_1 + 2 a_2 [x  - x_0] \left.{\Large\strut}\right|_{x=x_0} = a_1\]</span>
<span class="math display">\[\partial_{xx} g(x)\left.{\Large\strut}\right|_{x=x_0} =  2 a_2\]</span>
To make <span class="math inline">\(g(x)\)</span> approximate <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x=x_0\)</span>, we need merely set
<span class="math display">\[a_1 = \partial_x f(x)\left.{\Large\strut}\right|_{x=x_0}\]</span> and
<span class="math display">\[a_2 = \frac{1}{2} \partial_{xx} f(x) \left.{\Large\strut}\right|_{x=x_0}\]</span>
This logic can also be applied to higher-order polynomials. For instance, to match the third derivative of <span class="math inline">\(f(x)\)</span> at <span class="math inline">\(x_0\)</span>, set
<span class="math display">\[a_3 = \frac{1}{6} \partial_{xxx} f(x)  \left.{\Large\strut}\right|_{x=x_0}\]</span>
Remarkably, each coefficient in the approximating polynomial involves only the corresponding order of derivative. <span class="math inline">\(a_1\)</span> involves only <span class="math inline">\(\partial_x f(x) \left.{\Large\strut}\right|_{x=x_0}\)</span>; the <span class="math inline">\(a_2\)</span> coefficient involves only <span class="math inline">\(\partial_{xx} f(x) \left.{\Large\strut}\right|_{x=x_0}\)</span>; the <span class="math inline">\(a_3\)</span> coefficient involves only <span class="math inline">\(\partial_{xx} f(x) \left.{\Large\strut}\right|_{x=x_0}\)</span>, and so on.</p>
<p>Now we can explain where the polynomial that started this section, <span class="math inline">\(x - \frac{1}{6} x^3\)</span> came from and why those coefficients make the polynmomial approximate the sinusoid near <span class="math inline">\(x=0\)</span>.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="10%">
<col width="36%">
<col width="53%">
</colgroup>
<thead><tr class="header">
<th>Order</th>
<th>
<span class="math inline">\(\sin(x)\)</span> derivative</th>
<th>
<span class="math inline">\(x - \frac{1}{6}x^3\)</span> derivative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><span class="math inline">\(\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(\left( 1 - \frac{1}{6}x^3\right)\left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td><span class="math inline">\(\cos(x) \left.{\Large\strut}\right|_{x=0} = 1\)</span></td>
<td><span class="math inline">\(\left(1 - \frac{3}{6} x^2\right) \left.{\Large\strut}\right|_{x=0}= 1\)</span></td>
</tr>
<tr class="odd">
<td>2</td>
<td><span class="math inline">\(-\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(\left(- \frac{6}{6} x\right) \left.{\Large\strut}\right|_{x=0} = -1\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td><span class="math inline">\(-\cos(x) \left.{\Large\strut}\right|_{x=0} = -1\)</span></td>
<td><span class="math inline">\(- 1\left.{\Large\strut}\right|_{x=0} = -1\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td><span class="math inline">\(\sin(x) \left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
<td><span class="math inline">\(0\left.{\Large\strut}\right|_{x=0} = 0\)</span></td>
</tr>
</tbody>
</table></div>
<p>The first four derivatives of <span class="math inline">\(x - \frac{1}{6} x^3\)</span> exactly match, at <span class="math inline">\(x=0\)</span>, the first four derivatives of <span class="math inline">\(\sin(x)\)</span>.</p>
<p>The polynomial constructed by matching successive derivatives of a function <span class="math inline">\(f(x)\)</span> at some input <span class="math inline">\(x_0\)</span> is called a <strong><em>Taylor polynomial</em></strong>.</p>
<div class="workedexample">
<p>Let’s construct a 3th-order Taylor polynomial approximation to <span class="math inline">\(f(x) = e^x\)</span> around <span class="math inline">\(x=0\)</span>.</p>
<p>We know it will be a 3th order polynomial:
<span class="math display">\[g_{\exp}(x) \equiv a_0 + a_1 x + a_2 x^2 + a_3 x^3\]</span>
The exponential function is particularly nice for examples because the function value and all it’s derivatives are identical: <span class="math inline">\(e^x\)</span>. So
<span class="math display">\[f(x= 0) = 1\]</span><br><span class="math display">\[ \partial_x f(x=0) = 1\]</span>
<span class="math display">\[\partial_{xx} f(x=0) = 1\]</span>
<span class="math display">\[\partial_{xxx} f(x=0) = 1\]</span> and so on.</p>
<p>The function value and derivatives of <span class="math inline">\(g_{\exp}(x)\)</span> at <span class="math inline">\(x=0\)</span> are:
<span class="math display">\[g_{\exp}(x=0) = a_0\]</span>
<span class="math display">\[\partial_{x}g_{\exp}(x=0) = a_1\]</span>
<span class="math display">\[\partial_{xx}g_{\exp}(x=0) = 2 a_2\]</span></p>
<p><span class="math display">\[\partial_{xxx}g_{\exp}(x=0) = 2\cdot3\cdot a_3 = 6\, a_3\]</span>
Matching these to the exponential evaluated at <span class="math inline">\(x=0\)</span>, we get
<span class="math display">\[a_0 = 1\]</span>
<span class="math display">\[a_1 = 1\]</span>
<span class="math display">\[a_2 = \frac{1}{2}\]</span>
<span class="math display">\[a_3 = \frac{1}{2 \cdot 3} = \frac{1}{6}\]</span></p>
<p>Result: the 3rd-order Taylor polynomial approximation to the exponential at <span class="math inline">\(x=0\)</span> is <span class="math display">\[g_{\exp}(x) = 1 + x + \frac{1}{2} x + \frac{1}{2\cdot 3} x^2 + \frac{1}{2\cdot 3} x^3 +\frac{1}{2\cdot 3\cdot 4} x^4\]</span></p>
<p>Figure <a href="polynomials.html#fig:taylor-exp-3">26.5</a> shows the exponential function <span class="math inline">\(e^x\)</span> and its 3th-order Taylor polynomial approximation near <span class="math inline">\(x=0\)</span>:</p>
<div class="figure" style="text-align: center">
<span id="fig:taylor-exp-3"></span>
<img src="CalcZ-notes_files/figure-html/taylor-exp-3-1.png" alt="The 3th-order Taylor polynomial approximation to $e^x$ arount $x=0$" width="90%"><p class="caption">
Figure 26.5: The 3th-order Taylor polynomial approximation to <span class="math inline">\(e^x\)</span> arount <span class="math inline">\(x=0\)</span>
</p>
</div>
<p>The polynomial is exact at <span class="math inline">\(x=0\)</span>. The <strong><em>error</em></strong> <span class="math inline">\({\cal E}(x)\)</span> grows with increasing distance from <span class="math inline">\(x=0\)</span>:</p>
<div class="figure" style="text-align: center">
<span id="fig:taylor-exp-5"></span>
<img src="CalcZ-notes_files/figure-html/taylor-exp-5-1.png" alt="The error from a 3th-order Taylor polynomial approximation to $e^x$ around $x=0$ is a power-law function with exponent $4$." width="50%"><img src="CalcZ-notes_files/figure-html/taylor-exp-5-2.png" alt="The error from a 3th-order Taylor polynomial approximation to $e^x$ around $x=0$ is a power-law function with exponent $4$." width="50%"><p class="caption">
Figure 26.6: The error from a 3th-order Taylor polynomial approximation to <span class="math inline">\(e^x\)</span> around <span class="math inline">\(x=0\)</span> is a power-law function with exponent <span class="math inline">\(4\)</span>.
</p>
</div>
<p>The plot of <span class="math inline">\(\log_{10} {\cal E}(x)\)</span> versus <span class="math inline">\(\log_{10} | x |\)</span> in Figure <a href="polynomials.html#fig:taylor-exp-5">26.6</a> shows that the error grows from zero at <span class="math inline">\(x=0\)</span> as a power-law function. Measuring the exponent of the power-law from the slope of the graph on log-log axes give <span class="math inline">\({\cal E}(|x|) = a |x|^4\)</span>. This is typical of Taylor polynomials: for a polynomial of degree <span class="math inline">\(n\)</span>, the error will grow as a power-law with exponent <span class="math inline">\(n+1\)</span>. This means that the higher is <span class="math inline">\(n\)</span>, the faster <span class="math inline">\(\lim_{x\rightarrow x_0}{\cal E}(x) \rightarrow 0\)</span>. On the other hand, since <span class="math inline">\({\cal E}_x\)</span> is a power law function, as <span class="math inline">\(x\)</span> gets further from <span class="math inline">\(x_0\)</span> the error grows as as <span class="math inline">\(\left(x-x_0\right)^{n+1}\)</span>.</p>
</div>
<div class="intheworld">
<p><a href="https://en.wikipedia.org/wiki/Brook_Taylor">Brooke Taylor</a> (1685-1731), a near contemporary of Newton, published his work on approximating polynomials in 1715. Wikipedia reports: “[T]he importance of [this] remained unrecognized until 1772, when Joseph-Louis Lagrange realized its usefulness and termed it ‘the main [theoretical] foundation of differential calculus.’”<a href="https://en.wikipedia.org/wiki/Brook_Taylor#/media/File:Taylor_Brook_Goupy_NPG.jpg">Source</a></p>
<div class="figure" style="text-align: center">
<span id="fig:brook-taylor"></span>
<img src="www/Brook_Taylor.jpg" alt="Brook Taylor" width="40%"><p class="caption">
Figure 26.7: Brook Taylor
</p>
</div>
<p>Taylor’s work preceded by about a century the development of techniques for working with data. One of the pioneers in these new techniques was Carl Friedrich Gauss (1777-1855), after whom the gaussian function is named. Gauss’s techniques are the foundation of an incredibly important statistical method that is ubiquitous today: <strong><em>least squares</em></strong>. Least squares provides an entirely different way to find the coefficients on approximating polynomials (and an infinite variety of other function forms). The R/mosaic <code>fitModel()</code> function for polishing parameter estimates is based on least squares. In Block 5, we’ll explore least squares and the mathematics underlying the calculations of least-squares estimates of parameters.</p>
<p>Due to the importance of Taylor polynomials in the development of calculus, many students assume their use extends to constructing models from data. They also assume that third- and higher-order monomials are a good basis for modeling data. Both these assumptions are wrong. Least squares is the proper foundation for working with data.</p>
</div>
</div>
<div id="indeterminate-forms" class="section level2" number="26.4">
<h2>
<span class="header-section-number">26.4</span> Indeterminate forms<a class="anchor" aria-label="anchor" href="#indeterminate-forms"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s return to an issue that has bedeviled calculus students since Newton’s time. The example we’ll use is the function <span class="math display">\[\text{sinc}(x)  \equiv \frac{\sin(x)}{x}\]</span></p>
<p>The sinc() function (pronounced “sink”) is still important today, in part because of its role in converting discrete-time measurements (as in an mp3 recording of sound) into continuous signals.</p>
<p>What is the value of <span class="math inline">\(\text{sinc}(0)\)</span>? One answer, favored by arithmetic teachers is that <span class="math inline">\(\text{sinc}(0)\)</span> is meaningless, because it involves division by zero.</p>
<p>On the other hand, <span class="math inline">\(\sin(0) = 0\)</span> as well, so the sinc function evaluated at zero involves 0/0. This quotient is called an <strong><em>indeterminant form</em></strong>. The logic is this: Suppose we assume that <span class="math inline">\(0/0 = b\)</span> for some number <span class="math inline">\(b\)</span>. then <span class="math inline">\(0 = 0 \times b = 0\)</span>. So any value of <span class="math inline">\(b\)</span> would do; the value of <span class="math inline">\(0/0\)</span> is “indeterminant.”</p>
<p>Still another answer is suggested by plotting out sinc(<span class="math inline">\(x\)</span>) near <span class="math inline">\(x=0\)</span> and reading the value off the graph: sinc(0) = 1.</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slice_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="va">x</span> <span class="op">~</span> <span class="va">x</span>, <span class="fu">domain</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:sinc-near-zero"></span>
<img src="CalcZ-notes_files/figure-html/sinc-near-zero-1.png" alt="To judge from this plot, sin(0) = 1." width="90%"><p class="caption">
Figure 26.8: To judge from this plot, sin(0) = 1.
</p>
</div>
<p>The graph of sinc() looks smooth and the shape makes sense. Even if we zoom in very close to <span class="math inline">\(x=0\)</span>, the graph continues to look smooth. We call such functions <strong><em>well behaved</em></strong>.</p>
<p>Compare the well-behaved sinc() to a very closely related function (which doesn’t seem to be so important in applied work): <span class="math inline">\(\frac{\sin(x)}{x^3}\)</span>.</p>
<p>Both <span class="math inline">\(\sin(x)/x\)</span> and <span class="math inline">\(\sin(x) / x^3\)</span>, evaluated at <span class="math inline">\(x=0\)</span> involve a divide by zero. Both are the indeterminant form 0/0 at <span class="math inline">\(x=0\)</span>. But the graph of <span class="math inline">\(\sin(x) / x^3\)</span> (see Figure <a href="#fig:sinc2"><strong>??</strong></a>) is not we’ll behaved. <span class="math inline">\(\sin(x) / x^3\)</span> does not have any particular value at <span class="math inline">\(x=0\)</span>; instead, it has an asymptote.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slice_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="va">x</span> <span class="op">~</span> <span class="va">x</span>, <span class="fu">domain</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_refine</span><span class="op">(</span><span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:sinc2-1"></span>
<img src="CalcZ-notes_files/figure-html/sinc2-1.png" alt="Left: The graph of $\sin(x)/x$ versus $x$, closer to zero using semi-log axes. Right: The graph of $\sin(x)/x^2$. The vertical scales on the two graphs are utterly different." width="90%"><p class="caption">
Figure 26.9: Left: The graph of <span class="math inline">\(\sin(x)/x\)</span> versus <span class="math inline">\(x\)</span>, closer to zero using semi-log axes. Right: The graph of <span class="math inline">\(\sin(x)/x^2\)</span>. The vertical scales on the two graphs are utterly different.
</p>
</div>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slice_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span> <span class="op">~</span> <span class="va">x</span>, <span class="fu">domain</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, npts<span class="op">=</span><span class="fl">500</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_refine</span><span class="op">(</span><span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:sinc2-2"></span>
<img src="CalcZ-notes_files/figure-html/sinc2-2.png" alt="Left: The graph of $\sin(x)/x$ versus $x$, closer to zero using semi-log axes. Right: The graph of $\sin(x)/x^2$. The vertical scales on the two graphs are utterly different." width="90%"><p class="caption">
Figure 26.10: Left: The graph of <span class="math inline">\(\sin(x)/x\)</span> versus <span class="math inline">\(x\)</span>, closer to zero using semi-log axes. Right: The graph of <span class="math inline">\(\sin(x)/x^2\)</span>. The vertical scales on the two graphs are utterly different.
</p>
</div>
<p>Since both <span class="math inline">\(\sin(x)/x\left.{\Large\strut}\right|_{x=0}\)</span> and <span class="math inline">\(\sin(x)/x^3\left. {\Large\strut}\right|_{x=0}\)</span> involve a divide-by-zero, the answer to the utterly different behavior of the two functions is not to be found at zero. Instead, it’s to be found <strong><em>near</em></strong> zero. For any non-zero value of <span class="math inline">\(x\)</span>, the arithmetic to evaluate the functions is straight-forward. Note that <span class="math inline">\(\sin(x) / x^3\)</span> starts its mis-behavior away from zero. The slope of <span class="math inline">\(\sin(x) / x^3\)</span> is very large near <span class="math inline">\(x=0\)</span>, while the slope of <span class="math inline">\(\sin(x) / x\)</span> smoothly approaches zero.</p>
<p>Since we’re interested in behavior <strong>near</strong> <span class="math inline">\(x=0\)</span>, a useful technique is to approximate the numerator and denominator of both functions by polynomial approximations.</p>
<ul>
<li>
<span class="math inline">\(\sin(x) \approx x - \frac{1}{6} x^3\)</span> near <span class="math inline">\(x=0\)</span>
</li>
<li>
<span class="math inline">\(x\)</span> is already a polynomial.</li>
<li>
<span class="math inline">\(x^3\)</span> is already a polynomial.</li>
</ul>
<p>Remember, these approximations are <strong>exact</strong> as <span class="math inline">\(x\)</span> goes to zero. So sufficiently close to zero,</p>
<p><span class="math display">\[\frac{\sin(x)}{x} = \frac{x - \frac{1}{6} x^3}{x} = 1 + \frac{1}{6} x^2\]</span>
Evan at <span class="math inline">\(x=0\)</span>, there’s nothing indeterminant about <span class="math inline">\(1 + x^2/6\)</span>; it’s simply 1.</p>
<p>Compare this to the polynomial approximation to <span class="math inline">\(\sin(x) / x^3\)</span>:
<span class="math display">\[\frac{\sin(x)}{x^3} = \frac{x - \frac{1}{6} x^3}{x^3} = \frac{1}{x^2} - \frac{1}{6}\]</span></p>
<p>Evaluating this at <span class="math inline">\(x=0\)</span> involves division by zero. No wonder it’s badly behaved.</p>
<p>The procedure for checking whether a function involving division by zero behaves well or poorly is described in the first-ever calculus textbook, published in 1697. The title (in English) is: <em>The analysis into the infinitely small for the understanding of curved lines</em>. In honor of the author, the Marquis de l’Hospital, the procedure is calle <strong><em>l’Hopital’s rule</em></strong>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;In many French words, the sequence “os” has been replaced by a single, accented letter, &lt;span class="math inline"&gt;\(\hat{\text{o}}\)&lt;/span&gt;.&lt;/p&gt;'><sup>33</sup></a></p>
<p>Conventionally, the relationship is written
<span class="math display">\[\lim_{x\rightarrow x_0} \frac{u(x)}{v(x)} = \lim_{x\rightarrow x_0} \frac{\partial_x u(x)}{\partial_x v(x)}\]</span></p>
<p>Let’s try this out with our two example functions around <span class="math inline">\(x=0\)</span>:</p>
<p><span class="math display">\[\lim_{x\rightarrow 0} \frac{\sin(x)}{x} = \frac{\lim_{x\rightarrow 0} \cos(x)}{\lim_{x \rightarrow 0} 1} = \frac{1}{1} = 1\]</span></p>
<p><span class="math display">\[\lim_{x\rightarrow 0} \frac{\sin(x)}{x^3} = \frac{\lim_{x\rightarrow 0} \cos(x)}{\lim_{x \rightarrow 0} 3x^2} = \frac{1}{0} \ \ \text{indeterminant}!\]</span>
## Computing with indeterminate forms</p>
<p>In the early days of electronic computers, division by zero would cause a fault in the computer, often signaled by stopping the calculation and printing an error message to some display. This was inconvenient, since programmers did not always forsee division-by-zero situations and avoid them.</p>
<p>As you’ve seen, modern computers have adopted a convention that simplifies programming considerably. Instead of stopping the calculation, the computer just carries on normally, but produces as a result one of two indeterminant forms: <code>Inf</code> and <code>NaN</code>.</p>
<p><code>Inf</code> is the output for the simple case of dividing zero into a non-zero number, for instance:</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">17</span><span class="op">/</span><span class="fl">0</span></code></pre></div>
<pre><code>## [1] Inf</code></pre>
<p><code>NaN</code>, standing for “not a number,” is the output for more challenging cases: dividing zero into zero, or multiplying <code>Inf</code> by zero, or dividing <code>Inf</code> by <code>Inf</code>.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">0</span><span class="op">/</span><span class="fl">0</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">0</span> <span class="op">*</span> <span class="cn">Inf</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="cn">Inf</span> <span class="op">/</span> <span class="cn">Inf</span></code></pre></div>
<pre><code>## [1] NaN</code></pre>
<p>The brilliance of the idea is that any calculation that involves <code>NaN</code> will return a value of <code>NaN</code>. This might seem to get us nowhere. But most programs are built out of other programs, usually written by other people interested in other applications. You can use those programs (mostly) without worrying about the implications of a divide by zero. If it’s important to respond in some particularly way, you can always check the result for being <code>NaN</code> in your own programs. (Much the same is true for <code>Inf</code>, although dividing a non-<code>Inf</code> number by <code>Inf</code> will return 0.)</p>
<p>Plotting software will often treat <code>NaN</code> values as “don’t plot this.” That’s why it’s possible to make a sensible plot of <span class="math inline">\(\sin(x)/x\)</span> even when the plotting domain includes zero.</p>
</div>
<div id="exercises" class="section level2" number="26.5">
<h2>
<span class="header-section-number">26.5</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h2>
<details><summary><strong>Exercise 26.02</strong>: <span><a name="File:%20Exercises/Diff/birch-lie-sheet.Rmd" href="#3EdMBL"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/birch-lie-sheet.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">3EdMBL</span>
</span></summary><p>The Taylor polynomial for <span class="math inline">\(e^x\)</span> has an especially lovely formula: <span class="math display">\[p(x) = 1 + \frac{x}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots\]</span></p>
<p><strong>Question C3</strong> In the above formula, the center <span class="math inline">\(x_0\)</span> does not appear. Why not?</p>
<ol style="list-style-type: lower-alpha">
<li>Having a center is not a requirement for a Taylor polynomial. [<em>This is wrong. All Taylor polynomials are expansions around some fixed center value.</em>]</li>
<li>There is a center, <span class="math inline">\(x_0 = 1\)</span>, but terms like <span class="math inline">\(x_0 x^2\)</span> were simplified to <span class="math inline">\(x^2\)</span>. [<em>Look again at the Taylor formula at the start of this section. The basis functions are <span class="math inline">\(x-x_0, (x-x_0)^2, \ldots\)</span>, not <span class="math inline">\(x_0 x, x_0 x^2, \ldots\)</span></em>]</li>
<li>There is a center, <span class="math inline">\(x_0 = 0\)</span>, but the terms like <span class="math inline">\((x-x_0)^2\)</span> were simplified to <span class="math inline">\(x^2\)</span>. <span class="math inline">\(\heartsuit\)</span>
</li>
</ol></details><details><summary><strong>Exercise 26.04</strong>: <span><a name="File:%20Exercises/Diff/pig-iron-closet.Rmd" href="#o6dP4k"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/pig-iron-closet.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">o6dP4k</span>
</span></summary><p>Here is a Taylor polynomial:
<span class="math display">\[p(x) = e + \frac{e}{1!} (x-1) + \frac{e}{2!} (x-1)^2 + \cdots\]</span></p>
<p><strong>Question D3</strong> Where is the center <span class="math inline">\(x_0\)</span> of this polynomial?</p>
<ol style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(x_0 = -2\)</span><br>
</li>
<li>
<span class="math inline">\(x_0 = -1\)</span><br>
</li>
<li>
<span class="math inline">\(x_0 = 0\)</span><br>
</li>
<li>
<span class="math inline">\(x_0=1\)</span> <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li><span class="math inline">\(x_0 = 2\)</span></li>
</ol>
<p><strong>Question E3</strong> Your roommate suggests that <span class="math inline">\(p(x)\)</span> is a Taylor expansion of <span class="math inline">\(e^x\)</span> around <span class="math inline">\(x=1\)</span>. Is he right?</p>
<ol style="list-style-type: lower-alpha">
<li>No, a polynomial doesn’t have functions like <span class="math inline">\(e\)</span>. [<em><span class="math inline">\(e\)</span> is not a function, it’s just a number, 2.718282….</em>]</li>
<li>Yes. The center is <span class="math inline">\(x_0 = 1\)</span>. <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>Not really. The formula suggests that the center is <span class="math inline">\(x_0=1\)</span> but the coefficients are wrong. [<em>The coefficients are right.</em>]
</li>
</ol></details><details><summary><strong>Exercise 26.06</strong>: <span><a name="File:%20Exercises/Diff/dog-feel-boat.Rmd" href="#Co1Ekt"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/dog-feel-boat.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">Co1Ekt</span>
</span></summary><p>Consider the function <span class="math inline">\(f(x) \equiv (x - 3)^2\)</span>.</p>
<p><strong>Question F3</strong> Using ordinary algebra, <span class="math inline">\(f(x)\)</span> can be expanded as <span class="math inline">\((x^2 - 6 x -9)\)</span>. Is <span class="math display">\[p(x) = -9 - 6 x + x^2\]</span> a Taylor polynomial expansion of <span class="math inline">\(f(x)\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>Yes, with a center at <span class="math inline">\(x_0 = 0\)</span> <span class="math inline">\(\heartsuit\)</span> [<em>As you can tell from solving, this works for this specific polynomial, but is uncommon among polynomials.</em>]</li>
<li>Yes, with a center at <span class="math inline">\(x_0 = 3\)</span><br>
</li>
<li>No, because there are no factorials involved [<em>The factorials are part of the coefficients.</em>]
</li>
</ol></details><details><summary><strong>Exercise 26.08</strong>: <span><a name="File:%20Exercises/Diff/calf-tear-fridge.Rmd" href="#llX7EF"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/calf-tear-fridge.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">llX7EF</span>
</span></summary><p>Here’s the Taylor polynomial expansion of <span class="math inline">\(\sin(x)\)</span> about a center <span class="math inline">\(x_0\)</span>:
<span class="math display">\[p(x) = 1/2 - \frac{\sqrt{3}/{2}}{2!} (x - x_0)^2 + \frac{1/2}{4!} (x - x_0)^4 + \cdots\]</span></p>
<p><strong>Question G3</strong> Which of these is the numerical value of <span class="math inline">\(x_0\)</span>? (Hint: Remember that the coefficients involve the function and its derivatives evaluated at <span class="math inline">\(x_0\)</span> as described at the very top of this section.)</p>
<ol style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(\pi/6\)</span> <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>
<span class="math inline">\(\pi/3\)</span><br>
</li>
<li>
<span class="math inline">\(\pi/2\)</span><br>
</li>
<li>
<span class="math inline">\(\pi\)</span><br>
</li>
</ol></details><details><summary><strong>Exercise 26.10</strong>: <span><a name="File:%20Exercises/Diff/frog-throw-screen.Rmd" href="#ecdVKx"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/frog-throw-screen.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">ecdVKx</span>
</span></summary><p>For a function <span class="math inline">\(f(x)\)</span> and its derivatives <span class="math inline">\(f^{(1)}(x)\)</span>, <span class="math inline">\(f^{(2)}(x)\)</span>, … the Taylor polynomial <span class="math inline">\(p(x)\)</span> centered on <span class="math inline">\(x_0\)</span> is</p>
<p><span class="math display">\[p(x) \equiv f(x_0) + \frac{f^{(1)}(x_0)}{1!} (x - x_0)^1 + 
\frac{f^{(2)}(x_0)}{2!} (x - x_0)^2 + \cdots\]</span></p>
<p>A Taylor polynomial, like all polynomials, is a linear combination of basic functions.</p>
<p><strong>Question H3</strong> Which of these are the basic functions being linearly combined in a Taylor polynomial?</p>
<ol style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(f(x), f^{(1)}(x), f^{(2)}(x), \ldots\)</span> [<em>You won’t find any of these in the definition of <span class="math inline">\(p(x)\)</span> given above. You’re confusing <span class="math inline">\(x\)</span> with <span class="math inline">\(x_0\)</span>.</em>]</li>
<li>
<span class="math inline">\(f(x_0), f^{(1)}(x_0), f^{(2)}(x_0), \ldots\)</span> [<em>These are not functions of <span class="math inline">\(x\)</span>. They are numbers computed by evaluating a function at the center point <span class="math inline">\(x_0\)</span>.</em>]</li>
<li>
<span class="math inline">\(f(x_0), \frac{f^{(1)}(x_0)}{1!}, \frac{f^{(2)}(x_0)}{2!}, \ldots\)</span> [<em>These are not functions of <span class="math inline">\(x\)</span>. They are numbers computed by evaluating a function at the center point <span class="math inline">\(x_0\)</span>.</em>]</li>
<li>
<span class="math inline">\((x-x_0), (x - x_0)^2, \ldots\)</span> <span class="math inline">\(\heartsuit\)</span> [<em>These are the only places where the variable <span class="math inline">\(x\)</span> appears in the Taylor formula.</em>]</li>
</ol></details><details><summary><strong>Exercise 26.12</strong>: <span><a name="File:%20Exercises/Diff/local-shift.Rmd" href="#682lsB"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/local-shift.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">682lsB</span>
</span></summary><p>Each of the three functions graphed below is a simple power-law function that can be written <span class="math inline">\(\left[x-x_0\right]^n\)</span>. The three functions have different values for <span class="math inline">\(x_0\)</span> and for <span class="math inline">\(n\)</span>.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-314-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Question I3</strong> For the blue function, what is <span class="math inline">\(x_0\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>-2<br>
</li>
<li>-1<br>
</li>
<li>0<br>
</li>
<li>1<br>
</li>
<li>2<br>
</li>
<li>3<br>
</li>
<li>4 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>5</li>
</ol>
<p><strong>Question J3</strong> For the blue function, what is the order of the polynomial?</p>
<ol style="list-style-type: lower-alpha">
<li>0<br>
</li>
<li>1 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>2<br>
</li>
<li>3<br>
</li>
<li>4<br>
</li>
<li>5</li>
</ol>
<hr>
<p><strong>Question K3</strong> For the red function, what is <span class="math inline">\(x_0\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>-2<br>
</li>
<li>-1<br>
</li>
<li>0<br>
</li>
<li>1<br>
</li>
<li>2 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>3<br>
</li>
<li>4<br>
</li>
<li>5</li>
</ol>
<p><strong>Question L3</strong> For the red function, what is the order of the polynomial?</p>
<ol style="list-style-type: lower-alpha">
<li>0<br>
</li>
<li>1 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>2<br>
</li>
<li>3<br>
</li>
<li>4<br>
</li>
<li>5</li>
</ol>
<hr>
<p><strong>Question M3</strong> For the green function, what is <span class="math inline">\(x_0\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>-2<br>
</li>
<li>-1<br>
</li>
<li>0<br>
</li>
<li>1<br>
</li>
<li>2<br>
</li>
<li>3<br>
</li>
<li>4 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>5</li>
</ol>
<p><strong>Question N3</strong> For the green function, what is the order of the polynomial?</p>
<ol style="list-style-type: lower-alpha">
<li>0<br>
</li>
<li>1<br>
</li>
<li>2<br>
</li>
<li>3 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>4<br>
</li>
<li>5<br>
</li>
</ol></details><details><summary><strong>Exercise 26.14</strong>: <span><a name="File:%20Exercises/Diff/dolphin-mean-linen.Rmd" href="#cQT2v6"><img src="www/icons8-signpost.png" title="Location: Exercises/Diff/dolphin-mean-linen.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">cQT2v6</span>
</span></summary><p>At <span class="math inline">\(x=0\)</span>, the value of <span class="math inline">\(x \ln(x)\)</span> is indeterminate, having the form <span class="math inline">\(0 \cdot \infty\)</span>.</p>
<p>Try plotting out <span class="math inline">\(x \ln(x)\)</span> over the domain <span class="math inline">\(0 &lt; x &lt; \frac{1}{2}\)</span>.</p>
<p><strong>Question O3</strong> From the graph, determine <span class="math inline">\(\lim_{x\rightarrow 0} x \ln(x()\)</span>. Choose the correct answer.</p>
<ol style="list-style-type: lower-alpha">
<li>-0.2<br>
</li>
<li>0 <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>0.1<br>
</li>
<li>0.5<br>
</li>
<li>not well behaved</li>
</ol>
<p>Use l’Hopital’s rule to confirm that <span class="math inline">\(\\lim_{x\\rightarrow 0} x \\ln(x()\)</span> exists. Here, the rule has the form:</p>
<p><span class="math display">\[\lim_{x\rightarrow 0} x \cdot \ln(x) = [\lim_{x\rightarrow 0} \partial_x x] \cdot
 [\lim_{x\rightarrow 0} \partial_x \ln(x)]\]</span></p>
<p><strong>Question P3</strong> Does the application of l’Hopital’s rule confirm the result from graphing the function?</p>
<ol style="list-style-type: lower-alpha">
<li>Yes <span class="math inline">\(\heartsuit\)</span><br>
</li>
<li>No [<em>Aren’t you getting $rac{1}{1/x} = x$ when you carry out the differentiation involved?</em>]
</li>
</ol></details><!--
## Fitting polynomials

Taylor polynomials provide a means to approximate continuous and smooth functions around a center $x_0$. So long as $x$ is very close to $x_0$, the approximation will be excellent. But Taylor polynomials aren't a solution to every problem. Consider the piecewise continuous function, $ramp(x-1)$, in Figure \@ref(fig:ramp-Taylor).

<div class="figure" style="text-align: center">
<img src="CalcZ-notes_files/figure-html/ramp-Taylor-1.png" alt="A piecewise continuous ramp function (gray) together with its Taylor polynomial (magenta) centered on $x_0 = 0$." width="90%" />
<p class="caption">(\#fig:ramp-Taylor)A piecewise continuous ramp function (gray) together with its Taylor polynomial (magenta) centered on $x_0 = 0$.</p>
</div>
The value of $ramp(x-1) \left.\Large\right|_{x=0}$ is zero, as is the value of the first, second, third, and every other derivative. Whatever we choose for the order $n$ of the Taylor polynomial, it will be $\text{Taylor(x) = 0}$. That's an excellent approximation to $ramp(x-1)$ around $x=0$! But it misses the point of $ramp()$ entirely.

Or consider the problem that introduced this chapter: finding an arithmetic process to evaluate $\sin(x)$. As it happens, we only need to be able to evaluate $\sin(x)$ on the interval $0 \leq x \leq \pi/2$.^[If $x$ is outside this range, add or subtract a multiple $k \in [\ldots, -2, -1, 0, 1, 2, \ldots]$ of $\pi$ so  $0 \leq x - k \pi \leq \pi$. Then, if $\pi/2 \leq (x - k \pi)$, calculate $\sin(\pi - (x - k \pi))$ 

FIT TO PART OF SINE


```r
Pts <- tibble(x = seq(0, pi/2, length=1000), y = sin(x))
mod <- lm(y ~ x + I(x*x) + I(x*x*x) - 1, data = Pts)
mod
```

```
## 
## Call:
## lm(formula = y ~ x + I(x * x) + I(x * x * x) - 1, data = Pts)
## 
## Coefficients:
##            x      I(x * x)  I(x * x * x)  
##       1.0164       -0.0563       -0.1189
```

```r
fmod <- makeFun(mod)
slice_plot(sin(x) ~ x, domain(x=c(0, pi/2)), size=3, alpha=0.25) %>%
  slice_plot(fmod(x) ~ x, color="magenta")
```

<img src="CalcZ-notes_files/figure-html/unnamed-chunk-124-1.png" width="90%" style="display: block; margin: auto;" />

```r
slice_plot(sin(x) - fmod(x) ~ x, domain(x=c(0, pi/2))) %>%
  slice_plot(sin(x) - (x - x^3/6) ~ x, color="green")
```

<img src="CalcZ-notes_files/figure-html/unnamed-chunk-124-2.png" width="90%" style="display: block; margin: auto;" />

-->
</div>
</div>








































  <div class="chapter-nav">
<div class="prev"><a href="local-approximations.html"><span class="header-section-number">25</span> Local approximations</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#polynomials"><span class="header-section-number">26</span> Polynomials</a></li>
<li><a class="nav-link" href="#polynomial-basics"><span class="header-section-number">26.1</span> Basics of polynomials with one input</a></li>
<li><a class="nav-link" href="#multiple-inputs"><span class="header-section-number">26.2</span> Multiple inputs?</a></li>
<li><a class="nav-link" href="#high-order-approximations"><span class="header-section-number">26.3</span> High-order approximations</a></li>
<li><a class="nav-link" href="#indeterminate-forms"><span class="header-section-number">26.4</span> Indeterminate forms</a></li>
<li><a class="nav-link" href="#exercises"><span class="header-section-number">26.5</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="Not%20available/blob/master/Diff-taylor.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="Not%20available/edit/master/Diff-taylor.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MOSAIC Calculus</strong>" was written by Daniel Kaplan. It was last built on 2021-09-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
