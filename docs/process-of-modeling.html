<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Finding parameters for the basic modeling functions | MOSAIC Calculus</title>
<meta name="author" content="Daniel Kaplan">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');

      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}
    \newcommand{\CC}[1]{\color{#648fff}{#1}}
    \newcommand{\CE}[1]{\color{#785ef0}{#1}}
    \newcommand{\CA}[1]{\color{#dc267f}{#1}}
    \newcommand{\CB}[1]{\color{#fe6100}{#1}}
    \newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
    </span>



    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MOSAIC Calculus</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Functions for modeling</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="active" href="process-of-modeling.html"><span class="header-section-number">8</span> Finding parameters for the basic modeling functions</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">9</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">10</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">11</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">12</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">13</span> Piecewise functions</a></li>
<li><a class="" href="modeling-cycle.html"><span class="header-section-number">14</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">15</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">16</span> Dimensions</a></li>
<li class="book-part">Block 2: Differentiation</li>
<li><a class="" href="prolog-differentiation-and-birth.html">Prolog: Differentiation and birth</a></li>
<li><a class="" href="change-relationships.html"><span class="header-section-number">17</span> Change relationships</a></li>
<li><a class="" href="evanescent-h.html"><span class="header-section-number">18</span> Evanescent h</a></li>
<li><a class="" href="computing-derivs.html"><span class="header-section-number">19</span> Computing derivatives</a></li>
<li><a class="" href="concavity-curvature.html"><span class="header-section-number">20</span> Concavity and curvature</a></li>
<li><a class="" href="cont-and-smooth.html"><span class="header-section-number">21</span> Continuity and smoothness</a></li>
<li><a class="" href="prod-comp-rules.html"><span class="header-section-number">22</span> Derivatives of assembled functions</a></li>
<li><a class="" href="optim-and-shape.html"><span class="header-section-number">23</span> Optimization</a></li>
<li><a class="" href="partial-change.html"><span class="header-section-number">24</span> Partial change</a></li>
<li><a class="" href="local-approximations.html"><span class="header-section-number">25</span> Local approximations</a></li>
<li><a class="" href="polynomials.html"><span class="header-section-number">26</span> Polynomials</a></li>
<li class="book-part">Block 3: Accumulation</li>
<li><a class="" href="change-accumulation.html"><span class="header-section-number">27</span> Change and accumulation</a></li>
<li><a class="" href="totaling-bits.html"><span class="header-section-number">28</span> Totaling the little bits</a></li>
<li><a class="" href="net-change.html"><span class="header-section-number">29</span> Integration</a></li>
<li><a class="" href="integrals-step-by-step.html"><span class="header-section-number">30</span> Integrals step-by-step</a></li>
<li><a class="" href="accum-symbolic.html"><span class="header-section-number">31</span> Symbolic anti-differentiation</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="Not%20available">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="process-of-modeling" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Finding parameters for the basic modeling functions<a class="anchor" aria-label="anchor" href="#process-of-modeling"><i class="fas fa-link"></i></a>
</h1>
<p>Seen very abstractly, a mathematical model is a set of <strong><em>functions</em></strong> that represent the relationships between inputs and outputs. <span style="float: right; padding-left: 50px;"><a name="900" href="#900"><img src="www/icons8-signpost.png" title="Location: 900" width="12px"></a><span style="color: red; font-size: 6pt;">900</span></span></p>
<p>At the most simple level, building a model can be a short process:</p>
<ol style="list-style-type: decimal">
<li>Develop an understanding of the relationship you want to model. Often, part of this “understanding” is the pattern seen in data.</li>
<li>Choose a function type—e.g. exponential, sinusoidal, sigmoid—that you think would be a good match to the relationship.</li>
<li>Find <strong><em>parameters</em></strong> that scales your function to be able to accept real-world inputs and generate real-world outputs.</li>
</ol>
<p>It’s important to distinguish between two basic types of model:</p>
<ol style="list-style-type: decimal">
<li>
<strong><em>Empirical models</em></strong> which are rooted in <strong><em>observation</em></strong> and <strong><em>data</em></strong>.</li>
<li>
<strong><em>Mechanistic models</em></strong> such as those created by applying fundamental laws of physics, chemistry, and such.</li>
</ol>
<p>We are going to put off mechanistic models for a while, for two reasons. First, the “fundamental laws of physics, chemistry, and such” are often expressed with the concepts and methods of calculus. We are heading there, but at this point you don’t yet know the core concepts and methods of calculus. Second, most students don’t make a careful study of the “fundamental laws of physics, chemistry, and such” until <em>after</em> they have studied calculus. So examples of mechanistic models will be a bit hollow at this point.</p>
<p>We’ll start then with empirical modeling: finding functions that are a good summary of data. The process of constructing a model that is a good match for data is called <strong><em>curve fitting</em></strong>, or, more generally, <strong><em>fitting a model</em></strong>.</p>
<div id="variations-from-scaling" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Variations from scaling<a class="anchor" aria-label="anchor" href="#variations-from-scaling"><i class="fas fa-link"></i></a>
</h2>
<p>A good place to start building a model is to pick one of the basic modeling functions. This works surprisingly often. To remind you, here are our nine <strong><em>pattern-book</em></strong> functions: <span style="float: right; padding-left: 50px;"><a name="910" href="#910"><img src="www/icons8-signpost.png" title="Location: 910" width="12px"></a><span style="color: red; font-size: 6pt;">910</span></span></p>
<!-- the official list of pattern-book functions and their names -->
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Pattern name</th>
<th>Traditional notation</th>
<th>R notation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>exponential</td>
<td><span class="math inline">\(e^x\)</span></td>
<td><code><a href="https://rdrr.io/r/base/Log.html">exp(x)</a></code></td>
</tr>
<tr class="even">
<td>logarithm (“natural log”)</td>
<td><span class="math inline">\(\ln(x)\)</span></td>
<td><code><a href="https://rdrr.io/r/base/Log.html">log(x)</a></code></td>
</tr>
<tr class="odd">
<td>sinusoid</td>
<td><span class="math inline">\(\sin(x)\)</span></td>
<td><code><a href="https://rdrr.io/r/base/Trig.html">sin(x)</a></code></td>
</tr>
<tr class="even">
<td>square</td>
<td><span class="math inline">\(x^2\)</span></td>
<td><code>x^2</code></td>
</tr>
<tr class="odd">
<td>proportional</td>
<td><span class="math inline">\(x\)</span></td>
<td><code>x</code></td>
</tr>
<tr class="even">
<td>constant</td>
<td><span class="math inline">\(1\)</span></td>
<td><code>1</code></td>
</tr>
<tr class="odd">
<td>reciprocal</td>
<td>
<span class="math inline">\(1/x\)</span> or <span class="math inline">\(x^{-1}\)</span>
</td>
<td><code>1/x</code></td>
</tr>
<tr class="even">
<td>gaussian</td>
<td><span class="math inline">\(\dnorm(x)\)</span></td>
<td><code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(x)</a></code></td>
</tr>
<tr class="odd">
<td>sigmoid</td>
<td><span class="math inline">\(\pnorm(x)\)</span></td>
<td><code><a href="https://rdrr.io/r/stats/Normal.html">pnorm(x)</a></code></td>
</tr>
</tbody>
</table></div>
<p>The basic modeling functions are the same, but replace the plain <span class="math inline">\(x\)</span> in the pattern-book function with a straight-line function, for instance <span class="math inline">\(ax + b\)</span> or, equivalently <span class="math inline">\(a(x - x_0)\)</span>. In use, the parameter <span class="math inline">\(a\)</span> is often written with some other letter and, often, the <span class="math inline">\(b\)</span> or <span class="math inline">\(-x_0\)</span> part is not needed.</p>
<p>Here are some of the common forms of the basic modeling functions you will encounter:</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="45%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Common forms</th>
<th>note</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential</td>
<td>
<span class="math inline">\(e^{k t}\)</span> or <span class="math inline">\(e^{-k t}\)</span> or <span class="math inline">\(e^{-t/ \tau}\)</span>
</td>
<td></td>
</tr>
<tr class="even">
<td>Sinusoid</td>
<td>
<span class="math inline">\(\sin\left(\frac{2 \pi}{P} (t-t_0)\right)\)</span>, <span class="math inline">\(\sin\left(\frac{2 \pi}{P} t\right)\)</span>, or <span class="math inline">\(\sin(\omega t)\)</span>
</td>
<td>
<span class="math inline">\(P\)</span> is “period,” <span class="math inline">\(\omega\)</span> is “angular frequency.”</td>
</tr>
<tr class="odd">
<td>Monomials</td>
<td>
<span class="math inline">\([x-x_0]\)</span> or <span class="math inline">\([x-x_0]^2\)</span>, and so on</td>
<td></td>
</tr>
<tr class="even">
<td>Power-law generally</td>
<td>
<span class="math inline">\(x^p\)</span> or <span class="math inline">\([x-x_0]^p\)</span>
</td>
<td>
<span class="math inline">\(p\)</span> is “power.”</td>
</tr>
<tr class="odd">
<td>Gaussian</td>
<td><span class="math inline">\(\dnorm(x, mean, sd)\)</span></td>
<td>Interpret “mean” as “center.”</td>
</tr>
<tr class="even">
<td>Sigmoid</td>
<td><span class="math inline">\(\dnorm(x, mean, sd)\)</span></td>
<td>
<span class="math inline">\(sd\)</span> is “standard deviation” or “spread.”</td>
</tr>
</tbody>
</table></div>
<p>It helps in making the selection to have ready to mind the basic shape of each of these function families. To review, revisit Section <a href="pattern-book.html#function-shapes">2.4</a>.</p>
<p>Remember also that, in general, we scale the inputs and scale the output. This means that in choosing a model family, we don’t have to worry at first about the numbers on the axes. (Of course, those numbers will be critically important later on in the process!) The scaling does, however, allow us to consider some variations on the shapes of the modeling functions. In particular, the <strong><em>input scaling</em></strong> lets us flip the shape right-for-left. And the <strong><em>output scaling</em></strong> lets us flip the shape top-for-bottom.</p>
<ul>
<li>
<span class="math inline">\(f(t)\)</span>, basic shape</li>
<li>
<span class="math inline">\(f(-t)\)</span>, flipped right-for-left</li>
<li>
<span class="math inline">\(-f(t)\)</span>, flipped top-for-bottom</li>
<li>
<span class="math inline">\(-f(-t)\)</span>, flipped both top-for-bottom and right-for-left</li>
</ul>
<p>For functions such as the sinusoid, flipping is not much use, since the flipped sinusoid curve is still a sinusoid, although with a shifted input. Similarly, a right-for-left flipped gaussian function has the same shape as the original. For the straight-line function, flipping of either sort accomplishes the same thing: changing the sign of the slope.</p>
<p>For the exponential function, the two possible types of flipping—right-for-left and top-for-bottom—produce four different curves, all of which are exponential, shown in Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>.</p>
<div class="figure" style="text-align: center">
<span id="fig:four-variations"></span>
<img src="CalcZ-notes_files/figure-html/four-variations-1.png" alt="Four variations of the exponential function." width="50%"><img src="CalcZ-notes_files/figure-html/four-variations-2.png" alt="Four variations of the exponential function." width="50%"><p class="caption">
Figure 8.1: Four variations of the exponential function.
</p>
</div>
</div>
<div id="fit-periodic" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Curve fitting a periodic function<a class="anchor" aria-label="anchor" href="#fit-periodic"><i class="fas fa-link"></i></a>
</h2>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-1">8.2</a> shows the tide level in <a href="https://www.google.com/maps/place/Providence,+RI/@41.8071,-71.4012,14z/data=!4m5!3m4!1s0x89e444e0437e735d:0x69df7c4d48b3b627!8m2!3d41.8071!4d-71.4012">Providence, Rhode Island</a>, starting at midnight on April 1, 2020 and recorded every minute for four and a half days. (These data were collected by the US National Oceanic and Atmospheric Administration. <a href="https://tidesandcurrents.noaa.gov/api/datagetter?begin_date=20200401%2010:00&amp;end_date=20200405%201:59&amp;station=8454000&amp;product=one_minute_water_level&amp;datum=mllw&amp;units=metric&amp;time_zone=gmt&amp;application=web_services&amp;format=csv">Link</a>) <span style="float: right; padding-left: 50px;"><a name="960" href="#960"><img src="www/icons8-signpost.png" title="Location: 960" width="12px"></a><span style="color: red; font-size: 6pt;">960</span></span></p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-1-1.png" alt="About four days of tide-level data from Providence, Rhode Island" width="90%"><p class="caption">
Figure 8.2: About four days of tide-level data from Providence, Rhode Island
</p>
</div>
<p>It’s not too hard to see what’s going on. The tide rises and falls about every 12 hours. The difference between high tide and low tide is a little more than one meter. The tide gauge is calibrated so that a typical reading is 1 meter, although we don’t know what that is respect to. (Certainly not sea level, since then the typical reading would be around zero.)</p>
<p>This simple description tells almost everything needed to match a basic modeling function to the tide level. Given the clear pattern in the data, we’ll use a sinusoid, that is, a function of the form <span class="math display">\[\text{tide}(t) \equiv A \sin(2\pi t/P) + B\]</span> The procedure is straightforward:</p>
<p><strong>Step 0</strong>: Determine whether a sinusoid model is appropriate. As you know, sinusoids oscillate up and down repeatedly with a steady <strong><em>period</em></strong>. That certainly seems the case here. But sinusoids are also steady in the <strong><em>peak</em></strong> and <strong><em>trough</em></strong> values for each cycle. That’s only approximately true in the Providence data. Models inevitably involve approximation. We’ll have to keep an eye on whether modeling with sinusoids and their <strong><em>fixed amplitude</em></strong> still lets us extract useful information.</p>
<p><strong>Step 1</strong>: Choose a sensible value to represent the low point repeatedly reached. 0.5 m seems appropriate here, but obviously the exact position of the trough of each cycle varies over the 4.5 day duration of the data. Similarly, the peak is near 1.6 m. Parameter <span class="math inline">\(B\)</span> is the mean of the peak and trough values: <span class="math inline">\(\frac{1.6 + 0.5}{2} = 1.05\)</span> m here. Parameter <span class="math inline">\(A\)</span> is half the difference between the peak and trough values: <span class="math inline">\(\frac{1.6 - 0.5}{2} = 0.55\)</span>. Parameter <span class="math inline">\(B\)</span> is called the <strong><em>baseline</em></strong> of the sinusoid. Parameter <span class="math inline">\(A\)</span> is the <strong><em>amplitude</em></strong>. (Note that by convention, the amplitude is always <em>half</em> the high-to-low range of the sinusoid.)</p>
<p><strong>Step 2</strong>: Estimate the period <span class="math inline">\(P\)</span> of the sinusoid. This can be done with the horizontal axis scale: measure the horizontal duration of a complete cycle. I like to use the time between peaks, but the time between troughs would work just as well. Another good choice is the time between positive sloping crossings of the baseline. (But be careful. The time between <em>successive</em> baseline crossings, one positive sloping and the other negative, give just <em>half</em> the period.)</p>
<p>On the scale of the above plot, it’s hard to read off the time of the first peak. So, zoom in until it becomes more obvious.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-1.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%"><img src="CalcZ-notes_files/figure-html/Fun-4-a-3-2-2.png" alt="Zooming in on the start of the data (left) and on the last part of the data (right)." width="50%"><p class="caption">
Figure 8.3: Zooming in on the start of the data (left) and on the last part of the data (right).
</p>
</div>
<p>The left panel in Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-2">8.3</a> shows about 24 hours at the start of the record. The first peak is at about 6 hours, the second at about 19 hours. That indicates that the period is roughly 19 - 6 = 13 hours.</p>
<p><strong>Step 3</strong> Plot out the model over the data. Replacing the symbols <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(P\)</span> with our estimates, the model is</p>
<p><span class="math display">\[{\color{magenta}\text{tide}(t) \equiv 1.05 + 0.55 \sin(2\pi t/13)}\]</span></p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> shows this model in <span class="math inline">\(\color{magenta}\text{magenta}\)</span>.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-3-3"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-3-3-1.png" alt="The sinusoid fails to align with the timing of peaks and troughs." width="90%"><p class="caption">
Figure 8.4: The sinusoid fails to align with the timing of peaks and troughs.
</p>
</div>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> shows the model aligning beautifully with the data at around time 80 hours, but not so well near the very beginning of the record. Looking carefully, you can see the magenta peak gradually move to the left compared to the data as you look at the peaks of the cycles one at a time moving backward from <span class="math inline">\(t=80\)</span> hours. This is diagnostic of our 13-hour estimate for the period being a little too long.</p>
<p>A good way to refine the estimate is to change the model slightly and re-graph the data and model. Keep doing this until you have found the right alignment. In other words, parameter estimation is often an <strong><em>iterative</em></strong> process of estimate-and-refine. This is one of the aspects of the <strong><em>modeling cycle</em></strong>, where a modeler builds a tentative model, looks for systematic deviations from the data, and refines the model.</p>
<div class="intheworld">
<p>Another sort of deviation of the model from the data seen in Figure <a href="process-of-modeling.html#fig:Fun-4-a-3-3">8.4</a> concerns the varying heights of the peaks and troughs in the data, which is not captured by the simple sinusoid pattern. Perhaps you can see that at the beginning of the record, the troughs are also <em>wider</em> than the peaks. Later on, as this extra width disappears, the amplitude of the peaks and troughs increases.</p>
<p>You don’t yet have the calculus tools or experience to know how or whether this phenomenon can be modeled. For now, a hint: Earth has two large orbiting bodies, the Sun and the Moon. These have slightly different periods: 24 hours for the Sun and slightly longer for the Moon.</p>
</div>
<p><strong>Step 4</strong> Our model omitted one of the parameters of the sinusoid basic modeling function: the time shift <span class="math inline">\(t_0\)</span>. A more complete model would be:
<span class="math display">\[\text{tide}_\text{shifted}(t) \equiv A \sin(2\pi (t - t_0)/P) + B\]</span>
Whether including this parameter is important depends on our purpose for the model. If the goal is to find the period of the tides, the time shift hardly matters. But if the goal is to predict a future tide level, the time shift is critical.</p>
<p>Estimating <span class="math inline">\(t_0\)</span> can only be done once the period <span class="math inline">\(P\)</span> is known precisely. In practice, as you’ll see in Chapter <a href="modeling-cycle.html#modeling-cycle">14</a>, we use a numerical method called <strong><em>polishing</em></strong> to estimate both <span class="math inline">\(P\)</span> and <span class="math inline">\(t_0\)</span> at the same time.</p>
</div>
<div id="fit-exponential" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Curve fitting an exponential function<a class="anchor" aria-label="anchor" href="#fit-exponential"><i class="fas fa-link"></i></a>
</h2>
<p>The exponential function is particularly useful when the quantity we want to model shows <strong><em>constant proportional increase</em></strong>. Many quantities in everyday life are this way. For instance, an increase in salary is typically presented in a format like “a 3% increase.” The population growth of a country is often presented as “percent per year.” Inflation in the price of goods is similarly described in percent per year. Interest on money in a bank savings account is also described as percent per year. But if you have the bad fortune to owe money to a loan shark, the proportional increase might be described as “percent per month” or “percent per week.” <span style="float: right; padding-left: 50px;"><a name="920" href="#920"><img src="www/icons8-signpost.png" title="Location: 920" width="12px"></a><span style="color: red; font-size: 6pt;">920</span></span></p>
<p>When you know the “percent increase per time” of a quantity whose initial value is <span class="math inline">\(A\)</span>, the exponential function is easy to write down: <span class="math display">\[f(t) = A (1+r)^t\]</span>
The number <span class="math inline">\(r\)</span> is often called the <strong><em>interest rate</em></strong> or <strong><em>discount rate</em></strong> and is given in <strong>percent</strong>.</p>
<div class="takenote">
<p>Regrettably, it’s extremely easy and common to forget the rules for addition with percent. If <span class="math inline">\(r = 5\%\)</span>, then <span class="math inline">\((1+r) = 1.05\)</span>, not 6. Always keep in mind that <span class="math inline">\(5\%\)</span> means <span class="math inline">\(\frac{5}{100}\)</span>.</p>
<p>Another source of error stems from the tradition in mathematics of using the number <span class="math inline">\(e=2.718282\)</span> as the “natural” base of the exponential function, whereas in <span class="math inline">\(f(t) = A (1+r)^t\)</span> the base is <span class="math inline">\(1+r\)</span>.</p>
<p>You can translate an exponential <span class="math inline">\(b^t\)</span> in any base <span class="math inline">\(b\)</span> to the “natural” base. This is just a matter of calculating the appropriate parameter <span class="math inline">\(k\)</span> such that <span class="math inline">\(e^k = b\)</span>. Using logarithms, <span class="math display">\[e^k = b\ \ \implies \ \  k=\ln(b)\]</span> For instance, if
<span class="math inline">\(r=5\%\)</span> per year, we’ll have <span class="math inline">\(k = \ln(1+r) = \ln(1.05) = 0.488\)</span> per year.</p>
<p>Almost everybody is happier doing arithmetic with numbers like 2 and 10 rather than <span class="math inline">\(e=2.718282\)</span>. For this reason, you may see formulations of the exponential function as <span class="math inline">\(g(t) \equiv 2^{a t}\)</span> or <span class="math inline">\(h(t) \equiv 10^{c t}\)</span>. Remember that <span class="math inline">\(2^{a t}\)</span> and <span class="math inline">\(e^{at}\)</span>, although both exponential functions, are quantitatively different. If you want to write <span class="math inline">\(2^{at}\)</span> using the “natural” base, it will be <span class="math inline">\(e^{\ln(2) a\, t }\)</span>. Similarly, <span class="math inline">\(10^{ct} = e^{\ln(10) c\, t}\)</span>.</p>
</div>
<p>Exponential functions also describe <strong><em>decrease</em></strong> or <strong><em>decay</em></strong>. Just replace <span class="math inline">\(t\)</span> with <span class="math inline">\(-t\)</span>. That is, a movie of a decreasing quantity is just the movie of an increasing quantity played backwards in time! <span style="float: right; padding-left: 50px;"><a name="930" href="#930"><img src="www/icons8-signpost.png" title="Location: 930" width="12px"></a><span style="color: red; font-size: 6pt;">930</span></span></p>
<p>Figure <a href="process-of-modeling.html#fig:Fun-4-intro-1">8.5</a> shows some data collected by Prof. Stan Wagon to support his making a detailed mechanistic model of an everyday phenomenon: <a href="https://www.researchgate.net/profile/Gianluca_Argentini/post/Is_analogy_reasoning_between_heat_transfert_and_electriocity_allows_to_apply_the_electricity_laws_about_resistance_to_thermal_resistances/attachment/59d6573379197b80779ada64/AS%3A533325451403264%401504166104259/download/Stan+WAGON+How+quickly+does+water+cool.pdf">The cooling of a mug of hot beverage to room temperature</a>. The mug started at room temperature, which was measured at 26 degrees C. At time 0 he poured in boiling water from a kettle and measured the temperature of the water over the next few hours.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-intro-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-intro-1-1.png" alt="Stan's data" width="90%"><p class="caption">
Figure 8.5: Stan’s data
</p>
</div>
<p>Our task is to translate this data into the form of a function that takes time as input and returns temperature as output. Such a model would be useful for, say, filling in the gaps of the data. For instance, we might want to find the temperature of the water immediately after being poured from the kettle into the mug.</p>
<p>Looking at the data, one sees that the temperature decreases along a curve: cooling fast at first and then more slowly. This is the pattern of the flipped right-for-left exponential. (Figure <a href="process-of-modeling.html#fig:four-variations">8.1</a>(B)) We can imagine then that an exponential, <span class="math inline">\(A e^{kt} + C\)</span> will be a suitable model form for the cooling water.</p>
<p>What remains is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span>. Here is a general process for curve-fitting an exponential. Later, we’ll apply this process specifically to the water-cooling situation.</p>
<p><strong>General process for curve-fitting an exponential</strong></p>
<p>The goal is to find the parameters <span class="math inline">\(A\)</span>, <span class="math inline">\(k\)</span>, and <span class="math inline">\(C\)</span> in the formula <span class="math inline">\(A e^{kx} + C\)</span>.</p>
<p><strong>Step 0</strong>: Check that the data show an exponential pattern in one of its varieties, namely a smooth increase or decrease and leveling out beyond some value of <span class="math inline">\(x\)</span>. If this isn’t true, reconsider whether you should be using an exponential function in the first place. Using your mind’s eye (or paper, if you like) sketch out an exponential-shaped curve that follows the overall trend of the data. We’ll call this imagined curve <span class="math inline">\(f(x)\)</span>.</p>
<p><strong>Step 1</strong>: Find the <strong><em>baseline</em></strong>. This is the output level at which the function has a horizontal asymptote, that is, at which the function levels off. <span class="math inline">\(C\)</span> is this baseline level.</p>
<p><strong>Step 2</strong>: Find the numerical value of the imagined function <span class="math inline">\(f()\)</span> at input <span class="math inline">\(x = 0\)</span>. We’ll call this value <span class="math inline">\(f(0)\)</span>. Then <span class="math inline">\(A \equiv f(0) - C\)</span>.</p>
<p><strong>Step 3</strong> Estimate parameter <span class="math inline">\(k\)</span> using these steps:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Pick any input value, which we’ll call <span class="math inline">\(x_2\)</span>, such that <span class="math inline">\(f(x_2)\)</span> is far from the baseline.</p></li>
<li><p>Find an input value, which we’ll call <span class="math inline">\(x_1\)</span> such that <span class="math inline">\(f(x_1)\)</span> is halfway<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The motivation for the equation is that the distance between &lt;span class="math inline"&gt;\(f(x_1)\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(C\)&lt;/span&gt; should be half that of the distance between &lt;span class="math inline"&gt;\(f(x_2)\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(C\)&lt;/span&gt;. In other words, &lt;span class="math display"&gt;\[f(x_1) - C = \frac{f(x_2) - C}{2}\]&lt;/span&gt; Simplifying the algebra a little tells you to look for &lt;span class="math inline"&gt;\(x_1\)&lt;/span&gt; such that &lt;span class="math display"&gt;\[f(x_1) = \frac{f(x_2) + C}{2}\]&lt;/span&gt;&lt;/p&gt;'><sup>14</sup></a> between the baseline <span class="math inline">\(C\)</span> and <span class="math inline">\(f(x_2)\)</span>, that is <span class="math display">\[f(x_1) = \frac{f(x_2) + C}{2}\]</span></p></li>
<li><p>Once you have <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, you can immediately find <span class="math inline">\(k\)</span>: <span class="math display">\[k = \frac{\ln(2)}{x_2 - x_1} \approx \frac{0.693}{x_2 - x_1}\]</span></p></li>
<li><p>Using this simple test to double-check your work. If the horizontal asymptote of <span class="math inline">\(f()\)</span> (that is, approach to the baseline) is for <span class="math inline">\(x \rightarrow \infty\)</span>, then <span class="math inline">\(k\)</span> should be <strong>negative</strong>. If the horizontal asymptote is for <span class="math inline">\(x \rightarrow - \infty\)</span>, then <span class="math inline">\(k\)</span> will be positive.</p></li>
</ol>
<p>Notice that the question of “growth or decay” depends only on the sign of the parameter <span class="math inline">\(k\)</span>. You can have an exponentially decaying process that’s increasing. Consider, for instance, the speed of a car as it merges onto a highway from a slow speed on the entrance ramp. The car’s velocity is increasing, but as you approach highway speed the rate of increase gets smaller. That’s exponential <strong>decay</strong>.</p>
<p>The procedure in Step 3 for estimating <span class="math inline">\(k\)</span> stems from a very important property of exponential functions: Exponential functions always double/half at a constant pace. By design, the parameter <span class="math inline">\(k\)</span>
directly determines that pace. Picking an <span class="math inline">\(x_2\)</span> and finding the corresponding <span class="math inline">\(x_1\)</span> gives the length of the input interval, <span class="math inline">\(x_1 - x_2\)</span> over which the distance from the baseline doubles/halves.</p>
<p>What’s remarkable about the doubling/halving time is that, for a genuinely exponential function, it doesn’t matter which point we choose for <span class="math inline">\(x_1\)</span>. In practice working with graphed data, it’s best to choose so that <span class="math inline">\(f(x_1)\)</span> is discernibly far from the baseline.</p>
<p>The <span class="math inline">\(2\)</span> in <span class="math inline">\(\ln(2)\)</span> corresponds to idea of doubling/halving. The logarithm converts <span class="math inline">\(2\)</span> to a scale that will generate 2 when exponentiated.</p>
<p><strong>Step 4</strong> If you can plot the data, do so. Add to that a graphics layer showing the function <span class="math inline">\(A e^{k x} + C\)</span> using the values for <span class="math inline">\(A\)</span>, <span class="math inline">\(C\)</span>, and <span class="math inline">\(k\)</span> that you just found. If you are not satisfied with the way the plotted function approximates the data, tweak the parameters a bit until you are.</p>
<p><strong>Exponential curve fitting applied to the water-cooling data</strong></p>
<p>Let’s illustrate the general process on the water-cooling data, redrawn in Figure <a href="process-of-modeling.html#fig:Fun-4-a-2-1">8.6</a>. <span style="float: right; padding-left: 50px;"><a name="950" href="#950"><img src="www/icons8-signpost.png" title="Location: 950" width="12px"></a><span style="color: red; font-size: 6pt;">950</span></span></p>
<pre><code>## `geom_smooth()` using method = 'loess'</code></pre>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-1-1.png" alt="The cooling-water data, repeated here for convenience. We've sketched in an exponential-like curve that matches the data pretty well." width="90%"><p class="caption">
Figure 8.6: The cooling-water data, repeated here for convenience. We’ve sketched in an exponential-like curve that matches the data pretty well.
</p>
</div>
<p>Step 0: The data indicate a smooth curve. As <span class="math inline">\(t\)</span> gets large, the curve approaches a constant. So an exponential model is reasonable.</p>
<p><strong>Step 1</strong>: The curve looks like it’s leveling out at a temperature of about 25 degrees C for large <span class="math inline">\(t\)</span>. So <span class="math inline">\(C \approx 25^{\circ} \text{C}\)</span>.</p>
<p><strong>Step 2</strong>: Looking at our imagined curve (sketched in blue in Figure <a href="process-of-modeling.html#fig:Fun-4-a-2-1">8.6</a>), it appears to intersect the <span class="math inline">\(t=0\)</span> vertical axis at about <span class="math inline">\(f(0) = 85^\circ\text{C}\)</span>. Thus, <span class="math display">\[A = 85^\circ\text{C} - 25^\circ\text{C} = 60^\circ\text{C}\]</span></p>
<p><strong>Step 3</strong>:</p>
<ol style="list-style-type: lower-alpha">
<li>Now choose a time <span class="math inline">\(t_2\)</span> where <span class="math inline">\(f(t_2)\)</span> is far from the baseline. … It looks like <span class="math inline">\(t_2 = 25\)</span> will do the job, at which point we can read off the graph that the function value is <span class="math inline">\(f(25) \approx 65\)</span>.</li>
<li>Find an input value <span class="math inline">\(t_1\)</span> such that <span class="math inline">\(f(t_1) -C = (f(t_2)-C)/2.\)</span> This tells us that <span class="math inline">\(f(t_1) = 25 + (65-25)/2 = (65+25)/2 = 45\)</span>. Referring to the graph, the time at which the function is about 45 is <span class="math inline">\(t_1 \approx 65\)</span>, that is, <span class="math inline">\(f(t_1) \approx 65\)</span>.</li>
<li>We have <span class="math inline">\(t_1 \approx 65\)</span> and <span class="math inline">\(t_2 = 25\)</span>. From this, we calculate <span class="math inline">\(k\)</span>:
<span class="math display">\[ k = \frac{\ln(2)}{25 - 65} = 0.693/(-40) = -0.0173\]</span>
</li>
<li>The data show exponential decay, so we expect <span class="math inline">\(k\)</span> to be negative. Happily, it is. If it hadn’t been, we would go back to look for a sign error someplace.</li>
</ol>
<p><strong>Step 4</strong>. Graph the function on top of the data to confirm the fitted function is a good match to the data.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-4-a-2-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-4-a-2-2-1.png" alt="An exponential function that roughly aligns with the data." width="90%"><p class="caption">
Figure 8.7: An exponential function that roughly aligns with the data.
</p>
</div>
<p>Step 5: The flat zone of the data is to the right. So we’ve got exponential decay and <span class="math inline">\(k &lt; 0\)</span>.</p>
</div>
<div id="curve-fitting-a-power-law-function" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Curve fitting a power-law function<a class="anchor" aria-label="anchor" href="#curve-fitting-a-power-law-function"><i class="fas fa-link"></i></a>
</h2>
<p>You have been using power-law functions from early in your math and science education. Some examples: <span style="float: right; padding-left: 50px;"><a name="970" href="#970"><img src="www/icons8-signpost.png" title="Location: 970" width="12px"></a><span style="color: red; font-size: 6pt;">970</span></span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Setting</th>
<th>Function formula</th>
<th>exponent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Circumference of a circle</td>
<td><span class="math inline">\(C(r) = 2 \pi r\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>Area of a circle</td>
<td><span class="math inline">\(A(r) = \pi r^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Volume of a sphere</td>
<td><span class="math inline">\(V(r) = \frac{4}{3} \pi r^3\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td>Distance traveled by a falling object</td>
<td><span class="math inline">\(d(t) = \frac{1}{2} g t^2\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Gas pressure versus volume</td>
<td><span class="math inline">\(P(V) = \frac{n R T}{V}\)</span></td>
<td><span class="math inline">\(-1\)</span></td>
</tr>
<tr class="even">
<td>… perhaps less familiar …</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Distance traveled by a diffusing gas</td>
<td><span class="math inline">\(X(t) = D \sqrt{ \strut t}\)</span></td>
<td><span class="math inline">\(1/2\)</span></td>
</tr>
<tr class="even">
<td>Animal lifespan (in the wild) versus body mass</td>
<td><span class="math inline">\(L(M) = a M^{0.25}\)</span></td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>Blood flow versus body mass</td>
<td><span class="math inline">\(F(M) = b M^{0.75}\)</span></td>
<td>0.75</td>
</tr>
</tbody>
</table></div>
<p>One reason why power-law functions are so important in science has to do with the logic of physical quantities such as length, mass, time, area, volume, force, power, and so on. We’ll discuss this at length later in the course and the principles will appear throughout calculus.</p>
<p>As for finding the power law <span class="math inline">\(f(x) \equiv A x^p\)</span> that provides a good match to data, we’ll need some additional tools to be introduced in Chapter <a href="magnitudes.html#magnitudes">15</a>.</p>
</div>
<div id="gaussian-and-sigmoid-functions" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Gaussian and sigmoid functions<a class="anchor" aria-label="anchor" href="#gaussian-and-sigmoid-functions"><i class="fas fa-link"></i></a>
</h2>
<p>Our last two basic modeling functions express an important idea in modeling: <strong><em>localness</em></strong>. To put this in concrete terms, imagine creating a function to depict the elevation above sea level of a long road as a function of distance in miles, <span class="math inline">\(x\)</span>, from the start of the road. If the road were level at 1200 feet elevation, a sensible model would be <span class="math inline">\(\text{elevation}(x) = 1200 \text{ft}\)</span>. If the road were gently sloping, a better model would be <span class="math inline">\(\text{elevation}(x) = 1200 + 0.01 x\)</span>. <span style="float: right; padding-left: 50px;"><a name="980" href="#980"><img src="www/icons8-signpost.png" title="Location: 980" width="12px"></a><span style="color: red; font-size: 6pt;">980</span></span></p>
<p>Now let’s add a bump to the road. A bump is a local feature, often only a few feet wide. Or, perhaps the road is crossing a mountain range. That’s also a local feature, but unlike a bump in the road a mountain range extends for many miles.</p>
<p>The basic modeling function suited to represent bumps in the road, or potholes, or mountain ranges is generically called a “hump function.” In this book, we use a specific hump function called the <strong><em>gaussian</em></strong> function (<code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>).</p>
<p>A gaussian function has two parameters: the location<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;That is, the input value at which the function value is largest.&lt;/p&gt;"><sup>15</sup></a> of the peak, which we’ll call the <strong><em>center</em></strong> parameter, and the sideways extent of the gaussian, which is called the <strong><em>standard deviation</em></strong>. Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> shows a few gaussian functions with different parameters.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-3C-1"></span>
<img src="CalcZ-notes_files/figure-html/Fun-3C-1-1.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%"><img src="CalcZ-notes_files/figure-html/Fun-3C-1-2.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%"><img src="CalcZ-notes_files/figure-html/Fun-3C-1-3.png" alt="Gaussians with various centers and standard deviations (sd)." width="90%"><p class="caption">
Figure 8.8: Gaussians with various centers and standard deviations (sd).
</p>
</div>
<p>It’s easy to read off the <strong><em>center</em></strong> parameter from a graph of a gaussian. It’s the location of the top of the function graph. (We mentioned before that a mathematical word for “the location of the top” is <strong><em>argmax</em></strong>; the value for the input of the function that produces the maximum output.)</p>
<p>The <strong><em>spread</em></strong> parameter is also pretty straightforward, but you first have to become familiar with an unusual feature of the gaussian function. The output of the gaussian <em>far from the center</em> is practically zero. But it is not exactly zero. You can see from the graphs that the gaussian function has long flanks which approach zero output more or less in the manner of an exponential function. This means that we can’t measure the spread of the gaussian function by the distance between the zeros on either side of the peak. Instead, we need a <strong><em>convention</em></strong> that will allow us to be precise in quantifying what is admittedly a vague concept of width.</p>
<p>Technically, the convention is that the spread is the length of the interval from the argmax to the inflection point. This can be hard to judge from a graph, but a reasonable approximation is that the spread is the “half-width at half-height.” Come down half-way from the peak value of the output. Panel (c) of Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> marks that elevation with a thin, tan, horizontal line. Along that line, measure the width of the gaussian, as marked by the thick tan line in Panel (c). The <strong><em>spread</em></strong> parameter is half the width of the gaussian measured in this way. <span style="float: right; padding-left: 50px;"><a name="990" href="#990"><img src="www/icons8-signpost.png" title="Location: 990" width="12px"></a><span style="color: red; font-size: 6pt;">990</span></span></p>
<p>If you have a keen eye, you’ll notice that the tan line in Figure <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> is not exactly half-way down from the peak. It’s down 39.35% from the peak. This corresponds exactly to the technical convention.</p>
<p>Another seeming oddity about the gaussian function is the value of the maximum. It would have seemed natural to define this as 1, so-called “unit height.” The way it actually works is different: the maximum height is set so that the <strong><em>area</em></strong> under the gaussian function is 1.</p>
<p>This business with the area will make more sense when you’ve learned some calculus tools, specifically “differentation” and “integration.” For now though …</p>
<p>Consider another road feature, a local <strong><em>change</em></strong> from one elevation to another as you might accomplish with a ramp. The basic modeling function corresponding to a <strong><em>local change</em></strong> from one level to another is the <strong><em>sigmoid</em></strong> function. Figure <a href="process-of-modeling.html#fig:Fun-3C-2">8.9</a> shows three sigmoid functions.</p>
<div class="figure" style="text-align: center">
<span id="fig:Fun-3C-2"></span>
<img src="CalcZ-notes_files/figure-html/Fun-3C-2-1.png" alt="Sigmoids with various centers and standard deviations" width="90%"><img src="CalcZ-notes_files/figure-html/Fun-3C-2-2.png" alt="Sigmoids with various centers and standard deviations" width="90%"><img src="CalcZ-notes_files/figure-html/Fun-3C-2-3.png" alt="Sigmoids with various centers and standard deviations" width="90%"><p class="caption">
Figure 8.9: Sigmoids with various centers and standard deviations
</p>
</div>
<div class="inline-figure">The name “sigmoid” comes from vague resemblance of the graph to the letter S (which is “sigma” in Greek: <img src="www/variant-sigma.png">).</div>
<p>The parameters of the sigmoid function are the same as for the gaussian function: <strong><em>center</em></strong> and <strong><em>width</em></strong>. The center is easy to estimate from a graph. It’s the value of the input that produces an output of 0.5, half-way between the max and min of the sigmoid. As with the gaussian function, the <strong><em>width</em></strong> is measured according to a convention. The width is the <strong><em>change in input</em></strong> needed to go from an output of 0.5 to an output of 0.8413. This use of 0.8413 must seem loony at first exposure, but there is a reason. We’ll need more calculus tools before it can make sense.</p>
<p>Gaussian functions and sigmoid functions with the same center and width parameters have a very close relationship. The <strong><em>instantaneous rate of change</em></strong> of the sigmoid function is the corresponding <strong><em>gaussian</em></strong> function. Figures <a href="process-of-modeling.html#fig:Fun-3C-1">8.8</a> and <a href="process-of-modeling.html#fig:Fun-3C-2">8.9</a> show corresponding gaussian and sigmoid functions. To the very far left, the sigmoid function is effectively flat: a slope near zero. Moving toward the center the sigmoid has a gentle slope: a low number. In the center, the sigmoid is steepest: a higher number. Then the slope of the sigmoid becomes gentle again before gradually falling off to zero. Near zero, then low, then higher, then low again, then falling off to zero: that’s also the description of a gaussian function!</p>
<p>In R, the name of the sigmoid function is <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. The gaussian is <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>. The parameters that specify center and spread are named <code>mean</code> and <code>sd</code>. The word “mean” accurately conveys the idea of “center.” It would be nice to be able to say that <code>sd</code> comes from <code>s</code>prea<code>d</code>, but in fact <code>sd</code> is short for <strong><em>standard deviation</em></strong>, a term familiar to students of statistics. <span style="float: right; padding-left: 50px;"><a name="1000" href="#1000"><img src="www/icons8-signpost.png" title="Location: 1000" width="12px"></a><span style="color: red; font-size: 6pt;">1000</span></span></p>
<div class="intheworld">
<p>Figure <a href="process-of-modeling.html#fig:ebola-data">8.10</a> shows the cumulative number of Ebola cases during an outbreak in Sierra Leone from May 1, 2014 to December 16, 2015.</p>
<div class="figure" style="text-align: center">
<span id="fig:ebola-data"></span>
<img src="CalcZ-notes_files/figure-html/ebola-data-1.png" alt="Cumulative Ebola cases in Sierra Leone" width="90%"><p class="caption">
Figure 8.10: Cumulative Ebola cases in Sierra Leone
</p>
</div>
<p>Although the cumulative case data are roughly sigmoidal in shape, there are systematic differences in shape from a true sigmoid. For comparison, Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a> is a graph of genuinely sigmoidal data.</p>
<div class="figure" style="text-align: center">
<span id="fig:true-sigmoid"></span>
<img src="CalcZ-notes_files/figure-html/true-sigmoid-1.png" alt="A simulated sigmoidal growth process." width="90%"><p class="caption">
Figure 8.11: A simulated sigmoidal growth process.
</p>
</div>
<p>The Ebola data have only a rough similarity to the sigmoid shape. Still, fitting a model and then examining closely the deviations of the model from the data can prompt questions that can lead to a better understanding of the data and what’s needed in an appropriate model.</p>
</div>
<p>Here’s a methodology for estimating the parameters <code>mean</code> and <code>sd</code> of a sigmoid graphically.</p>
<ol style="list-style-type: decimal">
<li><p>Sketch in a S-shaped curve that smoothly follows the data. In Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a> this has already been done for you. For the Ebola data, you will have to use your judgment.</p></li>
<li><p>Find the top plateau of the S-curve. This is indicated by the tan line in Figure <a href="process-of-modeling.html#fig:true-sigmoid">8.11</a>. The parameter <code>A</code> is simply the height of the plateau, in this case <span class="math inline">\(y \approx 15\)</span>.</p></li>
<li><p>Come down half way from the plateau. Here, that’s 15/2 or 7.5, indicated by the horizontal blue line segment. Find the inverse of the S-curve from that half-way point onto the horizontal-axis. Here, that gives <span class="math inline">\(t \approx 5\)</span>. The parameter <code>center</code> is that value.</p></li>
<li><p>From the center of the S-shaped curve, follow the curve upward about 2/3 of the way to the plateau. In the diagram, that point is marked with a green line at <span class="math inline">\(t \approx 7\)</span>. The <code>width</code> is the distance along the horizontal axis from the blue centerline to the green line. Here, that’s <span class="math inline">\(7 - 5\)</span> giving 2 as the <code>width</code>.</p></li>
<li><p>You might also want to trace the S-curve <em>downward</em> from the centerline about 2/3 of the way to zero. That’s indicated by the left green line. In the standard sigmoid, the two green lines will be equally spaced around the centerline. Of course the data may not be in the shape of the standard sigmoid, so you might find the two green lines are not equally spaced from the center.</p></li>
</ol>
</div>
<div id="exercises-7" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises-7"><i class="fas fa-link"></i></a>
</h2>
<details><summary><strong>Exercise 8.1</strong>: <span><a name="File:%20Exercises/Fun/kid-type-boat.Rmd" href="#0rvpbu"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/kid-type-boat.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">0rvpbu</span>
</span></summary><p>These three expressions</p>
<p><span class="math display">\[e^{kt}\ \ \ \ \ 10^{t/d} \  \ \ \ \  2^{t/h}\]</span></p>
<p>produce the same value if <span class="math inline">\(k\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(h\)</span> have corresponding numerical values.</p>
<div class="scaffolding">
<p>The scaffolding has an expression for plotting out <span class="math inline">\(2^{t/h}\)</span> for <span class="math inline">\(-4 \leq t \leq 12\)</span> where <span class="math inline">\(h = 4\)</span>. It also plots out <span class="math inline">\(e^{kt}\)</span> and <span class="math inline">\(10^{t/d}\)</span></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">k</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>  <span class="op">~</span> <span class="va">t</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="va">t</span><span class="op">/</span><span class="va">h</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span>, h <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">fb</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="va">t</span><span class="op">/</span><span class="va">d</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span>, d <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>

<span class="fu">slice_plot</span><span class="op">(</span><span class="fu">fa</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span>, <span class="fu">domain</span><span class="op">(</span>t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fu">fb</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span>, color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">slice_plot</span><span class="op">(</span><span class="fu">fc</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span>, color  <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">gf_lims</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<p>Your task is to modify the values of <code>d</code> and <code>k</code> such that all three curves lie on top of one another. (Leave <code>h</code> at the value 4.) You can find the appropriate values of <code>d</code> and <code>k</code> to accomplish this by any means you like, say, by using the algebra of exponents or by using trial and error. (Trial and error is a perfectly valid strategy regardless of what your high-school math teachers might have said about “guess and check.” The trick is to make each new guess systematically based on your previous ones and observation of how those previous ones performed.)</p>
<p>After you have found values of <code>k</code> and <code>d</code> that are suited to the task …</p>
<pre>What is the numerical value of your best estimate of `k`? 



( )  0.143
(x)  0.173
( )  0.283
( )  0.320

[[Excellent!]]

</pre>
<pre>What is the numerical value of your best estimate of `d`? 



( )  11.2
( )  11.9
(x)  13.3
( )  15.8

[[Right!]]

</pre>
</details><details><summary><strong>Exercise 8.3</strong>: <span><a name="File:%20Exercises/Fun/flipping-1.Rmd" href="#YLWP1"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/flipping-1.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YLWP1</span>
</span></summary><div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>One of the curves in plot (A) is a pattern-book function. Which one? 



(x)  black
( )  blue
( )  green
( )  tan
( )  none of them

[[It's the exponential function.]]

</pre>
<pre>Taking $$f()$$ to be the pattern-book function in plot (A), which one of the curves is $$f(-x)$$? 



( )  black
( )  blue
( )  green
(x)  tan
( )  none of them

[[Right!]]

</pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>One of the curves in plot (B) is a pattern-book function. Which one? 



( )  black
( )  blue
( )  green
(x)  tan
( )  none of them

[[Right!]]

</pre>
<pre>Taking $$f()$$ to be the pattern-book function in plot (B), which one of the curves is $$-f(x)$$? 



( )  black
(x)  blue
( )  green
( )  tan
( )  none of them

[[Correct.]]

</pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-3-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The blue curve in plot (C), as you know, is the sinusoid pattern-book function.</p>
<pre>Which of these functions is the green curve? 



( )  $$\sin(-x)$$
( )  $$-\sin(x)$$
( )  $$-\sin(-x)$$
( )  Both $$\sin(-x)$$ and $$-\sin(-x)$$
(x)  Both $$\sin(-x)$$ and $$-\sin(x)$$

[[The sine function has so-called "odd" symmetry around $$x=0$$.]]

</pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-1-4-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>One of the curves in plot (D) is a pattern-book function. Which one? 



( )  black
( )  dodgerblue
(x)  green
( )  tan
( )  none of them

[[Nice!]]

</pre>
<pre>Taking $$f()$$ to be the pattern-book function in plot (D), which one of the curves is $$-f(-x)$$? 



(x)  black
( )  dodgerblue
( )  green
( )  tan
( )  none of them

[[Nice!]]

</pre>
</details><details><summary><strong>Exercise 8.5</strong>: <span><a name="File:%20Exercises/Fun/lamb-talk-gloves.Rmd" href="#YELXG"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/lamb-talk-gloves.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YELXG</span>
</span></summary><p>A person breathes in and out roughly every three seconds. The volume <span class="math inline">\(V\)</span> of air in the person’s lungs varies between a minimum of <span class="math inline">\(2\)</span> liters and a maximum of <span class="math inline">\(4\)</span> liters. Assume time <span class="math inline">\(t\)</span> is measured in seconds.</p>
<p>Remember that a full cycle of the sine wave <span class="math inline">\(\sin(x)\)</span> involves <span class="math inline">\(x\)</span> going from its starting value to that value <strong>plus</strong> <span class="math inline">\(2 \pi\)</span>.</p>
<pre>Which of the following is the most appropriate of these models for $$V(t)$$? 



( )  $$V(t) \equiv 2 \sin \left( \frac{\pi}{3} t \right) + 2$$
(x)  $$V(t) \equiv \sin \left( \frac{2\pi}{3} t \right) + 3$$
( )  $$V(t) \equiv 2 \sin \left( \frac{2\pi}{3} t \right)+ 2$$
( )  $$V(t) \equiv  \sin \left( \frac{\pi}{3} t \right) + 3$$

[[Good. In this class, we generally write the sine function like  $$\sin(2 \pi t/P)$$ which means that the overall argument to  the sine function will go from 0 to $$2 \pi$$ when $$t$$ goes from 0 to $$P$$.]]

</pre>
<p>A respiratory cycle can be divided into two parts: inspiration and expiration. Please do an experiment. Using a clock or watch, breath with a total period of 3 seconds/breath, that is, complete one breath every three seconds. Once you have practiced this and can do it without forcing either phase of breathing, make a rough estimate of what fraction of the cycle is inspiration and what fraction is expiration. (The “correct/incorrect” answers here are right for most people. Your natural respiration might be different.)</p>
<pre>Which is true? 



(x)  Inspiration lasts longer than expiration
( )  Expiration lasts longer than inspiration
( )  Inspiration and expiration each consume about  the same fraction of the complete  cycle.

[[Excellent!]]

</pre>
</details><details><summary><strong>Exercise 8.7</strong>: <span><a name="File:%20Exercises/Fun/spirometer.Rmd" href="#VBWD"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/spirometer.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">VBWD</span>
</span></summary><p>The graph below shows a recording from a “spirometer,” an instrument for recording respiration. Like many old instruments, the trace from this spirometer is made by a pen at the end of a swinging arm with paper moving steadily beneath it. The arm is not exactly aligned with the horizontal axis. Nonetheless, you should be able to estimate an appropriate amplitude and period for the trace. (dm<span class="math inline">\(^3\)</span> is cubic-decimeters: a tenth of a meter cubed. This is the same as a liter.)</p>
<div class="inline-figure"><img src="Exercises/Fun/www/spirometer.jpg" width="75%" style="display: block; margin: auto;"></div>
<pre>What are appropriate  estimates for the period and amplitude of the respiration trace? 



( )  About $$\pm 1$$ liter and 3 seconds.
(x)  About $$\pm 1$$ liter and 5 seconds.
( )  About $$\pm 1$$ liter and 7.5 seconds.

[[Right!]]

</pre>
</details><details><summary><strong>Exercise 8.9</strong>: <span><a name="File:%20Exercises/Fun/chicken-choose-vase.Rmd" href="#vkwl4"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/chicken-choose-vase.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">vkwl4</span>
</span></summary><p>The Bargain Basement store wants to sell its goods quickly. Consequently, they reduce each product’s price <span class="math inline">\(P\)</span> by 5% per day.</p>
<pre>If a jacket costs $$80 today, how much will it cost in $$t$$ days? 



( )  $$P = 80 - 5t$$
( )  $$P = 80 - 4t$$
( )  $$P = 80 - 0.05t$$
( )  $$P = 80 (0.05)^t$$
(x)  $$P = 80 (0.95)^t$$

[[Excellent!]]

</pre>
<p>You’ll need to open a sandbox for the next question.</p>
<div class="scaffolding">
<p>You’re on your own here! Remember, to raise a number to a power, you can use an expression like <code>0.95^7</code>.</p>
</div>
<pre>You decided that you like the $$80 jacket, but you have a budget of only $$60. How long should you wait before coming back to the Bargain Basement store.? 



( )  3 days
( )  4 days
( )  5 days
(x)  6 days

[[Nice!]]

</pre>
</details><details><summary><strong>Exercise 8.11</strong>: <span><a name="File:%20Exercises/Fun/cow-type-kayak.Rmd" href="#asevss"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/cow-type-kayak.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">asevss</span>
</span></summary><p>The Wikipedia entry on “Common Misconceptions” used to contain this item:</p>
<blockquote>
<p><em>Some cooks believe that food items cooked with wine or liquor will be non-alcoholic, because alcohol’s low boiling point causes it to evaporate quickly when heated. However, a study found that some of the alcohol remains: 25% after 1 hour of baking or simmering, and 10% after 2 hours.</em></p>
</blockquote>
<p>The modeler’s go-to function type for events like the evaporation of alcohol is exponential: The amount of alcohol that evaporates would, under constant conditions (e.g. an oven’s heat), be proportional to the amount of alcohol that hasn’t yet evaporated.</p>
<pre>A) Assume that 25% of the alcohol remains after 1 hour? If the process were exponential, how much would remain after 2 hours? 



( )  10%
( )  25%
(x)  25% of 25%
( )  75%
( )  75% of 75%

[[We know that 75% is eliminated over 1 hour, leaving 25%. The continuing exponential process will, over the next hour eliminate 75% of the amount at the start of that hour. So after hour 2 we'll have 25% of the amount we had at hour 1, which was 25% of the original amount.]]

</pre>
<pre>B) What is the half-life of an exponential process that decays to 25% after one hour? 



( )  15 minutes
(x)  30 minutes
( )  45 minutes
( )  none of the above

[[This gives time for two halvings in one hour, bringing us to 25% as observed.]]

</pre>
<p>Let’s change pace and think about the “10% after 2 hours” observation. First, recall that the amount left after <span class="math inline">\(n\)</span> halvings is
<span class="math inline">\(\text{amount.left}(n) \equiv \frac{1}{2}^n\)</span>
This is an exponential function with base 1/2.</p>
<p>You’re going to carry out a <strong><em>guess-and-check</em></strong> procedure to find <span class="math inline">\(n\)</span> that gives <span class="math inline">\(\text{amount.left}(n) = 0.10\)</span>.</p>
<p>Open a sandbox and copy over the scaffolding, which includes the definition of the <code>amount.left()</code> function. We started with a guess of <span class="math inline">\(n=0\)</span>, which is wrong. Change the guess until you get the output 10%.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">amount.left</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="va">n</span> <span class="op">~</span> <span class="va">n</span><span class="op">)</span>
<span class="fu">amount.left</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
</div>
<pre>C) Use `amount.left()` as defined in the scaffolding to guess-and-check how many halvings it takes to bring something down to 10% of the original amount. 



( )  2.58
(x)  3.32
( )  3.62
( )  3.94
( )  4.12

[[Nice!]]

</pre>
<p>Another way to find the input <span class="math inline">\(n\)</span> that generates an output of 10% is to construct the <strong><em>inverse function</em></strong> to <span class="math inline">\(\text{amount.left}()\)</span>.</p>
<p>The computer already provides you with inverse functions for <span class="math inline">\(2^n\)</span> and <span class="math inline">\(e^n\)</span> and <span class="math inline">\(10^n\)</span>. Their names are <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, and <code><a href="https://rdrr.io/r/base/Log.html">log10()</a></code> repectively. Using <code><a href="https://rdrr.io/r/base/Log.html">log2()</a></code>, write a function named <code>log_half()</code> that gives the inverse function to <span class="math inline">\((1/2)^n\)</span>. Remember, the input to the inverse function corresponds to 10%; the output to the <span class="math inline">\(n\)</span>.</p>
<div class="scaffolding">
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="process-of-modeling.html#cb48-1" aria-hidden="true" tabindex="-1"></a>log_half <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="sc">-</span> <span class="fu">log2</span>(...your stuff here ...) <span class="sc">~</span> x)</span></code></pre></div>
</div>
<pre>D) The answer you got in part C) is the **number** of halvings needed to reach 10%. If this number occurs in 2 hours (that is, 120 minutes),  what is the half life stated in minutes. 



( )  30
( )  35
(x)  36
( )  38
( )  42
( )  47

[[Right!]]

</pre>
<p>Suppose you compromise between the half-life needed to reach 25% after one hour and the half-life needed to reach 10% after two hours. Use, say, 33 minutes as the compromise half life. Using the sandbox, calculate how much would be left after 1 hour for this compromise half life, and how much left after 2 hours.</p>
<pre>E) How much is left after 1 hour and after 2 hours when the half life is 33 minutes? 



(x)  28% and  8%
( )  31% and 4%
( )  30% and 9%
( )  27% and 9%

[[Right!]]

</pre>
</details><details><summary><strong>Exercise 8.13</strong>: <span><a name="File:%20Exercises/Fun/hump-intro.Rmd" href="#IELWV"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/hump-intro.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">IELWV</span>
</span></summary><p>The gaussian function is implemented in R with <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(x, mean, sd)</a></code>. The input called <code>mean</code> corresponds to the <em>center</em> of the hump. The input called <code>sd</code> gives the <em>width</em> of the hump.</p>
<div class="scaffolding">
<p>In a sandbox, make a slice plot of <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm(x, mean=0, sd=1)</a></code>. By varying the value of <code>width</code>, figure out how you could read that value directly from the graph.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">slice_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>,
           <span class="fu">domain</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<p>In the plot below, one of the double-headed arrows represents the <code>width</code> parameter. The others are misleading.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-174-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>Which arrow shows correctly the `width` parameter of the gaussian function in the graph with arrows? 



(x)  top
( )  middle
( )  bottom
( )  none of them

[[Good.]]

</pre>
<pre>What is the value of `center` in the graph with arrows? 



( )  -2
( )  -1
( )  -0.5
( )  0
(x)  0.5
( )  1
( )  2

[[Excellent!]]

</pre>
</details><details><summary><strong>Exercise 8.15</strong>: <span><a name="File:%20Exercises/Fun/sigmoid-intro.Rmd" href="#CKSLE"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/sigmoid-intro.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">CKSLE</span>
</span></summary><p>Gaussian functions and sigmoidal functions come in pairs. For every possible sigmoid, there is a corresponding gaussian that gives, for each value of the input, the slope of the sigmoid.</p>
<p>Each of the following graphs shows a sigmoid and a gaussian function. The two might or might not correspond to one another. That is, the output of the gaussian might be the slope of the sigmoid, or the gaussian might correspond to some other sigmoid. Remember, you’re comparing the <em>output</em> of the gaussian to the <em>slope</em> of the sigmoid.</p>
<p>For each graph, say whether the gaussian and the sigmoid correspond to one another. If not, choose one of the reasons why not.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-176-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>Graph (A) 



(x)  The gaussian and sigmoid correspond.
( )  The peak of the gaussian does not occur at the same value of $$x$$ at which the sigmoid is steepest.
( )  The numerical value of the output of the gaussian function is, for all $$x$$, much larger than the numerical value  of the *slope*  of the sigmoid.

[[Good.]]

</pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-177-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>Graph (B) 



( )  The gaussian and sigmoid correspond.
(x)  The peak of the gaussian does not occur at the same value of $$x$$ at which the sigmoid is steepest.
( )  The numerical value of the output of the gaussian function is much larger than the numerical value  of the *slope*  of the sigmoid.

[[The gaussian peaks at about $$x=2$$ while the steepest part of the sigmoid is at about $$x=4$$]]

</pre>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-178-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>Graph (C) 



(x)  The gaussian and sigmoid correspond.
( )  The peak of the gaussian does not occur at the same value of $$x$$ at which the sigmoid is steepest.
( )  The numerical value of the output of the gaussian function is, for all $$x$$, much larger than the numerical value  of the *slope*  of the sigmoid.

[[Correct.]]

</pre>
<p>In the graph <em>D</em>, there are several gaussian functions shown, only one of which corresponds to the sigmoid.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-179-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>Which gaussian corresponds to  the sigmoid? 



( )  A
(x)  B
( )  C
( )  D

[[Right! The gaussian is centered on the steepest part of the sigmoid and falls to zero where the sigmoid levels out.]]

</pre>
</details><details><summary><strong>Exercise 8.17</strong>: <span><a name="File:%20Exercises/Fun/sigmoid-bath.Rmd" href="#bllKR"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/sigmoid-bath.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">bllKR</span>
</span></summary><p>Have in mind a gaussian function and a sigmoid function that form a corresponding pair.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/unnamed-chunk-181-1.png" width="50%" style="display: block; margin: auto;"></div>
<pre>Which of these stories is consistent with the relationship between a gaussian and its corresponding sigmoid? 



( )  The gaussian is the amount of water in a bathtub while the sigmoid is the time you spend in the bath.
( )  The gaussian is the amount of water in the bathtub while the sigmoid is the rate at which water flows from the tap.
(x)  The gaussian is the rate at which water flows from the tap and the sigmoid is the amount of water in the bathtub.
( )  The gaussian indicates the amount the drain is open and the sigmoid is the amount of water in the bathtub.

[[Correct.]]

</pre>
</details><details><summary><strong>Exercise 8.19</strong>: <span><a name="File:%20Exercises/Fun/flipping-2.Rmd" href="#YLWP2"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/flipping-2.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">YLWP2</span>
</span></summary><p>Each of the curves in the graph is an exponential function <span class="math inline">\(e^{kt}\)</span>, for various values of <span class="math inline">\(k\)</span>.</p>
<div class="inline-figure"><img src="CalcZ-notes_files/figure-html/flipping-2-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre>What is the order from $$k$$ smallest (most negative) to k largest? 



(x)  black, orange, red, green, blue
( )  black, orange, blue, green, red
( )  red, green, blue, orange, black

[[Exponential functions that grow slowly have $$k$$ with a small absolute value]]

</pre>
</details><details><summary><strong>Exercise 8.21</strong>: <span><a name="File:%20Exercises/Fun/ebola-sigmoid.Rmd" href="#EKCIE"><img src="www/icons8-signpost.png" title="Location: Exercises/Fun/ebola-sigmoid.Rmd" width="12px"></a><span style="color: red; font-size: 9pt;">EKCIE</span>
</span></summary><hr>
<p><em>Put aside for the moment that the Ebola data plotted in Figure <a href="process-of-modeling.html#fig:ebola-data">8.10</a> doesn’t look exactly like the standard sigmoid function. Follow the fitting procedure as best you can.</em></p>
<pre>Where is the top plateau? 



( )  About Day 600.
(x)  About 14,000 cases
( )  About 20,000 cases
( )  None of the above

[[Good.]]

</pre>
<pre>Where is the centerline? 



(x)  Near Day 200
( )  Near Day 300
( )  At about 7000 cases

[[Correct.]]

</pre>
<pre>Now to find the `width` parameter. The curve looks more classically sigmoidal to the left of the centerline than to the right, so follow the curve *downward* as in Step 4 of the algorithm to find the parameters. What's a good estimate for `width`? 



(x)  About 50 days
( )  About 100 days
( )  About 10 days
( )  About 2500 cases

[[Correct.]]

</pre>
</details>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></div>
<div class="next"><a href="fun-slopes.html"><span class="header-section-number">9</span> Slope function</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#process-of-modeling"><span class="header-section-number">8</span> Finding parameters for the basic modeling functions</a></li>
<li><a class="nav-link" href="#variations-from-scaling"><span class="header-section-number">8.1</span> Variations from scaling</a></li>
<li><a class="nav-link" href="#fit-periodic"><span class="header-section-number">8.2</span> Curve fitting a periodic function</a></li>
<li><a class="nav-link" href="#fit-exponential"><span class="header-section-number">8.3</span> Curve fitting an exponential function</a></li>
<li><a class="nav-link" href="#curve-fitting-a-power-law-function"><span class="header-section-number">8.4</span> Curve fitting a power-law function</a></li>
<li><a class="nav-link" href="#gaussian-and-sigmoid-functions"><span class="header-section-number">8.5</span> Gaussian and sigmoid functions</a></li>
<li><a class="nav-link" href="#exercises-7"><span class="header-section-number">8.6</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="Not%20available/blob/master/Fun-modeling.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="Not%20available/edit/master/Fun-modeling.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MOSAIC Calculus</strong>" was written by Daniel Kaplan. It was last built on 2021-09-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
