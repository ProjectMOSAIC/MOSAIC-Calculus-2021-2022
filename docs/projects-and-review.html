<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Projects and review | MOSAIC Calculus</title>
<meta name="author" content="Daniel Kaplan">
<meta name="description" content="16.8 Ebola in Guinea, part I In December 2013, an 18-month-old boy from a village in Guinea suffered fatal diarrhea. Over the next months a broader outbreak was discovered, and in mid-March 2014,...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Projects and review | MOSAIC Calculus">
<meta property="og:type" content="book">
<meta property="og:description" content="16.8 Ebola in Guinea, part I In December 2013, an 18-month-old boy from a village in Guinea suffered fatal diarrhea. Over the next months a broader outbreak was discovered, and in mid-March 2014,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Projects and review | MOSAIC Calculus">
<meta name="twitter:description" content="16.8 Ebola in Guinea, part I In December 2013, an 18-month-old boy from a village in Guinea suffered fatal diarrhea. Over the next months a broader outbreak was discovered, and in mid-March 2014,...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.0/transition.js"></script><script src="libs/bs3compat-0.3.0/tabs.js"></script><script src="libs/bs3compat-0.3.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.9.4.1/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.18/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');

      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script>
</head>
<body>
<span class="math inline">
    \(\newcommand{\line}{\text{line}}
    \newcommand{\hump}{\text{hump}}
    \newcommand{\sigmoid}{\text{sigmoid}}
    \newcommand{\recip}{\text{recip}}
    \newcommand{\diff}[1]{{\cal D}_#1}
    \newcommand{\pnorm}{\text{pnorm}}
    \newcommand{\dnorm}{\text{dnorm}}
    \newcommand{\CC}[1]{\color{#648fff}{#1}}
    \newcommand{\CE}[1]{\color{#785ef0}{#1}}
    \newcommand{\CA}[1]{\color{#dc267f}{#1}}
    \newcommand{\CB}[1]{\color{#fe6100}{#1}}
    \newcommand{\CD}[1]{\color{#ffb000}{#1}}\)
    </span>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="CalcZ-style.css">
<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MOSAIC Calculus</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to calculus</a></li>
<li class="book-part">Block 1: Functions and quantity</li>
<li><a class="" href="change.html"><span class="header-section-number">1</span> Change</a></li>
<li><a class="" href="pattern-book.html"><span class="header-section-number">2</span> Functions for modeling</a></li>
<li><a class="" href="structure-of-a-function.html"><span class="header-section-number">3</span> Structure of a function</a></li>
<li><a class="" href="fun-describing.html"><span class="header-section-number">4</span> Describing functions</a></li>
<li><a class="" href="fun-notation.html"><span class="header-section-number">5</span> Notation for functions</a></li>
<li><a class="" href="graphs-and-graphics.html"><span class="header-section-number">6</span> Graphics &amp; function graphs</a></li>
<li><a class="" href="params-intro.html"><span class="header-section-number">7</span> Parameters for functions</a></li>
<li><a class="" href="process-of-modeling.html"><span class="header-section-number">8</span> Finding parameters for the basic modeling functions</a></li>
<li><a class="" href="fun-slopes.html"><span class="header-section-number">9</span> Slope function</a></li>
<li><a class="" href="function-inverses-and-solving.html"><span class="header-section-number">10</span> Function inverses and “solving”</a></li>
<li><a class="" href="fun-assembling.html"><span class="header-section-number">11</span> Assembling functions</a></li>
<li><a class="" href="fun-multiple-inputs.html"><span class="header-section-number">12</span> Functions with multiple inputs</a></li>
<li><a class="" href="fun-piecewise.html"><span class="header-section-number">13</span> Piecewise functions</a></li>
<li><a class="" href="modeling-cycle.html"><span class="header-section-number">14</span> Modeling cycle</a></li>
<li><a class="" href="magnitudes.html"><span class="header-section-number">15</span> Magnitudes</a></li>
<li><a class="" href="dimensions.html"><span class="header-section-number">16</span> Dimensions</a></li>
<li><a class="active" href="projects-and-review.html">Projects and review</a></li>
<li class="book-part">Block 2: Differentiation</li>
<li><a class="" href="prolog-differentiation-and-birth.html">Prolog: Differentiation and birth</a></li>
<li><a class="" href="change-relationships.html"><span class="header-section-number">17</span> Change relationships</a></li>
<li><a class="" href="evanescent-h.html"><span class="header-section-number">18</span> Evanescent h</a></li>
<li><a class="" href="computing-derivs.html"><span class="header-section-number">19</span> Computing derivatives</a></li>
<li><a class="" href="concavity-curvature.html"><span class="header-section-number">20</span> Concavity and curvature</a></li>
<li><a class="" href="cont-and-smooth.html"><span class="header-section-number">21</span> Continuity and smoothness</a></li>
<li><a class="" href="prod-comp-rules.html"><span class="header-section-number">22</span> Derivatives of assembled functions</a></li>
<li><a class="" href="optim-and-shape.html"><span class="header-section-number">23</span> Optimization</a></li>
<li><a class="" href="partial-change.html"><span class="header-section-number">24</span> Partial change</a></li>
<li><a class="" href="local-approximations.html"><span class="header-section-number">25</span> Local approximations</a></li>
<li><a class="" href="polynomials.html"><span class="header-section-number">26</span> Polynomials</a></li>
<li class="book-part">Block 3: Accumulation</li>
<li><a class="" href="change-accumulation.html"><span class="header-section-number">27</span> Change and accumulation</a></li>
<li><a class="" href="totaling-bits.html"><span class="header-section-number">28</span> Totaling the little bits</a></li>
<li><a class="" href="net-change.html"><span class="header-section-number">29</span> Integration</a></li>
<li><a class="" href="integrals-step-by-step.html"><span class="header-section-number">30</span> Integrals step-by-step</a></li>
<li><a class="" href="accum-symbolic.html"><span class="header-section-number">31</span> Symbolic anti-differentiation</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="Not%20available">View book source <i class="fab fa-gitlab"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="projects-and-review" class="section level1 unnumbered">
<h1>Projects and review<a class="anchor" aria-label="anchor" href="#projects-and-review"><i class="fas fa-link"></i></a>
</h1>
<div id="ebola-in-guinea-part-i" class="section level2" number="16.8">
<h2>
<span class="header-section-number">16.8</span> Ebola in Guinea, part I<a class="anchor" aria-label="anchor" href="#ebola-in-guinea-part-i"><i class="fas fa-link"></i></a>
</h2>
<p>In December 2013, an 18-month-old boy from a village in Guinea suffered fatal diarrhea. Over the next months a broader outbreak was discovered, and in mid-March 2014, the Pasteur Institute in France confirmed the illness as Ebola-Virus Disease caused by the Zaire ebolavirus.</p>
<p>Although the outbreak was first recognized in Guinea, it eventually encompassed Liberia and Sierra Leone as well. By July 2014, the outbreak spread to the capitals of all three countries. We are going to examine the time course of the epidemic using reports that were issued by the World Health Organization along with some concepts and techniques we have been studying in the first block of Math 141Z. Data are provided by the US Centers for Disease Control (CDC).</p>
<div id="data" class="section level3" number="16.8.1">
<h3>
<span class="header-section-number">16.8.1</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h3>
<p>The CDC data are provided to you as a dataframe named <code>EbolaAll</code>. The dataframe consists of 182 reports spread out over 18 months during 2014 and 2015. Each report is represented by a single row in the dataframe . Each report gives the number of new cases and disease-related deaths since the last report in each or three countries: Sierra Leon, Liberia, and Guinea. These values have been calculated from the raw, cumulative data. The data have been scrubbed to remove obvious errors.</p>
</div>
<div id="exploring-the-data" class="section level3" number="16.8.2">
<h3>
<span class="header-section-number">16.8.2</span> Exploring the Data<a class="anchor" aria-label="anchor" href="#exploring-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>We will begin by looking at some data. Use <code><a href="https://rdrr.io/r/utils/head.html">head(EbolaAll)</a></code> to see the column headers and first 6 rows of data. As you can see, the <code>EbolaAl</code> dataframe is structured like a table, and each row contains multiple columns of data. The table below lists the column names found in <code>EbolaAll</code> dataframe along with a brief description of what the column records.</p>
<ul>
<li>
<code>Date</code>: Date when the World Health Organization issued the report</li>
</ul>
<p><code>Gcases</code>: Number of new cases in Guinea</p>
<p><code>Gdeaths</code>: Number of new deaths in Guinea</p>
<p><code>Lcases</code>: Number of new cases in Liberia</p>
<p><code>Ldeaths</code>: Number of new deaths in Liberia</p>
<p><code>SLcases</code>: Number of new cases in Sierra Leone</p>
<p><code>SLdeaths</code>: <code>Number of new deaths in Sierra Leone</code></p>
<p><code>TotCases</code>: Total number of cases across all three countries</p>
<p><code>TotDeaths</code>: Total number of deaths across all three countries</p>
<p>We will focus on the Guinea data. As we have done throughout this book, we model this data using the pattern-book functions.</p>
<blockquote>
<p>In a <a href="https://maa-statprep.shinyapps.io/CalcZ-Sandbox/">SANDBOX</a>, use <code>gf_point()</code> to plot the number of new cases in Guinea (variables <code>Date</code> and <code>Gcases</code> in dataframe <code>EbolaAll</code>).</p>
</blockquote>
<pre><code>**Question 1**: Look at the shape of the graph. Of the functions we have studied, which would be most appropriate as a model for the new cases in Guinea? If none of the functions we have studied best matches this data, select "None of the above." </code></pre>
<p>Although we are tempted to regard data sets as definitive, they are the culmination of an imperfect process of data collection in the field and imperfect processing/correction/amendment by people. For instance, most of the cases (and deaths) in the epidemic were never confirmed by viral testing and are considered “suspected cases.” Cases and deaths reported on one day might possibly be from previous days, and some cases and deaths were, no doubt, not reported.</p>
<p>In the Sandbox, run the following command to look at the data:</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">EbolaAll</span><span class="op">)</span></code></pre></div>
<p>The resulting display is interactive; you can page through the many rows of data.</p>
<blockquote>
<p><strong>Question 2</strong>: Look through the data printout and find a data point form one of the World Health Organization reports that seems strange or inconsistent when compared with nearby reports. To receive full credit for this question, you must state the country and date of the report and explain your reasons for identifying this report as inconsistent.</p>
</blockquote>
</div>
<div id="data-wrangling" class="section level3" number="16.8.3">
<h3>
<span class="header-section-number">16.8.3</span> Data Wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"><i class="fas fa-link"></i></a>
</h3>
<p>An essential part of all projects involving data is to prepare the data for analysis: a process often called <strong><em>data wrangling</em></strong>. Although data wrangling is an important skill, it is not the topic of this book. So we will take care of the programming and present you with the results in the form of a data frame <code>EbolaGuinea</code>.</p>
<p>The wrangling accomplished two things: averaging the data over 7-report windows and extracting a numerical “day number” from the <code>Date</code> of each report.</p>
<p>First, rather than working with the year:month:day format of <code>Date</code>, it’s convenient to use a purely numerical quantity to represent time. So, we’ll translate the day when reports were issued into number of days from the initial report, presenting the result in the column <code>Days</code>. This makes the data-analysis programming easier, since all our mathematical software knows how to handle numbers, but not necessarily calendar dates.</p>
<p>Second, we’re going to <strong>smooth</strong> the number of cases and the number of deaths. We did this by averaging each day’s number-of-cases and number-of deaths over several report. As you can see in the data, the interval between reports is not constant. Some reports occur just one day after the previous report; sometimes there is a week between reports. The widely spaced reports tend to have much higher cases and deaths than reports that come every day. This is for the simple reason that each report gives the number of new cases and deaths since the previous report; there’s more time for the numbers to accumulate when there is a wide spacing between reports. The data reflect not just the process of the Ebola epidemic, but also the way the data were collected and reported, which is not directly of interest to us. To reduce this report-to-report fluctuation, we’ll average the number of new cases in each report with the three reports before and three reports after: a <strong><em>moving average</em></strong> over seven reports.</p>
<p>The result of our wrangling—the dataframe <code>EbolaGuinea</code>—includes three new columns:</p>
<ul>
<li>
<code>Days</code>: When the report was issued in terms of a count of days from the initial report.</li>
<li>
<code>G7Rcases</code>: Number of new cases in Guinea averaged across 7 reports</li>
<li>
<code>G7Rdeaths</code>: Number of new deaths in Guinea averaged across 7 reports</li>
</ul>
</div>
</div>
<div id="analysis-of-the-outbreak" class="section level2" number="16.9">
<h2>
<span class="header-section-number">16.9</span> Analysis of the outbreak<a class="anchor" aria-label="anchor" href="#analysis-of-the-outbreak"><i class="fas fa-link"></i></a>
</h2>
<p>In your Sandbox, use <code>gf_point()</code> to plot the smoothed data in <code>EbolaGuinea</code> to show the time course of the epidemic. The variables you want to plot are <code>G7Rcases</code> versus <code>Days</code>. averaged number of new cases in Guinea (variables Days and G7Rcases in dataframe EbolaGuinea).</p>
<blockquote>
<p><strong>Question 3</strong> Look at the shape of the graph. Of the functions we have studied, which would be most appropriate as a model for the new cases in Guinea? If none of the functions we have studied best matches this data, select “None of the above.”</p>
</blockquote>
<p>It is well known that the infection rate during an outbreak follows a Gaussian pattern when the population interacts consistently. Ebola initially spreads exponentially as people pass the virus to one another. As people are exposed to the virus, there are fewer and fewer people who are still susceptible. The result is that the rate of exponential growth slows and, when the fraction of the population that is susceptible becomes small, the epidemic slows down and the number of new cases decays exponentially. Overall, the pattern of new cases day-by-day looks like a gaussian: zero cases per day before the outputbreak, exponential growth at first after the virus is introduced to the population, leveling out for a time, and exponential decay back to zero new cases.</p>
<p>The graph of <code>G7Rcases</code> versus <code>Days</code> looks only vaguely like a gaussian hump. One possible explanation is that the data summarize more than one outbreak, as the virus spreads from one region to another. We’ll treat each individual output as a gaussian and try to figure out how many of them make up the whole data. The individual outbreaks will be modelled as a gaussian function with it’s own center and width. The center for each gaussian corresponds to the peak of the hypothesized outbreak in one particular region.</p>
<p>We’ll combine the several gaussians in a linear combination. The scalar multiplying each gaussian is related to the size of the population exposed in each outbreak.</p>
<p>Here is an R/mosaic definition of a linear combination of two gaussian outbreaks.</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_mod</span> <span class="op">&lt;-</span> <span class="fu">makeFun</span><span class="op">(</span><span class="fl">15800</span><span class="op">*</span><span class="op">(</span><span class="va">A</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">m1</span>,<span class="va">sd1</span><span class="op">)</span> <span class="op">+</span> 
                            <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">A</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">t</span>,<span class="va">m2</span>,<span class="va">sd2</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">t</span><span class="op">)</span> </code></pre></div>
<p>There are five parameters in the function. <code>m1</code> the time when the first hypothesized outbreak peaked, <code>m2</code> is the peak time of the second hypothesized outbreaks, and <code>sd1</code> and <code>sd2</code> reflect the duration of each outbreak. The parameter <code>A</code> represents the relative population sizes of the two regions. The number 15,800 reflects the total number of cases, which we know retrospectively. (The 15,800 includes a correction for the average day spacing between reports, but that detail need not concern us here.)</p>
<p>Note that selecting <code>A</code> sets the amplitude for both Gaussians, i.e. <code>A</code> and <code>1−A</code>. The amplitudes <code>A</code> and <code>1-A</code> sum up to 1. Arranging things this way effectively make <code>A</code> the size of the one outbreak, leaving <code>1-A</code> to be the size of the other outbreak.</p>
<p>To see how these Gaussians work together, start with the following values: <code>A = 0.5</code>, <code>m1 = 150</code>, <code>sd1 = 50</code>, <code>m2 = 350</code>, <code>sd2 = 50</code>. Do not change the 15800 number which reflects the overall size of the whole outbreak, as opposed to the relative size of the hypothesized individual outbreaks: <code>A</code> and <code>1-A</code>.</p>
<p>Use <code>gf_point()</code>, the pipe operator <code>%&gt;%</code>, and <code>slice_plot()</code> to overlay your model on top of the data. Discrepancies between the model and the data can lead you to improve the model by adjusting the parameters. It’s to be expected that you will need several cycles of such parameter adjustments until you find a model that seems to agree with the data in a satisfactory way. to you Guinea cases along with your model.</p>
<p>Once you have adjusted your model to match the data as closely as you can, write down the parameters you used in your report, as well as the graph comparing the data to your final model.</p>
<p><strong>Question 3</strong>: Find the longest time interval during which your model systematically overstates the number of cases. What’s the start and end of that interval? (Your answer can be rough, just so long as it points the reader of your report to the interval you mean.)</p>
</div>
<div id="more-data-smoothing" class="section level2" number="16.10">
<h2>
<span class="header-section-number">16.10</span> More data smoothing<a class="anchor" aria-label="anchor" href="#more-data-smoothing"><i class="fas fa-link"></i></a>
</h2>
<p>Accurately modeling the Guinea case data with two gaussian functions is difficult. Despite the smoothing, the numbers in <code>G7Rcases</code> fluctuate irregularly and substantially from report to report.</p>
<p>Another way to smooth the data, that is, to reduce the irregular report-to-report fluctuations, is to <strong><em>accumulate</em></strong> the number of new cases to get the total number of cases up through each report. (This accumulation, at the end of the epidemic, will be the total number of people who came down with Ebola illness.)</p>
<p>Such a sum of new cases from the beginning of the outbreak through the day of each report is called a <strong><em>cumulative sum</em></strong> or “running total.” Keep in mind that this is not a number, but a new column of data giving the number of cases to date for each of the dates in the data.</p>
<p>To illustrate, the small set of numbers: [1 2 3 4 5 6]. The cumulative sum of this set shows the running total: [1 3 6 10 15 21]. Make sure you are comfortable with how the second set of numbers is related to the first.</p>
<p>The R function <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> calculates the cumulative sum on a column of data. You are going to need to do a little data wrangling; we can’t do it for you because we don’t know what model you decided to settle on.</p>
<p>There are many computer systems for data wrangling. You may have heard of one called Structured Query Language (SQL) which is a required skill listed in many job listings and a multi-billion dollar component of the economy. We will use a system called <code>dplyr</code> specially designed for the R language. In the <code>dplyr</code> system, the function <code>mutate()</code> is used to create a new column in a data frame by carrying out calculations on the existing columns.</p>
<p>Here is an R/dplyr command to generate the running total of cases. (We’re using <code>Gcases</code> instead of the smoothed <code>G7Rcases</code> because the cumulative summing will do the smoothing for us.)</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">EbolaGuinea</span> <span class="op">&lt;-</span> <span class="va">EbolaGuinea</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>GcasesTotal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">Gcases</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>It’s worthwhile to parse that command carefully. The part to the right of <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code> is an instruction for taking the <code>EbolaGuinea</code> data frame and adding a new column. The new column will be called <code>GcasesTotal</code>. The values in the new column will be generated by applying <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> to the <code>Gcases</code> column. Altogether, the right-hand side of the statement creates a <em>new</em> data frame that includes the new column. The left-hand side of the statement stores this new data frame under a name. For convenience, we’re using <code>EbolaGuinea</code> as that name. Effectively, the command as a whole, including the name assignment <code>EbolaGuinea &lt;-</code> can be seen as <strong>updating</strong> the data frame with the new column.</p>
<p>You can verify that the new column is in place by showing the first several lines of the updated data frame:</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">EbolaGuinea</span><span class="op">)</span> </code></pre></div>
<p>Use <code>gf_point()</code> to plot <code>GCasesTotal</code> versus <code>Days</code>. The graph will show how the number of cases accumulated over time to to the overall total for the epidemic as a whole.</p>
<blockquote>
<p><strong>Question 5</strong>: Consider which of the functions we have studied could be fitted to represent the <code>GCasesTotal</code> versus <code>Days</code> curve in your graph? It’s likely that none of the functions we have studied fits the data particularly well, but one of them will be better than the others.</p>
</blockquote>
<p>We haven’t forgotten that you already created a model of the new cases by a linear combination of gaussian functions. What we want to do now is translate your model for the number of new cases each day into a model of the cumulative number of cases to date. In other words, we want to perform the same action that <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> does, but applied to your model rather than data.</p>
<p>To do this, you will replace the gaussian <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> function in your model with the sigmoidal <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. No other changes are needed. This works because the gaussian and sigmoid functions are related to one another in just the same way as <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> relates the <code>GCases</code> column to the <code>GCasesTotal</code> column.</p>
<p>Remember that the Gaussian and sigmoid functions are related to one another. The sigmoid is the accumulation of the Gaussian, i.e. it is the cumulative sum of the Gaussian. We will use this relationship to improve your double Gaussian model.</p>
<p>Create a new function in your sandbox called <code>my_mod_cumulative()</code>. Plot this new function over the <code>GCasesTotal</code> versus <code>Dates</code> data. As before, you can do this with <code>gf_point()</code>, the pipe operator <code>%&gt;%</code>, and <code>slice_plot()</code>.</p>
<blockquote>
<p><strong>Question 6</strong>: Observe the rate of change (slope) of your model. The rate of change represents the number of new infections per day. Find the day on which your rate of change is greatest. Describe how this is related to the argmax of your model from Question 4.</p>
</blockquote>
<p>Try adjusting the parameters in <code>my_mod_cumulative()</code> to better match the function to the <code>GCasesTotal</code> data. Some aspects of the outbreak can be better seen from the cumulative number of cases to date, and other aspects may be better seen with the-newcases-each-day data.</p>
<p>Now we will leverage the relationship between the Gaussian and sigmoid functions. Adjust your double Gaussian model and use the Question6 cumulative sums graph to evaluate your modifications. The procedure is outlined here:</p>
</div>
<div id="final-thoughts" class="section level2" number="16.11">
<h2>
<span class="header-section-number">16.11</span> Final thoughts<a class="anchor" aria-label="anchor" href="#final-thoughts"><i class="fas fa-link"></i></a>
</h2>
<p>The gaussian as a model for the time course of new cases, and the sigmoid for the time course of accumulated cases to date, are well established. But here we’ve used two gaussians (or, equivalently, two sigmoids). So was there one outbreak or two?</p>
<blockquote>
<p><strong>Question 7</strong>: Think about why the two-gaussian model matches the data better than the one-gaussian model. What might this mean in terms of the structure of the Ebola outbreak in Guinea? Don’t be afraid to speculate and frame your answer in terms that a layman might understand.</p>
</blockquote>
<p>The <strong><em>modeling cycle</em></strong> is all about using your current model to identify ways that you might be able to improve the model. Of course, in practice, you need to present your model for use, so you have to exit the cycle at some point. You’re at that point now, but we ask you to reflect a bit more.</p>
<blockquote>
<p><strong>Question 8</strong>: Given the results of your modeling efforts and your answer to Question 7, might it be better to model the outbreak using 3 or 4 Gaussians in our linear combination? What are the challenges associated with using more Gaussians?</p>
</blockquote>
<blockquote>
<p><strong>Question 9</strong>: The <code>EbolaAll</code> data frame records the Sierra Leone and Liberia outbreaks as well as the outbreak in Guinea. How might you use that additional data to explore the validity of your modeling process?</p>
</blockquote>
<p>Authors: Prof. Robert Wolverson, USAFA &amp; Daniel Kaplan, Macalester College and USAFA.</p>

</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="dimensions.html"><span class="header-section-number">16</span> Dimensions</a></div>
<div class="next"><a href="prolog-differentiation-and-birth.html">Prolog: Differentiation and birth</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#projects-and-review">Projects and review</a></li>
<li>
<a class="nav-link" href="#ebola-in-guinea-part-i"><span class="header-section-number">16.8</span> Ebola in Guinea, part I</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data"><span class="header-section-number">16.8.1</span> Data</a></li>
<li><a class="nav-link" href="#exploring-the-data"><span class="header-section-number">16.8.2</span> Exploring the Data</a></li>
<li><a class="nav-link" href="#data-wrangling"><span class="header-section-number">16.8.3</span> Data Wrangling</a></li>
</ul>
</li>
<li><a class="nav-link" href="#analysis-of-the-outbreak"><span class="header-section-number">16.9</span> Analysis of the outbreak</a></li>
<li><a class="nav-link" href="#more-data-smoothing"><span class="header-section-number">16.10</span> More data smoothing</a></li>
<li><a class="nav-link" href="#final-thoughts"><span class="header-section-number">16.11</span> Final thoughts</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="Not%20available/blob/master/Block-1-projects.Rmd">View source <i class="fab fa-gitlab"></i></a></li>
          <li><a id="book-edit" href="Not%20available/edit/master/Block-1-projects.Rmd">Edit this page <i class="fab fa-gitlab"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MOSAIC Calculus</strong>" was written by Daniel Kaplan. It was last built on 2021-10-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
